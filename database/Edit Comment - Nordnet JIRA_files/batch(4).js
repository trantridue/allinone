;/* module-key = 'com.atlassian.jira.jira-projects-plugin:browser-util', location = 'static/util/browser.js' */
(function(){AJS.namespace("JIRA.Projects.Util");JIRA.Projects.Util.Browser={getCurrentUrl:function(){return document.location.href},getCurrentLocation:function(){return document.location},hasPushState:function(){return !!(window.history&&window.history.pushState)},locationReplace:function(a){return window.location.replace(a)},locationAssign:function(a){return window.location.assign(a)},locationReload:function(a){window.location.reload(a)}}}());;
;/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-switch-analytics', location = '/static/page/darkfeature/analytics.js' */
(function(){var a=function(b,c){AJS.trigger("analyticsEvent",{name:"jira.project.centric.navigation.sidebar."+b,data:c})};AJS.namespace("JIRA.Projects.Sidebar.Switch");JIRA.Projects.Sidebar.Switch.Analytics={sidebarEnabled:function(){a("enabled")},sidebarDisabled:function(b){a("disabled",b)}}})();;
;/* module-key = 'com.atlassian.jira.jira-projects-plugin:project-centric-navigation-user-options', location = 'sidebar/options/user/sidebar-dark-feature-controller.js' */
(function(c){function i(){var k=JIRA.Projects.Util.Browser.getCurrentUrl();var j=/\/browse\/([A-Z][A-Z]+$|[A-Z][A-Z]+[\/\?#].*$)/;return j.test(k)||k.indexOf("/secure/BrowseProject.jspa")>-1||k.indexOf("/secure/BrowseProjectTabs.jspa")>-1}function a(){return JIRA.API&&JIRA.API.Projects&&JIRA.API.Projects.getCurrentProjectKey&&JIRA.API.Projects.getCurrentProjectKey()!==undefined}function g(k,j){var l=k?"The new project navigation has been enabled. Go to a project and try it out!":"The new project navigation has been disabled.";j.showSuccessMsg("",l,{closeable:true,close:"auto"})}function f(k,l){var j=k?"Disable new project navigation":"Enable new project navigation";l.text(j);l.toggleClass("enable-project-centric-nav disable-project-centric-nav")}function h(k,l,j){return function(){JIRA.trace("sidebar.darkfeature.toggled");var m=function(){if(a()){JIRA.Projects.Util.Browser.locationReplace(AJS.contextPath()+"/browse/"+JIRA.API.Projects.getCurrentProjectKey())}else{if(i()){JIRA.Projects.Util.Browser.locationReload(true)}else{g(k,j);f(k,l)}}};if(k){JIRA.Projects.Sidebar.Switch.Analytics.sidebarEnabled();m()}else{JIRA.Projects.Sidebar.Switch.Analytics.sidebarDisabled();JIRA.Projects.Sidebar.Options.User.Controller.initOptOutIssueCollector().always(m)}}}function d(k,j){return function(){var l=k?"The new project navigation could not be enabled. Please try again. If this problem persists, contact support.":"The new project navigation could not be disabled. Please try again. If this problem persists, contact support.";j.showErrorMsg("",l,{closeable:true,close:"auto"})}}function e(k,l,j){c.ajax({url:AJS.contextPath()+"/rest/projects/1.0/darkfeature",type:k?"PUT":"DELETE",contentType:"application/json"}).done(h(k,l,j)).fail(d(k,j))}function b(j){return function(l){l.preventDefault();var k=j.$userOption.hasClass("enable-project-centric-nav");if(k){j.enable()}else{j.disable()}}}AJS.namespace("JIRA.Projects.Sidebar.Options.User.Controller");JIRA.Projects.Sidebar.Options.User.Controller=function(k,j){this.$userOption=k;this.JIRAFlag=j};JIRA.Projects.Sidebar.Options.User.Controller.prototype={start:function(){this.$userOption.click(b(this))},enable:function(){e(true,this.$userOption,this.JIRAFlag)},disable:function(){e(false,this.$userOption,this.JIRAFlag)},isCurrentlyViewingLegacyBrowseProjectPage:i};JIRA.Projects.Sidebar.Options.User.Controller.initOptOutIssueCollector=function(){var k=c.Deferred();window.ATL_JQ_PAGE_PROPS={triggerFunction:function(l){_.defer(function(){l()})}};var j=function(l){if(l.originalEvent.data&&l.originalEvent.data==="cancelFeedbackDialog"){c(window).off("message",j);k.resolve()}};c(window).on("message",j);c.ajax({url:"https://jira.atlassian.com/s/f7a8a8a335008e9eb92ec2e306962491-T/en_UK-mw2hfv/64005/131/1.4.17/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=900de8dd",type:"get",cache:true,timeout:10000,dataType:"script"}).fail(function(l){k.reject()});return k.promise()}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-projects-plugin:project-centric-navigation-user-options', location = 'sidebar/options/user/init.js' */
(function(a){a(function(){var c=a(".project-centric-nav-user-option");var b=new JIRA.Projects.Sidebar.Options.User.Controller(c,require("jira/flag"));b.start()})})(AJS.$);;
;/* module-key = 'com.onresolve.jira.groovy.groovyrunner:userMessageUtil', location = 'js/userMessageRenderer.js' */
(function(c){AJS.toInit(function(){var a=function(a,d,e){AJS.$.get(AJS.params.baseURL+"/rest/scriptrunner/1.0/message",{},function(a){a=a||{};c.each(a,function(a,b){"undefined"!=typeof b&&JIRA.Messages.showMsg(a,{type:JIRA.Messages.Types[b.type],closeable:b.closeable})})})};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,a);a(null,null,null)})})(AJS.$);;
;/* module-key = 'com.onresolve.jira.groovy.groovyrunner:bh-issuePluginResources', location = 'js/jquery.tools.min.js' */
/*
 * jQuery Tools 1.2.5 - The missing UI library for the Web
 * 
 * [overlay, toolbox.expose]
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 * File generated: Mon Nov 29 13:12:11 GMT 2010
 */
(function(a){function t(d,b){var c=this,j=d.add(c),o=a(window),k,f,m,g=a.tools.expose&&(b.mask||b.expose),n=Math.random().toString().slice(10);if(g){if(typeof g=="string")g={color:g};g.closeOnClick=g.closeOnEsc=false}var p=b.target||d.attr("rel");f=p?a(p):d;if(!f.length)throw"Could not find Overlay: "+p;d&&d.index(f)==-1&&d.click(function(e){c.load(e);return e.preventDefault()});a.extend(c,{load:function(e){if(c.isOpened())return c;var h=q[b.effect];if(!h)throw'Overlay: cannot find effect : "'+b.effect+
'"';b.oneInstance&&a.each(s,function(){this.close(e)});e=e||a.Event();e.type="onBeforeLoad";j.trigger(e);if(e.isDefaultPrevented())return c;m=true;g&&a(f).expose(g);var i=b.top,r=b.left,u=f.outerWidth({margin:true}),v=f.outerHeight({margin:true});if(typeof i=="string")i=i=="center"?Math.max((o.height()-v)/2,0):parseInt(i,10)/100*o.height();if(r=="center")r=Math.max((o.width()-u)/2,0);h[0].call(c,{top:i,left:r},function(){if(m){e.type="onLoad";j.trigger(e)}});g&&b.closeOnClick&&a.mask.getMask().one("click",
c.close);b.closeOnClick&&a(document).bind("click."+n,function(l){a(l.target).parents(f).length||c.close(l)});b.closeOnEsc&&a(document).bind("keydown."+n,function(l){l.keyCode==27&&c.close(l)});return c},close:function(e){if(!c.isOpened())return c;e=e||a.Event();e.type="onBeforeClose";j.trigger(e);if(!e.isDefaultPrevented()){m=false;q[b.effect][1].call(c,function(){e.type="onClose";j.trigger(e)});a(document).unbind("click."+n).unbind("keydown."+n);g&&a.mask.close();return c}},getOverlay:function(){return f},
getTrigger:function(){return d},getClosers:function(){return k},isOpened:function(){return m},getConf:function(){return b}});a.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(e,h){a.isFunction(b[h])&&a(c).bind(h,b[h]);c[h]=function(i){i&&a(c).bind(h,i);return c}});k=f.find(b.close||".close");if(!k.length&&!b.close){k=a('<a class="close"></a>');f.prepend(k)}k.click(function(e){c.close(e)});b.load&&c.load()}a.tools=a.tools||{version:"1.2.5"};a.tools.overlay={addEffect:function(d,
b,c){q[d]=[b,c]},conf:{close:null,closeOnClick:true,closeOnEsc:true,closeSpeed:"fast",effect:"default",fixed:!a.browser.msie||a.browser.version>6,left:"center",load:false,mask:null,oneInstance:true,speed:"normal",target:null,top:"10%"}};var s=[],q={};a.tools.overlay.addEffect("default",function(d,b){var c=this.getConf(),j=a(window);if(!c.fixed){d.top+=j.scrollTop();d.left+=j.scrollLeft()}d.position=c.fixed?"fixed":"absolute";this.getOverlay().css(d).fadeIn(c.speed,b)},function(d){this.getOverlay().fadeOut(this.getConf().closeSpeed,
d)});a.fn.overlay=function(d){var b=this.data("overlay");if(b)return b;if(a.isFunction(d))d={onBeforeLoad:d};d=a.extend(true,{},a.tools.overlay.conf,d);this.each(function(){b=new t(a(this),d);s.push(b);a(this).data("overlay",b)});return d.api?b:this}})(jQuery);
(function(b){function k(){if(b.browser.msie){var a=b(document).height(),d=b(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a-d<20?d:a]}return[b(document).width(),b(document).height()]}function h(a){if(a)return a.call(b.mask)}b.tools=b.tools||{version:"1.2.5"};var l;l=b.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var c,i,e,g,j;b.mask={load:function(a,d){if(e)return this;if(typeof a=="string")a={color:a};a=a||g;g=a=b.extend(b.extend({},l.conf),a);c=b("#"+a.maskId);if(!c.length){c=b("<div/>").attr("id",a.maskId);b("body").append(c)}var m=k();c.css({position:"absolute",top:0,left:0,width:m[0],height:m[1],display:"none",opacity:a.startOpacity,zIndex:a.zIndex});a.color&&c.css("backgroundColor",a.color);if(h(a.onBeforeLoad)===false)return this;a.closeOnEsc&&b(document).bind("keydown.mask",function(f){f.keyCode==
27&&b.mask.close(f)});a.closeOnClick&&c.bind("click.mask",function(f){b.mask.close(f)});b(window).bind("resize.mask",function(){b.mask.fit()});if(d&&d.length){j=d.eq(0).css("zIndex");b.each(d,function(){var f=b(this);/relative|absolute|fixed/i.test(f.css("position"))||f.css("position","relative")});i=d.css({zIndex:Math.max(a.zIndex+1,j=="auto"?0:j)})}c.css({display:"block"}).fadeTo(a.loadSpeed,a.opacity,function(){b.mask.fit();h(a.onLoad);e="full"});e=true;return this},close:function(){if(e){if(h(g.onBeforeClose)===
false)return this;c.fadeOut(g.closeSpeed,function(){h(g.onClose);i&&i.css({zIndex:j});e=false});b(document).unbind("keydown.mask");c.unbind("click.mask");b(window).unbind("resize.mask")}return this},fit:function(){if(e){var a=k();c.css({width:a[0],height:a[1]})}},getMask:function(){return c},isLoaded:function(a){return a?e=="full":e},getConf:function(){return g},getExposed:function(){return i}};b.fn.mask=function(a){b.mask.load(a);return this};b.fn.expose=function(a){b.mask.load(a,this);return this}})(jQuery);
;
;/* module-key = 'com.onresolve.jira.groovy.groovyrunner:bh-issuePluginResources', location = 'js/clientvaljq.js' */
var JBHV={};
(function(h){function q(a){return-1<AJS.$.inArray(a,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker;com.atlassian.jira.issue.fields.DueDateSystemField;com.atlassian.jira.plugin.system.customfieldtypes:datepicker;Multi User Picker;com.atlassian.jira.issue.fields.IssueLinksSystemField;com.atlassian.jira.plugin.system.customfieldtypes:grouppicker;com.atlassian.jira.plugin.system.customfieldtypes:multigrouppicker;com.atlassian.jira.plugin.system.customfieldtypes:multiversion".split(";"))}function n(a){return a instanceof
Array&&1==a.length?a[0]:a}function C(a){var b=function(b){if(AJS.$(this).is(".editable-field")||AJS.$(this).is(".editable-field \x3e *"))a.removeClass("editable-field").removeClass("inactive").addClass("uneditable"),a.find("span.aui-iconfont-edit").remove(),a.attr("title","Inline edit disabled."),a.find(".icon").remove(),a.unbind("mouseenter").unbind("mouseleave").unbind("mousemove").unbind("mouseover")};a.is(":hover")?(a.delegate("*,","mouseover",b),a.hover(b),a.mousemove(b)):a.hover(b)}function x(){var a=
[];AJS.$.each(d,function(b,e){e.allowInlineEdit||a.push(b)});try{JIRA.Issues.FocusShifter.getSuggestions=JIRA.Issues.FocusShifter.getSuggestions=function(){var b=JIRA.Issues.Api.getFieldsOnSelectedIssue();return _.chain(b.models).filter(function(b){return!(-1<AJS.$.inArray(b.id,a))}).filter(JIRA.Components.IssueEditor.Models.Field.IS_EDITABLE).filter(function(a){return"comment"!==a.id}).map(function(a){return{label:a.getLabel(),value:a.id}}).value()}}catch(b){console.log("FocusShifter wasn't ready")}AJS.$(".editable-field").each(function(){var b=
AJS.$(this).attr("id");"undefined"!=typeof b&&(b=b.replace("-val",""),-1<AJS.$.inArray(b,a)&&C(AJS.$(this)))})}function l(){for(var a in d)if(0<a.length&&"__I18N__"!=a){var b=r(AJS.$("body"),a);if(0<b.length&&q(d[a].fieldType)){null==s[a]&&(s[a]="");var c=!1;if(null!=b.val()&&null!=s[a]&&"object"==typeof b.val())try{c=b.val().join("")==s[a].join("")}catch(e){console.log("error "+a+", todo")}else c=b.val()==s[a]||null==b.val()&&""==s[a];c||(console.log("Field changed, revalidating: "+b.attr("name")+
": "+b.val()),s[a]=b.val(),b.trigger("change.jbhv"))}}}function D(a){return d.__I18N__?d.__I18N__[a]:a}function u(){AJS.$(this).attr("disabled",!0);AJS.$(this).addClass("clientreadonly")}function E(a,b,c){0<AJS.$("#"+c+"-ms").length&&(a=AJS.$("#"+c+"-ms"));c in d||(console.log("Testing... - should not see this in production"),d[c]={},d[c].fieldType="");if(t(d[c].fieldType))if(a.find("input:checkbox:checked").attr("checked",!1),"object"==typeof b&&b.length)for(var e in b)a.find("input[value\x3d'"+
b[e]+"']").attr("checked",!0);else a.find("input[value\x3d'"+b+"']").attr("checked",!0);else"commentLevel"==a.attr("name")?(a.find("option").removeAttr("selected"),a.find("option[value\x3d'"+b+"']").attr("selected","selected"),c=""===b?AJS.params.securityLevelViewableByAll:AJS.params.securityLevelViewableRestrictedTo,a.parent().find(".current-level").html(AJS.format(c,a.find("option:selected").html()))):a.hasClass("single-user-picker")?AJS.$.get(AJS.params.baseURL+"/rest/api/1.0/users/picker.json",
{showAvatar:!0,query:b},function(c){if(""===b)a.find("option").removeAttr("selected");else{c=JIRA.UserPickerUtil.formatResponse(c)[0].properties.items[0];if("undefined"===typeof c){console.warn("Failed to find user: ",b);return}a.find("option").removeAttr("selected");a.find("optgroup:first").append(AJS.$("\x3coption/\x3e",{selected:"selected","class":"current-user","data-field-text":c.properties.label,value:b,style:"background-image: url("+c.properties.icon+")"}).html(c.properties.label))}a.parent().find("div.aui-ss").remove();
a.removeData("aui-ss");AJS.$(document).trigger(JIRA.Events.NEW_CONTENT_ADDED,[a.parent(),"pageLoad"])}):"comment"==a.attr("name")?a.is(":visible")&&a.val(b):a.hasClass("multi-select-select")?(console.log("set value to : ",b),"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]),H(a,b)):a.hasClass("aui-ss-select")?a.trigger("set-selection-value",b):a.val(b)}function I(a){var b;if(0<a.find(":radio").length)a.find(":radio").each(u);else if(0<a.find(":checkbox").length)a.find(":checkbox").each(u);
else{b="issuelinks-issues"==a.attr("name")?"issuelinks":a.attr("name");b in d||(console.log("Testing... - should not see this in production"),d[b]={},d[b].fieldType="");if(a.hasClass("cascadingselect-parent"))a.parent().find("select").each(u);else if("com.atlassian.jira.plugin.system.customfieldtypes:userpicker"==d[b].fieldType||"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker"==d[b].fieldType)AJS.$("#"+b).parent().find("a").each(function(){AJS.$(this).attr("style","display: none")});
else if(a.hasClass("aui-ss-select"))a=a.parent().find("input.aui-ss-field"),u(a),a.parent().find("span.drop-menu").hide();else if(a.hasClass("multi-select-select")){console.log("special treatment for multi select fields");var c=a.parent();AJS.$.each(["textarea","select"],function(a,b){c.find(b).addClass("clientreadonly");c.find(b).attr("disabled",!0)});c.find("span.drop-menu").hide();c.find("a.issue-picker-popup").hide();c.find("em").hide()}else a.parent().is("div.aui-field-datepicker")?AJS.$("#"+
b).parent().find("a").hide():"commentLevel"==b&&(AJS.$("#commentLevel-multi-select \x3e a.drop").find("span:first").removeClass("icon-unlocked").addClass("icon-locked"),AJS.$("#commentLevel-multi-select a span").removeClass("drop-menu"),AJS.$("#commentLevel-multi-select a.drop").unbind("click"));"com.atlassian.jira.issue.fields.AssigneeSystemField"==d[b].fieldType&&AJS.$("#"+b).parent().find("a").hide();a.each(u)}}function v(){AJS.$(this).attr("title","");AJS.$(this).attr("disabled",!1);AJS.$(this).removeClass("clientreadonly")}
function F(a){var b;if(0<a.find(":radio").length)a.find(":radio").each(v);else if(0<a.find(":checkbox").length)a.find(":checkbox").each(v);else{b="issuelinks-issues"==a.attr("name")?"issuelinks":a.attr("name");if(a.hasClass("cascadingselect-parent"))a.parent().find("select").each(v);else if("User Picker"==d[b].fieldType||"Multi User Picker"==d[b].fieldType)AJS.$("#"+b).parent().find("a").each(function(){AJS.$(this).attr("style","")});else if(a.hasClass("aui-ss-select"))a=a.parent().find("input.aui-ss-field"),
v(a),a.parent().find("span.drop-menu").show();else if(a.hasClass("multi-select-select")){var c=a.parent();AJS.$.each(["textarea","select"],function(a,b){c.find(b).removeClass("clientreadonly");c.find(b).attr("disabled",!1)});c.find("span.drop-menu").show();c.find("a.issue-picker-popup").show();c.find("em").show()}else a.parent().is("div.aui-field-datepicker")&&AJS.$("#"+b).parent().find("a").show();"com.atlassian.jira.issue.fields.AssigneeSystemField"==d[b].fieldType&&AJS.$("#"+b).parent().find("a").show();
a.each(v)}}function y(a){return 0<z.serverDone?(alert("Please wait a moment for the server to finish then retry your action."),a.preventDefault(),a.stopImmediatePropagation(),!1):U(a)}function U(a){console.log("submitting form:");var b="",c;AJS.$("div.jbhverror").remove();for(var e in d)if(0<e.length&&"__I18N__"!=e){console.log("submit field: "+e);var g;t(d[e].fieldType)?g=AJS.$("input[name\x3d'"+e+"']:first"):"issuelinks"==e?k=a.data.docRoot.find("#issuelinks-issues"):g=a.data.docRoot.find("#"+e);
if(0<g.length&&""!=d[e].title&&"undefined"!=typeof d[e].title){var b=b+(d[e].displayName+": "+d[e].title+"\n\n"),f=r(a.data.docRoot,e);J(f,d[e].title);c||(c=f);k=g.closest(".tabs-pane").not(".active-pane").attr("id");"undefined"!=typeof k&&(k=AJS.$("a[href\x3d'#"+k+"'] strong"),k.addClass("tabinvalid"),k.click(function(){AJS.$(this).removeClass("tabinvalid")}))}}if(0<b.length){b=c.offset().top-jQuery(window).height()/2;console.log("Scroll to: "+b);if(c.closest("div.tabs-pane").is(".active-pane")||
"comment"==f.attr("id"))"DIV"==a.data.docRoot.prop("tagName")?(c=a.data.docRoot.find(".form-body"),c.animate({scrollTop:b+c.scrollTop()},500)):AJS.$("body").animate({scrollTop:b},500);a.preventDefault();a.stopImmediatePropagation();console.log("Behaviours: Preventing the form from being submitted");return!1}for(e in d)if(0<e.length&&"__I18N__"!=e&&d[e].readonly){console.log("submit form make writable: "+e);var k;k=t(d[e].fieldType)?AJS.$("input[name\x3d'"+e+"']").parent():AJS.$("#"+e);0<k.length&&
(console.log("makeWritable: "+e),F(k))}return!0}function m(a,b){b=AJS.$(this);var c;c=b;c=0<c.parent().find(":radio").length?c.find(":radio")[0].name:0<c.find(":checkbox").length?c.find(":checkbox")[0].name:"issuelinks-issues"==c.attr("name")?"issuelinks":c.attr("name");console.log("Validate field: "+c);!b.hasClass("select")&&b.val()?d[c].title="":b.hasClass("select")&&b.val()&&"-1"!==b.val().toString()&&""!=b.val()?d[c].title="":"select-multiple"==b.attr("type")&&null!=b.val()&&"-1"!=b.val()?d[c].title=
"":"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons"==d[c].fieldType?-1!=b.parent().find("input:radio:checked").val()?d[c].title="":(d[c].title=D("field.title.missing.value"),A(c)):"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"==d[c].fieldType?(console.log("validate checkboxes"),0<b.parent().find("input:checkbox:checked").length?(console.log("remove checkboxes class"),d[c].title=""):(console.log("add checkboxes class"),d[c].title=D("field.title.missing.value"),
A(c))):d[c].title=D("field.title.missing.value")}function A(a){console.log("requireField: "+a);var b=AJS.$("label[for\x3d'"+a+"']");b.length||(b=AJS.$(":input[name\x3d'"+a+"']").parent().parent().find("legend \x3e span"));b.children().size()||b.append('\x3cspan class\x3d"aui-icon icon-required"\x3e\x3c/span\x3e\x3cspan class\x3d"content"\x3eRequired\x3c/span\x3e')}function G(a){console.log("unrequireField: "+a);var b=AJS.$("label[for\x3d'"+a+"']");b.length||(b=AJS.$(":input[name\x3d'"+a+"']").parent().parent().find("legend \x3e span"));
b.children().size()&&b.children().remove()}function V(){for(var a="",b=0;8>b;b++)var c=Math.floor(61*Math.random()),a=a+"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(c,c+1);return a}function p(a){var b=AJS.$(this),c;c=null==a.data||"undefined"==typeof a.data?a.data.closest("form"):a.data.docRoot;a=0<b.find(":radio").length?b.find(":radio")[0].name:0<b.find(":checkbox").length?b.find(":checkbox")[0].name:/:/.test(b.attr("name"))?b.attr("name").replace(/:.*/,""):b.attr("name");
var e={};e[a]=b.val();c.find("form.aui").find(":input").each(function(){var a=AJS.$(this);if(a.hasClass("multi-select-select")){var b=[];AJS.$("#"+a.attr("name")+" :selected").each(function(){b.push(AJS.$(this).val())});e[a.attr("name")]=b.join("-*-*-")}else if(a.hasClass("aui-ss-select"))e[a.attr("name")]=n(a.parent().find("select").val());else if("radio"==a.attr("type"))e[a.attr("name")]=a.parent().parent().find(":checked").val();else if("checkbox"==a.attr("type"))b=[],a.closest("fieldset").find(":checked").each(function(){b.push(AJS.$(this).val())}),
e[a.attr("name")]=b.join("-*-*-");else if(a.hasClass("cascadingselect-parent")){var c=a.parent().find("option:selected").map(function(){return AJS.$(this).val()});e[a.attr("name")]=AJS.$.makeArray(c).join("-*-*-")}else e[a.attr("name")]=a.val()});b=c.find("#project");0<b.length&&(e.pid=jQuery.isArray(b.val())?b.val()[0]:b.val());b=c.find("#issuetype");0<b.length&&(e.issuetype=jQuery.isArray(b.val())?b.val()[0]:b.val());e.__validators__=d;console.log("posting runvalidator for field: "+a+". Payload:",
e);z.serverDone++;AJS.$.post(AJS.params.baseURL+"/rest/com.onresolve.jira.plugin.Behaviours/1.0/behaviours/runvalidator.json",{fieldName:a,form:JSON.stringify(e)},function(a){B(c,a,!1)}).error(function(){console.log("Behaviours post failed.")}).complete(function(){z.serverDone--})}function r(a,b){var c;c=b in d&&t(d[b].fieldType)?a.find("input[name\x3d'"+b+"']").parent():"issuelinks"==b?a.find("#issuelinks-issues"):a.find("#"+b);c.exists()||(c=AJS.$("label[for\x3d'"+b+"']"));return c}function J(a,
b){a.parent().find("div.jbhverror").remove();var c=a.parent().find("div.error:last"),d='\x3cdiv class\x3d"error jbhverror"\x3e'+b+"\x3c/div\x3e";0<c.length?c.prepend(d):a.parent().append(d)}function W(a,b){var c=a.parent().find("div.description");c.exists()?c.empty().append(b):a.parent().append(h("\x3cdiv/\x3e",{"class":"description",html:b}))}function K(a,b,c,d){a.unbind("keyup.jbhv",m);a.unbind("change.jbhv",m);a.unbind("click",m);a.unbind("unselect.jbhv",m);a.unbind("selected.jbhv",m);"comment"==
b&&c.find(":input[name\x3d'comment']").unbind("change.jbhv",m);d&&(a.bind("click",m),"comment"==b?c.find(":input[name\x3d'comment']").bind("change.jbhv",m):a.hasClass("multi-select-select")?(a.bind("unselect.jbhv",m),a.bind("selected.jbhv",m)):(a.bind("keyup.jbhv",m),a.bind("change.jbhv",m)))}function L(a,b,c,e,g){console.log("Conversion.... to "+e);if("single-select"==e||"multi-select"==e)if(b.hasClass("aui-ss-select")||"true"==b.data("is-ms-field")||b.is(":hidden")){console.warn("Field already is a select/multiselect list");
return}if("short-text"==e)b.show(),b.removeData("is-ms-field"),AJS.$("#"+c+"-ms-multi-select").remove(),AJS.$("#"+c+"-ms-single-select").remove(),AJS.$("#"+c+"-ms").remove();else if("single-select"==e)if(b.is(".select"))new AJS.SingleSelect({element:b,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"});else{var f=c+"-ms";b.after("\x3cselect id\x3d'"+f+"' name\x3d'"+f+"' class\x3d'select cf-select'\x3e\x3c/select\x3e").hide();e=AJS.$("#"+f+"");e.data("redirect-to",b.attr("id"));e.bind("change, unselect.jbhv, selected.jbhv",
function(a){var b=AJS.$(this);a=b.parent().find("#"+b.data("redirect-to"));b=AJS.$.makeArray(b.val());a.val(b.join("; "))});b=r(a,c);var k=((d||{})[c]||{}).fieldOptions;k&&w(a,e,c,d[c].fieldOptions);new AJS.SingleSelect({element:e,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"})}else if("multi-select"==e)if(b.is(".select"))new AJS.MultiSelect({element:b,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"});else{f=c+"-ms";b.after("\x3cselect id\x3d'"+f+"' name\x3d'"+f+
"' class\x3d'select cf-select' multiple\x3d'multiple'\x3e\x3c/select\x3e").hide();e=AJS.$("#"+f+"");b.data("is-ms-field","true");e.bind("change, unselect.jbhv, selected.jbhv",function(a){var b=AJS.$(this);a=b.parent().find("#"+b.data("redirect-to"));b=AJS.$.makeArray(b.val());a.val(b.join("; "))});b=r(a,c);(k=((d||{})[c]||{}).fieldOptions)&&w(a,e,c,d[c].fieldOptions);if(!(b.val()instanceof Array||_.isEmpty(b.val()))){var k=b.val().split("; "),M={};_.each(k,function(a){M[a]=a});w(a,e,c,M);E(e,k,f)}a=
{element:e,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"};AJS.$.isEmptyObject(g)||("issue"==g.ajaxOptions.formatResponse?g.ajaxOptions.formatResponse=JBHV.IssuePickerUtil.formatResponse:"general"==g.ajaxOptions.formatResponse&&(g.ajaxOptions.formatResponse=JBHV.GeneralPickerUtil.formatResponse));g=g||{};new AJS.MultiSelect(AJS.$.extend(a,g));e.data("redirect-to",b.attr("id"))}else log.warn("Not supported")}function N(a,b){a.parent().find("div.representation").find("span.value-text:contains('"+
b+"')").closest("li").find("em.item-delete").click()}function O(a,b){a.is(".multi-select-select,.aui-ss-select")?a.find("option").each(function(c,d){var g=h(d).data("descriptor");g.value()==b&&(console.log("removing item",g.label()),N(a,g.label()))}):a.parent().find("div.representation").find("option").filter(function(a){return AJS.$(this).val()==b}).remove()}function X(a){return a.find("option").map(function(){return AJS.$(this).val()}).get()}function P(a,b){var c=jQuery.grep(a.find("option"),function(a,
c){return h(a).data("descriptor").value()==b});c.length?a.trigger("selectOption",c):console.warn(AJS.format("Could not add invalid option {0} to ${1}",b,a.selector))}function Q(a,b){var c=h.map(b,function(a,b){return b}),d=!1,g=X(a),f=_(g).difference(c);h.each(f,function(b,c){d=a.val()?-1<a.val().indexOf(c):!1;O(a,c);a.find("option[value\x3d'"+c+"']").remove()});c=_(c).difference(g);h.each(c,function(c,d){a.append(h("\x3coption/\x3e",{text:b[d],value:d}))});a.hasClass("aui-ss-select")&&d&&(console.log("in array"),
(c=a.find("option:first"))&&a.val(c.val()));a.trigger("reset")}function H(a,b){b=b.map(function(a){return String(a)});h.each(b,function(b,d){P(a,d)});_.each(_(a.val()).difference(b),function(b){O(a,b)})}function w(a,b,c,d){b=a.find("#"+c+"-ms").length?a.find("#"+c+"-ms"):a.find("#"+c);Q(b,d)}function B(a,b,c){console.log("Adding listeners: ");console.log(b);if(null!=b){var e=!1,g=AJS.$.extend(!0,{},d);d=b;console.log("Setting timeout for disabling inline edit");setTimeout(x,100);for(var f in d)if(0<
f.length){var k=d[f];b=r(a,f);if(0<b.length){if(console.log("field: "+f),"undefined"!=typeof k){q(d[f].fieldType)&&(e=!0);"true"==d[f].required?(console.log("Make required: "+f),K(b,f,a,!0),A(f),b.trigger("click")):"false"==d[f].required&&(d[f].title="",K(b,f,a,!1),G(f));"undefined"!=typeof d[f].helpText&&J(b,d[f].helpText);"undefined"!=typeof d[f].description&&W(b,d[f].description);"server"==d[f].validator&&(t(k.fieldType)?(b.find("input").unbind("change.jbhv",p).bind("change.jbhv",{docRoot:a},p),
c&&b.find("input:checked").trigger("change.jbhv")):R(k.fieldType)?(console.log("add select fns"),b.parent().find("select").unbind("change.jbhv",p).bind("change.jbhv",{docRoot:a},p)):b.hasClass("multi-select-select")?(b.unbind("unselect.jbhv").bind("unselect.jbhv",{docRoot:a},p),b.unbind("selected.jbhv").bind("selected.jbhv",{docRoot:a},p),c&&b.trigger("selected.jbhv")):(b.unbind("change.jbhv",p).bind("change.jbhv",{docRoot:a},p),c&&(/^(?:com.valiantys.jira.plugins.sql.customfield)$/.test(d[f].fieldType)||
b.trigger("change.jbhv"))));"undefined"!=typeof d[f].label&&b.parent().find("label[for\x3d'"+f+"'").empty().html(d[f].label);"true"==d[f].readonly?(console.log("Make readonly: "+f),I(b)):"false"==d[f].readonly&&F(b);if("undefined"!=typeof d[f].overlay){k=d[f].overlay;console.log(k);var h=V();console.log("overlay id: "+h);AJS.$("body").append('\x3cdiv class\x3d"simple_overlay" id\x3d"'+h+'" ;"\x3e'+k+"\x3c/div\x3e");AJS.$("#"+h).overlay({expose:{color:"#333",loadSpeed:200,opacity:0.9},api:!0}).load()}"true"==
d[f].hidden?(b.closest("fieldset.group").hide(),b.closest("div.field-group").hide()):"false"==d[f].hidden&&(b.closest("fieldset.group").show(),b.closest("div.field-group").show());"undefined"!=typeof d[f].convertTo&&L(a,b,f,d[f].convertTo,d[f].selectOptions||{});d[f].fieldOptions&&w(a,b,f,d[f].fieldOptions);k=d[f].setValue;"undefined"!=typeof k&&E(b,k,f);b="assignee"==f||"priority"==f?a.find("#"+f+"-field"):b;"invalid"==d[f].validity&&b.removeClass("clientok").addClass("invalid");"valid"==d[f].validity&&
b.removeClass("invalid").addClass("clientok");""==d[f].validity&&b.removeClass("invalid").removeClass("clientok");"undefined"!=typeof d[f].errorMsg&&(d[f].title=d[f].errorMsg)}}else"__I18N__"!=f&&console.log("Field not found: "+f)}AJS.$.each(d,function(a,b){a in g?AJS.$.each(d[a],function(b,c){g[a][b]=c}):g[a]=b});d=g;c&&e&&setInterval(function(){l()},700)}}function t(a){return"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons"==a||"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"==
a}function R(a){return"com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect"==a}function Y(a,b,c,d){a.unbind(b,c);a.bind(b,d,c);c=a.data("events")[b];c.unshift(c.pop());a.data("events")[b]=c}function S(){console.log("[behaviors] new content added, clearing outstanding errors...");for(var a in d)if(!(0>=a.length||"__I18N__"==a)){var b=r(AJS.$("body"),a);0>=b.length||(console.log("behaviors] clearing conditions on: "+a),b.parent().find("div.jbhverror").remove(),d[a].helpText="",d[a].title=
"",G(a),t(d[a].fieldType)?b.find("input").unbind("click.jbhv",p):R(d[a].fieldType)?b.parent().find("select").unbind("change.jbhv",p):b.unbind("change.jbhv",p))}l()}var d={},z=[];z.serverDone=0;h.fn.exists=function(){return 0!==this.length};var s=[];"undefined"==typeof console&&(console={log:function(){},trace:function(){},warn:function(){}});var T=function(a,b,c){a=!1;c||(a=!0);"HEADER"==b.prop("tagName")&&"stalker"==b.attr("id")&&(b=AJS.$(document),a=!0);a||!c||c!=JIRA.CONTENT_ADDED_REASON.dialogReady&&
c!=JIRA.CONTENT_ADDED_REASON.pageLoad||(a=!0);if(a){S();d=[];c=n(b.find("input[name\x3d'action']").val());a=n(b.find("#project,input[name\x3dpid]").val());var e=n(b.find("#issuetype,input[name\x3dissuetype]").val()),g=n(b.find("input[name\x3did]").val());b.find("form#issue-create,form#issue-workflow-transition,form#assign-issue,input[type\x3d'hidden'][name\x3d'id'],div.issue-setup-fields").length&&("undefined"!=typeof g&&null!==g?AJS.$.ajax({type:"GET",url:AJS.params.baseURL+"/rest/com.onresolve.jira.plugin.Behaviours/1.0/behaviours/validators.json",
data:{issueId:g,actionId:c},success:function(a){B(b,a,!0)},error:function(a,b,c){console.error("ScriptRunner","Error retrieving validators",{xhr:a,status:b,error:c})}}):"undefined"!=typeof a&&"undefined"!=typeof e&&a&&e?AJS.$.ajax({type:"GET",url:AJS.params.baseURL+"/rest/com.onresolve.jira.plugin.Behaviours/1.0/behaviours/validatorsByPid.json",data:{pid:a,issueTypeId:e,actionId:c},success:function(a){B(b,a,!0)},error:function(a,b,c){console.error("ScriptRunner","Error retrieving validators",{xhr:a,
status:b,error:c})}}):console.warn("ScriptRunner","This context does NOT contain an IssueId or Pid/IssueTypeId. Field Listeners NOT added",b.find("form#issue-create,form#issue-workflow-transition,form#assign-issue,input[type\x3d'hidden'][name\x3d'id'],div.issue-setup-fields")),Y(b.find("form#issue-create,form#issue-workflow-transition,form#assign-issue,input[type\x3d'hidden'][name\x3d'id'],div.issue-setup-fields").closest("form"),"submit",y,{docRoot:b}))}};AJS.$(document).ready(function(){AJS.$.each(["#key-val",
"form[id\x3d'issue-workflow-transition']","#issue-create","form[id\x3d'issue-edit']","form[id\x3d'subtask-create-details']"],function(a,b){AJS.$(b).unbind("submit",y).bind("submit",{docRoot:AJS.$("body")},y)});T(null,AJS.$(document),null);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,T)});JBHV.setFieldValue=E;JBHV.findFieldForId=r;JBHV.makeWritable=F;JBHV.makeReadOnly=I;JBHV.setBehaviours=function(a){d=a};JBHV.requireField=A;JBHV.unRequireField=G;JBHV.setFieldOptions=w;JBHV.convertToType=L;JBHV.submitForm=
y;JBHV.addFieldListeners=B;JBHV.setMultiSelectListValue=H;JBHV.addMultiSelectOption=function(a,b){var c=jQuery.grep(a.find("option"),function(a,c){return h(a).data("descriptor").label()==b});c.length?a.trigger("selectOption",c):console.warn(AJS.format("Could not add invalid option {0} to ${1}",b,a.selector))};JBHV.syncOptions=Q;JBHV.getAvailableOptions=function(a){return a.find("option").map(function(){return AJS.$(this).text().trim()}).get()};JBHV.getSelectedOptions=function(a){return a.find("option:selected").map(function(){return AJS.$(this).text().trim()}).get()};
JBHV.removeMultiSelectOption=N;JBHV.addMultiSelectOptionById=P;JBHV.clearAllBehaviours=S})(AJS.$);
(function(h){JBHV.GeneralPickerUtil={formatResponse:function(q){var n=[];h(q).each(function(q,x){var l=new AJS.GroupDescriptor({weight:q,label:x.footer});h(x.items).each(function(){l.addItem(new AJS.ItemDescriptor({value:this.value,label:this.label,html:this.html,icon:this.icon,allowDuplicate:!1,highlighted:!0}))});n.push(l)});return n}};JBHV.IssuePickerUtil={formatResponse:function(h){var n=[],C=function(){var h=parseUri(window.location);return h.protocol+"://"+h.authority}();h&&h.sections&&jQuery(h.sections).each(function(h,
l){console.log("section",l);if("cs"===l.id){var q=new AJS.GroupDescriptor({weight:h,label:l.label,description:l.sub});l.issues&&0<l.issues.length&&jQuery(l.issues).each(function(){q.addItem(new AJS.ItemDescriptor({highlighted:!0,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?C+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))});n.push(q)}});return n}}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/keymaster.js' */
(function(u){var v,B={},A={16:false,18:false,17:false,91:false},r="all",e={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},f={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},a=function(k){return f[k]||k.toUpperCase().charCodeAt(0)},x=[];for(v=1;v<20;v++){f["f"+v]=111+v}function h(F,E){var k=F.length;while(k--){if(F[k]===E){return k}}return -1}function y(E,k){if(E.length!=k.length){return false}for(var F=0;F<E.length;F++){if(E[F]!==k[F]){return false}}return true}var q={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function i(k){for(v in A){A[v]=k[q[v]]}}function C(J){var G,I,E,F,K,H;G=J.keyCode;if(h(x,G)==-1){x.push(G)}if(G==93||G==224){G=91}if(G in A){A[G]=true;for(E in e){if(e[E]==G){g[E]=true}}return}i(J);if(!g.filter.call(this,J)){return}if(!(G in B)){return}H=n();for(F=0;F<B[G].length;F++){I=B[G][F];if(I.scope==H||I.scope=="all"){K=I.mods.length>0;for(E in A){if((!A[E]&&h(I.mods,+E)>-1)||(A[E]&&h(I.mods,+E)==-1)){K=false}}if((I.mods.length==0&&!A[16]&&!A[18]&&!A[17]&&!A[91])||K){if(I.method(J,I)===false){if(J.preventDefault){J.preventDefault()}else{J.returnValue=false}if(J.stopPropagation){J.stopPropagation()}if(J.cancelBubble){J.cancelBubble=true}}}}}}function d(H){var G=H.keyCode,E,F=h(x,G);if(F>=0){x.splice(F,1)}if(G==93||G==224){G=91}if(G in A){A[G]=false;for(E in e){if(e[E]==G){g[E]=false}}}}function j(){for(v in A){A[v]=false}for(v in e){g[v]=false}}function g(E,F,I){var H,G;H=b(E);if(I===undefined){I=F;F="all"}for(var k=0;k<H.length;k++){G=[];E=H[k].split("+");if(E.length>1){G=w(E);E=[E[E.length-1]]}E=E[0];E=a(E);if(!(E in B)){B[E]=[]}B[E].push({shortcut:H[k],scope:F,method:I,key:H[k],mods:G})}}function z(G,H){var k,J,I=[],F,E,K;k=b(G);for(E=0;E<k.length;E++){J=k[E].split("+");if(J.length>1){I=w(J);G=J[J.length-1]}G=a(G);if(H===undefined){H=n()}if(!B[G]){return}for(F in B[G]){K=B[G][F];if(K.scope===H&&y(K.mods,I)){B[G][F]={}}}}}function c(k){if(typeof(k)=="string"){k=a(k)}return h(x,k)!=-1}function p(){return x.slice(0)}function l(E){var k=(E.target||E.srcElement).tagName;return !(k=="INPUT"||k=="SELECT"||k=="TEXTAREA")}for(v in e){g[v]=false}function m(k){r=k||"all"}function n(){return r||"all"}function s(G){var F,k,E;for(F in B){k=B[F];for(E=0;E<k.length;){if(k[E].scope===G){k.splice(E,1)}else{E++}}}}function b(k){var E;k=k.replace(/\s/g,"");E=k.split(",");if((E[E.length-1])==""){E[E.length-2]+=","}return E}function w(E){var F=E.slice(0,E.length-1);for(var k=0;k<F.length;k++){F[k]=e[F[k]]}return F}function t(k,E,F){if(k.addEventListener){k.addEventListener(E,F,false)}else{if(k.attachEvent){k.attachEvent("on"+E,function(){F(window.event)})}}}t(document,"keydown",function(k){C(k)});t(document,"keyup",d);t(window,"focus",j);var o=u.key;function D(){var E=u.key;u.key=o;return E}u.key=g;u.key.setScope=m;u.key.getScope=n;u.key.deleteScope=s;u.key.filter=l;u.key.isPressed=c;u.key.getPressedKeyCodes=p;u.key.noConflict=D;u.key.unbind=z;if(typeof module!=="undefined"){module.exports=key}})(this);;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/amd-wrappers.js' */
define("wiki-edit/aui",function(){return AJS});define("wiki-edit/JIRA",function(){return JIRA});define("wiki-edit/keymaster",["wiki-edit/aui"],function(a){if(a.Meta.get("keyboard-shortcuts-enabled")===false){return function b(){}}return key.noConflict()});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/templates/wiki-editor.soy' */
// This file was automatically generated from wiki-editor.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Plugins == 'undefined') { JIRA.Templates.Plugins = {}; }
if (typeof JIRA.Templates.Plugins.WikiEditor == 'undefined') { JIRA.Templates.Plugins.WikiEditor = {}; }


JIRA.Templates.Plugins.WikiEditor.renderEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="wiki-edit-dropdown2-text-style-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-dropdown"><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a href="#" class="wiki-edit-operation" data-operation="paragraph" title="', soy.$$escapeHtml("Paragraph"), '">', soy.$$escapeHtml("Paragraph"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-h1" data-operation="h1" title="', soy.$$escapeHtml("Heading 1"), '">', soy.$$escapeHtml("Heading 1"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-h2" data-operation="h2" title="', soy.$$escapeHtml("Heading 2"), '">', soy.$$escapeHtml("Heading 2"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-h3" data-operation="h3" title="', soy.$$escapeHtml("Heading 3"), '">', soy.$$escapeHtml("Heading 3"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-h4" data-operation="h4" title="', soy.$$escapeHtml("Heading 4"), '">', soy.$$escapeHtml("Heading 4"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-h5" data-operation="h5" title="', soy.$$escapeHtml("Heading 5"), '">', soy.$$escapeHtml("Heading 5"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-h6" data-operation="h6" title="', soy.$$escapeHtml("Heading 6"), '">', soy.$$escapeHtml("Heading 6"), '</a></li><li><a href="#" class="wiki-edit-operation wiki-edit-operation-monospace" data-operation="monospace" title="', soy.$$escapeHtml("Preformatted"), '">', soy.$$escapeHtml("Preformatted"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="paragraph-quote" title="', soy.$$escapeHtml("Paragraph quote"), '">', soy.$$escapeHtml("Paragraph quote"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="block-quote" title="', soy.$$escapeHtml("Block quote"), '">', soy.$$escapeHtml("Block quote"), '</a></li></ul></div></div><div id="wiki-edit-dropdown2-more-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-dropdown"><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a href="#" class="wiki-edit-operation" data-operation="delete" data-shortcut="ctrl+shift+s, command+shift+s" title="', soy.$$escapeHtml("Strikethrough"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+Shift+S)">', soy.$$escapeHtml("Strikethrough"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="superscript">', soy.$$escapeHtml("Superscript"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="subscript">', soy.$$escapeHtml("Subscript"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="cite">', soy.$$escapeHtml("Citation"), '</a></li></ul></div></div><div id="wiki-edit-dropdown2-link-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-dropdown wiki-edit-dropdown-link"><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a href="#" class="wiki-edit-operation" data-operation="link" data-shortcut="ctrl+k, command+k" title="', soy.$$escapeHtml("External link"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+K)">', soy.$$escapeHtml("External link"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="link-mail">', soy.$$escapeHtml("Mail link"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="link-anchor">', soy.$$escapeHtml("Anchor link"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="link-attachment">', soy.$$escapeHtml("Attachment link"), '</a></li></ul></div><div class="aui-dropdown2-section wiki-edit-insert-link"><strong>', soy.$$escapeHtml("Attachment link"), '</strong><ul class="aui-list-truncate"><li><a href="#"></a></li></ul></div></div><div id="wiki-edit-dropdown2-image-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-dropdown wiki-edit-dropdown-image"><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a href="#" class="wiki-edit-operation" data-operation="image" title="', soy.$$escapeHtml("External image"), '">', soy.$$escapeHtml("External image"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="image-attachment">', soy.$$escapeHtml("Attached image"), '</a></li></ul></div><div class="aui-dropdown2-section wiki-edit-insert-image"><strong>', soy.$$escapeHtml("Attached image"), '</strong><ul class="aui-list-truncate"><li><a href="#"></a></li></ul></div></div><div id="wiki-edit-color-picker-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-picker wiki-edit-color-picker" data-container="wiki-edit-color-picker-buttons-', soy.$$escapeHtml(opt_data.editorId), '">');
  var colors__soy90 = ['333333', '707070', 'cccccc', '205081', '59afe1', '14892c', '8eb021', 'd04437', 'f79232', 'f6c342', '654982', 'f691b2'];
  output.append('<div class="aui-dropdown2-section"><ul>');
  var colorList92 = colors__soy90;
  var colorListLen92 = colorList92.length;
  for (var colorIndex92 = 0; colorIndex92 < colorListLen92; colorIndex92++) {
    var colorData92 = colorList92[colorIndex92];
    output.append('<li><a href="#" style="background-color: #', soy.$$escapeHtml(colorData92), '" data-operation="color" data-color="#', soy.$$escapeHtml(colorData92), '">&nbsp;</a></li>');
  }
  output.append('</ul></div></div><div id="wiki-edit-dropdown2-icon-picker-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-picker wiki-edit-icon-picker" data-container="wiki-edit-icon-picker-buttons-', soy.$$escapeHtml(opt_data.editorId), '"><div class="aui-dropdown2-section"><ul><li><a href="#" class="wiki-edit-operation" title=":)" data-operation=":)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/smile.gif" alt="', soy.$$escapeHtml("smile"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title=":(" data-operation=":("><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/sad.gif" alt="', soy.$$escapeHtml("sad"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title=":P" data-operation=":P"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/tongue.gif" alt="', soy.$$escapeHtml("tongue"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title=":D" data-operation=":D"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/biggrin.gif" alt="', soy.$$escapeHtml("biggrin"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title=";)" data-operation=";)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/wink.gif" alt="', soy.$$escapeHtml("wink"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(y)" data-operation="(y)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/thumbs_up.gif" alt="', soy.$$escapeHtml("thumbs up"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(n)" data-operation="(n)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/thumbs_down.gif" alt="', soy.$$escapeHtml("thumbs down"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(i)" data-operation="(i)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/information.gif" alt="', soy.$$escapeHtml("information"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(/)" data-operation="(/)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/check.gif" alt="', soy.$$escapeHtml("check"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(x)" data-operation="(x)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/error.gif" alt="', soy.$$escapeHtml("error"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(!)" data-operation="(!)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/warning.gif" alt="', soy.$$escapeHtml("warning"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(+)" data-operation="(+)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/add.gif" alt="', soy.$$escapeHtml("add"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(-)" data-operation="(-)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/forbidden.gif" alt="', soy.$$escapeHtml("forbidden"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(?)" data-operation="(?)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/help_16.gif" alt="', soy.$$escapeHtml("help"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(on)" data-operation="(on)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/lightbulb_on.gif" alt="', soy.$$escapeHtml("lightbulb on"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(off)" data-operation="(off)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/lightbulb.gif" alt="', soy.$$escapeHtml("lightbulb"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(*)" data-operation="(*)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/star_yellow.gif" alt="', soy.$$escapeHtml("star yellow"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(*r)" data-operation="(*r)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/star_red.gif" alt="', soy.$$escapeHtml("star red"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(*g)" data-operation="(*g)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/star_green.gif" alt="', soy.$$escapeHtml("star green"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(*b)" data-operation="(*b)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/star_blue.gif" alt="', soy.$$escapeHtml("star blue"), '" /></a></li><li><a href="#" class="wiki-edit-operation" title="(*y)" data-operation="(*y)"><img src="', soy.$$escapeHtml(""), '/images/icons/emoticons/star_yellow.gif" alt="', soy.$$escapeHtml("star yellow"), '" /></a></li></ul></div></div><div id="wiki-edit-dropdown2-other-', soy.$$escapeHtml(opt_data.editorId), '" class="aui-dropdown2 aui-style-default wiki-edit-dropdown"><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a href="#" class="wiki-edit-operation" data-operation="mention">', soy.$$escapeHtml("User mention"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="table">', soy.$$escapeHtml("Table"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="code">', soy.$$escapeHtml("Code"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="noformat">', soy.$$escapeHtml("Preformatted"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="panel">', soy.$$escapeHtml("Panel"), '</a></li><li><a href="#" class="wiki-edit-operation" data-operation="hr">', soy.$$escapeHtml("Horizontal ruler"), '</a></li></ul></div></div><div class="wiki-edit-toolbar" id="wiki-edit-', soy.$$escapeHtml(opt_data.editorId), '"><div class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="aui-buttons"><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-style-picker-trigger" aria-owns="wiki-edit-dropdown2-text-style-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" aria-controls="toolbardemo-dropdown2-more-', soy.$$escapeHtml(opt_data.editorId), '">', soy.$$escapeHtml("Style"), '</a></div><div class="aui-buttons wiki-edit-toolbar-section"><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-operation" data-operation="bold" data-shortcut="ctrl+b, command+b" title="', soy.$$escapeHtml("Bold"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+B)"><span class="aui-icon aui-icon-small aui-iconfont-editor-bold">', soy.$$escapeHtml("Bold"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-operation" data-operation="italic" data-shortcut="ctrl+i, command+i" title="', soy.$$escapeHtml("Italic"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+I)"><span class="aui-icon aui-icon-small aui-iconfont-editor-italic">', soy.$$escapeHtml("Italic"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-operation" data-operation="underline" data-shortcut="ctrl+u, command+u" title="', soy.$$escapeHtml("Underline"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+U)"><span class="aui-icon aui-icon-small aui-iconfont-editor-underline">', soy.$$escapeHtml("Underline"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-operation wiki-edit-operation-color" data-operation="color" data-color="red" title="', soy.$$escapeHtml("Text color"), '"><span class="aui-icon aui-icon-small aui-iconfont-editor-color">', soy.$$escapeHtml("Text color"), '</span><span class="wiki-edit-color-indicator"></span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-color-picker-trigger" data-operation="color-parameter" aria-owns="wiki-edit-color-picker-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" title="', soy.$$escapeHtml("More colors"), '"><span>', soy.$$escapeHtml("More colors"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-more-picker-trigger" aria-owns="wiki-edit-dropdown2-more-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" aria-controls="toolbardemo-dropdown2-more-', soy.$$escapeHtml(opt_data.editorId), '" title="', soy.$$escapeHtml("More"), '"><span class="aui-icon aui-icon-small aui-iconfont-editor-styles">', soy.$$escapeHtml("More"), '</span></a></div><div class="aui-buttons"><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-link-picker-trigger" aria-owns="wiki-edit-dropdown2-link-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" aria-controls="wiki-edit-dropdown2-link-', soy.$$escapeHtml(opt_data.editorId), '" title="', soy.$$escapeHtml("Link"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+K)"><span class="aui-icon aui-icon-small aui-iconfont-link">', soy.$$escapeHtml("Link"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-image-picker-trigger" aria-owns="wiki-edit-dropdown2-image-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" aria-controls="wiki-edit-dropdown2-image-', soy.$$escapeHtml(opt_data.editorId), '" title="', soy.$$escapeHtml("Image"), '"><span class="aui-icon aui-icon-small aui-iconfont-image">', soy.$$escapeHtml("Image"), '</span></a></div><div class="aui-buttons wiki-edit-toolbar-section"><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-operation" data-operation="bullet-list" data-shortcut="ctrl+shift+b, command+shift+b" title="', soy.$$escapeHtml("Bullet list"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+Shift+B)"><span class="aui-icon aui-icon-small aui-iconfont-editor-list-bullet">', soy.$$escapeHtml("Bullet list"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-operation" data-operation="numbered-list" data-shortcut="ctrl+shift+n, command+shift+n" title="', soy.$$escapeHtml("Numbered list"), ' (', soy.$$escapeHtml(opt_data.controlKey), '+Shift+N)"><span class="aui-icon aui-icon-small aui-iconfont-editor-list-number">', soy.$$escapeHtml("Numbered list"), '</span></a></div><div class="aui-buttons"><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-icon-picker-trigger wiki-edit-tooltip" aria-owns="wiki-edit-dropdown2-icon-picker-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" aria-controls="wiki-edit-dropdown2-icon-picker-', soy.$$escapeHtml(opt_data.editorId), '" title="', soy.$$escapeHtml("Icons"), '"><span class="aui-icon aui-icon-small aui-iconfont-editor-emoticon">', soy.$$escapeHtml("Icons"), '</span></a><a href="#" tabindex="-1" class="aui-button aui-button-subtle aui-dropdown2-trigger wiki-edit-other-picker-trigger wiki-edit-tooltip" aria-owns="wiki-edit-dropdown2-other-', soy.$$escapeHtml(opt_data.editorId), '" aria-haspopup="true" aria-controls="wiki-edit-dropdown2-other-', soy.$$escapeHtml(opt_data.editorId), '" title="', soy.$$escapeHtml("Other"), '"><span class="aui-icon aui-icon-small aui-iconfont-add">', soy.$$escapeHtml("Other"), '</span></a></div><div class="aui-buttons wiki-edit-toolbar-last"><a href="#" tabindex="-1" class="aui-button aui-button-subtle wiki-edit-visible-toggle wiki-edit-tooltip" title="', soy.$$escapeHtml("Toggle visibility"), '"><span class="aui-icon icon-toolbartoggle">Lock / Unlock</span></a></div></div></div><!-- .aui-toolbar-inner --></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Plugins.WikiEditor.renderListItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a href="#">', soy.$$escapeHtml(opt_data.text), '</a></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/Analytics.js' */
define("wiki-edit/analytics",["wiki-edit/aui"],function(b){var c=(b.Analytics&&b.Analytics.triggerPrivacyPolicySafeEvent)?(function c(d,e){b.Analytics.triggerPrivacyPolicySafeEvent("jira.wikieditor."+d,e||{})}):(function c(d,e){b.trigger("analytics",{name:"jira.wikieditor."+d,data:e||{}})});function a(e){var d;var g=0;if(!e){return""}for(var f=0;f<e.length;f+=1){d=e.charCodeAt(f);g=((g*32)-g)+d;g|=0}return g}return{trigger:c,hashCode:a}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/KeyTester.js' */
define("wiki-edit/KeyTester",function(){return{getActionType:function(a){if(this.isNavigation(a)){return"navigating"}else{if(this.isDeleting(a)){return"deleting"}else{if(this.isReturn(a)){return"newline"}else{if(this.isEscape(a)){return"escape"}else{if(this.isTyping(a)){return"typing"}}}}}},isNavigation:function(a){return(a>=33&&a<=40)||(a>=63232&&a<=63235)},isDeleting:function(a){return(a==8||a==46||a==127)},isReturn:function(a){return(a==13)},isEscape:function(a){return(a==27)},isTyping:function(a){return(a>47&&a<58)||(a>95&&a<112)||(a>64&&a<91)||(a>185&&a<193)||(a>218&&a<223)||a==32||a==13}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/UndoManager.js' */
define("wiki-edit/UndoManager",function(){var a=function(){this._undoStack=[];this._redoStack=[];this._current=undefined};a.prototype.MAX_STACK=1000;a.prototype.updateCurrent=function(c,b){if(c!=this._current){this._current=c;if(!b){this._redoStack.length=0}}};a.prototype.push=function(b){this._redoStack.length=0;if(!this._undoStack.length||!_.isEqual(b,this._undoStack[this._undoStack.length-1])){this._undoStack.push(b);this._current=b}if(this._undoStack.length>this.MAX_STACK){this._undoStack.splice(0,this._undoStack.length-this.MAX_STACK)}};a.prototype.undo=function(){if(!this.canUndo()){return}var b;do{b=this._undoStack.pop()}while(_.isEqual(b,this._current)&&this.canUndo());this._redoStack.push(this._current);this._current=b;return b};a.prototype.redo=function(){if(!this.canRedo()){return}var b=this._redoStack.pop();this._undoStack.push(this._current);this._current=b;return b};a.prototype.canUndo=function(){return !!this._undoStack.length};a.prototype.canRedo=function(){return !!this._redoStack.length};return a});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/UndoableTextarea.js' */
define("wiki-edit/UndoableTextarea",["jquery","wiki-edit/UndoManager","wiki-edit/KeyTester"],function(e,g,a){var f="";function c(h,i){if(f!=i){if(f!="newline"){h.recordHistoryItem()}f=i}}function d(h,j){if(h.undoManager["can"+j[0].toUpperCase()+j.substring(1)]()){var i=h.undoManager[j]();h.element.value=i.value;h.element.selectionStart=i.selectionStart;h.element.selectionEnd=i.selectionEnd}}var b=function b(i){this.element=i;this.$el=e(i);this.undoManager=new g();this.undoManager.updateCurrent(this.getValue());this.undoManager.push(this.getValue());var j=(function h(l){var k=l.keyCode;var m=String.fromCharCode(k);if(k){if(!l.ctrlKey&&!l.metaKey){this.undoManager.updateCurrent(this.getValue());c(this,a.getActionType(k))}else{if((l.ctrlKey||l.metaKey)&&!l.altKey){switch(m.toLowerCase()){case"y":this.undoManager.updateCurrent(this.getValue(),true);this.redo();l.preventDefault();break;case"z":this.undoManager.updateCurrent(this.getValue(),true);if(!l.shiftKey){this.undo()}else{this.redo()}l.preventDefault();break}}}}else{this.undoManager.updateCurrent(this.getValue());c(this,"other")}}).bind(this);this.$el.on("keydown",j)};b.prototype.getValue=function(){return{value:this.element.value,selectionStart:this.element.selectionStart,selectionEnd:this.element.selectionEnd}};b.prototype.updateCurrent=function(){this.undoManager.updateCurrent(this.getValue())};b.prototype.recordHistoryItem=function(){this.undoManager.push(this.getValue())};b.prototype.undo=function(){c(this,"undo");d(this,"undo");this.element.scrollTop=this.element.scrollHeight};b.prototype.redo=function(){d(this,"redo");this.element.scrollTop=this.element.scrollHeight};return b});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/TextareaManipulator.js' */
define("wiki-edit/TextareaManipulator",function(){var a=function(b){this.el=b};a.prototype.NEW_LINE_TOKEN="\n";a.prototype.getSelection=function(){return{start:this.el.selectionStart,end:this.el.selectionEnd,length:this.el.selectionEnd-this.el.selectionStart,text:this.el.value.substring(this.el.selectionStart,this.el.selectionEnd)}};a.prototype.setSelection=function(c,b){if(arguments.length===1){b=c}this.el.selectionStart=c;this.el.selectionEnd=b};a.prototype.replaceSelectionWith=function(d,c){var e=this.el.selectionStart;var b=this.el.value;this.el.value=b.substring(0,this.el.selectionStart)+d+b.substring(this.el.selectionEnd,b.length);this.el.selectionEnd=e+d.length;this.el.selectionStart=(c)?e:this.el.selectionEnd};a.prototype.wrapSelectionWith=function(e,f,h){if(arguments.length<3){h=""}if(arguments.length===1){f=e}var d=this.getSelection();var g=this.el.value;if(g.substring(d.start-e.length,d.start)===e&&g.substring(d.end,d.end+f.length)===f){return}var c=g.substring(d.start,d.end);if(c.length==0){c=h}this.el.value=g.substring(0,d.start)+e+c+f+g.substring(d.end,g.length);var b=d.start+e.length;this.setSelection(b,b+c.length)};a.prototype._getSelectedLines=function(){var f=this.el.value;var c=this.getSelection();var e=f.substring(0,c.start).split(this.NEW_LINE_TOKEN).length-1;var d=e+f.substring(c.start,c.end).split(this.NEW_LINE_TOKEN).length-1;var b=f.split(this.NEW_LINE_TOKEN);return{lines:b,start:e,end:d}};a.prototype.getLineAtCursor=function(){var b=this._getSelectedLines();return b.lines[b.end]};a.prototype.areSelectedLinesPrefixed=function(c){var b=this._getSelectedLines();var d;for(d=b.start;d<=b.end;d++){if(b.lines[d].indexOf(c)==0){return true}}return false};a.prototype.prefixSelectedLines=function(f){var e=this.getSelection();var b=this._getSelectedLines();var h;var c=0;var g=true;for(h=b.start;h<=b.end;h++){if(b.lines[h].indexOf(f)==0){if(h==b.start){g=false}continue}c+=1;b.lines[h]=f+b.lines[h]}this.el.value=b.lines.join(this.NEW_LINE_TOKEN);var d=f.length*c;this.setSelection(e.start+((g)?f.length:0),e.end+d)};a.prototype.unprefixSelectedLines=function(f){var e=this.getSelection();var b=this._getSelectedLines();var h;var g=false;var c=0;for(h=b.start;h<=b.end;h++){if(b.lines[h].indexOf(f)==0){c+=1;b.lines[h]=b.lines[h].substring(f.length);if(h==b.start){g=true}}}this.el.value=b.lines.join(this.NEW_LINE_TOKEN);var d=f.length*c;this.setSelection(e.start-((g)?f.length:0),e.end-d)};return a});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/keymaster-setup.js' */
define("wiki-edit/keymaster-setup",["jquery","wiki-edit/keymaster"],function(b,a){return{init:function(){a.filter=function(e){var c=e.target||e.srcElement||false;var d;if(c&&(" "+c.className+" ").indexOf(" wiki-textfield ")>-1){d=b(c).data("wikiEditor");if(d){a.setScope(d.id);return true}}return false}}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/WikiEnabledTextarea.js' */
define("wiki-edit/WikiEnabledTextarea",["wiki-edit/TextareaManipulator","wiki-edit/UndoableTextarea","wiki-edit/keymaster","wiki-edit/keymaster-setup","jquery"],function(c,a,f,k,d){k.init();var h=0;var l=function(n){this.el=n;this.$el=d(n);if(this.$el.data("wikiEditor")){return this.$el.data("wikiEditor")}this.id="wikiEdit"+h;h+=1;this.manipulationEngine=new c(this.el);this.undoRedoEl=new a(n);var o=this;f("enter",o.id,function m(q){var p=o.manipulationEngine.getSelection();b.forEach(function(r){if(o.manipulationEngine.areSelectedLinesPrefixed(r)){if(p.length==0&&o.manipulationEngine.getLineAtCursor()===r){o.manipulationEngine.unprefixSelectedLines(r)}else{o.manipulationEngine.replaceSelectionWith("\n"+r)}q.preventDefault()}})});this.$el.data("wikiEditor",this)};var g={bold:["*","*","strong text"],italic:["_","_","emphasized text"],underline:["+","+","underlined text"],"delete":["-","-","deleted text"],superscript:["^","^","superscript text"],subscript:["~","~","subscript text"],monospace:["{{","}}","monospaced text"],cite:["??","??","citation"],"block-quote":["{quote}","{quote}","quoted text"],color:["{color:$1}","{color}","colored text","red"],link:["[","]","link title"+"|http://example.com"],"link-anchor":["[#","]","anchor"],"link-mail":["[mailto:","]","mail@example.com"],image:["!","!","http://example.com/image.png"],mention:["@","","Mention someone by typing their name..."],code:["\n{code:java}\n","\n{code}\n","// Some comments here\npublic String getFoo()\n{\n    return foo;\n}"],noformat:["\n{noformat}\n","\n{noformat}\n","*no* further _formatting_ is done here"],panel:["\n{panel:title="+"My title"+"}\n","\n{panel}\n","Some text with a title"],table:["\n||"+"Heading"+" 1||"+"Heading"+" 2||\n|","|"+"Col"+" A2|\n","Col"+" A1"]};for(var i in g){l.prototype[i]=(function(m,n){var o=0;if(m.length>3){o=m.length-3}return function(){var s=m[0];var t=m[1];var u=m[2];var p;for(p=1;p<=o;p++){s=s.replace("$"+p,arguments[p-1]||m[2+p]);t=t.replace("$"+p,arguments[p-1]||m[2+p])}var r=this.el.value;var q=this.manipulationEngine.getSelection();this.undoRedoEl.recordHistoryItem();if(r.substring(q.start-s.length,q.start)===s&&r.substring(q.end,q.end+t.length)===t){this.el.value=r.substring(0,q.start-s.length)+r.substring(q.start,q.end)+r.substring(q.end+t.length,r.length);this.manipulationEngine.setSelection(q.start-s.length,q.end-s.length)}else{this.manipulationEngine.wrapSelectionWith.call(this.manipulationEngine,s,t,u)}this.undoRedoEl.recordHistoryItem();this.$el.trigger("input")}})(g[i],i)}var e={paragraph:"","bullet-list":"* ","numbered-list":"# ",h1:"h1. ",h2:"h2. ",h3:"h3. ",h4:"h4. ",h5:"h5. ",h6:"h6. ","paragraph-quote":"bq. "};for(var i in e){l.prototype[i]=(function(m){return function(){this.undoRedoEl.recordHistoryItem();for(var n in e){if(this.manipulationEngine.areSelectedLinesPrefixed(e[n])){this.manipulationEngine.unprefixSelectedLines(e[n])}}this.manipulationEngine.prefixSelectedLines.call(this.manipulationEngine,m);this.undoRedoEl.recordHistoryItem();this.$el.trigger("input")}})(e[i])}var b=[e["bullet-list"],e["numbered-list"]];var j={hr:"\n----\n",":)":":)",":(":":(",":P":":P",":D":":D",";)":";)","(y)":"(y)","(n)":"(n)","(i)":"(i)","(/)":"(/)","(x)":"(x)","(!)":"(!)","(+)":"(+)","(-)":"(-)","(?)":"(?)","(on)":"(on)","(off)":"(off)","(*)":"(*)","(*r)":"(*r)","(*g)":"(*g)","(*b)":"(*b)","(*y)":"(*y)","image-attachment":["!$1|thumbnail!","attachment-name.jpg"],"link-attachment":["[^$1]","attachment-name.zip"]};for(var i in j){l.prototype[i]=(function(m){var o=0;var n;if(_.isArray(m)){o=m.length-1;n=m.slice(1);m=m[0]}return function(){var q;var p=m;for(q=1;q<=o;q++){p=m.replace("$"+q,arguments[q-1]||n[q-1])}this.undoRedoEl.recordHistoryItem();this.manipulationEngine.replaceSelectionWith.call(this.manipulationEngine,p,false);this.undoRedoEl.recordHistoryItem();this.$el.trigger("input")}})(j[i])}return l});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources', location = '/js/WikiEditor.js' */
define("wiki-edit/WikiEditor",["wiki-edit/WikiEnabledTextarea","jquery","wiki-edit/JIRA","wiki-edit/keymaster","wiki-edit/analytics"],function(f,e,b,c,a){var d="Ctrl";if(navigator.platform.indexOf("Mac")!=-1){d="⌘"}return{create:function(j){if(typeof j.selectionStart=="undefined"){return}var p=e(j);if(p.data("wikiEditor")){return}a.trigger("initialized");var g=new f(j);var i=e(b.Templates.Plugins.WikiEditor.renderEditor({editorId:g.id,controlKey:d}));var A=i.filter(".wiki-edit-toolbar");p.parent().before(i);var o=p.closest(".jira-dialog").length>0||p.closest("form#issue-create").length>0;var n=p.closest("#create-issue-dialog").length>0;var x=e("#issue-content").length>0;var h=p.closest("#addcomment").length>0;var E=i.find(".wiki-edit-operation[title], .aui-dropdown2-trigger, .wiki-edit-tooltip");var C;if(o){C="Dialog.beforeHide"}else{C=b.Events.BEFORE_INLINE_EDIT_CANCEL}E.each(function(){var K=e(this);var J={aria:true,hideOnClick:true,hoverable:false};if(K.parent().is("li")){J.gravity="w"}K.tooltip(J)});var G=function(){E.each(function(){e(this).tooltip("hide")})};b.bind(C,G);var q=false;var I=i.filter(".aui-dropdown2");I.on({"aui-dropdown2-show":function(){q=true;p.focus()},"aui-dropdown2-hide":function(){q=false;G()}});p.on("keydown",function B(K){if(q&&K.keyCode===AJS.keyCode.ESCAPE){if(o){b.one("Dialog.beforeHide",function(L){L.preventDefault()})}else{if(x&&!h){b.one(b.Events.BEFORE_INLINE_EDIT_CANCEL,function J(L){L.preventDefault()})}}}});var m=i.filter(".wiki-edit-dropdown-image");var l=m.find(".wiki-edit-insert-image");var F=m.find(".wiki-edit-operation[data-operation=image-attachment]");var s=m.find(".wiki-edit-insert-image ul");s.on("click","a",function(J){J.preventDefault();g["image-attachment"](e(this).text());a.trigger("operation.attachment.image")});m.on("aui-dropdown2-show",function(){var J=e();if(!n&&x){J=J.add("#attachment_thumbnails .attachment-title")}if(o){J=J.add(".upload-progress-bar:not(.upload-progress-bar__upload-error) .upload-progress-bar__thumbnail_image + .upload-progress-bar__file-name")}s.empty();l.addClass("hidden");F.removeClass("hidden");if((o||x)&&J.length){F.addClass("hidden");l.removeClass("hidden");J.each(function(){s.append(e(b.Templates.Plugins.WikiEditor.renderListItem({text:e.trim(e(this).text())})))})}});var D=i.filter(".wiki-edit-dropdown-link");var y=D.find(".wiki-edit-insert-link");var k=D.find(".wiki-edit-operation[data-operation=link-attachment]");var H=D.find(".wiki-edit-insert-link ul");H.on("click","a",function(J){J.preventDefault();g["link-attachment"](e(this).text());a.trigger("operation.attachment.link")});D.on("aui-dropdown2-show",function(){var J=e();if(!n&&x){J=J.add("#attachment_thumbnails .attachment-title, #file_attachments .attachment-title a")}if(o){J=J.add(".upload-progress-bar:not(.upload-progress-bar__upload-error) .upload-progress-bar__thumbnail + .upload-progress-bar__file-name")}H.empty();y.addClass("hidden");k.removeClass("hidden");if((o||x)&&J.length){y.removeClass("hidden");k.addClass("hidden");J.each(function(){H.append(e(b.Templates.Plugins.WikiEditor.renderListItem({text:e.trim(e(this).text())})))})}});i.filter(".wiki-edit-dropdown, .wiki-edit-picker").on("mousedown",function(J){J.preventDefault()});i.find(".wiki-edit-operation:not(.wiki-edit-operation-color)").each(function(){var K=e(this);var J=function(L){if(!L){return}L.preventDefault&&L.preventDefault();p.focus();g[K.data("operation")]();a.trigger("operation",{name:K.data("operation"),nameHash:a.hashCode(K.data("operation")),trigger:L.type});a.trigger("operation."+K.data("operation"),{trigger:L.type})};K.click(J);if(K.data("shortcut")){c(K.data("shortcut"),g.id,J)}});i.find(".wiki-edit-operation-color").each(function(){var K=e(this);var J=function(L){if(!L){return}L.preventDefault&&L.preventDefault();p.focus();g[K.data("operation")](K.data("color"));a.trigger("operation",{name:K.data("operation"),nameHash:a.hashCode(K.data("operation")),trigger:L.type});a.trigger("operation."+K.data("operation"),{trigger:L.type})};K.click(J);if(K.data("shortcut")){c(K.data("shortcut"),g.id,J)}});var z=(window.localStorage.getItem("jira.wikieditor.last.color"))?window.localStorage.getItem("jira.wikieditor.last.color"):"red";var u=i.find(".wiki-edit-operation-color");u.data("color",z);var t=A.find(".wiki-edit-color-indicator");t.css("background-color",z);i.filter(".wiki-edit-color-picker").on("click","a",function(K){K.preventDefault();p.focus();var J=e(this).data("color");g.color(J);a.trigger("operation",{name:"color"});a.trigger("operation.color.picked",{color:J});u.data("color",J);t.css("background-color",J);window.localStorage.setItem("jira.wikieditor.last.color",J)});var w=i.find(".wiki-edit-visible-toggle");var v=(localStorage.getItem("jira.wikieditor.visibility"+j.name+"."+j.id)==="true")?true:false;if(v){w.addClass("active");A.addClass("wiki-edit-toolbar-compact")}function r(J){J.preventDefault();J.stopPropagation();v=!v;w.toggleClass("active",v);A.toggleClass("wiki-edit-toolbar-compact",v);localStorage.setItem("jira.wikieditor.visibility"+j.name+"."+j.id,(v)?"true":"false");a.trigger((v)?"hide":"show")}w.on("click",r);A.parent().on("click",".wiki-edit-toolbar-compact",r);e(document).on("showWikiPreview",function(K,J){if(e(J).find(j).length){A.addClass("hidden")}});e(document).on("showWikiInput",function(K,J){if(e(J).find(j).length){A.removeClass("hidden")}})}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources-init', location = '/js/wiki-editor-init.js' */
require(["wiki-edit/WikiEditor","wiki-edit/JIRA","jquery"],function(c,b,d){function a(e){e.find(".wiki-textfield, .wiki-enabled-textfield").each(function(){c.create(this)})}b.bind(b.Events.NEW_CONTENT_ADDED,function(g,f){a(f)});d(function(){a(d(document));if(d("#gh").length>0){b.Dialogs.comment.options.width=810;b.Dialogs.assignIssue.options.width=810;b.Dialogs.attachFile.options.width=810;b.Dialogs.logWork.options.width=810;b.Dialogs.logWork.options.width=810}})});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:resources', location = 'js/status.js' */
;
