;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-jquery-ui', location = 'includes/js/lib/jquery-ui-1.8.16.js' */
var bfjQueryoverride=jQuery.noConflict();
/*!
 * jQuery UI 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(a,d){a.uibonfire=a.uibonfire||{};a.extend(a.uibonfire,{version:"1.8.16",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn._focus||a.fn.focus,focus:function(e,f){return typeof e==="number"?this.each(function(){var g=this;setTimeout(function(){a(g).focus();if(f){f.call(g)}},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){e=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{e=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!e.length?a(document):e},zIndex:function(h){if(h!==d){return this.css("zIndex",h)}if(this.length){var f=a(this[0]),e,g;while(f.length&&f[0]!==document){e=f.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){g=parseInt(f.css("zIndex"),10);if(!isNaN(g)&&g!==0){return g}}f=f.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".uibonfire-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".uibonfire-disableSelection")}});a.each(["Width","Height"],function(g,e){var f=e==="Width"?["Left","Right"]:["Top","Bottom"],h=e.toLowerCase(),k={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};function j(m,l,i,n){a.each(f,function(){l-=parseFloat(a.curCSS(m,"padding"+this,true))||0;if(i){l-=parseFloat(a.curCSS(m,"border"+this+"Width",true))||0}if(n){l-=parseFloat(a.curCSS(m,"margin"+this,true))||0}});return l}a.fn["inner"+e]=function(i){if(i===d){return k["inner"+e].call(this)}return this.each(function(){a(this).css(h,j(this,i)+"px")})};a.fn["outer"+e]=function(i,l){if(typeof i!=="number"){return k["outer"+e].call(this,i)}return this.each(function(){a(this).css(h,j(this,i,true,l)+"px")})}});function c(g,e){var j=g.nodeName.toLowerCase();if("area"===j){var i=g.parentNode,h=i.name,f;if(!g.href||!h||i.nodeName.toLowerCase()!=="map"){return false}f=a("img[usemap=#"+h+"]")[0];return !!f&&b(f)}return(/input|select|textarea|button|object/.test(j)?!g.disabled:"a"==j?g.href||e:e)&&b(g)}function b(e){return !a(e).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.extend(a.expr[":"],{data:function(g,f,e){return !!a.data(g,e[3])},focusable:function(e){return c(e,!isNaN(a.attr(e,"tabindex")))},tabbable:function(g){var e=a.attr(g,"tabindex"),f=isNaN(e);return(f||e>=0)&&c(g,!f)}});a(function(){var e=document.body,f=e.appendChild(f=document.createElement("div"));a.extend(f.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=f.offsetHeight===100;a.support.selectstart="onselectstart" in f;e.removeChild(f).style.display="none"});a.extend(a.uibonfire,{plugin:{add:function(f,g,j){var h=a.uibonfire[f].prototype;for(var e in j){h.plugins[e]=h.plugins[e]||[];h.plugins[e].push([g,j[e]])}},call:function(e,g,f){var j=e.plugins[g];if(!j||!e.element[0].parentNode){return}for(var h=0;h<j.length;h++){if(e.options[j[h][0]]){j[h][1].apply(e.element,f)}}}},contains:function(f,e){return document.compareDocumentPosition?f.compareDocumentPosition(e)&16:f!==e&&f.contains(e)},hasScroll:function(h,f){if(a(h).css("overflow")==="hidden"){return false}var e=(f&&f==="left")?"scrollLeft":"scrollTop",g=false;if(h[e]>0){return true}h[e]=1;g=(h[e]>0);h[e]=0;return g},isOverAxis:function(f,e,g){return(f>e)&&(f<(e+g))},isOver:function(j,f,i,h,e,g){return a.uibonfire.isOverAxis(j,i,e)&&a.uibonfire.isOverAxis(f,h,g)}})})(bfjQueryoverride);
/*!
 * jQuery UI Widget 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,d){if(b.cleanData){var c=b.cleanData;b.cleanData=function(f){for(var g=0,h;(h=f[g])!=null;g++){try{b(h).triggerHandler("remove")}catch(j){}}c(f)}}else{var a=b.fn.remove;b.fn.remove=function(e,f){return this.each(function(){if(!f){if(!e||b.filter(e,[this]).length){b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(g){}})}}return a.call(b(this),e,f)})}}b.widget=function(f,h,e){var g=f.split(".")[0],j;f=f.split(".")[1];j=g+"-"+f;if(!e){e=h;h=b.Widget}b.expr[":"][j]=function(k){return !!b.data(k,f)};b[g]=b[g]||{};b[g][f]=function(k,l){if(arguments.length){this._createWidget(k,l)}};var i=new h();i.options=b.extend(true,{},i.options);b[g][f].prototype=b.extend(true,i,{namespace:g,widgetName:f,widgetEventPrefix:b[g][f].prototype.widgetEventPrefix||f,widgetBaseClass:j},e);b.widget.bridge(f,b[g][f])};b.widget.bridge=function(f,e){b.fn[f]=function(i){var g=typeof i==="string",h=Array.prototype.slice.call(arguments,1),j=this;i=!g&&h.length?b.extend.apply(null,[true,i].concat(h)):i;if(g&&i.charAt(0)==="_"){return j}if(g){this.each(function(){var k=b.data(this,f),l=k&&b.isFunction(k[i])?k[i].apply(k,h):k;if(l!==k&&l!==d){j=l;return false}})}else{this.each(function(){var k=b.data(this,f);if(k){k.option(i||{})._init()}else{b.data(this,f,new e(i,this))}})}return j}};b.Widget=function(e,f){if(arguments.length){this._createWidget(e,f)}};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(f,g){b.data(g,this.widgetName,this);this.element=b(g);this.options=b.extend(true,{},this.options,this._getCreateOptions(),f);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled uibonfire-state-disabled")},widget:function(){return this.element},option:function(f,g){var e=f;if(arguments.length===0){return b.extend({},this.options)}if(typeof f==="string"){if(g===d){return this.options[f]}e={};e[f]=g}this._setOptions(e);return this},_setOptions:function(f){var e=this;b.each(f,function(g,h){e._setOption(g,h)});return this},_setOption:function(e,f){this.options[e]=f;if(e==="disabled"){this.widget()[f?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",f)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(f,g,h){var k=this.options[f];g=b.Event(g);g.type=(f===this.widgetEventPrefix?f:this.widgetEventPrefix+f).toLowerCase();h=h||{};if(g.originalEvent){for(var e=b.event.props.length,j;e;){j=b.event.props[--e];g[j]=g.originalEvent[j]}}this.element.trigger(g,h);return !(b.isFunction(k)&&k.call(this.element[0],g,h)===false||g.isDefaultPrevented())}}})(bfjQueryoverride);(function(a,b){var c=0;a.widget("uibonfire.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var d=this,f=this.element[0].ownerDocument,e;this.element.addClass("uibonfire-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(g){if(d.options.disabled||d.element.propAttr("readOnly")){return}e=false;var h=a.uibonfire.keyCode;switch(g.keyCode){case h.PAGE_UP:d._move("previousPage",g);break;case h.PAGE_DOWN:d._move("nextPage",g);break;case h.UP:d._move("previous",g);g.preventDefault();break;case h.DOWN:d._move("next",g);g.preventDefault();break;case h.ENTER:case h.NUMPAD_ENTER:if(d.menu.active){e=true;g.preventDefault()}case h.TAB:if(!d.menu.active){return}d.menu.select(g);break;case h.ESCAPE:d.element.val(d.term);d.close(g);break;default:clearTimeout(d.searching);d.searching=setTimeout(function(){if(d.term!=d.element.val()){d.selectedItem=null;d.search(null,g)}},d.options.delay);break}}).bind("keypress.autocomplete",function(g){if(e){e=false;g.preventDefault()}}).bind("focus.autocomplete",function(){if(d.options.disabled){return}d.selectedItem=null;d.previous=d.element.val()}).bind("blur.autocomplete",function(g){if(d.options.disabled){return}clearTimeout(d.searching);d.closing=setTimeout(function(){d.close(g);d._change(g)},150)});this._initSource();this.response=function(){return d._response.apply(d,arguments)};this.menu=a("<ul></ul>").addClass("uibonfire-autocomplete").appendTo(a(this.options.appendTo||"body",f)[0]).mousedown(function(g){var h=d.menu.element[0];if(!a(g.target).closest(".uibonfire-menu-item").length){setTimeout(function(){a(document).one("mousedown",function(i){if(i.target!==d.element[0]&&i.target!==h&&!a.uibonfire.contains(h,i.target)){d.close()}})},1)}setTimeout(function(){clearTimeout(d.closing)},13)}).menu({focus:function(h,i){var g=i.item.data("item.autocomplete");if(false!==d._trigger("focus",h,{item:g})){if(/^key/.test(h.originalEvent.type)){d.element.val(g.value)}}},selected:function(i,j){var h=j.item.data("item.autocomplete"),g=d.previous;if(d.element[0]!==f.activeElement){d.element.focus();d.previous=g;setTimeout(function(){d.previous=g;d.selectedItem=h},1)}if(false!==d._trigger("select",i,{item:h})){d.element.val(h.value)}d.term=d.element.val();d.close(i);d.selectedItem=h},blur:function(g,h){if(d.menu.element.is(":visible")&&(d.element.val()!==d.term)){d.element.val(d.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if(a.fn.bgiframe){this.menu.element.bgiframe()}},destroy:function(){this.element.removeClass("uibonfire-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(d,e){a.Widget.prototype._setOption.apply(this,arguments);if(d==="source"){this._initSource()}if(d==="appendTo"){this.menu.element.appendTo(a(e||"body",this.element[0].ownerDocument)[0])}if(d==="disabled"&&e&&this.xhr){this.xhr.abort()}},_initSource:function(){var d=this,f,e;if(a.isArray(this.options.source)){f=this.options.source;this.source=function(h,g){g(a.uibonfire.autocomplete.filter(f,h.term))}}else{if(typeof this.options.source==="string"){e=this.options.source;this.source=function(h,g){if(d.xhr){d.xhr.abort()}d.xhr=a.ajax({url:e,data:h,dataType:"json",autocompleteRequest:++c,contentType:"application/json",success:function(j,i){if(this.autocompleteRequest===c){g(j)}},error:function(){if(this.autocompleteRequest===c){g([])}}})}}else{this.source=this.options.source}}},search:function(e,d){e=e!=null?e:this.element.val();this.term=this.element.val();if(e.length<this.options.minLength){return this.close(d)}clearTimeout(this.closing);if(this._trigger("search",d)===false){return}return this._search(e)},_search:function(d){this.pending++;this.element.addClass("uibonfire-autocomplete-loading");this.source({term:d},this.response)},_response:function(d){if(!this.options.disabled&&d&&d.length){d=this._normalize(d);this._suggest(d);this._trigger("open")}else{this.close()}this.pending--;if(!this.pending){this.element.removeClass("uibonfire-autocomplete-loading")}},close:function(d){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",d)}},_change:function(d){if(this.previous!==this.element.val()){this._trigger("change",d,{item:this.selectedItem})}},_normalize:function(d){if(d.length&&d[0].label&&d[0].value){return d}return a.map(d,function(e){if(typeof e==="string"){return{label:e,value:e}}return a.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(d){var e=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(e,d);this.menu.deactivate();this.menu.refresh();e.show();e.width(this.element.outerWidth());e.position(a.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new a.Event("mouseover"))}},_resizeMenu:function(){var d=this.menu.element;d.outerWidth(Math.max(d.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(f,e){var d=this;a.each(e,function(g,h){d._renderItem(f,h)})},_renderItem:function(d,e){return a("<li></li>").data("item.autocomplete",e).append(a("<a></a>").text(e.label)).appendTo(d)},_move:function(e,d){if(!this.menu.element.is(":visible")){this.search(null,d);return}if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)){this.element.val(this.term);this.menu.deactivate();return}this.menu[e](d)},widget:function(){return this.menu.element}})}(bfjQueryoverride));(function(f,g){f.uibonfire=f.uibonfire||{};var d=/left|center|right/,e=/top|center|bottom/,a="center",b=f.fn.position,c=f.fn.offset;f.fn.position=function(i){if(!i||!i.of){return b.apply(this,arguments)}i=f.extend({},i);var m=f(i.of),l=m[0],o=(i.collision||"flip").split(" "),n=i.offset?i.offset.split(" "):[0,0],k,h,j;if(l.nodeType===9){k=m.width();h=m.height();j={top:0,left:0}}else{if(l.setTimeout){k=m.width();h=m.height();j={top:m.scrollTop(),left:m.scrollLeft()}}else{if(l.preventDefault){i.at="left top";k=h=0;j={top:i.of.pageY,left:i.of.pageX}}else{k=m.outerWidth();h=m.outerHeight();j=m.offset()}}}f.each(["my","at"],function(){var p=(i[this]||"").split(" ");if(p.length===1){p=d.test(p[0])?p.concat([a]):e.test(p[0])?[a].concat(p):[a,a]}p[0]=d.test(p[0])?p[0]:a;p[1]=e.test(p[1])?p[1]:a;i[this]=p});if(o.length===1){o[1]=o[0]}n[0]=parseInt(n[0],10)||0;if(n.length===1){n[1]=n[0]}n[1]=parseInt(n[1],10)||0;if(i.at[0]==="right"){j.left+=k}else{if(i.at[0]===a){j.left+=k/2}}if(i.at[1]==="bottom"){j.top+=h}else{if(i.at[1]===a){j.top+=h/2}}j.left+=n[0];j.top+=n[1];return this.each(function(){var s=f(this),u=s.outerWidth(),r=s.outerHeight(),t=parseInt(f.curCSS(this,"marginLeft",true))||0,q=parseInt(f.curCSS(this,"marginTop",true))||0,w=u+t+(parseInt(f.curCSS(this,"marginRight",true))||0),x=r+q+(parseInt(f.curCSS(this,"marginBottom",true))||0),v=f.extend({},j),p;if(i.my[0]==="right"){v.left-=u}else{if(i.my[0]===a){v.left-=u/2}}if(i.my[1]==="bottom"){v.top-=r}else{if(i.my[1]===a){v.top-=r/2}}v.left=Math.round(v.left);v.top=Math.round(v.top);p={left:v.left-t,top:v.top-q};f.each(["left","top"],function(z,y){if(f.uibonfire.position[o[z]]){f.uibonfire.position[o[z]][y](v,{targetWidth:k,targetHeight:h,elemWidth:u,elemHeight:r,collisionPosition:p,collisionWidth:w,collisionHeight:x,offset:n,my:i.my,at:i.at})}});if(f.fn.bgiframe){s.bgiframe()}s.offset(f.extend(v,{using:i.using}))})};f.uibonfire.position={fit:{left:function(h,i){var k=f(window),j=i.collisionPosition.left+i.collisionWidth-k.width()-k.scrollLeft();h.left=j>0?h.left-j:Math.max(h.left-i.collisionPosition.left,h.left)},top:function(h,i){var k=f(window),j=i.collisionPosition.top+i.collisionHeight-k.height()-k.scrollTop();h.top=j>0?h.top-j:Math.max(h.top-i.collisionPosition.top,h.top)}},flip:{left:function(i,k){if(k.at[0]===a){return}var m=f(window),l=k.collisionPosition.left+k.collisionWidth-m.width()-m.scrollLeft(),h=k.my[0]==="left"?-k.elemWidth:k.my[0]==="right"?k.elemWidth:0,j=k.at[0]==="left"?k.targetWidth:-k.targetWidth,n=-2*k.offset[0];i.left+=k.collisionPosition.left<0?h+j+n:l>0?h+j+n:0},top:function(i,k){if(k.at[1]===a){return}var m=f(window),l=k.collisionPosition.top+k.collisionHeight-m.height()-m.scrollTop(),h=k.my[1]==="top"?-k.elemHeight:k.my[1]==="bottom"?k.elemHeight:0,j=k.at[1]==="top"?k.targetHeight:-k.targetHeight,n=-2*k.offset[1];i.top+=k.collisionPosition.top<0?h+j+n:l>0?h+j+n:0}}};if(!f.offset.setOffset){f.offset.setOffset=function(l,i){if(/static/.test(f.curCSS(l,"position"))){l.style.position="relative"}var k=f(l),n=k.offset(),h=parseInt(f.curCSS(l,"top",true),10)||0,m=parseInt(f.curCSS(l,"left",true),10)||0,j={top:(i.top-n.top)+h,left:(i.left-n.left)+m};if("using" in i){i.using.call(l,j)}else{k.css(j)}};f.fn.offset=function(h){var i=this[0];if(!i||!i.ownerDocument){return null}if(h){return this.each(function(){f.offset.setOffset(this,h)})}return c.call(this)}}}(bfjQueryoverride));(function(a){a.widget("uibonfire.menu",{_create:function(){var b=this;this.element.addClass("uibonfire-menu uibonfire-widget uibonfire-widget-content uibonfire-corner-all").attr({role:"listbox","aria-activedescendant":"uibonfire-active-menuitem"}).click(function(c){if(!a(c.target).closest(".uibonfire-menu-item a").length){return}c.preventDefault();b.select(c)});this.refresh()},refresh:function(){var c=this;var b=this.element.children("li:not(.uibonfire-menu-item):has(a)").addClass("uibonfire-menu-item").attr("role","menuitem");b.children("a").addClass("uibonfire-corner-all").attr("tabindex",-1).mouseenter(function(d){c.activate(d,a(this).parent())}).mouseleave(function(){c.deactivate()})},activate:function(e,d){this.deactivate();if(this.hasScroll()){var f=d.offset().top-this.element.offset().top,b=this.element.scrollTop(),c=this.element.height();if(f<0){this.element.scrollTop(b+f)}else{if(f>=c){this.element.scrollTop(b+f-c+d.height())}}}this.active=d.eq(0).children("a").addClass("uibonfire-state-hover").attr("id","uibonfire-active-menuitem").end();this._trigger("focus",e,{item:d})},deactivate:function(){if(!this.active){return}this.active.children("a").removeClass("uibonfire-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(b){this.move("next",".uibonfire-menu-item:first",b)},previous:function(b){this.move("prev",".uibonfire-menu-item:last",b)},first:function(){return this.active&&!this.active.prevAll(".uibonfire-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".uibonfire-menu-item").length},move:function(e,d,c){if(!this.active){this.activate(c,this.element.children(d));return}var b=this.active[e+"All"](".uibonfire-menu-item").eq(0);if(b.length){this.activate(c,b)}else{this.activate(c,this.element.children(d))}},nextPage:function(d){if(this.hasScroll()){if(!this.active||this.last()){this.activate(d,this.element.children(".uibonfire-menu-item:first"));return}var e=this.active.offset().top,c=this.element.height(),b=this.element.children(".uibonfire-menu-item").filter(function(){var f=a(this).offset().top-e-c+a(this).height();return f<10&&f>-10});if(!b.length){b=this.element.children(".uibonfire-menu-item:last")}this.activate(d,b)}else{this.activate(d,this.element.children(".uibonfire-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(c){if(this.hasScroll()){if(!this.active||this.first()){this.activate(c,this.element.children(".uibonfire-menu-item:last"));return}var d=this.active.offset().top,b=this.element.height();result=this.element.children(".uibonfire-menu-item").filter(function(){var e=a(this).offset().top-d+b-a(this).height();return e<10&&e>-10});if(!result.length){result=this.element.children(".uibonfire-menu-item:first")}this.activate(c,result)}else{this.activate(c,this.element.children(".uibonfire-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(b){this._trigger("selected",b,{item:this.active})}})}(bfjQueryoverride));;
;/* module-key = 'com.atlassian.bonfire.plugin:complete-session-resource', location = 'includes/js/sessions/complete-session.js' */
if(typeof BF=="undefined"){var BF={}}AJS.$(function(){BF.bindCompleteSessionCommon=function(a,b){if(b&&b.$form){b.$form.find("input[type=text]").keypress(function(c){if(c.keyCode==13||c.keyCode==10){jQuery("#bonfire-complete-button").click()}})}};BF.bindCompleteSubmit=function(m,h,f){m.preventDefault();var g=h.closest("form");var l=g.find("[name=testSessionId]").val();var c=contextPath+"/rest/bonfire/1.0/sessions/"+l+"/complete";var n=g.find("#bf-time-spent").val();var a=g.find("#bf-log-time-issue");var q="";if(a.length!==0){q=a.val()}var o=g.find(".bfcom-select");var b=[];for(var k=0,p=o.length;k<p;k++){var d=jQuery(o[k]).data("raised-id");var r=o[k].value;b.push({raisedId:d,relatedId:r})}var j={timeSpent:n,logTimeIssueId:q,issueLinks:b};jQuery("#error-complete-session").empty();h[0].disabled=true;JIRA.SmartAjax.makeRequest({url:c,type:"POST",dataType:"json",data:BF.utils.bonJSONStringify(j),contentType:"application/json",complete:function(s,t,i){if(i.successful){g.find(".cancel").click();f()}else{h[0].disabled=false;var e=JSON.parse(i.data).errors;for(error in e){jQuery("#error-complete-session").append("<span>"+e[error].errorMessage+"</span><br/>")}}}})}});;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-common-resources', location = 'includes/js/utils/utils.js' */
if(typeof BF=="undefined"){var BF={}}if(typeof BF.utils=="undefined"){BF.utils={}}BF.utils.bonJSONStringify=function(b){var a=JSON.stringify(b);if(a&&typeof(a)==="string"){if(/\?\?/.test(a)){var c="\\u003F";a=a.replace(/\?\?/g,c+c)}}return a};BF.utils.bonGetProp=function(a,b){if(!!a.prop){return a.prop(b)}else{return a.attr(b)}};BF.utils.bonSetProp=function(a,c,b){if(!!a.prop){a.prop(c,b)}else{a.attr(c,b)}};;
;/* module-key = 'com.atlassian.bonfire.plugin:quick-session-dialog-resources', location = 'includes/js/quicksession/quick-session.js' */
if(typeof BF=="undefined"){var BF={}}AJS.$(function(){var o=150;var g=0;var d=jQuery(window);var h={width:430,hideDelay:null,getArrowPath:function(p){return"M0,0L11,8,0,16"},calculatePositions:function(p,r,u,q){var t=r.target.offset();var s=d.scrollTop();return{displayAbove:false,popupCss:{position:"fixed",top:t.top-o-s,left:t.left-p.width()-11,right:"auto"},arrowCss:{position:"absolute",left:p.width()-1,right:"auto",top:o}}}};BF.quickSessionCreate=function(r,q){q=q+g;var p=function(w){var v=d.scrollTop();var t=jQuery("#inline-dialog-"+q);var s=r.offset();var x=s.top-o-v;var u=s.left-t.width()-11;t.css({top:x,left:u})};jQuery.extend(h,{initCallback:function(){d.bind("scroll resize",p)},hideCallback:function(){d.unbind("scroll resize",p)},});new AJS.InlineDialog(r,q,function(u,t,w){var v=jQuery(t).attr("data-session-id");var s=contextPath+"/rest/bonfire/1.0/quick-session/"+v;JIRA.SmartAjax.makeRequest({url:s,type:"GET",dataType:"json",contentType:"application/json",complete:function(A,B,y){var x=jQuery(u);x.empty();if(y.successful){var z={session:y.data,contextPath:contextPath};jQuery(BF.template.quicksession(z)).appendTo(u);f(u)}else{jQuery(BF.template.quicksessionError()).appendTo(u)}w()}})},h);jQuery(document).bind("showLayer",function(u,s,t){if(s&&s==="inlineDialog"&&t&&t.id&&t.id===q){t._validateClickToClose=function(v){if(jQuery(v.target).parents("#inline-dialog-"+t.id).length>0){return false}return true};jQuery("body").unbind("click."+t.id+".inline-dialog-check")}});g++};var f=function(r){var q=document.createElement("input");if(!("placeholder" in q)){var p=r.find(".bfq-placeholder");p.each(function(){var t=jQuery(this),s=jQuery("<label/>",{"class":"bfq-placeholder-label","for":this.id,text:t.attr("placeholder"),css:{fontFamily:t.css("fontFamily"),fontSize:t.css("fontSize")}}).insertBefore(t);t.focus(function(){s.hide()}).bind("blur change",function(){s.toggle(!jQuery(this).val().length)})})}q=null};var e=function(p){jQuery(".bfq-button").addClass("bfq-not-selected");jQuery(p).removeClass("bfq-not-selected")};var i=function(p){p.animate({scrollTop:p.scrollTop()+p.height()},500)};var m=function(p){p.find(".bfq-addinfo-edit").addClass("hidden");p.find(".bfq-addinfo-wiki").removeClass("hidden");p.find(".bfq-error").empty();p.find(".bfq-info-textarea").unbind("blur",b)};var l=function(r){var q=r.find(".bfq-note-display-container");var p=r.find(".bfq-note-edit");q.removeClass("hidden");p.addClass("hidden");r.find(".bfq-edit-error").empty();r.find(".bfq-note-textarea").unbind("blur",c);jQuery(".bfq-edit-note").live("click",n)};var n=function(t){t.preventDefault();var u=jQuery(this).closest(".bfq-note-container");var s=u.find(".bfq-note-display-container");var p=u.find(".bfq-note-edit");var r=u.find(".bfq-original-note").val();var q=u.find(".bfq-note-textarea");q.val(r);s.addClass("hidden");p.removeClass("hidden");q.focus();q.bind("blur",c);jQuery(".bfq-edit-note").die("click",n)};var j=function(q){var r=jQuery(this).closest(".bfq-additionalInfo");var p=r.data("blurTimeout");if(typeof p!="undefined"){clearTimeout(p);r.find(".bfq-info-textarea").focus()}};var k=function(q){var r=jQuery(this).closest(".bfq-note-container");var p=r.data("blurTimeout");if(typeof p!="undefined"){clearTimeout(p);r.find(".bfq-note-textarea").focus()}};var c=function(q){var r=jQuery(this).closest(".bfq-note-container");var p=setTimeout(function(){r.find(".bfq-note-edit-actions .bfq-submit").click()},100);r.data("blurTimeout",p)};var b=function(q){var r=jQuery(this).closest(".bfq-additionalInfo");var p=setTimeout(function(){r.find(".bfq-add-info-actions .bfq-submit").click()},100);r.data("blurTimeout",p)};var a=function(r,s){var q=JSON.parse(r.data).errors;for(error in q){var p=q[error].errorMessage;if(typeof p!=="undefined"){s.append("<span>"+p+"</span><br/>")}}};jQuery(".bfq-addinfo-tab").live("click",function(p){jQuery(".bfq-swappable-content").addClass("hidden");jQuery(".bfq-additionalInfo").removeClass("hidden");e(this)});jQuery(".bfq-notes-tab").live("click",function(p){jQuery(".bfq-swappable-content").addClass("hidden");jQuery(".bfq-notes").removeClass("hidden");e(this)});jQuery(".bfq-addinfo-wiki.bfq-editable").live("click",function(t){var p=jQuery(this);var u=p.closest(".bfq-additionalInfo");p.addClass("hidden");var q=u.find(".bfq-addinfo-edit");q.removeClass("hidden");var s=u.find(".bfq-original-addinfo").val();var r=q.find(".bfq-info-textarea");r.val(s);r.focus();u.find(".bfq-info-textarea").bind("blur",b)});jQuery(".bfq-add-info-actions .bfq-cancel").live("click",function(p){p.preventDefault();var q=jQuery(this).closest(".bfq-additionalInfo");m(q)});jQuery(".bfq-add-info-container").live("keydown",function(p){if(p.keyCode==27){p.preventDefault();var q=jQuery(this).closest(".bfq-additionalInfo");m(q)}if(p.ctrlKey&&(p.keyCode==13||p.keyCode==10)){p.preventDefault();var q=jQuery(this).closest(".bfq-additionalInfo");q.find(".bfq-add-info-actions .bfq-submit").click()}});jQuery(".bfq-add-info-actions").live("click",j);jQuery(".bfq-add-info-container").live("click",j);jQuery(".bfq-add-info-actions .bfq-submit").live("click",function(w){var x=jQuery(this).closest(".bfq-additionalInfo");var v=x.find(".bfq-original-addinfo");var q=x.find(".bfq-addinfo-wiki");var s=x.find(".bfq-error");var r=x.find(".bfq-waiting-icon");var u=x.find(".bfq-session-id").val();var p=contextPath+"/rest/bonfire/1.0/sessions/"+u+"/additionalInfo";var y=x.find(".bfq-info-textarea").val();var t={additionalInfo:y};s.empty();r.removeClass("hidden");JIRA.SmartAjax.makeRequest({url:p,type:"POST",dataType:"json",data:BF.utils.bonJSONStringify(t),contentType:"application/json",complete:function(A,B,z){r.addClass("hidden");if(z.successful){if(z.data.isEmpty){q.html(BF.template.getNoAddInfoMsg())}else{q.html(z.data.additionalInfoDisplay)}v.text(z.data.additionalInfoRaw);m(x)}else{a(z,s)}}})});jQuery(".bfq-add-note-textarea").live("focus",function(){var p=jQuery(this).closest(".bfq-notes");p.find(".bfq-note-button").removeClass("hidden");i(p)});jQuery(".bfq-add-note-textarea").live("keydown",function(p){if(p.ctrlKey&&(p.keyCode==13||p.keyCode==10)){p.preventDefault();var q=jQuery(this).closest(".bfq-notes");q.find(".bfq-note-button").click()}});jQuery(".bfq-note-button").live("click",function(){var u=jQuery(this).closest(".bfq-notes");var t=u.find(".bfq-session-id").val();var w=u.find(".bfq-add-note-textarea");var q=w.val();var v=u.find(".bfq-error.bfq-addnote-error");var r=u.find(".bfq-allnotes");var p=contextPath+"/rest/bonfire/1.0/sessions/"+t+"/note";var s={note:q};v.empty();JIRA.SmartAjax.makeRequest({url:p,type:"POST",dataType:"json",data:BF.utils.bonJSONStringify(s),contentType:"application/json",complete:function(y,z,x){if(x.successful){w.val("");r.find("em").remove();r.append(BF.template.drawnote({note:x.data}))}else{a(x,v)}i(u)}})});jQuery(".bfq-delete-note").live("click",function(t){t.preventDefault();if(confirm("Are you sure you want to delete this session note?")){var u=jQuery(this).closest(".bfq-note-container");var s=u.closest(".bfq-allnotes");var r=u.find(".bfq-note-id").val();var p=u.find(".bfq-error");var q=contextPath+"/rest/bonfire/1.0/notes/"+r;p.empty();JIRA.SmartAjax.makeRequest({url:q,type:"DELETE",dataType:"json",contentType:"application/json",complete:function(x,y,w){if(w.successful){u.remove();var v=s.find(".bfq-note-container").size();if(!v){s.html(BF.template.getNoNoteMsg())}}else{a(w,p)}}})}});jQuery(".bfq-note-data").live("click",function(p){var q=jQuery(this).closest(".bfq-note-container");q.find(".bfq-edit-note").click()});jQuery(".bfq-edit-note").live("click",n);jQuery(".bfq-note-edit-actions").live("click",k);jQuery(".bfq-note-edit-container").live("click",k);jQuery(".bfq-note-edit-actions .bfq-cancel").live("click",function(p){var q=jQuery(this).closest(".bfq-note-container");l(q)});jQuery(".bfq-note-edit-container").live("keydown",function(p){if(p.keyCode==27){p.preventDefault();var q=jQuery(this).closest(".bfq-note-container");l(q)}if(p.ctrlKey&&(p.keyCode==13||p.keyCode==10)){p.preventDefault();var q=jQuery(this).closest(".bfq-note-container");q.find(".bfq-note-edit-actions .bfq-submit").click()}});jQuery(".bfq-note-edit-actions .bfq-submit").live("click",function(t){var w=jQuery(this).closest(".bfq-note-container");var p=w.find(".bfq-note-id").val();var q=contextPath+"/rest/bonfire/1.0/notes/"+p;var u=w.find(".bfq-edit-error");var x=w.find(".bfq-note-textarea").val();var y=w.find(".bfq-note-data");var v=w.find(".bfq-original-note");var r=w.find(".bfq-waiting-icon");var s={noteData:x};u.empty();r.removeClass("hidden");JIRA.SmartAjax.makeRequest({url:q,type:"PUT",dataType:"json",data:BF.utils.bonJSONStringify(s),contentType:"application/json",complete:function(A,B,z){r.addClass("hidden");if(z.successful){y.html(z.data.noteData);v.text(z.data.rawNoteData);l(w)}else{a(z,u)}}})})});;
;/* module-key = 'com.atlassian.bonfire.plugin:quick-session-dialog-resources', location = 'includes/soy/quicksession/quick-session.soy' */
// This file was automatically generated from quick-session.soy.
// Please don't edit this file by hand.

if (typeof BF == 'undefined') { var BF = {}; }
if (typeof BF.template == 'undefined') { BF.template = {}; }


BF.template.quicksession = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="bfq-main-container"><div class="bfq-header"><div class="bfq-name-container"><a href="', soy.$$escapeHtml(opt_data.contextPath), '/secure/ViewSession.jspa?testSessionId=', soy.$$escapeHtml(opt_data.session.id), '" class="bfq-session-name" title="', soy.$$escapeHtml(opt_data.session.name), '">', soy.$$escapeHtml(opt_data.session.name), '</a></div><div class="bfq-button-container"><span class="bfq-button bfq-first bfq-addinfo-tab">', soy.$$escapeHtml("Additional Information"), '</span><span class="bfq-button bfq-last bfq-not-selected bfq-notes-tab">', soy.$$escapeHtml("Notes"), '</span></div></div><div class="bfq-main-content"><div class="bfq-swappable-content bfq-additionalInfo"><div class="bfq-addinfo-wiki ', (opt_data.session.canEditSession) ? 'bfq-editable' : '', '" ', (opt_data.session.canEditSession) ? 'title="' + soy.$$escapeHtml("Click to edit") + '"' : '', '>', (opt_data.session.hasAdditionalInfo) ? opt_data.session.additionalInfo : (opt_data.session.canEditSession) ? '<em>' + soy.$$escapeHtml("Click here to add Additional Information") + '</em>' : soy.$$escapeHtml("There is no Additional Information for this session."), '</div>');
  if (opt_data.session.canEditSession) {
    output.append('<input class="bfq-session-id" type="hidden" value="', soy.$$escapeHtml(opt_data.session.id), '"/><textarea class="bfq-original-addinfo hidden">', soy.$$escapeHtml(opt_data.session.rawAdditionalInfo), '</textarea><div class="bfq-addinfo-edit hidden"><div class="bfq-error"></div><div class="bfq-add-info-container"><textarea class="bfq-info-textarea"></textarea></div><div class="bfq-inline-button-container bfq-add-info-actions">');
    BF.template.drawInlineEditButtons(null, output);
    output.append('</div></div>');
  }
  output.append('</div><div class="bfq-swappable-content bfq-notes hidden"><input class="bfq-session-id" type="hidden" value="', soy.$$escapeHtml(opt_data.session.id), '"/><div class="bfq-allnotes bfq-table">');
  if (opt_data.session.hasNotes) {
    var noteList53 = opt_data.session.notes;
    var noteListLen53 = noteList53.length;
    for (var noteIndex53 = 0; noteIndex53 < noteListLen53; noteIndex53++) {
      var noteData53 = noteList53[noteIndex53];
      BF.template.drawnote({note: noteData53}, output);
    }
  } else {
    output.append('<em>', soy.$$escapeHtml("There are no notes for this session yet."), '</em>');
  }
  output.append('</div>', (opt_data.session.canAddNote) ? '<div class="bfq-add-note-container"><textarea class="bfq-add-note-textarea bfq-placeholder" placeHolder="Add Note"></textarea></div><div class="bfq-error bfq-addnote-error"></div><div class="bfq-add-note-actions"><span class="bfq-note-button hidden">Add Note</span></div>' : '', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};


BF.template.drawnote = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="bfq-note-container"><input class="bfq-note-id" type="hidden" value="', soy.$$escapeHtml(opt_data.note.id), '"/><div class="bfq-note-left"><img src="', soy.$$escapeHtml(opt_data.note.userIconUrl), '" title="Author: ', soy.$$escapeHtml(opt_data.note.authorDisplayName), '" width="32px" height="32px"/></div><div class="bfq-note-right"><div class="bfq-note-display-container"><div class="bfq-note-data ', (opt_data.note.canEdit) ? 'bfq-editable' : '', '" ', (opt_data.note.canEdit) ? 'title="' + soy.$$escapeHtml("Click to edit") + '"' : '', '>', opt_data.note.noteData, '</div><div class="bfq-error"></div><div class="bfq-note-ops"><span class="bfq-timestamp">', soy.$$escapeHtml(opt_data.note.createdDate), ' ', soy.$$escapeHtml(opt_data.note.createdTime), '</span>', (opt_data.note.canEdit) ? '<a href="#" class="bfq-note-op bfq-edit-note" title="' + soy.$$escapeHtml("Click to edit") + '">edit</a><a href="#" class="bfq-note-op bfq-delete-note" title="' + soy.$$escapeHtml("Click to delete") + '">delete</a>' : '', '</div></div>');
  if (opt_data.note.canEdit) {
    output.append('<textarea class="bfq-original-note hidden">', soy.$$escapeHtml(opt_data.note.rawNoteData), '</textarea><div class="bfq-note-edit hidden"><div class="bfq-edit-error"></div><div class="bfq-note-edit-container"><textarea class="bfq-note-textarea"></textarea></div><div class="bfq-inline-button-container bfq-note-edit-actions">');
    BF.template.drawInlineEditButtons(null, output);
    output.append('</div></div>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


BF.template.getNoAddInfoMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<em>', soy.$$escapeHtml("Click here to add Additional Information"), '</em>');
  return opt_sb ? '' : output.toString();
};


BF.template.getNoNoteMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<em>', soy.$$escapeHtml("There are no notes for this session yet."), '</em>');
  return opt_sb ? '' : output.toString();
};


BF.template.drawInlineEditButtons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bfq-waiting-icon hidden"></span><button class="bfq-inline-edit-buttons bfq-submit" type="submit"><span class="bfq-inline-edit-button-icons bfq-tick-icon"></span></button><button class="bfq-inline-edit-buttons bfq-cancel" type="cancel" class="cancel" href="#"><span class="bfq-inline-edit-button-icons bfq-cross-icon"></span></button>');
  return opt_sb ? '' : output.toString();
};


BF.template.quicksessionError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="bfq-main-container bfq-error-main"><div class="bfq-error-container"><div class="aui-message error shadowed"><span class="aui-icon icon-error"></span><p>', soy.$$escapeHtml("Session was not found. The session or the project it belonged to may have been deleted. Please check that the session still exists on the server. "), '</p></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-test-session-dialog-assets', location = 'includes/js/sessions/test-session-dialog.js' */
AJS.$(function(){if(!AJS.FormPopup){AJS.FormPopup=JIRA.FormDialog}var d=function(){AJS.reloadViaWindowLocation(window.location.href)};var g={data:{inline:true,decorator:"dialog"}};var i=function(m,l){var j={preMsg:m.getResponseHeader("X-Atlassian-Dialog-Msg-Html-Pre"),postMsg:m.getResponseHeader("X-Atlassian-Dialog-Msg-Html-Post")};if(j.preMsg){j.msg=j.preMsg+l+j.postMsg;var k=m.getResponseHeader("X-Atlassian-Dialog-Msg-Type");j.type=k?k.toUpperCase():k;j.closeable=(m.getResponseHeader("X-Atlassian-Dialog-Msg-Closeable")==="true");j.target=m.getResponseHeader("X-Atlassian-Dialog-Msg-Target");return j}};var e=function(){if(JIRA.SessionStorage){var m="jira.messages.reloadMessageMsg",j="jira.messages.reloadMessageType",l="jira.messages.reloadMessageCloseable",k="jira.messages.reloadMessageTarget";JIRA.SessionStorage.removeItem(m);JIRA.SessionStorage.removeItem(j);JIRA.SessionStorage.removeItem(l);JIRA.SessionStorage.removeItem(k)}};var b=function(m,n,o,k){if(this.options.bonfireStayOnPage){var l=AJS.escapeHtml(jQuery(this.$form).find("#ex-session-name").val());var j=i(n,l);if(j){if(JIRA.Messages===undefined){Bonfire.Messages.showMsg(j)}else{JIRA.Messages.showMsg(j.msg,{type:JIRA.Messages.Types[j.type],closeable:j.closeable,target:j.target});e()}}}};var h=function(k,l,m,j){if(this.options.bonfireStayOnPage){return}d()};new AJS.FormPopup({trigger:"#create-test-session.no-refresh",id:"capture-create-test-session",autoClose:true,bonfireStayOnPage:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:".bf-create-session.no-refresh",id:"capture-create-test-session",autoClose:true,bonfireStayOnPage:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#create-test-session:not(.no-refresh)",id:"capture-create-test-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:".issueaction-create-test-session",id:"capture-create-test-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#clone-test-session",autoClose:true,bonfireStayOnPage:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#assign-test-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#edit-test-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#delete-test-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#pause-test-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#unshare-test-session-confirm",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:"#add-raised-to-session",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:".bf-add-raised-issues-link",autoClose:true,onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});new AJS.FormPopup({trigger:'a[title="Create Test Session"][class="aui-list-item-link"]',onSuccessfulSubmit:b,onDialogFinished:h,ajaxOptions:g});jQuery(document).bind("dialogContentReady",function(k,l){var j=bfjQueryoverride("#ex-assignee");j.autocomplete({source:function(n,m){jQuery.getJSON(contextPath+"/rest/bonfire/latest/userSearch",n,function(o){m(o.searchResult)})},minLength:1});AJS.$(document.body).find(".bonfire-issuepicker").each(function(){var n=AJS.$(this);var m=274;new JIRA.IssuePicker({element:n,width:m,uppercaseUserEnteredOnSelect:true});AJS.$("#"+n.attr("id")+"-textarea").attr("tabindex",n.attr("tabindex"))});BF.bindCompleteSessionCommon(k,l);jQuery("#bonfire-complete-button").bind("click",function(n){var m=jQuery(this);BF.bindCompleteSubmit(n,m,d)})});jQuery(".bf-twixy").live("click",function(k){var j=jQuery(this);j.toggleClass("bf-twix-open")});var f=function(k,j){JIRA.SmartAjax.makeRequest({url:k,type:j,dataType:"json",contentType:"application/json",complete:function(m,n,l){d()}})};jQuery(".bf-delete-raised-in").live("click",function(k){k.preventDefault();if(confirm("Are you sure you want to remove this issue from this Test Session's list of raised issues?")){var j=this.href;f(j,"DELETE")}});jQuery(".gf-post-trigger").live("click",function(k){k.preventDefault();var j=this.href;f(j,"POST")});jQuery(".gf-delete-trigger").live("click",function(k){k.preventDefault();var j=this.href;f(j,"DELETE")});new AJS.FormPopup({trigger:".gf-dialog-link-trigger",autoClose:true,onDialogFinished:h,ajaxOptions:g});var c=AJS.FormPopup.extend({_submitForm:function(j){j.preventDefault()}});new c({trigger:"#gf-complete-dialog",id:"capture-complete-test-session",autoClose:true,onSuccessfulSubmit:h,onUnSuccessfulSubmit:h,onDialogFinished:h,ajaxOptions:g,width:"100%"});var a=function(){jQuery.each(jQuery(".bf-view-session-button"),function(){var k="bf-dialog";var l=jQuery(this);BF.quickSessionCreate(l,k)});try{AJS.Dropdown.create({trigger:jQuery(".bf-more-button .bf-more-trigger"),content:jQuery(".bf-more-button .aui-list"),alignment:AJS.RIGHT})}catch(j){}};a();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(l,j,k){a()})});;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-test-session-dialog-assets', location = 'includes/js/msg/bonfire-client-msg.js' */
jQuery.namespace("Bonfire.Messages");Bonfire.Messages.showMsg=function(b){var d=function(i){var f=jQuery("body").width();var g=jQuery("#header");var h=g.offset().top+g.outerHeight()+10;i.width("auto");i.css({width:"auto",left:(f-i.width())/2,top:h,margin:0,padding:"1em"})};var a=jQuery(b.target||"#session-top-bar");var e=jQuery("<div>");e.addClass("bonfire-msg aui-message "+b.type.toLowerCase());e.html(b.msg);e.prependTo(a);d(e);var c={opacity:0.2};e.delay(700).animate(c,2000,function(){e.remove()})};;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-test-session-dialog', location = 'includes/empty.js' */
;
;/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'templates/share-dialog.soy' */
// This file was automatically generated from share-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.Share == 'undefined') { JIRA.Templates.Dialogs.Share = {}; }


JIRA.Templates.Dialogs.Share.contentPopup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form share-content-popup ', (opt_data.shareData.issue) ? ' viewissue ' : (opt_data.shareData.filter) ? ' issuenav ' : '', '">');
  JIRA.Templates.Dialogs.Share.shareLink(opt_data, output);
  output.append('<fieldset class="padding">');
  if (opt_data.showForm) {
    JIRA.Templates.Dialogs.Share.shareForm(opt_data, output);
  } else {
    JIRA.Templates.Dialogs.Share.disabledMailMessage(soy.$$augmentData(opt_data.isAdmin, {isAdmin: opt_data.isAdmin}), output);
  }
  output.append('</fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label for="sharenames-multi-select">', soy.$$escapeHtml("User name or email"), '</label><div class="autocomplete-user-target"><select id="sharenames" name="sharenames" class="share-user-picker hidden" multiple="multiple"></select></div><ol class="recipients"></ol><div><label for="note">', soy.$$escapeHtml("Note"), '</label></div><textarea class="textarea long-field" id="note" placeholder="', soy.$$escapeHtml("Add an optional note"), '"/><div class="button-panel"><div class="status"><div class="icon"></div><div class="progress-messages"></div></div><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" id="submitShare" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button submit" type="submit" value="', soy.$$escapeHtml("Share"), '" disabled/> <a accesskey="', soy.$$escapeHtml("`"), '" id="cancelShare" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="close-dialog" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.disabledMailMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (! opt_data.isAdmin) {
    aui.message.generic({content: '<p>' + soy.$$escapeHtml("Outgoing mail is not configured. Please contact your JIRA administrator to enable sharing.") + '</p>', extraClasses: 'disabled-mail-message'}, output);
  } else {
    aui.message.generic({content: '<p>' + soy.$$escapeHtml("Outgoing mail is not configured. You can configure it here") + '<a class="aui-list-item-link" id="configure_mail_server" href="' + soy.$$escapeHtml("") + '/secure/admin/OutgoingMailServers.jspa"><em> ' + soy.$$escapeHtml("Outgoing mail") + '</em></a>.</p>', extraClasses: 'disabled-mail-message'}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.shareData.permlink) ? '<div class="issuenav-permalink padding"><label>' + ((opt_data.shareData.issue) ? soy.$$escapeHtml("Link to Issue") : (opt_data.shareData.filter) ? soy.$$escapeHtml("Link to Filter") : '') + '</label><input class="permalink text long-field" value="' + soy.$$escapeHtml(opt_data.shareData.permlink) + '" readonly></div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-user-multi-select.js' */
(function($){function createShareUserPicker(ctx){$(".share-user-picker",ctx).each(function(){var control=new JIRA.MultiUserListPicker({layerId:$(this).attr("id")+"-layer",element:$(this),freeEmailInput:true});$(document).trigger("ready.multi-select.share-user",control)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createShareUserPicker(context)}})}(AJS.$));;
;/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-dialog.js' */
JIRA.JiraSharePlugin={};JIRA.JiraSharePlugin.SharePluginDialog=function($){var shareDialog,currentShareLink,dialogContents,allowDialogHide=true;this.resetAndHide=function resetAndHide(){$(document).one("hideLayer",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){$(document).unbind(".share-dialog");dialogContents.empty();dialogContents=undefined;currentShareLink=undefined}});return this.hideDialog()};this.hideDialog=function hideDialog(){shareDialog.hide();return false};function getUsernameValue(){return $(this).attr("data-username")}function getEmailValue(){return $(this).attr("data-email")}this._buildSendShareUrl=function buildSendShareUrl(options,data){var url=AJS.contextPath()+"/rest/share/1.0";if(options.issue){url+="/issue/"+options.issueKey}else{if(options.filter){if(options.filterId){url+="/filter/"+options.filterId}else{data.jql=options.jql;url+="/search"}}}return url};this._successShareHandler=function successShareHandler(){var icon=dialogContents.find(".button-panel .icon");icon.removeClass("throbber loading").addClass("icon-tick");var messages=dialogContents.find(".progress-messages");messages.removeClass("sending").addClass("success").text("Sent");setTimeout(_.bind(this.resetAndHide,this),1000)};this._errorShareHandler=function errorShareHandler(){var icon=dialogContents.find(".button-panel .icon");icon.removeClass("throbber loading").addClass("icon-cross");var messages=dialogContents.find(".progress-messages");messages.removeClass("sending").addClass("error").text("Error while sending")};this._sendShare=function sendShare(data,options){$("button,input,textarea",this).attr("disabled","disabled");var icon=dialogContents.find(".button-panel .icon");icon.addClass("throbber loading");var messages=dialogContents.find(".progress-messages");messages.text("Sending");messages.addClass("sending");var url=this._buildSendShareUrl(options,data);JIRA.trace("jira.plugins.share.send",_.defaults({url:url},data));var requestOptions={type:"POST",contentType:"application/json",dataType:"json",url:url,data:JSON.stringify(data),success:_.bind(this._successShareHandler,this),error:_.bind(this._errorShareHandler,this)};JIRA.SmartAjax.makeRequest(requestOptions)};this._collectMailData=function collectMailData(){var recipients=dialogContents.find(".recipients");var users=recipients.find("li[data-username]").map(getUsernameValue).toArray();var emails=recipients.find("li[data-email]").map(getEmailValue).toArray();if(!(users.length||emails.length)){return false}var message=dialogContents.find("#note").val();var data={usernames:users,emails:emails,message:message};return data};this.submit=function submit(shareData){var mailData=this._collectMailData();if(mailData){this._sendShare(mailData,shareData)}return false};this._enableSubmit=function enableSubmit(enabled){dialogContents.find(".submit").prop("disabled",!enabled)};this.enableAccessKeys=function enableAccessKeys(shareDialogForm){$(shareDialogForm).handleAccessKeys({selective:false})};this._getShareData=function getShareData(trigger){var $trigger=jQuery(trigger),shareTarget,permlinkFull;if($trigger.hasClass("viewissue-share")){shareTarget="issue";permlinkFull=AJS.Meta.get("viewissue-permlink")}else{if($trigger.hasClass("issuenav-share")){shareTarget="filter";permlinkFull=AJS.Meta.get("issuenav-permlink")}}var shareData={issueKey:JIRA.Meta.getIssueKey(),filterId:AJS.Meta.get("filter-id"),jql:AJS.Meta.get("filter-jql"),permlink:permlinkFull};shareData[shareTarget]=true;return shareData};this._enableSubmitWhenIsRecipient=function enableSubmitWhenIsRecipient(){var shareNames=dialogContents.find("#sharenames").val();var isUserProvided=(shareNames!=null)&&(shareNames.length>0);this._enableSubmit(isUserProvided)};this._addInteractionHandlersToDialog=function addInteractionHandlersToDialog(shareData){dialogContents.find("#sharenames").bind("change unselect",_.bind(this._enableSubmitWhenIsRecipient,this));dialogContents.find(".close-dialog").click(_.bind(this.resetAndHide,this));dialogContents.find("form").submit(_.bind(this.submit,this,shareData));dialogContents.find(".issuenav-permalink .text").click(function(e){e.target.select();return false});$(document).bind("keyup.share-dialog",_.bind(function(e){if(e.keyCode===$.ui.keyCode.ESCAPE){return this.hideDialog()}return true},this));$(document).bind("showLayer.share-dialog",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){dialogContents.find("#sharenames-textarea").focus()}})};this._renderDialogContent=function renderDialogContent(shareData){dialogContents.html(JIRA.Templates.Dialogs.Share.contentPopup({shareData:shareData,modifierKey:AJS.Meta.get("keyboard-accesskey-modifier"),showForm:AJS.Meta.get("outgoing-mail-enabled"),isAdmin:AJS.Meta.get("is-admin")}))};this._generatePopup=function generatePopup(contents,trigger,doShowPopup){var shareData=this._getShareData(trigger);if(dialogContents&&currentShareLink===shareData.permlink){dialogContents=contents;doShowPopup();return }currentShareLink=shareData.permlink;dialogContents=contents;this._renderDialogContent(shareData);if($.browser.msie){dialogContents.find("form").ieImitationPlaceholder()}this._enableSubmit(false);this._addInteractionHandlersToDialog.call(this,shareData);this.enableAccessKeys($("form",dialogContents));doShowPopup();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[dialogContents,JIRA.CONTENT_ADDED_REASON.shareDialogOpened])};this._scrollIntoViewForAuto=function _scrollIntoViewForAuto(){var self=this;var $context=$(this.context);$context.scrollIntoViewForAuto({complete:function(){var scrollers=$(this).add(window);_.delay(function(){scrollers.one("scroll",function(){AJS.$(document.activeElement).blur();self.hideDialog()})},20)}})};this._createDialogOptions=function _createDialogOptions(dialogId){var offsetX=(dialogId.indexOf("issuenav")!==-1)?-110:-170;var dialogOptions={preHideCallback:function(){return allowDialogHide},hideCallback:function(){$(".dashboard-actions .explanation").hide()},offsetY:17,offsetX:offsetX,hideDelay:3600000,useLiveEvents:true,initCallback:_.bind(this._scrollIntoViewForAuto,this)};return dialogOptions};this._addAJSInlineLayerEventHandlers=function _addAJSInlineLayerEventHandlers(){JIRA.bind(AJS.InlineLayer.EVENTS.beforeShow,function(e,layer,id){if(id==="sharenames-layer"){allowDialogHide=false}});JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(e,layer,reason,id){if(id==="sharenames-layer"){setTimeout(function(){allowDialogHide=true},0)}})};this._initShareDialog=function _initShareDialog(dialogId,context){var self=this;this.context=context;this._addAJSInlineLayerEventHandlers();var dialogOptions=this._createDialogOptions(dialogId);shareDialog=AJS.InlineDialog($(context),dialogId,_.bind(self._generatePopup,self),dialogOptions);shareDialog[0].popup._validateClickToClose=function(event){return validationResult=shareDialog.has(event.target).length===0};$(context).live("click",function(){if(shareDialog.find(".contents:visible").length){shareDialog.find("a.close-dialog").click()}});$(document).bind("keydown",function(e){if(e.keyCode===$.ui.keyCode.ESCAPE&&AJS.InlineDialog.current!==shareDialog&&shareDialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}shareDialog.hide()}})};this._overrideContents=function overrideContents(newContents){dialogContents=newContents};this._getCurrentDialogContent=function getCurrentDialogContent(){return dialogContents};this._getAllowDialogHide=function _getAllowDialogHide(){return allowDialogHide}};;
;/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources-init', location = 'js/share-dialog-init.js' */
JIRA.JiraSharePlugin.viewIssueDialog=new JIRA.JiraSharePlugin.SharePluginDialog(AJS.$);JIRA.JiraSharePlugin.issueNavDialog=new JIRA.JiraSharePlugin.SharePluginDialog(AJS.$);AJS.toInit(_.bind(JIRA.JiraSharePlugin.viewIssueDialog._initShareDialog,JIRA.JiraSharePlugin.viewIssueDialog,"share-entity-popup-viewissue","#jira-share-trigger.viewissue-share"));AJS.toInit(_.bind(JIRA.JiraSharePlugin.issueNavDialog._initShareDialog,JIRA.JiraSharePlugin.issueNavDialog,"share-entity-popup-issuenav","#jira-share-trigger.issuenav-share"));;
;/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,seedDate){var date=new Date(seedDate);date.setHours(13);var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.date=new Date(seedDate);this.onSetTime();this.title.innerHTML=Calendar._MN[month]+", "+year;this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),13,0,0);var then=new Date(this.getFullYear(),0,0,13,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;;
;/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){params=params||{};function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var i,item;var unwrap=["context","inputField","button","displayArea"];for(i in unwrap){item=unwrap[i];if(params[item] instanceof jQuery){params[item]=params[item][0]}}var tmp=["inputField","displayArea","button"];for(i in tmp){item=tmp[i];if(typeof params[item]==="string"){var escapedSelector="#"+params[item].escapejQuerySelector();var el=jQuery(params.context||document.body).find(escapedSelector);params[item]=el[0]}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
define("jira/autocomplete/autocomplete",["jira/ajs/ajax/smart-ajax","jira/util/objects","jquery"],function(SmartAjax,Objects,jQuery){return function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=Objects.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);jQuery(this.field).keydown(keyboardNavigateHandler);this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){callback.call(this)}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}()});AJS.namespace("jira.widget.autocomplete",null,require("jira/autocomplete/autocomplete"));AJS.namespace("JIRA.AutoComplete",null,require("jira/autocomplete/autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
define("jira/autocomplete/rest-autocomplete",["jira/autocomplete/autocomplete","jira/util/objects"],function(AutoComplete,Objects){return function(){var that=Objects.begetObject(AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}()});AJS.namespace("jira.widget.autocomplete.REST",null,require("jira/autocomplete/rest-autocomplete"));AJS.namespace("JIRA.RESTAutoComplete",null,require("jira/autocomplete/rest-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
define("jira/autocomplete/issue-autocomplete",["jira/autocomplete/rest-autocomplete","jira/util/objects","jquery"],function(RESTAutoComplete,Objects,jQuery){var IssueAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/2/issue/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.sections).each(function(){var section=this;var subSection=jQuery("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(jQuery("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(jQuery("<li/>").append(subSection).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}));if(section.msg){var msg=jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(jQuery("<li/>").append(msg).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=jQuery("<li/>").append(jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(jQuery("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(jQuery("<tr/>").append(jQuery("<td/>").append(jQuery("<img/>").attr("src",imgUrl))).append(jQuery("<td/>").append(jQuery("<div/>").addClass("yak").html(this.keyHtml))).append(jQuery("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};IssueAutoComplete.init=function(){jQuery("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(jQuery(this)),$container=jQuery("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=jQuery("#"+params.fieldId);if($formElement){jQuery.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};return IssueAutoComplete});AJS.namespace("jira.widget.autocomplete.Issues",null,require("jira/autocomplete/issue-autocomplete"));AJS.namespace("JIRA.IssueAutoComplete",null,require("jira/autocomplete/issue-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
define("jira/autocomplete/user-autocomplete",["jira/autocomplete/rest-autocomplete","jira/data/parse-options-from-fieldset","jira/util/browser","jira/util/elements","jira/util/objects","jquery"],function(RESTAutoComplete,parseOptionsFromFieldset,Browser,Elements,Objects,jQuery){var UserAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID,fieldConfigId:options.fieldConfigID,projectId:options.projectId},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!Browser.isSelenium()&&!Elements.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);jQuery(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};UserAutoComplete.init=function(parent){jQuery("fieldset.user-picker-params",parent).each(function(){var params=parseOptionsFromFieldset(jQuery(this)),field=(params.fieldId||params.fieldName),$container=jQuery("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;if(params.fieldConfigId){url+="&fieldConfigId="+params.fieldConfigId}if(params.projectId){if(jQuery.isArray(params.projectId)){for(var projectId in params.projectId){url+="&projectId="+projectId}}else{url+="&projectId="+params.projectId}}vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,fieldConfigID:params.fieldConfigId,projectId:params.projectId,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};return UserAutoComplete});AJS.namespace("jira.widget.autocomplete.Users",null,require("jira/autocomplete/user-autocomplete"));AJS.namespace("JIRA.UserAutoComplete",null,require("jira/autocomplete/user-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initSingleGroupPickers.js' */
(function(){var SingleSelect=require("jira/ajs/select/single-select");function initSingleGroupPickers(ctx){ctx.find(".js-default-single-group-picker").each(function(){var $el=jQuery(this);var $emptyValue=$el.find("option[data-empty]");new SingleSelect({element:this,itemAttrDisplayed:"label",revertOnInvalid:true,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:function(data){var formattedData=JIRA.GroupPickerUtil.formatResponse(data);if($emptyValue.length&&$el.val()!==""){formattedData.unshift(new AJS.ItemDescriptor({value:"",label:$emptyValue.text(),highlighted:true}))}return formattedData}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initSingleGroupPickers(context)}})})();;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();;
;/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=JSON.parse(this.$projectIssueTypesSchemes.html());this.issueTypesSchemeDefaults=JSON.parse(this.$issueTypeSchemeIssueDefaults.html()||"[]");if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));this.$project.change(function(){var val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val))})}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType=this.issueTypeSelect.model.getValue();this.issueTypeSelect.model.setFilterGroup(issueTypeSchemeId);if(!this.issueTypeSelect.model.setSelected(selectedIssueType,false)){this.setDefaultIssueType(issueTypeSchemeId)}this.issueTypeSelect.model.$element.data("project",this.$project.val())},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId),descriptor=this.issueTypeSelect.model.getDescriptor(defaultIssueType);if(!descriptor){descriptor=this.issueTypeSelect.model.getAllDescriptors()[0]}this.issueTypeSelect.setSelection(descriptor,false)}});;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){var SuggestionCollectionModel=require("jira/ajs/select/suggestion-collection-model");function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body");$ctx.find(".issuetype-field").each(function(index){var $project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=jQuery(this),$projectIssueTypes=$ctx.find("#"+$issueTypeSelect.attr("id")+"-projects"),$defaultProjectIssueTypes=$ctx.find("#"+$issueTypeSelect.attr("id")+"-defaults"),issueTypeSelect=new AJS.SingleSelect({element:$issueTypeSelect,revertOnInvalid:true,model:SuggestionCollectionModel});issueTypeSelect.model.remove("");if($project.length>0){new JIRA.ProjectIssueTypeSelect({project:$project.eq(index),issueTypeSelect:issueTypeSelect,projectIssueTypesSchemes:$projectIssueTypes,issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}})();;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){var ScrollableSingleSelect=require("jira/ajs/select/scrollable-single-select");var SuggestionCollectionModel=require("jira/ajs/select/suggestion-collection-model");function createProjectPicker(context){context.find(".project-field").each(function(){new ScrollableSingleSelect({element:this,revertOnInvalid:true,pageSize:50,pagingThreshold:100,model:SuggestionCollectionModel})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img alt="" src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<button type="button" class="remove-recipient item-delete"><span class="icon-default aui-icon aui-icon-small aui-iconfont-delete">' + soy.$$escapeHtml(AJS.format("Remove watcher: {0}",opt_data.username)) + '</span></button>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"><span class="icon-default aui-icon aui-icon-small aui-iconfont-delete"></span></span></span></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
define("jira/field/issue-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){var IssuePicker=MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){jQuery(response.sections).each(function(i,section){var groupDescriptor=new GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){groupDescriptor.addItem(new ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=jQuery.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return jQuery("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});IssuePicker.callback=null;return IssuePicker});AJS.namespace("jira.issuepicker",null,require("jira/field/issue-picker"));AJS.namespace("AJS.IssuePicker",null,require("jira/field/issue-picker"));AJS.namespace("JIRA.IssuePicker",null,require("jira/field/issue-picker"));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
define("jira/field/label-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){return MultiSelect.extend({_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(jQuery.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(jQuery.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){jQuery.each(data.suggestions,function(){optgroup.addItem(new ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=jQuery.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}})});AJS.namespace("AJS.LabelPicker",null,require("jira/field/label-picker"));AJS.namespace("JIRA.LabelPicker",null,require("jira/field/label-picker"));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){JIRA.ComponentPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Component"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingDescriptor=_.find(allExistingDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingDescriptor){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Component.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.ComponentPicker({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){var IssuePicker=require("jira/field/issue-picker");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");function initIssuePicker(el){$(el||document.body).find(".aui-field-issuepicker").each(function(){new IssuePicker({element:$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){initIssuePicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
define("jira/field/label-picker-factory",["jira/field/label-picker","jira/data/parse-options-from-fieldset","jquery","exports"],function(LabelPicker,parseOptionsFromFieldset,$,exports){exports.createPicker=function($fieldset,context){var opts=parseOptionsFromFieldset($fieldset),$select=$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}});(function(){var LabelPickerFactory=require("jira/field/label-picker-factory");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");var FIELDSET_SELECTOR="fieldset.labelpicker-params";function locateFieldset(parent){var $parent=$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){LabelPickerFactory.createPicker($fieldset,context)}})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){JIRA.VersionPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Version"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingVersionDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingVersion=_.find(allExistingVersionDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingVersion){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Version.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.VersionPicker({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$("#delete-log-work-adjust-estimate-new-value").change(function(){$("#delete-log-work-adjust-estimate-new").prop("checked",true)});$("#delete-log-work-adjust-estimate-manual-value").change(function(){$("#delete-log-work-adjust-estimate-manual").prop("checked",true)});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");require("jira/jquery/plugins/attachment/inline-attach");function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){createInlineAttach(context)}})})();;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(c,a,b){jQuery(this).trigger(c,a);if(b&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(e,d){jQuery(AJS).trigger(d+"."+c,a)})}return this};Class.prototype.bind=function(a,b){jQuery(this).bind(a,b);return this};JIRA.makePropertyFunc=function(a){if(jQuery.isFunction(a)){return a}else{return function(){return a}}};JIRA.Dialog.getAttrFromActiveTrigger=function(b){var c=JIRA.Dialog.current,a=c.$activeTrigger;if(a){return a.attr(b)}};JIRA.Dialog.getIssueActionTitle=function(b){var a=JIRA.Dialog.getActionIssueKey();if(!a){return b}return b+" : "+a};JIRA.Dialog.getActionIssueKey=function(){var a=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");if(!a&&JIRA.Issue){a=JIRA.Issue.getIssueKey()}if(!a&&JIRA.IssueNavigator){a=JIRA.IssueNavigator.getSelectedIssueKey()}if(!a&&JIRA.Issues){a=JIRA.Issues.Api.getSelectedIssueKey()}return a};JIRA.activateTabWithChild=function(e){var c,b,a,d=e.closest(".tabs-pane");if(d.length){b=d.closest(".aui-tabs");c=d.attr("id");a=b.find("a[href='#"+c+"']");a.click()}};JIRA.applyErrorsToForm=function(c,d){var b,a=[];jQuery.each(d,function(f,i){var h,e,g=c.find(":input[name='"+f+"']").last();if(g.length===1){if(!b){b=g}e=jQuery("<div class='error' />").attr("data-field",f).text(i);h=g.closest(".field-group, .group");h.find(".error").remove();h.append(e)}else{if(g.length===0){a.push(i)}}});if(a.length>0){JIRA.applyErrorMessageToForm(c,JIRA.Templates.Issue.undealtErrors({errors:a}))}JIRA.activateTabWithChild(c.find(".error:first"));if(b){b.focus()}};JIRA.extractScripts=function(b){var a=jQuery(b);return{html:a.not("script"),scripts:a.filter("script")}};JIRA.applyMessageToForm=function(a,c,b,e){var d=c.find(".aui-message-context");if(!d.length){d=jQuery("<div class='aui-message-context' />");if(JIRA.useLegacyDecorator()){d.prependTo(c.find(".content-body"))}else{d.prependTo(c.find(".form-body"))}}d.empty();AJS.messages[a](d,{shadowed:false,closeable:e,body:b})};JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")};JIRA.applyErrorMessageToForm=function(b,a){return JIRA.applyMessageToForm("error",b,a,false)};JIRA.applySuccessMessageToForm=function(b,a){return JIRA.applyMessageToForm("success",b,a,true)};;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(a){this.userFieldsResource=a.userFieldsResource;this.fieldsResource=a.fieldsResource;this.retainedFields=[];this._hasRetainFeature=false;this._hasVisibilityFeature=true},getFieldsResource:function(){return this.fieldsResource},getAtlToken:function(){return this.atlToken},getFormToken:function(){return this.formToken},getActiveFieldIds:function(){return this.getUserFields()},addFieldToRetainValue:function(a){if(this._hasRetainFeature){this.removeFieldToRetainValue(a);this.retainedFields.push(a)}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},clearRetainedFields:function(){this.retainedFields=[]},removeFieldToRetainValue:function(b){if(this._hasRetainFeature){var a=jQuery.inArray(b,this.retainedFields);if(a!=-1){this.retainedFields.splice(a,1)}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},hasRetainedValue:function(a){if(this._hasRetainFeature){return jQuery.inArray(a.id,this.retainedFields)!==-1}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},refresh:function(c){var a=this,b=jQuery.Deferred(),d;if(c){d=c+"&retainValues=true"}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:d,success:function(e){a.atlToken=e.atl_token;a.formToken=e.formToken;a.fields=e.fields;a.sortedTabs=e.sortedTabs;a.userPreferences=e.userPreferences},complete:function(f,g,e){if(e.successful){b.resolveWith(a,arguments)}else{a.triggerEvent("serverError",[e]);b.rejectWith(a,[e])}}});return b.promise()},setFields:function(a){this.fields=a},getConfigurableFields:function(){return this.getFields()},getFields:function(){var a=this,b=jQuery.Deferred();if(!this.fields){this.refresh().done(function(){b.resolve(a.fields)})}else{b.resolve(a.fields)}return b.promise()},_mungeTabs:function(b){var a=0,c=[];jQuery.each(b,function(d,e){a++;if(e.tab){if(!c[e.tab.position]){c[e.tab.position]=AJS.copyObject(e.tab)}if(e.tab.position===0){c[e.tab.position].isFirst=true}if(!c[e.tab.position].fields){c[e.tab.position].fields=[]}c[e.tab.position].fields.push(AJS.copyObject(e))}});return c},getTabs:function(){var a=this,b=jQuery.Deferred();this.getFields().done(function(c){var d=a._mungeTabs(c);b.resolve(d)});return b.promise()},getSortedTabs:function(){var a=jQuery.Deferred();if(!this.sortedTabs){this.refresh().done(function(){a.resolve(this.sortedTabs)})}else{a.resolve(this.sortedTabs)}return a.promise()},getUserFields:function(){var a=this,b=jQuery.Deferred();if(!this.userPreferences){this.refresh().done(function(){b.resolve(a.userPreferences.fields)})}else{b.resolve(a.userPreferences.fields)}return b.promise()},setUserFields:function(a){var b={};b.fields=a;return this.updateUserPrefs(b)},hasRetainFeature:function(){return !!this._hasRetainFeature},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature},getUseConfigurableForm:function(){var a=this,b=jQuery.Deferred();if(!this.userPreferences){this.refresh().done(function(){b.resolve(a.userPreferences.useQuickForm)}).fail(function(){b.reject()})}else{b.resolve(a.userPreferences.useQuickForm)}return b.promise()},setUseConfigurableForm:function(a){var b={};b.useQuickForm=a;return this.updateUserPrefs(b)},updateUserPrefs:function(c){var b=jQuery.Deferred(),a=this;if(AJS.Meta.get("remote-user")===""){b.done();return b.promise()}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");b.reject();return b.promise()}if(!c.fields){c.fields=this.userPreferences.fields}if(typeof c.showWelcomeScreen==="undefined"){c.showWelcomeScreen=this.userPreferences.showWelcomeScreen}if(typeof c.useQuickForm==="undefined"){c.useQuickForm=this.userPreferences.useQuickForm}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(c),dataType:"json",contentType:"application/json",complete:function(e,f,d){if(d.successful){a.userPreferences=c}else{a.triggerEvent("serverError",[d])}}})}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.error({closeable: 'true', content: opt_data.message}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(a){this.descriptor=a;this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())},focus:function(){this.$element.find(":input:first").focus()},highlight:function(){var a=this;this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){a.$element.animate({backgroundColor:"#fff"},function(){a.$element.css("backgroundColor","")})})},getLabel:function(){return this.descriptor.label},getId:function(){return this.descriptor.id},activate:function(b){var a;this.active=true;this.$element.addClass("qf-field-active").show();this.$element.find("textarea").trigger("refreshInputHeight");if(!b){a=this.render();this.$element.append(a.scripts);this.focus();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);this.$element.scrollIntoView();this.triggerEvent("activated")}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature},isActive:function(){return this.active},disable:function(a){this.render();this.active=false;this.$element.removeClass("qf-field-active").hide();if(!a){this.triggerEvent("disabled")}},render:function(){var b=JIRA.Templates.QuickForm.field(this.descriptor),a=JIRA.extractScripts(b);this.$element.html(a.html).addClass("qf-field").data("model",this);return{element:this.$element,scripts:a.scripts}}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]},switchToAll:function(a){this.isConfigurable=false;if(a!==true){this.hideCallback=function(){this.remove()};this.inlineDialog.hide();this.triggerEvent("switchedToAll")}},setForm:function(a){this.form=a},switchToCustom:function(a){this.isConfigurable=true;if(a!==true){this.hideCallback=function(){this.remove()};this.inlineDialog.hide();this.triggerEvent("switchedToCustom")}},hideCallback:function(){},bindInlineDialog:function(){var b=this,a=this.getInlineDialogTrigger();function c(f,d,e){b.render().done(function(g){if(f.find(".qf-picker").length===0){f.html(g);f.click(function(k){k.stopPropagation()})}var j=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),i=jQuery(window).height(),h=i-j-110;f.find(".qf-picker-content").css("maxHeight",h);e()})}if(this.inlineDialog){this.inlineDialog.remove()}this.inlineDialog=AJS.InlineDialog(a,this.INLINE_DIALOG_ID,c,{width:450,upfrontCallback:function(){a.parent().addClass("active")},hideCallback:function(){a.parent().removeClass("active")},nobind:true});a.click(function(d){if(jQuery("#inline-dialog-"+b.INLINE_DIALOG_ID).is(":visible")){b.inlineDialog.hide()}else{b.inlineDialog.show()}});return this.inlineDialog},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")},renderButtons:function(b){var a=this,c=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);jQuery.each(b,function(e,f){var g,d;if(a.isConfigurable){a.form.getFieldById(f.id).done(function(i){if(i&&i.hasVisibilityFeature()){var j=jQuery("<li />").appendTo(c);var h=new JIRA.Forms.FieldPicker.ConfigurableButton({field:i});h.render().appendTo(j);a.buttons.push(h)}})}else{d=new JIRA.Forms.FieldPicker.UnconfigurableButton(f);g=jQuery("<li />").appendTo(c);d.render().appendTo(g)}});if(c.children().length===0){c.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")}},renderContents:function(){var a=this,b=jQuery.Deferred();this.form.model.getSortedTabs().done(function(c){if(c.length===1){a.renderButtons(c[0].fields)}else{jQuery.each(c,function(d,e){if(e.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(a.$content).find("span").text(e.label);a.renderButtons(e.fields)}})}b.resolveWith(a,[a.$element])});return b.promise()},show:function(){this.inlineDialog.show()},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));this.$content=this.$element.find(".qf-picker-content");this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));return this.renderContents()},_events:{switchToCustom:{click:function(a){this.switchToCustom();a.preventDefault()}},switchToAll:{click:function(a){this.switchToAll();a.preventDefault()}}}});JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(a){this.descriptor=a},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));return this.$element}});JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(b){var a=this;this.field=b.field;this.field.bind("disabled",function(){a.$element.removeClass("qf-active")}).bind("activated",function(){a.$element.addClass("qf-active")})},toggle:function(){if(this.field.isActive()){this.field.disable()}else{this.field.activate()}},getId:function(){return this.field.getId()},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));this._assignEvents("button",this.$element);return this.$element},_events:{button:{click:function(a){this.toggle();a.preventDefault()}}}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var a=this;a.getForm().addClass("submitting");this.triggerEvent("submitting",[],true);return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){a.disable()},data:this.serialize(),complete:function(g,h,c){var e=c.data;a.getForm().find(".aui-message-context").remove();a.enable();a.getForm().find(".error").remove();if(c.successful){a.performAnalytics();if(e&&e.fields){a.invalidateFieldsCache();a.model.setFields(e.fields)}if(typeof e==="string"){var f=AJS.$(AJS.extractBodyFromResponse(e));var d=f.find("#atl_token").val();if(d){a.model.atlToken=d;a.getForm().find('input[name="atl_token"]').val(d)}var b=new JIRA.FormDialog({offsetTarget:"body",content:f});b._handleServerSuccess=function(){if(b.prev){b.prev._removeStackState();b.prev._resetWindowTitle();b._removeStackState()}b.hide();a.triggerEvent("sessionComplete",[],true);a.handleSubmitSuccess()};b._handleServerError=function(i){b.hide();a.handleSubmitError(i)};b.show()}else{a.handleSubmitSuccess(c.data)}}else{a.handleSubmitError(g)}a.getForm().removeClass("submitting")}})},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");this.getForm().find(":submit").attr("disabled","disabled")},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");this.getForm().find(":submit").removeAttr("disabled")},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")},serialize:function(c){var a=this,b=this.getForm().serialize();if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){b=b+"&multipleMode=true"}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();jQuery.each(this.getActiveFieldIds(),function(e,d){a.model.addFieldToRetainValue(d,c)});jQuery.each(this.model.getFieldsWithRetainedValues(),function(d,e){b=b+"&fieldsToRetain="+e})}return b},invalidateFieldsCache:function(){delete this.fields},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()},handleSubmitSuccess:function(){this.triggerEvent("submitted");AJS.reloadViaWindowLocation()},performAnalytics:function(){var a=function(d,e){var c="***** Analytics log ["+d+"]";if(e){c+="["+JSON.stringify(e)+"]"}AJS.log(c);if(AJS.EventQueue){AJS.EventQueue.push({name:d,properties:e||{}})}};var b=function(e){var c={};var f=_.filter(e,function(g){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],g.name)});var d=_.filter(f,function(g){return g.value!=""});_.each(d,function(h){var g=h.name;if(!_.has(c,g)){c[g]=[]}c[g].push(h.value)});return c};this.previousAnalytics=(function(k,o){var f=b(k);var m=_.keys(f);var g=_.keys(o.data);var j=_.difference(m,g);var n=_.difference(g,m);var l=_.intersection(g,m);var d=_.filter(l,function(p){return _.isEqual(o.data[p],f[p])});var c=_.difference(l,d);var i=o.count+1;var h=(JIRA.Dialog.current.options.id==="edit-issue-dialog");var e={"atlassian.numCreates":i,"edit.form":h};_.each(j,function(p){e[p]="added"});_.each(n,function(p){e[p]="removed"});_.each(d,function(p){e[p]="same"});_.each(c,function(p){e[p]="changed"});a("quick.create.fields",e);return{data:f,count:i}})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})},handleSubmitError:function(d){var a=this;var f;try{f=JSON.parse(d.responseText)}catch(c){}if(f){if(f.errorMessages&&f.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),f.errorMessages[0])}if(f&&f.errors&&d.status===400){if(this.getFieldById){jQuery.each(f.errors,function(e){if(/^timetracking/.test(e)){a.getFieldById("timetracking").done(function(g){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[a.$element]);g.activate(true)})}else{if(/^worklog/.test(e)){a.getFieldById("worklog").done(function(g){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[a.$element]);g.activate(true)})}else{a.getFieldById(e).done(function(g){g.activate(true)})}}})}JIRA.applyErrorsToForm(this.getForm(),f.errors);this.triggerEvent("validationError",[this,f.errors],true)}var b=a.$element.find(".error");if(b.length){b[0].scrollIntoView(false)}}},getAction:function(){return this.action},getFormContent:function(){return this.$element.find("div.content")},getForm:function(){return this.$element.find("form")},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")},_getActiveAttachments:function(a){var b=[];if(!a){return b}var d=a.split("&");for(var c=0;c<d.length;c++){var e=d[c].split("=");if(e[0]=="filetoconvert"){b.push(e[1])}}return b},_setActiveAttachments:function(b){var a=this.$element.find("input[name=filetoconvert]");a.each(function(){var d=jQuery(this);var c=_.contains(b,d.attr("value"));d.prop("checked",c)})},render:function(c){var b=jQuery.Deferred(),a=this;var d=a._getActiveAttachments(c);if(c){this.invalidateFieldsCache();this.model.refresh(c).done(function(){a._render().done(function(f,e){a.triggerEvent("rendered",[a.$element]);b.resolveWith(a,[a.$element,e])})})}else{a._render().done(function(f,e){a.triggerEvent("rendered",[a.$element]);b.resolveWith(a,[a.$element,e])})}b.always(function(){a._setActiveAttachments(d)});return b.promise()}});JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var b=jQuery.Deferred(),a=this;if(!this.fields){this.fields=[];this.model.getConfigurableFields().done(function(c){jQuery.each(c,function(d,f){var e=a.createField(f);a.fields.push(e)});b.resolveWith(a,[a.fields])})}else{b.resolveWith(this,[this.fields])}return b.promise()},getActiveFieldIds:function(){var b=[],a=this.$element.find(".qf-field.qf-field-active:not(.qf-required), .qf-field.qf-required:not(.qf-field-active)");jQuery.each(a,function(e,f){var d=jQuery(f);var c=d.data("model");var g=d.data("field-id")||c&&c.getId();if(g!=null){b.push(g)}if(g==="attachment"){d.find("input[name=filetoconvert]").each(function(){b.push(this.id)})}});return b},createField:function(c){c.hasVisibilityFeature=this.model.hasVisibilityFeature(c);if(this.model.hasRetainFeature(c)){c.hasRetainFeature=true;c.retainValue=this.model.hasRetainedValue(c)}var a=this,b=new JIRA.Forms.ConfigurableField(c);if(c.hasVisibilityFeature){b.bind("activated",function(){a.model.setUserFields(a.getActiveFieldIds());b.highlight();a.triggerEvent("QuickForm.fieldAdded",[b])}).bind("disabled",function(){a.model.setUserFields(a.getActiveFieldIds());a.triggerEvent("QuickForm.fieldRemoved",[b])})}return b},getFieldById:function(c){var a=this,b=jQuery.Deferred();this.getFields().done(function(d){jQuery.each(d,function(e,f){if(f.getId()===c){b.resolveWith(a,[f])}});b.rejectWith(a,[])});return b.promise()},hasNoVisibleFields:function(){var a=jQuery.Deferred();a.resolve(this.getActiveFieldIds().length===0);return a.promise()},renderFormContents:function(){var c=jQuery.Deferred(),b=jQuery(),a=this;a.getFields().done(function(d){a.model.getActiveFieldIds().done(function(e){jQuery.each(d,function(){var f=this.render();b=b.add(f.scripts);a.getFormContent().append(f.element)});jQuery.each(e,function(g,f){jQuery.each(d,function(){if(this.getId()===f){this.activate(true)}})});jQuery.each(d,function(){if(!this.isActive()){this.disable(true)}});a.hasNoVisibleFields().done(function(g){if(g===true){for(var f=0;f<3;f++){if(d[f]){d[f].activate(true)}}}c.resolveWith(this,[a.$element,b])})})});return c.promise()}});JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var a=this,b=jQuery.Deferred(),c={};this.model.getTabs().done(function(d){if(d.length===1){c.fields=d[0].fields}else{c.tabs=d;c.hasTabs=true}b.resolveWith(a,[JIRA.Templates.Issue.issueFields(c)])});return b.promise()},getActiveFieldIds:function(){var b=[];this.model.getFields().done(function(c){jQuery.each(c,function(d,e){b.push(e.id)})});if(b.indexOf("attachment")){var a=this.$element.find("input[name=filetoconvert]").map(function(c,d){return d.id}).toArray();b.push.apply(b,a)}return b},getFields:function(){var b=jQuery.Deferred(),a=this;if(!this.fields){this.fields=[];this.model.getFields().done(function(c){jQuery.each(c,function(d,f){var e=a.createField(f);a.fields.push(e)});b.resolveWith(a,[a.fields])})}else{b.resolveWith(this,[this.fields])}return b.promise()}});JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(a){var b,c;if(a.hasData&&a.status!==401){try{c=JSON.parse(a.data);if(c.errorMessages&&c.errorMessages.length>0){b=JIRA.Templates.QuickForm.errorMessage({message:c.errorMessages[0]})}else{b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}}catch(d){b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}}else{b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}return b},render:function(b){var a=this.getErrorMessageFromSmartAjax(b);return this._render(a)}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(a){this.$element=jQuery("<div />").addClass("qf-container");this.options=JIRA.makePropertyFunc(a);this.fieldPicker=new JIRA.Forms.FieldPicker();this.successData=[]},decorateRenderers:function(){var a=this;if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){a.unconfigurableForm.render(a.currentView.serialize(true)).done(function(){a.fieldPicker.show()})});this.fieldPicker.bind("switchedToCustom",function(){a.configurableForm.render(a.currentView.serialize(true)).done(function(){a.fieldPicker.show()})});this.fieldPicker.decorated=true}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(c,b){a.currentView=a.configurableForm;a.fieldPicker.switchToCustom(true);a.fieldPicker.setForm(a.configurableForm);a.fieldPicker.bindInlineDialog();a.applyGlobalDecorator(b);a.model.setUseConfigurableForm(true);a.triggerEvent("configurableFormRendered")});this.configurableForm.bind("submitted",function(c,b){a.successData.push(b);a.triggerEvent("configurableFormSubmitted")});this.configurableForm.decorated=true}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(c,b){a.fieldPicker.switchToAll(true);a.fieldPicker.setForm(a.unconfigurableForm);a.fieldPicker.bindInlineDialog();a.currentView=a.unconfigurableForm;a.applyGlobalDecorator(b);a.model.setUseConfigurableForm(false);a.triggerEvent("unconfigurableFormRendered")});this.unconfigurableForm.bind("submitted",function(c,b){a.successData.push(b);a.triggerEvent("unconfigurableFormSubmitted")});this.unconfigurableForm.decorated=true}},applyGlobalDecorator:function(c){function b(){if(a.currentView.setInitialFocus){a.currentView.setInitialFocus()}}var a=this;c.detach();this.$element.html(c);this.triggerEvent("contentRefreshed",[this.$element]);if(jQuery.browser.msie){window.setTimeout(b,0)}else{b()}},asDialog:function(b){var a=this,c;this.dialog=c=new JIRA.FormDialog({id:b.id,trigger:b.trigger,windowTitle:b.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(d){a.render().done(function(){d(a.$element)});a.triggerEvent("dialogShown")},submitHandler:function(f,d){f.preventDefault();a.currentView.submit().then(d,d)},stacked:true});if(b.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(d){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){d.preventDefault()}})}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])};this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){c.hide()});this.configurableForm.bind("sessionComplete",function(){c.hide()})}).bind("contentRefreshed",function(){c.notifyOfNewContent()});c.bind("Dialog.hide",function(){if(a.successData.length){a.triggerEvent("sessionComplete",[a.successData],true);a.successData=[]}});a.$element.ajaxStart(function(){c.showFooterLoadingIndicator()}).ajaxStop(function(){c.hideFooterLoadingIndicator()});c.getQuickForm=function(){return a};c.dirtyFormWarning();return c},lazyInit:function(){var a=this,b=this.options.call(this);this.model=b.model;this.errorHandler=b.errorHandler;this.globalEventNamespaces=b.globalEventNamespaces;this.configurableForm=b.configurableForm;this.unconfigurableForm=b.unconfigurableForm;this.sessionComplete=b.sessionComplete;this.model.clearRetainedFields();this.configurableForm.invalidateFieldsCache();this.model.bind("serverError",function(d,c){a.$element.html(a.errorHandler.render(c));a.triggerEvent("contentRefreshed",[this.$element])});this.triggerEvent("initialized");this.decorateRenderers()},render:function(){var a=this,b=jQuery.Deferred();this.lazyInit();a.model.getUseConfigurableForm().done(function(c){if(c===true){a.configurableForm.render().done(function(e,d){b.resolveWith(a,[a.$element]);a.$element.append(d)})}else{a.unconfigurableForm.render().done(function(e,d){b.resolveWith(a,[a.$element,d]);a.$element.append(d)})}}).fail(function(){b.resolveWith(a,[a.$element])});return b.promise()}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/edit.js' */
JIRA.Forms.EditIssueModel=JIRA.Forms.Model.extend({getUnconfigurableTabs:function(){var a=this,b=jQuery.Deferred();a.getTabs().done(function(d){var c=d.slice(0);c[0].fields=c[0].fields.slice(0);jQuery.each(c[0].fields,function(e,f){if(f.id==="comment"){c[0].fields.splice(e,1);return false}});b.resolve(c)});return b.promise()},getCommentField:function(){var a=jQuery.Deferred();this.getFields().done(function(b){jQuery.each(b,function(c,d){if(d.id==="comment"){a.resolve(d)}});a.reject()});return a.promise()}});JIRA.Forms.EditIssueError=JIRA.Forms.Error.extend({_render:function(a){return jQuery(JIRA.Templates.Issue.editIssueError({errorHtml:a,useLegacyDecorator:JIRA.useLegacyDecorator()}))}});JIRA.Forms.UnconfigurableEditIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(a){this.globalEventNamespaces=a.globalEventNamespaces||[];this.model=a.model;this.issueId=a.issueId;this.title=a.title;this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+a.issueId+"&decorator=none";this.$element=jQuery("<div class='qf-unconfigurable-form' />")},getFieldsHtml:function(){var a=this,b=jQuery.Deferred(),c={};this.model.getUnconfigurableTabs().done(function(d){if(d.length===1){c.fields=d[0].fields}else{c.tabs=d;c.hasTabs=true}b.resolveWith(a,[JIRA.Templates.Issue.issueFields(c)])});return b.promise()},handleSubmitSuccess:function(a){this.triggerEvent("submitted",[a]);this.triggerEvent("issueEdited",[a],true);this.triggerEvent("sessionComplete")},_render:function(){var b=jQuery.Deferred(),a=this;this.getFieldsHtml().done(function(c){var d={fieldsHtml:c,title:a.title,issueId:a.issueId,atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()};this.model.getCommentField().then(function(g){var f,e;d.commentField=g;f=JIRA.Templates.Issue.editIssueForm(d);e=JIRA.extractScripts(f);a.$element.html(e.html);b.resolveWith(a,[a.$element,e.scripts])},function(){var f=JIRA.Templates.Issue.editIssueForm(d),e=JIRA.extractScripts(f);a.$element.html(e.html);b.resolveWith(a,[a.$element,e.scripts])})});return b.promise()}});JIRA.Forms.ConfigurableEditIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(a){this.model=a.model;this.globalEventNamespaces=a.globalEventNamespaces||[];this.issueId=a.issueId;this.title=a.title;this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+a.issueId+"&decorator=none";this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")},handleSubmitSuccess:function(a){this.triggerEvent("submitted",[a]);this.triggerEvent("issueEdited",[a],true);this.triggerEvent("sessionComplete")},hasNoVisibleFields:function(){var a=jQuery.Deferred(),b=this.getActiveFieldIds();this.model.getUserFields().done(function(c){if(c.length===1&&c[0]==="comment"){a.resolve(false)}else{if(b.length===0||(b.length===1&&b[0]==="comment")){a.resolve(true)}else{a.resolve(false)}}});return a.promise()},_render:function(){var b=jQuery.Deferred(),a=this,c=JIRA.Templates.Issue.editIssueForm({issueId:this.issueId,title:this.title,atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),isConfigurable:true,useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()});this.$element.html(c);a.renderFormContents().done(function(e,d){a.getFieldById("comment").done(function(f){a.getFormContent().append(f.$element)});b.resolveWith(a,[a.$element,d])});return b.promise()}});JIRA.Forms.Model.createQuickEditIssueModel=function(a){return new JIRA.Forms.EditIssueModel({fieldsResource:contextPath+"/secure/QuickEditIssue!default.jspa?issueId="+a+"&decorator=none",userFieldsResource:contextPath+"/rest/quickedit/1.0/userpreferences/edit"})};JIRA.Dialog.shouldShowIssueKeyInTitle=function(){return JIRA.Issues||JIRA.IssueNavigator.isNavigator()||JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey")};JIRA.Forms.createEditIssueForm=function(){function a(c){var d=JIRA.Dialog.getAttrFromActiveTrigger("data-issueId");if(jQuery.isFunction(c.issueId)){return c.issueId(c)}else{if(c.issueId){return c.issueId}else{if(d){return d}else{return JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()}}}}function b(){var c="Edit Issue";if(JIRA.Dialog.shouldShowIssueKeyInTitle()){return JIRA.Dialog.getIssueActionTitle(c)}else{return c}}return function(c){c=c||{};return new JIRA.Forms.Container(function(){var h=a(c),g=b(),d=JIRA.Forms.Model.createQuickEditIssueModel(h),f=new JIRA.Forms.ConfigurableEditIssueForm({title:g,model:d,issueId:h,globalEventNamespaces:["QuickEdit"]}),e=new JIRA.Forms.UnconfigurableEditIssueForm({title:g,model:d,issueId:h,globalEventNamespaces:["QuickEdit"]});return{globalEventNamespaces:["QuickEdit"],model:d,errorHandler:new JIRA.Forms.EditIssueError(),configurableForm:f,unconfigurableForm:e}})}}();jQuery(function(){JIRA.Forms.createEditIssueForm().asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Edit Issue")},trigger:".issueaction-edit-issue",id:"edit-issue-dialog"});jQuery(document).bind("dialogContentReady",function(){AJS.tabs.setup()})});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>');
  if (opt_data.showFieldConfigurationToolBar) {
    JIRA.Templates.Issue.fieldConfigurationToolbar(null, output);
  }
  output.append(opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.fieldConfigurationToolbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param64 = new soy.StringBuilder();
  var param66 = new soy.StringBuilder();
  aui.buttons.button({text: ' ' + soy.$$escapeHtml("Configure Fields"), id: 'qf-field-picker-trigger', extraClasses: 'toolbar-trigger', iconText: "Configure Fields", iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-configure'}, param66);
  aui.toolbar2.item({item: 'secondary', content: param66.toString()}, param64);
  aui.toolbar2.toolbar2({extraClasses: 'qf-form-operations', content: param64.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      output.append((tabData82) ? '<li class="menu-item ' + ((tabData82.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData82.position) + '" ><strong>' + soy.$$escapeHtml(tabData82.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList96 = opt_data.tabs;
    var tabListLen96 = tabList96.length;
    for (var tabIndex96 = 0; tabIndex96 < tabListLen96; tabIndex96++) {
      var tabData96 = tabList96[tabIndex96];
      if (tabData96) {
        output.append('<div class="tabs-pane ', (tabData96.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData96.position), '">');
        var fieldList106 = tabData96.fields;
        var fieldListLen106 = fieldList106.length;
        for (var fieldIndex106 = 0; fieldIndex106 < fieldListLen106; fieldIndex106++) {
          var fieldData106 = fieldList106[fieldIndex106];
          output.append((fieldData106.editHtml) ? fieldData106.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList116 = opt_data.fields;
    var fieldListLen116 = fieldList116.length;
    for (var fieldIndex116 = 0; fieldIndex116 < fieldListLen116; fieldIndex116++) {
      var fieldData116 = fieldList116[fieldIndex116];
      output.append((fieldData116.editHtml) ? fieldData116.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>');
  if (opt_data.showFieldConfigurationToolBar) {
    JIRA.Templates.Issue.fieldConfigurationToolbar(null, output);
  }
  output.append(soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList138 = opt_data.issueSetupFields;
    var fieldListLen138 = fieldList138.length;
    for (var fieldIndex138 = 0; fieldIndex138 < fieldListLen138; fieldIndex138++) {
      var fieldData138 = fieldList138[fieldIndex138];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData138.id), ' qf-required" data-field-id="', soy.$$escapeHtml(fieldData138.id), '">', fieldData138.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button aui-button-primary" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList205 = opt_data.errors;
  var errorListLen205 = errorList205.length;
  for (var errorIndex205 = 0; errorIndex205 < errorListLen205; errorIndex205++) {
    var errorData205 = errorList205[errorIndex205];
    output.append('<li>', soy.$$escapeHtml(errorData205), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.onresolve.jira.groovy.groovyrunner:jqlQueryDoc', location = 'js/jquery.livequery.min.js' */
/* Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (MIT_LICENSE.txt)
 * and GPL Version 2 (GPL_LICENSE.txt) licenses.
 *
 * Version: 1.1.1
 * Requires jQuery 1.3+
 * Docs: http://docs.jquery.com/Plugins/livequery
 */
(function(a){a.extend(a.fn,{livequery:function(e,d,c){var b=this,f;if(a.isFunction(e)){c=d,d=e,e=undefined}a.each(a.livequery.queries,function(g,h){if(b.selector==h.selector&&b.context==h.context&&e==h.type&&(!d||d.$lqguid==h.fn.$lqguid)&&(!c||c.$lqguid==h.fn2.$lqguid)){return(f=h)&&false}});f=f||new a.livequery(this.selector,this.context,e,d,c);f.stopped=false;f.run();return this},expire:function(e,d,c){var b=this;if(a.isFunction(e)){c=d,d=e,e=undefined}a.each(a.livequery.queries,function(f,g){if(b.selector==g.selector&&b.context==g.context&&(!e||e==g.type)&&(!d||d.$lqguid==g.fn.$lqguid)&&(!c||c.$lqguid==g.fn2.$lqguid)&&!this.stopped){a.livequery.stop(g.id)}});return this}});a.livequery=function(b,d,f,e,c){this.selector=b;this.context=d;this.type=f;this.fn=e;this.fn2=c;this.elements=[];this.stopped=false;this.id=a.livequery.queries.push(this)-1;e.$lqguid=e.$lqguid||a.livequery.guid++;if(c){c.$lqguid=c.$lqguid||a.livequery.guid++}return this};a.livequery.prototype={stop:function(){var b=this;if(this.type){this.elements.unbind(this.type,this.fn)}else{if(this.fn2){this.elements.each(function(c,d){b.fn2.apply(d)})}}this.elements=[];this.stopped=true},run:function(){if(this.stopped){return}var d=this;var e=this.elements,c=a(this.selector,this.context),b=c.not(e);this.elements=c;if(this.type){b.bind(this.type,this.fn);if(e.length>0){a.each(e,function(f,g){if(a.inArray(g,c)<0){a.event.remove(g,d.type,d.fn)}})}}else{b.each(function(){d.fn.apply(this)});if(this.fn2&&e.length>0){a.each(e,function(f,g){if(a.inArray(g,c)<0){d.fn2.apply(g)}})}}}};a.extend(a.livequery,{guid:0,queries:[],queue:[],running:false,timeout:null,checkQueue:function(){if(a.livequery.running&&a.livequery.queue.length){var b=a.livequery.queue.length;while(b--){a.livequery.queries[a.livequery.queue.shift()].run()}}},pause:function(){a.livequery.running=false},play:function(){a.livequery.running=true;a.livequery.run()},registerPlugin:function(){a.each(arguments,function(c,d){if(!a.fn[d]){return}var b=a.fn[d];a.fn[d]=function(){var e=b.apply(this,arguments);a.livequery.run();return e}})},run:function(b){if(b!=undefined){if(a.inArray(b,a.livequery.queue)<0){a.livequery.queue.push(b)}}else{a.each(a.livequery.queries,function(c){if(a.inArray(c,a.livequery.queue)<0){a.livequery.queue.push(c)}})}if(a.livequery.timeout){clearTimeout(a.livequery.timeout)}a.livequery.timeout=setTimeout(a.livequery.checkQueue,20)},stop:function(b){if(b!=undefined){a.livequery.queries[b].stop()}else{a.each(a.livequery.queries,function(c){a.livequery.queries[c].stop()})}}});a.livequery.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass","empty","remove","html");a(function(){a.livequery.play()})})(jQuery);;
;/* module-key = 'com.onresolve.jira.groovy.groovyrunner:jqlQueryDoc', location = 'js/jqlQueryDoc.js' */
(function(c){c(function(){function d(){/aggregateExpression/i.test(AJS.$("#advanced-search").val())&&c.ajax({type:"GET",contentType:"application/json",url:AJS.params.baseURL+"/rest/scriptrunner-jira/latest/jqlfunctions/aggregateResult",data:AJS.$("form.navigator-search").serialize(),success:function(e){if(!AJS.$.isEmptyObject(e)){AJS.$("div.notifications").append('\x3cdiv class\x3d"aui-message info"\x3e\x3cspan class\x3d"aui-icon icon-info"\x3e\x3c/span\x3e\x3cdiv id\x3d"aggregate-data"\x3e\x3c/div\x3e\x3c/div\x3e');
c("#aggregate-data").append("\x3ctable\x3e\x3c/table\x3e");var d=c("#aggregate-data").find("table");AJS.$.each(e,function(b,a){d.append("\x3ctr\x3e\x3ctd \x3e\x3cem\x3e"+b+": \x3c/em\x3e \x3c/td\x3e\x3ctd\x3e"+a+"\x3c/td\x3e\x3c/tr\x3e")})}}})}"undefined"==typeof console&&(console={log:function(c){},trace:function(){}});c.get(AJS.params.baseURL+"/rest/scriptrunner-jira/latest/jqlfunctions/docs",function(e){function d(){AJS.$("div.suggestions.dropdown-ready li").each(function(){if(0==c(this).attr("id").indexOf("jql_function_suggest_")){var b=
c(this).text().replace(/\(.*/,"");if(b in e&&(b=e[b],b.enabled)){var a=c(this).html().replace(/\(.*\)/," (");if("args"in b){var d=[];AJS.$.each(b.args,function(b,a){d.push((a.optional?"[":"")+"\x3ci\x3e"+a.description+("\x3c/i\x3e"+(a.optional?"]":"")))});a+=d.join(", ")}a+=")";b.description&&(a=a+" \x3cspan style\x3d'float: right;'\x3e"+b.description+"\x3c/span\x3e ");c(this).html(a)}}})}AJS.$("#jql_function_suggest_0").livequery(function(){var b=AJS.$("div.suggestions").attr("style");if(!/!important/.test(b)){var a=
AJS.$("#jqltext,  #advanced-search");AJS.$("div.suggestions").attr("style",b+"width: "+a.width()+"px!important; max-width: "+a.width()+"px!important; ")}d()})});AJS.$("#advanced-search").livequery(function(){d();AJS.$("#advanced-search").keypress(function(c){13===c.which&&d()})});AJS.$("button.search-button").livequery("click",function(){d()})})})(AJS.$);;
;/* module-key = 'com.atlassian.jirafisheyeplugin:css', location = 'script/fisheye.js' */
AJS.$(function(){AJS.JFEP=AJS.JFEP||{};var a=function(b){AJS.$(".review-filter",b).live("change",function(d){var f=AJS.$(d.target).val(),c=AJS.$(d.target).is(":checked")?"block":"none";AJS.$(".review-status-"+f).css("display",c)});AJS.$(".tab-content",b).find(".project-activity:gt(0)").addClass("hidden");AJS.$("#activity-filter",b).live("change",function(c){var d=AJS.$("#activity-filter").val();AJS.$(".project-activity").addClass("hidden");AJS.$(".limit-"+d).removeClass("hidden")})};AJS.$("#preview-hide-tab",AJS.$(document)).live("click",function(b){AJS.$("#preview_form").submit();b.preventDefault()});if(JIRA.ViewIssueTabs){JIRA.ViewIssueTabs.onTabReady(a)}else{a(document)}AJS.JFEP.reviewIssueToggle=function(){AJS.$(".review-issue-target").addClass("hidden");AJS.$(".review-issue-trigger").click(function(c){c.preventDefault();var b=AJS.$(this).attr("href");AJS.$(b).toggleClass("hidden")})};AJS.JFEP.ignoreCookieName=function(){var b=AJS.$("#header-details-user-fullname").attr("data-username");if(!b){b="__ANON"}return"JFEP.ignoredAppLinks."+b};AJS.JFEP.ignoreAppLink=function(f){var e;var c=document.cookie;if(c.indexOf(AJS.JFEP.ignoreCookieName()+"=")>-1){var d=new RegExp(AJS.JFEP.ignoreCookieName()+"=([^;]*)");e=d.exec(c)[1]}else{e=""}if(e.indexOf(f)==-1){e+=(e.length>0?"|":"")+f;var b=new Date();b.setDate(b.getDate()+365);document.cookie=AJS.JFEP.ignoreCookieName()+"="+e+"; expires="+b.toUTCString()+"; path="+contextPath}};AJS.JFEP.clearIgnoredAppLinks=function(){var b=new Date();b.setDate(b.getDate()-5);document.cookie=AJS.JFEP.ignoreCookieName()+"=expired;expires="+b.toUTCString()+"; path="+contextPath};AJS.$(".ignore-applink").live("click",function(){var b=AJS.$(this).attr("data-id");AJS.JFEP.ignoreAppLink(b);AJS.$(this).parents(".credentials-required-message").slideUp()});AJS.$(".clear-ignored-applinks").live("click",function(){AJS.JFEP.clearIgnoredAppLinks();document.location.reload(true)});AJS.JFEP.loadMoreChangesets=function(c,b,d,e){jQuery("#more-changesets-action-spinner").show();jQuery("#more-changesets-blurb").hide();JIRA.SmartAjax.makeRequest({url:c+"/rest/tabs/1.0/more-changesets/"+b+d,type:"GET",dataType:"json",contentType:"application/json",complete:function(i,f,h){if(!h.successful){var g=(h.status!==401||h.statusText===JIRA.SmartAjax.SmartAjaxResult.TIMEOUT)?JSON.parse(h.data).errorMessages:JIRA.SmartAjax.buildSimpleErrorContent(h);jQuery(document).trigger(JIRA.SERVER_ERROR_EVENT,g)}else{e(h.data.changesets)}}})}});;
;/* module-key = 'com.atlassian.jira.plugin.system.comment-panel:expandablecomments', location = 'js/plugin/comment/comments-expanding.js' */
AJS.$(function($) {
    $(document).on('simpleClick', '.collapsed-comments', function(e) {
        e.preventDefault();

        var collapsedLink = $(this);
        var collapsedLinkBlock = collapsedLink.closest('.message-container');
        var container = collapsedLink.closest('.issuePanelContainer');
        var module = collapsedLink.closest('.module');
        var numCommentsBefore = collapsedLinkBlock.prevAll('.activity-comment').length;
        var numCollapsed = collapsedLink.find('.show-more-comments').data('collapsed-count');

        showLoading();
        makeRequest();

        function showLoading() {
            collapsedLink.find('.show-more-comments').text("Loading...");
        }

        function makeRequest() {
            var url = collapsedLink.attr('href');
            JIRA.SmartAjax.makeRequest({
                url: url,
                method: 'GET',
                headers: { "X-PJAX": true } // needed for the ViewIssue action to return only the activity panel
            }).done(showCollapsed);
        }

        function showCollapsed(html) {
            var commentsToShow = $(html).find('.activity-comment').slice(numCommentsBefore, numCommentsBefore + numCollapsed);
            collapsedLinkBlock.replaceWith(commentsToShow);
            JIRA.trace("jira.issue.comment.expanded");
            JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED, [module, JIRA.CONTENT_ADDED_REASON.panelRefreshed]);

            // Expand the twixi for the first comment
            container.find('.activity-comment:first').removeClass('collapsed').addClass('expanded');
        }
    });
});
;
;/* module-key = 'jira.webresources:momentjs', location = '/includes/jquery/plugins/livestamp/moment.js' */
(function(undefined){var moment,VERSION="2.6.0",globalScope=typeof global!=="undefined"?global:this,oldGlobalMoment,round=Math.round,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,languages={},momentProperties={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},hasModule=(typeof module!=="undefined"&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={"Milliseconds":1,"Seconds":1000,"Minutes":60000,"Hours":3600000,"Days":86400000,"Months":2592000000,"Years":31536000000},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function deprecate(msg,fn){var firstTime=true;function printMsg(){if(moment.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}return extend(function(){if(firstTime){printMsg();firstTime=false}return fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i)}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2)}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Language(){}function Moment(config){checkOverflow(config);extend(this,config)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1000+minutes*60000+hours*3600000;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._bubble()}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}if(b.hasOwnProperty("toString")){a.toString=b.toString}if(b.hasOwnProperty("valueOf")){a.valueOf=b.valueOf}return a}function cloneMoment(m){var result={},i;for(i in m){if(m.hasOwnProperty(i)&&momentProperties.hasOwnProperty(i)){result[i]=m[i]}}return result}function absRound(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function leftZeroFill(number,targetLength,forceSign){var output=""+Math.abs(number),sign=number>=0;while(output.length<targetLength){output="0"+output}return(sign?(forceSign?"+":""):"-")+output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days){rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding)}if(months){rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding)}if(updateOffset){moment.updateOffset(mom,days||months)}}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function isDate(input){return Object.prototype.toString.call(input)==="[object Date]"||input instanceof Date}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++}}return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(inputObject.hasOwnProperty(prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}function makeList(field){var count,setter;if(field.indexOf("week")===0){count=7;setter="day"}else{if(field.indexOf("month")===0){count=12;setter="month"}else{return }}moment[field]=function(format,index){var i,getter,method=moment.fn._lang[field],results=[];if(typeof format==="number"){index=format;format=undefined}getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment.fn._lang,m,format||"")};if(index!=null){return getter(index)}else{for(i=0;i<count;i++){results.push(getter(i))}return results}}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber)}else{value=Math.ceil(coercedNumber)}}return value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0}function checkOverflow(m){var overflow;if(m._a&&m._pf.overflow===-2){overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1;if(m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}m._pf.overflow=overflow}}function isValid(m){if(m._isValid==null){m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated;if(m._strict){m._isValid=m._isValid&&m._pf.charsLeftOver===0&&m._pf.unusedTokens.length===0}}return m._isValid}function normalizeLanguage(key){return key?key.toLowerCase().replace("_","-"):key}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}extend(Language.prototype,{set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[]}for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment.utc([2000,i]);regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._monthsParse[i].test(monthName)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output},isPM:function(input){return((input+"").toLowerCase().charAt(0)==="p")},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return typeof output==="function"?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==="function")?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});function loadLang(key,values){values.abbr=key;if(!languages[key]){languages[key]=new Language()}languages[key].set(values);return languages[key]}function unloadLang(key){delete languages[key]}function getLangDefinition(key){var i=0,j,lang,next,split,get=function(k){if(!languages[k]&&hasModule){try{require("./lang/"+k)}catch(e){}}return languages[k]};if(!key){return moment.fn._lang}if(!isArray(key)){lang=get(key);if(lang){return lang}key=[key]}while(i<key.length){split=normalizeLanguage(key[i]).split("-");j=split.length;next=normalizeLanguage(key[i+1]);next=next?next.split("-"):null;while(j>0){lang=get(split.slice(0,j).join("-"));if(lang){return lang}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return moment.fn._lang}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i] instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.lang().invalidDate()}format=expandFormat(format,m.lang());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function expandFormat(format,lang){var i=5;function replaceLongDateFormatTokens(input){return lang.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict){return parseTokenOneDigit}case"SS":if(strict){return parseTokenTwoDigits}case"SSS":if(strict){return parseTokenThreeDigits}case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"));return a}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=(string.match(parseTokenTimezone)||[]),tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==="+"?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":if(input!=null){datePartArray[MONTH]=(toInt(input)-1)*3}break;case"M":case"MM":if(input!=null){datePartArray[MONTH]=toInt(input)-1}break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input);if(a!=null){datePartArray[MONTH]=a}else{config._pf.invalidMonth=input}break;case"D":case"DD":if(input!=null){datePartArray[DATE]=toInt(input)}break;case"Do":if(input!=null){datePartArray[DATE]=toInt(parseInt(input,10))}break;case"DDD":case"DDDD":if(input!=null){config._dayOfYear=toInt(input)}break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(("0."+input)*1000);break;case"X":config._d=new Date(parseFloat(input)*1000);break;case"Z":case"ZZ":config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":token=token.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":token=token.substr(0,2);if(input){config._w=config._w||{};config._w[token]=input}break}}function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse,fixYear,w,temp,lang,weekday,week;if(config._d){return }currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){fixYear=function(val){var intVal=parseInt(val,10);return val?(val.length<3?(intVal>68?1900+intVal:2000+intVal):intVal):(config._a[YEAR]==null?moment().weekYear():config._a[YEAR])};w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){temp=dayOfYearFromWeeks(fixYear(w.GG),w.W||1,w.E,4,1)}else{lang=getLangDefinition(config._l);weekday=w.d!=null?parseWeekday(w.d,lang):(w.e!=null?parseInt(w.e,10)+lang._week.dow:0);week=parseInt(w.w,10)||1;if(w.d!=null&&weekday<lang._week.dow){week++}temp=dayOfYearFromWeeks(fixYear(w.gg),week,weekday,lang._week.doy,lang._week.dow)}config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}if(config._dayOfYear){yearToUse=config._a[YEAR]==null?currentDate[YEAR]:config._a[YEAR];if(config._dayOfYear>daysInYear(yearToUse)){config._pf._overflowDayOfYear=true}date=makeUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i]}input[HOUR]+=toInt((config._tzm||0)/60);input[MINUTE]+=toInt((config._tzm||0)%60);config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input)}function dateFromObject(config){var normalizedInput;if(config._d){return }normalizedInput=normalizeObjectUnits(config._i);config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond];dateFromConfig(config)}function currentDateArray(config){var now=new Date();if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]}else{return[now.getFullYear(),now.getMonth(),now.getDate()]}}function makeDateFromStringAndFormat(config){config._a=[];config._pf.empty=true;var lang=getLangDefinition(config._l),string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,lang).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){config._pf.unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){config._pf.empty=false}else{config._pf.unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else{if(config._strict&&!parsedInput){config._pf.unusedTokens.push(token)}}}config._pf.charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){config._pf.unusedInput.push(string)}if(config._isPm&&config._a[HOUR]<12){config._a[HOUR]+=12}if(config._isPm===false&&config._a[HOUR]===12){config._a[HOUR]=0}dateFromConfig(config);checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){config._pf.invalidFormat=true;config._d=new Date(NaN);return }for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=extend({},config);tempConfig._pf=defaultParsingFlags();tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue}currentScore+=tempConfig._pf.charsLeftOver;currentScore+=tempConfig._pf.unusedTokens.length*10;tempConfig._pf.score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function makeDateFromString(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){config._pf.iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(string.match(parseTokenTimezone)){config._f+="Z"}makeDateFromStringAndFormat(config)}else{moment.createFromInputFallback(config)}}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);if(input===undefined){config._d=new Date()}else{if(matched){config._d=new Date(+matched[1])}else{if(typeof input==="string"){makeDateFromString(config)}else{if(isArray(input)){config._a=input.slice(0);dateFromConfig(config)}else{if(isDate(input)){config._d=new Date(+input)}else{if(typeof (input)==="object"){dateFromObject(config)}else{if(typeof (input)==="number"){config._d=new Date(input)}else{moment.createFromInputFallback(config)}}}}}}}}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y)}return date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y)}return date}function parseWeekday(input,language){if(typeof input==="string"){if(!isNaN(input)){input=parseInt(input,10)}else{input=language.weekdaysParse(input);if(typeof input!=="number"){return null}}}return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1000),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<45&&["s",seconds]||minutes===1&&["m"]||minutes<45&&["mm",minutes]||hours===1&&["h"]||hours<22&&["hh",hours]||days===1&&["d"]||days<=25&&["dd",days]||days<=45&&["M"]||days<345&&["MM",round(days/30)]||years===1&&["y"]||["yy",years];args[2]=withoutSuffix;args[3]=milliseconds>0;args[4]=lang;return substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=moment(mom).add("d",daysToDayOfWeek);return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;if(input===null||(format===undefined&&input==="")){return moment.invalid({nullInput:true})}if(typeof input==="string"){config._i=input=getLangDefinition().preparse(input)}if(moment.isMoment(input)){config=cloneMoment(input);config._d=new Date(+input._d)}else{if(format){if(isArray(format)){makeDateFromStringAndArray(config)}else{makeDateFromStringAndFormat(config)}}else{makeDateFromInput(config)}}return new Moment(config)}moment=function(input,format,lang,strict){var c;if(typeof (lang)==="boolean"){strict=lang;lang=undefined}c={};c._isAMomentObject=true;c._i=input;c._f=format;c._l=lang;c._strict=strict;c._isUTC=false;c._pf=defaultParsingFlags();return makeMoment(c)};moment.suppressDeprecationWarnings=false;moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)});moment.utc=function(input,format,lang,strict){var c;if(typeof (lang)==="boolean"){strict=lang;lang=undefined}c={};c._isAMomentObject=true;c._useUTC=true;c._isUTC=true;c._l=lang;c._i=input;c._f=format;c._strict=strict;c._pf=defaultParsingFlags();return makeMoment(c).utc()};moment.unix=function(input){return moment(input*1000)};moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso;if(moment.isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else{if(typeof input==="number"){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else{if(!!(match=aspNetTimeSpanJsonRegex.exec(input))){sign=(match[1]==="-")?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}}else{if(!!(match=isoDurationRegex.exec(input))){sign=(match[1]==="-")?-1:1;parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign};duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}}}}}ret=new Duration(duration);if(moment.isDuration(input)&&input.hasOwnProperty("_lang")){ret._lang=input._lang}return ret};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.momentProperties=momentProperties;moment.updateOffset=function(){};moment.lang=function(key,values){var r;if(!key){return moment.fn._lang._abbr}if(values){loadLang(normalizeLanguage(key),values)}else{if(values===null){unloadLang(key);key="en"}else{if(!languages[key]){getLangDefinition(key)}}}r=moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key);return r._abbr};moment.langData=function(key){if(key&&key._lang&&key._lang._abbr){key=key._lang._abbr}return getLangDefinition(key)};moment.isMoment=function(obj){return obj instanceof Moment||(obj!=null&&obj.hasOwnProperty("_isAMomentObject"))};moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i){makeList(lists[i])}moment.normalizeUnits=function(units){return normalizeUnits(units)};moment.invalid=function(flags){var m=moment.utc(NaN);if(flags!=null){extend(m._pf,flags)}else{m._pf.userInvalidated=true}return m};moment.parseZone=function(){return moment.apply(null,arguments).parseZone()};moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000)};extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return +this._d+((this._offset||0)*60000)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();if(0<m.year()&&m.year()<=9999){return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}else{return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){if(this._a){return this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0}return false},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=false;return this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,1);return this},subtract:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,-1);return this},diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=(this.zone()-that.zone())*60000,diff,output;units=normalizeUnits(units);if(units==="year"||units==="month"){diff=(this.daysInMonth()+that.daysInMonth())*43200000;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf("month"))-(that-moment(that).startOf("month")))/diff;output-=((this.zone()-moment(this).startOf("month").zone())-(that.zone()-moment(that).startOf("month").zone()))*60000/diff;if(units==="year"){output=output/12}}else{diff=(this-that);output=units==="second"?diff/1000:units==="minute"?diff/60000:units==="hour"?diff/3600000:units==="day"?(diff-zoneDiff)/86400000:units==="week"?(diff-zoneDiff)/604800000:diff}return asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var sod=makeAs(moment(),this).startOf("day"),diff=this.diff(sod,"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.lang());return this.add({d:input-day})}else{return day}},month:makeAccessor("Month",true),startOf:function(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}else{if(units==="isoWeek"){this.isoWeekday(1)}}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this},endOf:function(units){units=normalizeUnits(units);return this.startOf(units).add((units==="isoWeek"?"week":units),1).subtract("ms",1)},isAfter:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){units=units||"ms";return +this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:function(other){other=moment.apply(null,arguments);return other<this?this:other},max:function(other){other=moment.apply(null,arguments);return other>this?this:other},zone:function(input,keepTime){var offset=this._offset||0;if(input!=null){if(typeof input==="string"){input=timezoneMinutesFromString(input)}if(Math.abs(input)<16){input=input*60}this._offset=input;this._isUTC=true;if(offset!==input){if(!keepTime||this._changeInProgress){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,false)}else{if(!this._changeInProgress){this._changeInProgress=true;moment.updateOffset(this,true);this._changeInProgress=null}}}}else{return this._isUTC?offset:this._d.getTimezoneOffset()}return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm){this.zone(this._tzm)}else{if(typeof this._i==="string"){this.zone(this._i)}}return this},hasAlignedHourOffset:function(input){if(!input){input=0}else{input=moment(input).zone()}return(this.zone()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/86400000)+1;return input==null?dayOfYear:this.add("d",(input-dayOfYear))},quarter:function(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return input==null?year:this.add("y",(input-year))},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add("y",(input-year))},week:function(input){var week=this.lang().week(this);return input==null?week:this.add("d",(input-week)*7)},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add("d",(input-week)*7)},weekday:function(input){var weekday=(this.day()+7-this.lang()._week.dow)%7;return input==null?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this._lang._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){units=normalizeUnits(units);return this[units]()},set:function(units,value){units=normalizeUnits(units);if(typeof this[units]==="function"){this[units](value)}return this},lang:function(key){if(key===undefined){return this._lang}else{this._lang=getLangDefinition(key);return this}}});function rawMonthSetter(mom,value){var dayOfMonth;if(typeof value==="string"){value=mom.lang().monthsParse(value);if(typeof value!=="number"){return mom}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){if(unit==="Month"){return rawMonthSetter(mom,value)}else{return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}function makeAccessor(unit,keepTime){return function(value){if(value!=null){rawSetter(this,unit,value);moment.updateOffset(this,keepTime);return this}else{return rawGetter(this,unit)}}}moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",false);moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",false);moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",false);moment.fn.hour=moment.fn.hours=makeAccessor("Hours",true);moment.fn.date=makeAccessor("Date",true);moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",true));moment.fn.year=makeAccessor("FullYear",true);moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",true));moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.quarters=moment.fn.quarter;moment.fn.toJSON=moment.fn.toISOString;extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);data.days=days%30;months+=absRound(days/30);data.months=months%12;years=absRound(months/12);data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+toInt(this._months/12)*31536000000},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());if(withSuffix){output=this.lang().pastFuture(difference,output)}return this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+"s"]()},as:function(units){units=normalizeUnits(units);return this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang,toIsoString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1000);if(!this.asSeconds()){return"P0D"}return(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+((hours||minutes||seconds)?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":"")}});function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return +this/factor}}for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationAsGetter(i,unitMillisecondFactors[i]);makeDurationGetter(i.toLowerCase())}}makeDurationAsGetter("Weeks",604800000);moment.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12};moment.lang("en",{ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?"th":(b===1)?"st":(b===2)?"nd":(b===3)?"rd":"th";return number+output}});function makeGlobal(shouldDeprecate){if(typeof ender!=="undefined"){return }oldGlobalMoment=globalScope.moment;if(shouldDeprecate){globalScope.moment=deprecate("Accessing Moment through the global scope is "+"deprecated, and will be removed in an upcoming "+"release.",moment)}else{globalScope.moment=moment}}if(hasModule){module.exports=moment}else{if(typeof define==="function"&&define.amd){define("moment",function(require,exports,module){if(module.config&&module.config()&&module.config().noGlobal===true){globalScope.moment=oldGlobalMoment}return moment});makeGlobal(true)}else{makeGlobal()}}}).call(this);;
;/* module-key = 'jira.webresources:momentjs', location = '/includes/jquery/plugins/livestamp/moment.jira.i18n.js' */
(function(moment){var timeUnits=WRM.data.claim("jira.webresources:dateFormatProvider.dateFormat");var map={d:"D",y:"Y",a:"A",E:"d",u:"d",Z:"ZZ",z:"[GMT]ZZ",XX:"ZZ",XXX:"Z"};JIRA.translateSimpleDateFormat=function(pattern){var inQuote=false,skip=false,tmpBuffer="",actuallyTranslate=function(tmpBuffer){return map[tmpBuffer]||_.reduce(tmpBuffer,function(memo,value){return memo+(map[value]||value)},"")},reduction=_.reduce(pattern,function(memo,value,index,list){if(skip){skip=false}else{if(value==="'"){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}if(list[index+1]==="'"){memo+=value;skip=true}else{memo+=!inQuote?"[":"]";inQuote=!inQuote}}else{if(inQuote){memo+=value}else{if(!/[a-zA-Z]/.test(value)){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}memo+=value}else{if(!tmpBuffer||tmpBuffer[tmpBuffer.length-1]===value){tmpBuffer+=value}else{memo+=actuallyTranslate(tmpBuffer);tmpBuffer=value}}}}}return memo},"");if(tmpBuffer){reduction+=actuallyTranslate(tmpBuffer)}return reduction};moment.lang("jira",{months:timeUnits.months,monthsShort:timeUnits.monthsShort,weekdays:timeUnits.weekdays,weekdaysShort:timeUnits.weekdaysShort,weekdaysMin:timeUnits.weekdaysShort,longDateFormat:{LT:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-time")),L:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-day")),LL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-dmy")),LLL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-complete"))},meridiem:function(hours){return timeUnits.meridiem[+(hours>11)]},calendar:{sameDay:"LLL",nextDay:"LLL",nextWeek:"LLL",lastDay:"LLL",lastWeek:"LLL",sameElse:"LLL"},relativeTime:{future:AJS.format("in {0}","%s"),past:AJS.format("{0} ago","%s"),s:"a few seconds",m:"a minute",mm:AJS.format("{0} minutes","%d"),h:"an hour",hh:AJS.format("{0} hours","%d"),d:"a day",dd:AJS.format("{0} days","%d"),M:"a month",MM:AJS.format("{0} months","%d"),y:"a year",yy:AJS.format("{0} years","%d")}})}(moment));;
;/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/time.js' */
(function($,moment){JIRA.Time={};function Type(str,isAge){this.key=str;this.isAge=isAge}var relativize=AJS.Meta.getBoolean("date-relativize");Type.types={};for(var a=["shortAge","longAge","fullAge","short","long","full","timestamp"],i=0,l=a.length,t;i<l;i++){t=a[i];Type.types[t]=new Type(t,t.toLowerCase().indexOf("age")!==-1)}var momentTranslations={};JIRA.Time.FormatType=Type;function getTextForRelativeAge(age,type,param){if(age in momentTranslations){return AJS.format(momentTranslations[age],param)}else{return null}}function getFormatString(type){switch(type.key){case"short":case"shortAge":return"ll";case"long":case"longAge":return"LL";case"full":case"fullAge":return"LLL";case"timestamp":return"LLL";default:return null}}function beginningOfDay(time){return time.clone().hours(0).minutes(0).seconds(0).milliseconds(0)}function isYesterday(now,date){var end=beginningOfDay(now);var start=end.clone().subtract("d",1);return start<=date&&date<end}function isTomorrow(now,date){var start=beginningOfDay(now).add("d",1);var end=start.clone().add("d",1);return start<=date&&date<end}function getMinutesBetween(start,end){return Math.floor(end.diff(start,"minutes",true))}function getHoursBetween(start,end){var hourDiff=end.diff(start,"hours",true);return Math.round(hourDiff)}function getDaysBetween(start,end){return Math.floor(end.diff(start,"days",true))}function formatDateWithFormatString(date,type){var formatString=getFormatString(type);return date.format(formatString)}function formatDateWithRelativeAge(date,type,now){now=now||moment();if(date<=now){if(date>now.clone().subtract("m",1)){return getTextForRelativeAge("aMomentAgo",type)}else{if(date>now.clone().subtract("m",2)){return getTextForRelativeAge("oneMinuteAgo",type)}else{if(date>now.clone().subtract("m",50)){return getTextForRelativeAge("xMinutesAgo",type,getMinutesBetween(date,now))}else{if(date>now.clone().subtract("m",90)){return getTextForRelativeAge("oneHourAgo",type)}else{if(isYesterday(now,date)&&date<now.clone().subtract("h",5)){return getTextForRelativeAge("oneDayAgo",type)}else{if(date>now.clone().subtract("d",1)){return getTextForRelativeAge("xHoursAgo",type,getHoursBetween(date,now))}else{if(date>now.clone().subtract("d",7)){return getTextForRelativeAge("xDaysAgo",type,Math.max(getDaysBetween(date,now),2))}else{if(date>now.clone().subtract("d",8)){return getTextForRelativeAge("oneWeekAgo",type)}}}}}}}}}else{if(date<now.clone().add("m",1)){return getTextForRelativeAge("inAMoment",type)}else{if(date<now.clone().add("m",2)){return getTextForRelativeAge("inOneMinute",type)}else{if(date<now.clone().add("m",50)){return getTextForRelativeAge("inXMinutes",type,getMinutesBetween(now,date))}else{if(date<now.clone().add("m",90)){return getTextForRelativeAge("inOneHour",type)}else{if(isTomorrow(now,date)&&date>now.clone().add("h",5)){return getTextForRelativeAge("inOneDay",type)}else{if(date<now.clone().add("d",1)){return getTextForRelativeAge("inXHours",type,getHoursBetween(now,date))}else{if(date<now.clone().add("d",7)){return getTextForRelativeAge("inXDays",type,Math.max(getDaysBetween(now,date),2))}else{if(date<now.clone().add("d",8)){return getTextForRelativeAge("inOneWeek",type)}}}}}}}}}return formatDateWithFormatString(date,type)}JIRA.Time.formatDate=function formatDate(momentDate,type,forceRelativize){if(momentDate&&type){if((relativize||forceRelativize)&&type.isAge){return formatDateWithRelativeAge(momentDate,type)}else{return formatDateWithFormatString(momentDate,type)}}else{return null}};JIRA.Time.setRelativeTranslations=function(values){for(var k in values){momentTranslations[k]=values[k]}};JIRA.Time.restoreDefaultRelativeTranslations=function(){this.setRelativeTranslations({"inAMoment":"Now","inOneMinute":"In 1 minute","inXMinutes":"In {0} minutes","inOneHour":"In 1 hour","inXHours":"In {0} hours","inOneDay":"Tomorrow","inXDays":"In {0} days","inOneWeek":"In 1 week","aMomentAgo":"Just now","oneMinuteAgo":"1 minute ago","xMinutesAgo":"{0} minutes ago","oneHourAgo":"1 hour ago","xHoursAgo":"{0} hours ago","oneDayAgo":"Yesterday","xDaysAgo":"{0} days ago","oneWeekAgo":"1 week ago"})};JIRA.Time.restoreDefaultRelativeTranslations();JIRA.Time.formatDateWithRelativeAge=formatDateWithRelativeAge;JIRA.Time.formatDateWithFormatString=formatDateWithFormatString}(jQuery,moment));;
;/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/livestamp.js' */
(function($,moment){var timeout,updateInterval=6000,relativize=AJS.Meta.getBoolean("date-relativize"),livestamps=[],prep=function($el,timestamp){$el.data("livestampdata",timestamp);livestamps.push($el)},run=function(){clearTimeout(timeout);update();timeout=setTimeout(run,updateInterval)},update=function(){livestamps=$.grep(livestamps,function($el){var timestamp=$el.data("livestampdata"),forceRelativize=$el.data("relativize"),from,to;if(!moment.isMoment(timestamp)||!$el.closest("html").length){$el.removeData("livestampdata")}else{from=$el.text();var tsFormat=$el.data("datetime-format");tsFormat=tsFormat?tsFormat:"fullAge";if(!(relativize||forceRelativize)){tsFormat=tsFormat.replace("Age","")}to=JIRA.Time.formatDate(timestamp,JIRA.Time.FormatType.types[tsFormat],forceRelativize);if(from!==to){$el.text(to)}}return !!$el.data("livestampdata")})},add=function($el){$el.each(function(){var $this=$(this),timestamp=$this.attr("datetime");if(timestamp){var timestampMoment=isNaN(timestamp)?moment(timestamp).zone(timestamp):moment(parseInt(timestamp,10));prep($this,timestampMoment)}});run();return $el};$.fn.livestamp=function(){return add(this)}}(jQuery,moment));;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-expander', location = 'js/aui-experimental-expander.js' */
(function(D){var E=D(document),C=function(G){var F={};F.$trigger=D(G.currentTarget);F.$content=E.find("#"+F.$trigger.attr("aria-controls"));F.triggerIsParent=F.$content.parent().filter(F.$trigger).length!==0;F.$shortContent=F.triggerIsParent?F.$trigger.find(".aui-expander-short-content"):null;F.height=F.$content.css("min-height");F.isCollapsible=F.$trigger.data("collapsible")!==false;F.replaceText=F.$trigger.attr("data-replace-text");F.replaceSelector=F.$trigger.data("replace-selector");return F},B=function(G){if(G.replaceText){var F=G.replaceSelector?G.$trigger.find(G.replaceSelector):G.$trigger;G.$trigger.attr("data-replace-text",F.text());F.text(G.replaceText)}};var A={"aui-expander-invoke":function(I){var F=D(I.currentTarget);var H=E.find("#"+F.attr("aria-controls"));var G=F.data("collapsible")!==false;if(H.attr("aria-expanded")==="true"&&G){F.trigger("aui-expander-collapse")}else{F.trigger("aui-expander-expand")}},"aui-expander-expand":function(G){var F=C(G);F.$content.attr("aria-expanded","true");F.$trigger.attr("aria-expanded","true");if(F.$content.outerHeight()>0){F.$content.attr("aria-hidden","false")}B(F);if(F.triggerIsParent){F.$shortContent.hide()}F.$trigger.trigger("aui-expander-expanded")},"aui-expander-collapse":function(G){var F=C(G);B(F);F.$content.attr("aria-expanded","false");F.$trigger.attr("aria-expanded","false");if(F.triggerIsParent){F.$shortContent.show()}if(F.$content.outerHeight()===0){F.$content.attr("aria-hidden","true")}F.$trigger.trigger("aui-expander-collapsed")},"click.aui-expander":function(G){var F=D(G.currentTarget);F.trigger("aui-expander-invoke",G.currentTarget)}};E.on(A,".aui-expander-trigger")})(jQuery);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,x,w,q,s,u){if(x in c){var t=c[x];if(w){t.authAdminUri=q;delete c[x]}j(t,w,u)}if(!s&&parent&&(parent!==window)){var v=window;f("iframe",parent.document.body).each(function(y,A){var z=A.contentWindow;if(z!==v){if(z.AJS&&z.AJS.$){z.AJS.$(z.document).trigger("applinks.auth.completion",[x,w,q,true,u])}}})}}function j(q,u,t){var s=f(document);if(u){var r=function(v){if(v.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",[q,t])}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eAuthenticate\u003c/a\u003e to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\"\u003eOAuth access tokens\u003c/a\u003e.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.plugins.jira-transition-triggers-plugin:dev-status-common-resources', location = 'js/workflow/TriggersPluginBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-transition-triggers-plugin:dev-status-common-resources', location = 'js/devstatus/FeedbackDialog.js' */
Backbone.define("JIRA.DevStatus.FeedbackDialog",Backbone.Model.extend({properties:["collectorId","summary"],defaults:{summary:"Tell us what you think.",collectorId:"effe8b72"},show:function(){var a=this.get("collectorId");window.ATL_JQ_PAGE_PROPS=window.ATL_JQ_PAGE_PROPS||{};window.ATL_JQ_PAGE_PROPS[a]={fieldValues:{summary:this.get("summary")},triggerFunction:function(b){_.defer(function(){b()})}};AJS.$.getScript(this._collectorUrlFor(a))},_collectorUrlFor:function(a){return"https://jira.atlassian.com/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-7m3tmj-1988229788/6307/131/1.4.8/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId="+a}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DateUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.Date");JIRA.DevStatus.Date={addTooltip:function(c){var b=c.find("time.livestamp");b.livestamp();b.each(function(){var f=a(this);var e=f.attr("datetime");var g=isNaN(e)?e:+e;var d=moment(g).zone(g);if(!d.isValid()){d=moment(g)}f.attr("title",d.format(JIRA.DevStatus.Date.format))})},format:"LLL"}}(AJS.$));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/Listeners.js' */
Backbone.define("JIRA.DevStatus.Util.Listeners",Class.extend({init:function(){this._listening=[]},startListening:function(a,c,e,b){var d={start:function(){a.on(c,e,b);return this},stop:function(){a.off(c,e,b);return this}};this._listening.push(d.start())},stopListening:function(){_.each(this._listening,function(a){a.stop()});this._listening=[]}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusURLUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.URL");JIRA.DevStatus.URL={getDetailDialogParam:function(){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);return c&&c.queryKey&&c.queryKey.devStatusDetailDialog},getUrlWithDetailDialogParam:function(d){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);c.queryKey.devStatusDetailDialog=encodeURIComponent(d);return this.createUrlFromParsedUri(c)},getCreateReviewDetailUrl:function(b){return this.getUrlWithDetailDialogParam("create-review-"+b)},isCreateReviewDetailDialogLink:function(b){return b&&b.lastIndexOf&&b.lastIndexOf("create-review-",0)===0},getCreateReviewDetailDialogApplicationType:function(b){return b.substring("create-review-".length)},_removeKickAssIHashFromUrl:function(b){return b.replace("i#","")},createUrlFromParsedUri:function(c){var d=[];AJS.$.each(c.queryKey,function(e,f){if(_.isObject(f)){AJS.$.each(f,function(g,h){d.push(e+"="+h)})}else{d.push(e+"="+f)}});var b="";if(c.protocol){b+=c.protocol+"://"}if(c.authority){b+=c.authority}if(c.path){b+=c.path}if(d.length>0){b+="?"+d.join("&")}if(c.anchor){b+="#"+c.anchor}return b}}}(AJS.$));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:fusion-widget-common-clientside', location = 'templates/fusion-widget/fusion-widget-common.soy' */
// This file was automatically generated from fusion-widget-common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.FusionWidget == 'undefined') { JIRA.Templates.FusionWidget = {}; }
if (typeof JIRA.Templates.FusionWidget.Common == 'undefined') { JIRA.Templates.FusionWidget.Common = {}; }


JIRA.Templates.FusionWidget.Common.branches = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#branch|1\x3cbranches}",'<span class="count">',opt_data.count,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.buildsText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var tagStart__soy6 = '<span class="count">';
  var tagEnd__soy7 = '</span>';
  output.append((opt_data.successfulBuildCount > 0) ? (opt_data.failedBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",tagStart__soy6,opt_data.failedBuildCount,tagEnd__soy7) : (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",tagStart__soy6,opt_data.successfulBuildCount,tagEnd__soy7) : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",tagStart__soy6,opt_data.count,tagEnd__soy7) : (opt_data.failedBuildCount > 0) ? (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",tagStart__soy6,opt_data.failedBuildCount,tagEnd__soy7) : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",tagStart__soy6,opt_data.count,tagEnd__soy7) : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} incomplete",tagStart__soy6,opt_data.count,tagEnd__soy7));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.buildsIconClass = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.failedBuildCount > 0) ? 'aui-iconfont-error' : (opt_data.successfulBuildCount > 0) ? 'aui-iconfont-approve' : (opt_data.unknownBuildCount > 0) ? 'aui-iconfont-devtools-task-cancelled' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.commits = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#commit|1\x3ccommits}",'<span class="count">',opt_data.count,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.deployments = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var instanceOne__soy43 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.deploymentsInstance({environment: opt_data.topEnvironments[0], showProjects: opt_data.showProjects}, instanceOne__soy43);
  instanceOne__soy43 = instanceOne__soy43.toString();
  var instanceTwo__soy47 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.deploymentsInstance({environment: opt_data.topEnvironments[1], showProjects: opt_data.showProjects}, instanceTwo__soy47);
  instanceTwo__soy47 = instanceTwo__soy47.toString();
  var instanceThree__soy51 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.deploymentsInstance({environment: opt_data.topEnvironments[2], showProjects: opt_data.showProjects}, instanceThree__soy51);
  instanceThree__soy51 = instanceThree__soy51.toString();
  output.append(AJS.format("{5}Deployed{6} to {0,choice,1#{1}|2#{1} and {2}|3#{1}, {2} and {3}|3\x3c{1}, {2}, {3}, and {4} more}",opt_data.successfulCount,instanceOne__soy43,instanceTwo__soy47,instanceThree__soy51,opt_data.successfulCount - 3,opt_data.anchorStart,opt_data.anchorEnd));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.deploymentsInstance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment) ? '<span class="environment" ' + ((opt_data.showProjects) ? 'title="' + soy.$$escapeHtml(AJS.format("Project: {0}",opt_data.environment.project)) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.environment.title) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.pullRequestsText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#pull request|1\x3cpull requests}",'<span class="count">',opt_data.stateCount,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#review|1\x3creviews}",'<span class="count">',opt_data.stateCount,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsState = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.stateLozenge({isSubtle: opt_data.isSubtle, lozengeClass: opt_data.stateClasses[opt_data.state], text: opt_data.stateText[opt_data.state], classes: opt_data.classes, tooltip: opt_data.tooltip, tooltipClass: opt_data.tooltipClass, tooltipText: opt_data.tooltipText}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.pullRequestsStateViewIssue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'OPEN': 'aui-lozenge-complete', 'MERGED': 'aui-lozenge-success', 'DECLINED': 'aui-lozenge-error'}, stateText: {'OPEN': "OPEN", 'MERGED': "MERGED", 'DECLINED': "DECLINED"}, classes: 'pullrequest-state'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.pullRequestsStateReleaseReport = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'OPEN': 'aui-lozenge-complete', 'MERGED': 'aui-lozenge-success', 'DECLINED': 'aui-lozenge-error'}, stateText: {'OPEN': "Under Review", 'MERGED': "MERGED", 'DECLINED': "DECLINED"}, tooltip: true, tooltipClass: 'fusion-widget-tooltip', tooltipText: opt_data.tooltipText}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'REVIEW': 'aui-lozenge-complete', 'CLOSED': 'aui-lozenge-success', 'DRAFT': 'aui-lozenge-complete', 'DEAD': 'aui-lozenge-error', 'REJECTED': 'aui-lozenge-error', 'UNKNOWN': 'aui-lozenge-error', 'APPROVAL': 'aui-lozenge-current', 'SUMMARIZE': 'aui-lozenge-complete'}, stateText: {'REVIEW': "Open", 'CLOSED': "Closed", 'DRAFT': "Draft", 'DEAD': "Abandoned", 'REJECTED': "Rejected", 'UNKNOWN': "Unknown", 'APPROVAL': "Approval", 'SUMMARIZE': "Summarize"}}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsStateReleaseReport = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'REVIEW': 'aui-lozenge-complete', 'CLOSED': 'aui-lozenge-success', 'DRAFT': 'aui-lozenge-complete', 'DEAD': 'aui-lozenge-error', 'REJECTED': 'aui-lozenge-error', 'UNKNOWN': 'aui-lozenge-error', 'APPROVAL': 'aui-lozenge-complete', 'SUMMARIZE': 'aui-lozenge-complete'}, stateText: {'REVIEW': "Under Review", 'CLOSED': "Closed", 'DRAFT': "Draft", 'DEAD': "Abandoned", 'REJECTED': "Rejected", 'UNKNOWN': "Unknown", 'APPROVAL': "Under Review", 'SUMMARIZE': "Under Review"}, tooltip: true, tooltipClass: 'fusion-widget-tooltip', tooltipText: opt_data.tooltipText}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.stateLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-lozenge aui-lozenge-overflow ', (opt_data.isSubtle) ? 'aui-lozenge-subtle' : '', ' ', soy.$$escapeHtml(opt_data.lozengeClass), ' ', (opt_data.tooltip) ? soy.$$escapeHtml(opt_data.tooltipClass) : '', ' ', (opt_data.classes) ? soy.$$escapeHtml(opt_data.classes) : '', '"', (opt_data.tooltip) ? 'data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipText) + '"' : '', '>', soy.$$escapeHtml(opt_data.text), '</span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/common/devstatus-common.soy' */
// This file was automatically generated from devstatus-common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Common == 'undefined') { JIRA.Templates.DevStatus.Common = {}; }


JIRA.Templates.DevStatus.Common.learnMoreLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.devToolsLearnMoreLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.devToolsLearnMoreLink) + '" class="learn-more-link" target="_blank">' + soy.$$escapeHtml("Learn more") + '</a>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-cta-dialog.soy' */
// This file was automatically generated from devstatus-cta-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Dialog == 'undefined') { JIRA.Templates.DevStatus.Dialog = {}; }


JIRA.Templates.DevStatus.Dialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading">', (opt_data.prompt) ? '<h2>' + soy.$$escapeHtml(opt_data.prompt) + '</h2>' : '', '</div><div class="jira-dialog-content"><ul class="targets">');
  var remoteAppList10 = opt_data.remoteApps;
  var remoteAppListLen10 = remoteAppList10.length;
  for (var remoteAppIndex10 = 0; remoteAppIndex10 < remoteAppListLen10; remoteAppIndex10++) {
    var remoteAppData10 = remoteAppList10[remoteAppIndex10];
    output.append('<li>');
    JIRA.Templates.DevStatus.Dialog.remoteApp(remoteAppData10, output);
    output.append('</li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><button class="aui-button aui-button-link cancel" id="aui-dialog-close">', soy.$$escapeHtml("Cancel"), '</button></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Dialog.remoteApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="target ', (opt_data.primary) ? 'primary' : '', '" data-application-type="', soy.$$escapeHtml(opt_data.applicationType), '" href="', soy.$$escapeHtml(opt_data.url), '">', (opt_data.iconUrl) ? '<img class="application-icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '">' : '<span class="application-icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>', '<div class="title" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</div><div class="base-url" title="', soy.$$escapeHtml(opt_data.baseUrl), '">', soy.$$escapeHtml(opt_data.baseUrl), '</div></a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-panel.soy' */
// This file was automatically generated from devstatus-panel.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }


JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm}, param3);
  aui.message.info({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemAsWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param10 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm}, param10);
  aui.message.warning({content: param10.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if ((! opt_data.errorInstances || opt_data.errorInstances.length == 0) && (! opt_data.notConfiguredInstances || opt_data.notConfiguredInstances.length == 0)) {
    output.append('<p class="connection-error">', "JIRA is having difficulty contacting the applications that supply development status information.", ' ');
    JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
    output.append('</p>');
  } else {
    if (opt_data.errorInstances.length > 0) {
      output.append('<p class="connection-error">');
      JIRA.Templates.DevStatus.connectionProblemMultipleInstances({instances: opt_data.errorInstances}, output);
      output.append(' ');
      JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
      output.append('</p>');
    }
    if (opt_data.notConfiguredInstances && opt_data.notConfiguredInstances.length > 0) {
      output.append('<p class="config-errors">');
      JIRA.Templates.DevStatus.configProblem(opt_data, output);
      output.append('</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.contactAdmin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.adminError) {
    JIRA.Templates.DevStatus.connectionProblemAdminError(opt_data, output);
  } else {
    output.append('<p class="connection-error">');
    if (! opt_data.instances || opt_data.instances.length == 0) {
      output.append("JIRA is having difficulty contacting the applications that supply development status information.");
    } else {
      JIRA.Templates.DevStatus.connectionProblemMultipleInstances(opt_data, output);
    }
    output.append(' ');
    var contactAdminAnchor__soy57 = new soy.StringBuilder('<a id="contact-admin" href="', soy.$$escapeHtml(""), '/secure/ContactAdministrators!default.jspa">');
    contactAdminAnchor__soy57 = contactAdminAnchor__soy57.toString();
    output.append(AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? contactAdminAnchor__soy57 : '',opt_data.showContactAdminForm ? '</a>' : ''), '</p>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemAdminError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="connection-error admin-error">', soy.$$escapeHtml(opt_data.adminError.message), '</p><p class="configure-applinks-link"><a href="', soy.$$escapeHtml(""), '/plugins/servlet/applinks/listApplicationLinks">', soy.$$escapeHtml("Configure Application Links"), '</a></p>');
  if (opt_data.adminError.details) {
    output.append('<p class="connection-error"><a id="replace-text-trigger" data-replace-text="', soy.$$escapeHtml("Hide error details"), '" class="aui-expander-trigger" aria-controls="expander-with-replace-text-content">', soy.$$escapeHtml("Show error details"), '</a></p><div id="expander-with-replace-text-content" class="aui-expander-content admin-error-details"><ul>');
    var detailList79 = opt_data.adminError.details;
    var detailListLen79 = detailList79.length;
    for (var detailIndex79 = 0; detailIndex79 < detailListLen79; detailIndex79++) {
      var detailData79 = detailList79[detailIndex79];
      output.append('<li>', soy.$$escapeHtml(detailData79), '</li>');
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.configProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var servers__soy86 = opt_data.notConfiguredInstances;
  output.append('<span class="description">');
  var server0__soy88 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy86[0]}, server0__soy88);
  server0__soy88 = server0__soy88.toString();
  if (servers__soy86.length == 1) {
    output.append(AJS.format("Couldn\x27\x27t read data from {0}.",server0__soy88));
  } else {
    var server1__soy96 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy86[1]}, server1__soy96);
    server1__soy96 = server1__soy96.toString();
    if (servers__soy86.length == 2) {
      output.append(AJS.format("Couldn\x27\x27t read data from {0} and {1}.",server0__soy88,server1__soy96));
    } else {
      var server2__soy104 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy86[2]}, server2__soy104);
      server2__soy104 = server2__soy104.toString();
      output.append((servers__soy86.length == 3) ? AJS.format("Couldn\x27\x27t read data from {0}, {1}, and {2}.",server0__soy88,server1__soy96,server2__soy104) : AJS.format("Couldn\x27\x27t read data from {0}, {1}, {2}, and {3} other {3,choice,1#application|1\x3capplications}.",server0__soy88,server1__soy96,server2__soy104,servers__soy86.length - 3));
    }
  }
  output.append('</span> <span class="hints">');
  var aOpenLearnMore__soy115 = new soy.StringBuilder('<a href="https://confluence.atlassian.com/x/OQNwGg" target="_blank">');
  aOpenLearnMore__soy115 = aOpenLearnMore__soy115.toString();
  var aOpenApplinks__soy117 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(""), '/plugins/servlet/applinks/listApplicationLinks">');
  aOpenApplinks__soy117 = aOpenApplinks__soy117.toString();
  var aClose__soy121 = new soy.StringBuilder('</a>');
  aClose__soy121 = aClose__soy121.toString();
  output.append(AJS.format("Learn {0}about this issue{1} or go to {2}application links{3} to fix it.",aOpenLearnMore__soy115,aClose__soy121,aOpenApplinks__soy117,aClose__soy121), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemMultipleInstances = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var instance0__soy127 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[0]}, instance0__soy127);
  instance0__soy127 = instance0__soy127.toString();
  if (opt_data.instances.length == 1) {
    output.append(AJS.format("JIRA is having difficulty contacting {0}.",instance0__soy127));
  } else {
    var instance1__soy135 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[1]}, instance1__soy135);
    instance1__soy135 = instance1__soy135.toString();
    if (opt_data.instances.length == 2) {
      output.append(AJS.format("JIRA is having difficulty contacting {0} and {1}.",instance0__soy127,instance1__soy135));
    } else {
      var instance2__soy143 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[2]}, instance2__soy143);
      instance2__soy143 = instance2__soy143.toString();
      output.append(AJS.format("JIRA is having difficulty contacting {0}, {1}, {3,choice,0#and {2}|1#{2}, and another application|1\x3c{2}, and {3} more applications}.",instance0__soy127,instance1__soy135,instance2__soy143,opt_data.instances.length - 3));
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemSingleInstance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="instance" data-name="', soy.$$escapeHtml(opt_data.instance.name), '"><a href="', soy.$$escapeHtml(opt_data.instance.baseUrl), '" title="', soy.$$escapeHtml(opt_data.instance.name), '">', soy.$$escapeHtml(opt_data.instance.name), '</a></span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.labsOnOff = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((! opt_data.isOptedInByAdmin && ! opt_data.isOptedIn) ? '<div class="on-off-panel aui-message closeable"><h2 class="title">' + soy.$$escapeHtml("JIRA Labs") + '</h2><p>' + soy.$$escapeHtml("The new way to see your related commits and pull requests as they occur.") + '</p><span class="aui-icon icon-close labs-close" role="button" tabindex="0" title="' + soy.$$escapeHtml("Close the JIRA Labs panel") + '"></span><div class="aui-group"><div class="aui-item"><button class="toggle-labs aui-button" title="' + soy.$$escapeHtml("Enable JIRA Labs for development panel") + '">' + soy.$$escapeHtml("Enable Labs") + '</button></div></div>' : '<div class="on-off-panel opted-in"><span class="feedback-link"><a href="#" title="' + soy.$$escapeHtml("Give Atlassian feedback about the JIRA development panel") + '">' + soy.$$escapeHtml("Feedback") + '</a></span>' + ((! opt_data.isOptedInByAdmin) ? ' | <span class="disable-labs"><a class="toggle-labs" href="#" title="' + soy.$$escapeHtml("Disable JIRA Labs for the development panel") + '">' + soy.$$escapeHtml("Disable Labs") + '</span></span>' : '') + '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.tryLabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span href="#" class="try-labs" title="', soy.$$escapeHtml("Show the JIRA Labs panel"), '">', soy.$$escapeHtml("Try Labs"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.lastUpdated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastUpdated) {
    output.append('<dd class="sub-text', (opt_data.extraClass) ? ' ' + soy.$$escapeHtml(opt_data.extraClass) : '', '">');
    JIRA.Templates.DevStatus.transitionContainer({content: '<div>' + soy.$$escapeHtml(opt_data.text) + ' <time class="livestamp date user-tz allow-future" ' + ((opt_data.datetimeFormat) ? 'data-datetime-format="' + soy.$$escapeHtml(opt_data.datetimeFormat) + '" ' : '') + 'datetime="' + soy.$$escapeHtml(opt_data.lastUpdated) + '">$' + soy.$$escapeHtml(opt_data.lastUpdated) + '</time></div>'}, output);
    output.append('</dd>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.transitionContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="rolling-container sliding-container"><div class="rolling-content">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog.soy' */
// This file was automatically generated from devstatus-detail-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.frame = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading devstatus-dialog-heading ', (opt_data.tabs.length > 1) ? 'borderless' : '', '"><h2>', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="jira-dialog-content devstatus-dialog-content">');
  JIRA.Templates.DevStatus.DetailDialog.applicationTabs(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.applicationTabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu ', (opt_data.tabs.length == 1) ? 'hidden' : '', '" >');
  var tabList18 = opt_data.tabs;
  var tabListLen18 = tabList18.length;
  for (var tabIndex18 = 0; tabIndex18 < tabListLen18; tabIndex18++) {
    var tabData18 = tabList18[tabIndex18];
    output.append('<li id="tab-menu-', soy.$$escapeHtml(tabData18.type), '" data-application-type=', soy.$$escapeHtml(tabData18.type), ' class="menu-item ', (! opt_data.initialTab && tabIndex18 == 0 || tabData18.type == opt_data.initialTab) ? ' active-tab' : '', '"><a  href="#tab-content-', soy.$$escapeHtml(tabData18.type), '"><strong>', soy.$$escapeHtml(tabData18.name), '</strong><span class="aui-badge devstatus-tab-count">', soy.$$escapeHtml(tabData18.count), '</span></a></li>');
  }
  output.append('</ul><div class="form-body">');
  var tabList36 = opt_data.tabs;
  var tabListLen36 = tabList36.length;
  for (var tabIndex36 = 0; tabIndex36 < tabListLen36; tabIndex36++) {
    var tabData36 = tabList36[tabIndex36];
    output.append('<div class="tabs-pane ', (tabIndex36 == 0) ? 'active-pane' : '', '" id="tab-content-', soy.$$escapeHtml(tabData36.type), '"><div class="status-loading"></div><div class="detail-content-container"></div></div>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.repositoryHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="repository-header', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '"><div class="aui-group aui-group-split repository-header-group"><div class="aui-item project-space">');
  JIRA.Templates.DevStatus.DetailDialog.projectInfo(opt_data, output);
  output.append('</div>', (opt_data.extraContent) ? '<div class="aui-item action-space">' + opt_data.extraContent + '</div>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-avatar" ', (opt_data.repository.avatarDescription) ? 'title="' + soy.$$escapeHtml(opt_data.repository.avatarDescription) + '"' : '', '><span class="aui-avatar aui-avatar-small aui-avatar-project ', (opt_data.repository.avatar) ? 'fusion-avatar-project' : 'default-avatar-project', '">', (opt_data.repository.avatar) ? '<span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(opt_data.repository.avatar) + '" /></span>' : '<span class="aui-avatar-inner aui-icon aui-icon-small aui-iconfont-devtools-repository"></span>', '</span></div><div class="project-info">', (opt_data.repository.url) ? '<a class="repository-link" href="' + soy.$$escapeHtml(opt_data.repository.url) + '"' + ((opt_data.showTooltip) ? ' title="' + soy.$$escapeHtml(opt_data.repository.name) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.repository.name) + '</a>' : '<span class="repository-link" ' + ((opt_data.showTooltip) ? ' title="' + soy.$$escapeHtml(opt_data.repository.name) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.repository.name) + '</span>', '</div><div class="extra-project-info">', (opt_data.showParent && opt_data.repository.parent && opt_data.repository.parent.name && opt_data.repository.parent.url) ? '<a class="fork-off" href="' + soy.$$escapeHtml(opt_data.repository.parent.url) + '"><span class="fork-name" title="' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '">' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '</span></a>' : '', (opt_data.extraProjectInfo) ? opt_data.extraProjectInfo : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.oauthStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-info" /> ', soy.$$escapeHtml(opt_data.message), ' ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.authenticationScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="authentication-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2>', (opt_data.userError) ? '<p class="user-error">' + soy.$$escapeHtml(opt_data.userError) + '</p>' : '', (opt_data.unauthInstances.length > 0) ? '<p>' + soy.$$escapeHtml(AJS.format("Please log in to approve {0,choice,1#this application|1\x3cthese applications}:",opt_data.unauthInstances.length)) + ' <span class="instances"></span></p>' : '');
  if (opt_data.otherInstances.length > 0) {
    JIRA.Templates.DevStatus.connectionProblemAsWarning({instances: opt_data.otherInstances, showContactAdminForm: opt_data.showContactAdminForm}, output);
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="connection-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2>');
  JIRA.Templates.DevStatus.connectionProblem(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="no-permission-to-view-all"><div class="lock-image"></div><span>', soy.$$escapeHtml(opt_data.message), '</span>', (opt_data.secondaryMessage) ? ' <span>' + soy.$$escapeHtml(opt_data.secondaryMessage) + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.timestamp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.timestamp) ? '<time class="livestamp date user-tz" datetime="' + soy.$$escapeHtml(opt_data.timestamp) + '" data-datetime-format="longAge">' + soy.$$escapeHtml(opt_data.timestamp) + '</time>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.vcsUser = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span><div class="vcs-user"><span class="extra-content-in-title ', (opt_data.approved) ? 'fade' : '', '" title="', soy.$$escapeHtml(opt_data.name), '"><img class="author-avatar" src="', soy.$$escapeHtml(opt_data.avatar), '"/></span>', (opt_data.approved) ? '<span class="approved">✓</span>' : '', '</div></span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/build/devstatus-detail-dialog-build.soy' */
// This file was automatically generated from devstatus-detail-dialog-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.build = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.projects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.projectContent({project: projectData3, projectIndex: projectIndex3, withArtifactColumn: opt_data.hasArtifacts, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-builds-container">');
  JIRA.Templates.DevStatus.DetailDialog.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table builds-table', (opt_data.withArtifactColumn) ? ' builds-table-with-artifact-column' : '', '"><table class="aui"><thead><tr><th class="plan">', soy.$$escapeHtml("Plan"), '</th><th class="build cell-type-collapsed">', soy.$$escapeHtml("Latest build"), '</th><th class="result cell-type-collapsed">', soy.$$escapeHtml("Result"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Completed"), '</th>', (opt_data.withArtifactColumn) ? '<th class="actions cell-type-collapsed"></th>' : '', '</tr></thead><tbody>');
  var planList30 = opt_data.project.plans;
  var planListLen30 = planList30.length;
  for (var planIndex30 = 0; planIndex30 < planListLen30; planIndex30++) {
    var planData30 = planList30[planIndex30];
    var planHasArtifacts__soy31 = planData30.build.artifacts && planData30.build.artifacts.length;
    var uniqueIdSuffix__soy32 = opt_data.projectIndex + '-' + planIndex30;
    output.append('<tr class="plan-row', (planHasArtifacts__soy31) ? ' merge' : '', '"><td class="plan">');
    JIRA.Templates.DevStatus.DetailDialog.planName({plan: planData30}, output);
    output.append('</td><td class="build">');
    JIRA.Templates.DevStatus.DetailDialog.buildIcon({build: planData30.build}, output);
    output.append(' <a class="build-link" href="', soy.$$escapeHtml(planData30.build.url), '">', soy.$$escapeHtml(AJS.format("#{0}",planData30.build.buildNumber)), '</a></td><td class="result">');
    JIRA.Templates.DevStatus.DetailDialog.buildResult({build: planData30.build}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: planData30.build.finishedDate}, output);
    output.append('</td>');
    if (opt_data.withArtifactColumn) {
      output.append('<td class="actions">');
      if (planHasArtifacts__soy31) {
        aui.expander.trigger({id: 'detail-dialog-build-show-artifacts-trigger-' + uniqueIdSuffix__soy32, contentId: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy32, tag: 'a', content: "Show artifacts", replaceText: "Hide artifacts"}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
    if (planHasArtifacts__soy31) {
      output.append('<tr class="artifacts"><td colspan="5">');
      var param71 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.artifactsTable({build: planData30.build}, param71);
      aui.expander.content({id: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy32, content: param71.toString()}, output);
      output.append('</td></tr>');
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="builds-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.planName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><span class="plan-name">', (opt_data.plan.isBranch) ? '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a> &rsaquo; <span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</span><a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</a>' : '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a>', '</span>', (opt_data.plan.disabled) ? '<span class="aui-lozenge aui-lozenge-subtle disabled" title="' + soy.$$escapeHtml("This plan is disabled") + '">' + soy.$$escapeHtml("Disabled") + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.build.buildState == 'SUCCESS' || opt_data.build.buildState == 'FAILED') {
    if (opt_data.build.testSummary) {
      var duration__soy131 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.buildDuration(opt_data, duration__soy131);
      duration__soy131 = duration__soy131.toString();
      output.append('<span>', (opt_data.build.testSummary.failedTestCount > 0) ? (opt_data.build.testSummary.successfulTestCount) ? soy.$$escapeHtml(AJS.format("{0} of {1} tests failed in {2}",opt_data.build.testSummary.failedTestCount,opt_data.build.testSummary.totalTestCount,duration__soy131)) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} failed in {1}",opt_data.build.testSummary.failedTestCount,duration__soy131)) : (opt_data.build.testSummary.successfulTestCount > 0) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} passed in {1}",opt_data.build.testSummary.successfulTestCount,duration__soy131)) : (opt_data.build.buildState == 'SUCCESS') ? soy.$$escapeHtml(AJS.format("Passed in {0}",duration__soy131)) : soy.$$escapeHtml(AJS.format("Failed in {0}",duration__soy131)), '</span>');
    }
  } else {
    output.append(soy.$$escapeHtml("Build incomplete"));
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildDuration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.build) ? (opt_data.build.durationInSeconds < 1) ? soy.$$escapeHtml("under 1 second") : (opt_data.build.durationInSeconds < 90) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#second|1\x3cseconds}",opt_data.build.durationInSeconds)) : (opt_data.build.durationInSeconds < 5400) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#minute|1\x3cminutes}",Math.floor(opt_data.build.durationInSeconds / 60))) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#hour|1\x3chours}",Math.floor(opt_data.build.durationInSeconds / 60 / 60))) : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy167 = new soy.StringBuilder((opt_data.build.buildState == 'SUCCESS') ? 'aui-iconfont-approve' : (opt_data.build.buildState == 'FAILED') ? 'aui-iconfont-error' : 'aui-iconfont-devtools-task-cancelled');
  iconClass__soy167 = iconClass__soy167.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy167), '">', soy.$$escapeHtml(opt_data.build.buildState), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var column1Height__soy181 = Math.ceil(opt_data.build.artifacts.length / 3);
  var column2Height__soy182 = Math.ceil((opt_data.build.artifacts.length - 1) / 3);
  var column3Height__soy183 = Math.ceil((opt_data.build.artifacts.length - 2) / 3);
  output.append('<div class="build-artifacts-table"><table class="aui"><tbody>');
  var artifactIndexLimit185 = column1Height__soy181;
  for (var artifactIndex185 = 0; artifactIndex185 < artifactIndexLimit185; artifactIndex185++) {
    output.append('<tr><td>');
    JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185]}, output);
    output.append('</td><td>');
    if (artifactIndex185 < column2Height__soy182) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185 + column1Height__soy181]}, output);
    }
    output.append('</td><td>');
    if (artifactIndex185 < column3Height__soy183) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185 + column1Height__soy181 + column2Height__soy182]}, output);
    }
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.artifact && opt_data.artifact.name) ? (opt_data.artifact.url) ? '<a class="artifact-link" href="' + soy.$$escapeHtml(opt_data.artifact.url) + '">' + soy.$$escapeHtml(opt_data.artifact.name) + '</a>' : soy.$$escapeHtml(opt_data.artifact.name) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/deployment/devstatus-detail-dialog-deployment.soy' */
// This file was automatically generated from devstatus-detail-dialog-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Deployment == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Deployment = {}; }


JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.deploymentProjects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent({project: projectData3, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-deployments-container">');
  JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table deployments-table"><table class="aui"><thead><tr><th class="environment">', soy.$$escapeHtml("Environment"), '</th><th class="status cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="release cell-type-collapsed">', soy.$$escapeHtml("Latest release"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Last deployed"), '</th></tr></thead><tbody>');
  var environmentList20 = opt_data.project.environments;
  var environmentListLen20 = environmentList20.length;
  for (var environmentIndex20 = 0; environmentIndex20 < environmentListLen20; environmentIndex20++) {
    var environmentData20 = environmentList20[environmentIndex20];
    output.append('<tr class="environment-row"><td class="environment">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName({environment: environmentData20}, output);
    output.append('</td><td class="status cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge({environment: environmentData20}, output);
    output.append('</td><td class="release">');
    if (environmentData20.deployedVersion) {
      JIRA.Templates.DevStatus.DetailDialog.Deployment.release({release: environmentData20.deployedVersion}, output);
    }
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: environmentData20.lastDeployed}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="deployments-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', (opt_data.project.description) ? soy.$$escapeHtml(opt_data.project.description) : soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2><div class="ellipsis"><strong class="commit-info">', soy.$$escapeHtml(AJS.format("Commits were in release {0}",opt_data.project.latestVersions[0].name)), '</strong></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="environment-link" href="', soy.$$escapeHtml(opt_data.environment.url), '" title="', (opt_data.environment.description) ? soy.$$escapeHtml(opt_data.environment.description) : soy.$$escapeHtml(opt_data.environment.name), '">', soy.$$escapeHtml(opt_data.environment.name), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment.status == 'DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-success">' + soy.$$escapeHtml("Deployed") + '</span>' : (opt_data.environment.status == 'FAILED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-error">' + soy.$$escapeHtml("Failed") + '</span>' : (opt_data.environment.status == 'NOT_DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle">' + soy.$$escapeHtml("Not deployed") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.release = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.release.url) ? '<a class="release-link" href="' + soy.$$escapeHtml(opt_data.release.url) + '" title="' + soy.$$escapeHtml(opt_data.release.name) + '">' + soy.$$escapeHtml(opt_data.release.name) + '</a>' : soy.$$escapeHtml(opt_data.release.name));
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-commit.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.commit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.canCreateReview) ? '<div class="aui-group aui-group-split"><div class="aui-item"></div><div class="aui-item"><div class="create-review-instance"><a href="#">' + soy.$$escapeHtml("Create review for all commits") + '</a></div></div></div>' : '');
  var repoList8 = opt_data.repositories;
  var repoListLen8 = repoList8.length;
  for (var repoIndex8 = 0; repoIndex8 < repoListLen8; repoIndex8++) {
    var repoData8 = repoList8[repoIndex8];
    JIRA.Templates.DevStatus.DetailDialog.commitContent(soy.$$augmentData(opt_data, {repository: repoData8, repositoryIndex: repoIndex8}), output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commitContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-commits-container', (opt_data.repository.showReviews) ? ' has-reviews' : '', (opt_data.repository.showBranches) ? ' has-branches' : '', (opt_data.repository.showFiles) ? ' has-files' : '', ' ', (opt_data.repository.showCreateReview) ? 'has-actions' : '', '" data-repository-index="', soy.$$escapeHtml(opt_data.repositoryIndex), '" >');
  JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {showParent: true, extraProjectInfo: (opt_data.repository.showInstance && opt_data.repository.instance) ? '<div class="repository-instance" title="' + soy.$$escapeHtml(opt_data.repository.instance.name) + '">(' + soy.$$escapeHtml(opt_data.repository.instance.name) + ')</div>' : '', extraContent: (opt_data.repository.showFiles) ? '<div class="file-expand"><a href="#">' + soy.$$escapeHtml("Show all files") + '</a></div>' : ''}), output);
  output.append('<div class="devstatus-detail-table commits-table"><table class="aui"><thead><tr><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="changeset cell-type-collapsed">', soy.$$escapeHtml("Commit"), '</th><th class="message">', soy.$$escapeHtml("Message"), '</th>', (opt_data.repository.showBranches) ? '<th class="branches"></th>' : '', (opt_data.repository.showReviews) ? '<th class="reviews">' + soy.$$escapeHtml("Reviews") + '</th>' : '', '<th class="timestamp">', soy.$$escapeHtml("Date"), '</th>', (opt_data.repository.showFiles) ? '<th class="filecount">' + soy.$$escapeHtml("Files") + '</th>' : '', (opt_data.repository.showCreateReview) ? '<th class="commit-actions">' + soy.$$escapeHtml("Actions") + '</th>' : '', '</tr></thead><tbody>');
  var commitList76 = opt_data.repository.commits;
  var commitListLen76 = commitList76.length;
  for (var commitIndex76 = 0; commitIndex76 < commitListLen76; commitIndex76++) {
    var commitData76 = commitList76[commitIndex76];
    output.append('<tr data-changesetid="', soy.$$escapeHtml(commitData76.id), '" class="commitrow', (commitData76.merge) ? ' merge' : '', '" data-commit-index="', soy.$$escapeHtml(commitIndex76), '"><td class="author">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(commitData76.author, output);
    output.append('</td><td class="changeset">', (commitData76.url) ? '<a class="changesetid" href="' + soy.$$escapeHtml(commitData76.url) + '">' + soy.$$escapeHtml(commitData76.displayId) + '</a>' : '<span class="changesetid">' + soy.$$escapeHtml(commitData76.displayId) + '</span>');
    if (commitData76.merge) {
      JIRA.Templates.DevStatus.DetailDialog.mergeLozenge(null, output);
    }
    output.append('</td><td class="message"><span class="ellipsis" title="', soy.$$escapeHtml(commitData76.message), '">', soy.$$truncate(soy.$$escapeHtml(commitData76.message), 500, true), '</span></td>');
    JIRA.Templates.DevStatus.DetailDialog.branchesColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    JIRA.Templates.DevStatus.DetailDialog.reviewColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    output.append('<td class="timestamp"><time class="livestamp" datetime="', soy.$$escapeHtml(commitData76.authorTimestamp), '" data-datetime-format="longAge"> ', soy.$$escapeHtml(commitData76.authorTimestamp), '</time></td>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesColumn({count: commitData76.fileCount}, output);
    }
    if (opt_data.repository.showCreateReview) {
      JIRA.Templates.DevStatus.DetailDialog.actionsColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    }
    output.append('</tr>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesRow(soy.$$augmentData(opt_data, {repository: opt_data.repository, commit: commitData76}), output);
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.mergeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-lozenge merge" title="', soy.$$escapeHtml("This commit is a merge"), '">', soy.$$escapeHtml("M"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.repository.showBranches) ? '<td class="branches">' + ((opt_data.commit.branches && opt_data.commit.branches.totalCount > 0) ? '<span class="branches-link aui-lozenge ref-lozenge"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">Branch</span></button>' + ((opt_data.commit.branches.totalCount > 1) ? '<span class="branch-count">' + soy.$$escapeHtml(opt_data.commit.branches.totalCount) + '</span>' : '') + '</span>' : '') + '</td>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="branch-tooltip">');
  var branchList155 = opt_data.branchData.branches;
  var branchListLen155 = branchList155.length;
  for (var branchIndex155 = 0; branchIndex155 < branchListLen155; branchIndex155++) {
    var branchData155 = branchList155[branchIndex155];
    output.append('<div class="branch-name-tooltip">', soy.$$escapeHtml(branchData155.name), '</div>');
  }
  output.append((opt_data.branchData.totalCount > opt_data.branchData.branches.length) ? '<div class="branch-tooltip-summary">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.branchData.totalCount - opt_data.branchData.branches.length)) + '</div>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.repository.showReviews) {
    output.append('<td class="reviews">');
    if (opt_data.commit.reviews && opt_data.commit.reviews.totalCount > 0) {
      output.append('<a class="reviews-link">');
      JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: opt_data.commit.reviews.reviews[0].state}, output);
      output.append('</a>');
    }
    output.append('</td>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.actionsColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="commit-actions">', (opt_data.commit.createReviewUrl) ? '<div class="create-review-commit"><a href="' + soy.$$escapeHtml(opt_data.commit.createReviewUrl) + '">' + soy.$$escapeHtml("Create review") + '</a></div>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="filecount">', (opt_data.count > 0) ? '<a href="#" class="extra-content-in-title" title="' + soy.$$escapeHtml("Click to show files") + '">' + ((opt_data.count < 100) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#file|1\x3cfiles}",opt_data.count)) : soy.$$escapeHtml(AJS.format("{0}+ files",100))) + '</a>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="hidden ', soy.$$escapeHtml(opt_data.commit.fileCount > 0 && opt_data.commit.files ? 'filerow' : ''), '"><td colspan="5">');
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow({files: opt_data.commit.files, max: 5}, output);
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles({files: opt_data.commit.files, fileCount: opt_data.commit.fileCount, instanceName: opt_data.repository.name, moreFilesUrl: opt_data.commit.url}, output);
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table><tbody>');
  var reviewList216 = opt_data.reviewData.reviews;
  var reviewListLen216 = reviewList216.length;
  for (var reviewIndex216 = 0; reviewIndex216 < reviewListLen216; reviewIndex216++) {
    var reviewData216 = reviewList216[reviewIndex216];
    output.append('<tr class="inline-review-row"><td class="inline-review-id"><a href="', soy.$$escapeHtml(reviewData216.url), '">', soy.$$escapeHtml(reviewData216.id), '</a></td><td class="inline-review-state">');
    JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: reviewData216.state}, output);
    output.append('</td></tr>');
  }
  output.append((opt_data.reviewData.totalCount > opt_data.reviewData.reviews.length) ? '<tr><td class="inline-review-summary" colspan="2">' + ((opt_data.reviewData.url) ? '<a href="' + soy.$$escapeHtml(opt_data.reviewData.url) + '">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.reviewData.totalCount - opt_data.reviewData.reviews.length)) + '</a>' : '<span>' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.reviewData.totalCount - opt_data.reviewData.reviews.length)) + '</span>') + '</td></tr>' : '', '</tbody></table>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/commit/devstatus-detail-dialog-commit-files.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit-files.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit.Files == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit.Files = {}; }


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var fileList3 = opt_data.files;
  var fileListLen3 = fileList3.length;
  for (var fileIndex3 = 0; fileIndex3 < fileListLen3; fileIndex3++) {
    var fileData3 = fileList3[fileIndex3];
    if (fileIndex3 < opt_data.max) {
      output.append('<div class="file"><div class="change">');
      if (fileData3.linesAdded != null && fileData3.linesRemoved != null) {
        output.append('<div class="lines">', (fileData3.changeType == 'ADDED') ? '<span class="aui-lozenge added">' + soy.$$escapeHtml("Added") + '</span>' : (fileData3.changeType == 'DELETED') ? '<span class="aui-lozenge removed">' + soy.$$escapeHtml("Deleted") + '</span>' : '<span class="aui-lozenge added count">+' + soy.$$escapeHtml(fileData3.linesAdded) + '</span><span class="aui-lozenge removed count">-' + soy.$$escapeHtml(fileData3.linesRemoved) + '</span>', '</div>');
      } else {
        output.append('<div class="changetype">');
        JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge({changeType: fileData3.changeType}, output);
        output.append('</div>');
      }
      output.append('</div><div class="filename ellipsis">', (fileData3.url) ? '<a href="' + soy.$$escapeHtml(fileData3.url) + '" title="' + soy.$$escapeHtml(fileData3.path) + '">' + soy.$$escapeHtml(fileData3.path) + '</a>' : soy.$$escapeHtml(fileData3.path), '</div></div>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.files.length < opt_data.fileCount) {
    if (opt_data.moreFilesUrl) {
      output.append('<a class="more-files-info" href="', soy.$$escapeHtml(opt_data.moreFilesUrl), '">', soy.$$escapeHtml(AJS.format("See more files in {0}",opt_data.instanceName)), '</a>');
    } else {
      var notShownFileCount__soy56 = opt_data.fileCount - opt_data.files.length;
      output.append('<span class="more-files-info">', soy.$$escapeHtml(AJS.format("and {0} more",notShownFileCount__soy56)), '</span>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var text__soy61 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      text__soy61.append(soy.$$escapeHtml("Added"));
      break;
    case 'COPIED':
      text__soy61.append(soy.$$escapeHtml("Copied"));
      break;
    case 'DELETED':
      text__soy61.append(soy.$$escapeHtml("Deleted"));
      break;
    case 'MOVED':
      text__soy61.append(soy.$$escapeHtml("Moved"));
      break;
    default:
      text__soy61.append(soy.$$escapeHtml("Modified"));
  }
  text__soy61 = text__soy61.toString();
  var class__soy73 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      class__soy73.append('success');
      break;
    case 'COPIED':
      class__soy73.append('current');
      break;
    case 'DELETED':
      class__soy73.append('error');
      break;
    case 'MOVED':
      class__soy73.append('moved');
      break;
    default:
      class__soy73.append('complete');
  }
  class__soy73 = class__soy73.toString();
  output.append('<span class="aui-lozenge aui-lozenge-', soy.$$escapeHtml(class__soy73), ' aui-lozenge-subtle">', soy.$$escapeHtml(text__soy61), '</span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-branch-pullrequest.soy' */
// This file was automatically generated from devstatus-detail-dialog-branch-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.pullRequest = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-pullrequests-container"><div class="devstatus-detail-table pullrequests-table"><table class="aui"><thead><tr><th class="pullrequest-id">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state">', soy.$$escapeHtml("Status"), '</th><th class="author">', soy.$$escapeHtml("Author"), '</th><th class="reviewer">', soy.$$escapeHtml("Reviewer"), '</th><th class="comment cell-type-collapsed"></th><th class="last-updated">', soy.$$escapeHtml("Updated"), '</th></tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var pullRequestList19 = opt_data.pullRequests;
  var pullRequestListLen19 = pullRequestList19.length;
  for (var pullRequestIndex19 = 0; pullRequestIndex19 < pullRequestListLen19; pullRequestIndex19++) {
    var pullRequestData19 = pullRequestList19[pullRequestIndex19];
    output.append('<tr class="pullrequest-row"><td class="pullrequest-id"><a class="pullrequest-link" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.id), '</a></td><td class="title"><a class="pullrequest-link ellipsis" title="', soy.$$escapeHtml(pullRequestData19.name), '" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.name), '</a></td><td class="state">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData19.status, isSubtle: true}, output);
    output.append('</td><td class="author"><img class="author-avatar extra-content-in-title" src="', soy.$$escapeHtml(pullRequestData19.author.avatar), '" title="', soy.$$escapeHtml(pullRequestData19.author.name), '"/></td><td class="reviewer">');
    if (pullRequestData19.reviewers && pullRequestData19.reviewers.length != 0) {
      JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(pullRequestData19, {countThreshold: opt_data.reviewersThreshold}), output);
    }
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: pullRequestData19}, output);
    output.append('</td><td class="last-updated"><time class="livestamp" data-datetime-format="longAge" datetime="', soy.$$escapeHtml(pullRequestData19.lastUpdate), '">', soy.$$escapeHtml(pullRequestData19.lastUpdate), '</time></td></tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commentCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.pullRequest.commentCount) ? '<div class="comment-container"><a class="comment-link" href="' + soy.$$escapeHtml(opt_data.pullRequest.url) + '" title="' + soy.$$escapeHtml("Comments") + '"><span class="aui-icon aui-icon-small aui-iconfont-comment">Comments</span></a><span class="count">' + soy.$$escapeHtml(opt_data.pullRequest.commentCount) + '</span></div>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewersList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer-container">');
  var showThreshold__soy64 = opt_data.countThreshold + 1;
  var indexLimit65 = Math.min(opt_data.countThreshold, opt_data.reviewers.length);
  for (var index65 = 0; index65 < indexLimit65; index65++) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[index65], output);
  }
  if (opt_data.reviewers.length == showThreshold__soy64) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[opt_data.countThreshold], output);
  } else if (opt_data.reviewers.length > showThreshold__soy64) {
    output.append('<span class="aui-badge extrareviewers-tooltip reviewers-link" data-reviewers="', soy.$$escapeHtml(opt_data.extraReviewers), '">', soy.$$escapeHtml(opt_data.reviewers.length - opt_data.countThreshold), '</span>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-branches-container"><div class="devstatus-detail-table branches-table"><table class="aui"><thead><tr><th class="repository">', soy.$$escapeHtml("Repository"), '</th><th class="branch">', soy.$$escapeHtml("Branch"), '</th>', (opt_data.features.lastCommitId) ? '<th class="changeset cell-type-collapsed">' + soy.$$escapeHtml("Last commit") + '</th>' : '', (opt_data.features.lastCommitTimestamp) ? '<th class="last-updated cell-type-collapsed">' + soy.$$escapeHtml("Last modified") + '</th>' : '', (opt_data.features.pullRequests) ? '<th class="pullrequest">' + soy.$$escapeHtml("Pull request") + '</th>' : '', (opt_data.features.reviews) ? '<th class="review">' + soy.$$escapeHtml("Review") + '</th>' : '', (opt_data.features.pullRequests || opt_data.features.reviews) ? '<th class="action">' + soy.$$escapeHtml("Action") + '</th>' : '', '</tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.branchEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var branchList113 = opt_data.branches;
  var branchListLen113 = branchList113.length;
  for (var branchIndex113 = 0; branchIndex113 < branchListLen113; branchIndex113++) {
    var branchData113 = branchList113[branchIndex113];
    output.append('<tr class="branch-row"><td class="repository">');
    JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {repository: branchData113.repository, showTooltip: true}), output);
    output.append('</td><td class="branch">');
    JIRA.Templates.DevStatus.DetailDialog.branchLozenge(branchData113, output);
    output.append('</td>', (opt_data.features.lastCommitId) ? '<td class="changeset cell-type-collapsed">' + ((branchData113.lastCommit && branchData113.lastCommit.displayId) ? (branchData113.lastCommit.url) ? '<a class="changeset-link changesetid" href="' + soy.$$escapeHtml(branchData113.lastCommit.url) + '">' + soy.$$escapeHtml(branchData113.lastCommit.displayId) + '</a>' : '<span class="changeset-link changesetid">' + soy.$$escapeHtml(branchData113.lastCommit.displayId) + '</span>' : '') + '</td>' : '');
    if (opt_data.features.lastCommitTimestamp) {
      output.append('<td class="last-updated cell-type-collapsed">');
      if (branchData113.lastCommit && branchData113.lastCommit.authorTimestamp) {
        JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: branchData113.lastCommit.authorTimestamp}, output);
      }
      output.append('</td>');
    }
    if (opt_data.features.pullRequests) {
      output.append('<td class="pullrequest">');
      JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch(branchData113.pullRequestState, output);
      output.append('</td>');
    }
    if (opt_data.features.reviews) {
      output.append('<td class="review">');
      JIRA.Templates.DevStatus.DetailDialog.reviewStatusForBranch({reviewData: branchData113.reviews}, output);
      output.append('</td>');
    }
    output.append((opt_data.features.pullRequests || opt_data.features.reviews) ? '<td class="action">' + ((branchData113.createPullRequestUrl && branchData113.createPullRequestUrl.length > 0) ? '<a class="create-pullrequest-link" href="' + soy.$$escapeHtml(branchData113.createPullRequestUrl) + '">' + soy.$$escapeHtml("Create pull request") + '</a>' : '') + ((branchData113.createReviewUrl && branchData113.createReviewUrl.length > 0) ? '<a class="create-review-link" href="' + soy.$$escapeHtml(branchData113.createReviewUrl) + '">' + soy.$$escapeHtml("Create review") + '</a>' : '') + '</td>' : '', '</tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.total > 0) {
    output.append('<a href="#" class="pullrequest-tooltip pullrequest-link pullrequest-status" data-detail="', soy.$$escapeHtml(opt_data.data), '">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: opt_data.status, isSubtle: true}, output);
    output.append('</a>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewStatusForBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.reviewData && opt_data.reviewData.totalCount > 0) {
    output.append('<a href="#" class="review-tooltip review-link review-status" data-detail="', soy.$$escapeHtml(opt_data.reviewData.json), '">');
    JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: opt_data.reviewData.reviews[0].state, isSubtle: true}, output);
    output.append('</a>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="pullrequest-link', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '" href="', soy.$$escapeHtml(opt_data.url), '" ><span>', soy.$$escapeHtml(opt_data.id), ' ', soy.$$escapeHtml(opt_data.name), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer"><div class="reviewer-container"><table class="aui"><tbody>');
  var reviewerList212 = opt_data.reviewers;
  var reviewerListLen212 = reviewerList212.length;
  for (var reviewerIndex212 = 0; reviewerIndex212 < reviewerListLen212; reviewerIndex212++) {
    var reviewerData212 = reviewerList212[reviewerIndex212];
    output.append('<tr><td class="reviewer-avatar">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewerData212, output);
    output.append('</td><td class="reviewer-name"><span title="', soy.$$escapeHtml(reviewerData212.name), '">', soy.$$escapeHtml(reviewerData212.name), '</span></td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="aui"><tbody>');
  var pullRequestList224 = opt_data.pullRequests;
  var pullRequestListLen224 = pullRequestList224.length;
  for (var pullRequestIndex224 = 0; pullRequestIndex224 < pullRequestListLen224; pullRequestIndex224++) {
    var pullRequestData224 = pullRequestList224[pullRequestIndex224];
    output.append('<tr><td class="pullrequest-name">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle(pullRequestData224, output);
    output.append('</td><td class="lozenge">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData224.status, isSubtle: false}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestState = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: opt_data.isSubtle, state: opt_data.status, stateClasses: {'OPEN': 'aui-lozenge-complete', 'MERGED': 'aui-lozenge-success', 'DECLINED': 'aui-lozenge-error'}, stateText: {'OPEN': "OPEN", 'MERGED': "MERGED", 'DECLINED': "DECLINED"}, classes: 'pullrequest-state'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="branch-name"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small"></span>', (opt_data.url) ? '<a class="branch-link' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '</a>' : '<span class="branch-link' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '</span>', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-review.soy' */
// This file was automatically generated from devstatus-detail-dialog-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.review = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="devstatus-detail-table detail-reviews-container"><div class="devstatus-detail-table reviews-table"><table class="aui"><thead><tr><th class="review cell-type-collapsed">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="reviewer cell-type-collapsed">', soy.$$escapeHtml("Reviewers"), '</th><th class="comment cell-type-collapsed"></th><th class="timestamp">', soy.$$escapeHtml("Date"), '</th></tr></thead><tbody>');
  var reviewList16 = opt_data.reviews;
  var reviewListLen16 = reviewList16.length;
  for (var reviewIndex16 = 0; reviewIndex16 < reviewListLen16; reviewIndex16++) {
    var reviewData16 = reviewList16[reviewIndex16];
    output.append('<tr data-id="', soy.$$escapeHtml(reviewData16.id), '"><td class="review"><a href="', soy.$$escapeHtml(reviewData16.url), '" class="review-link">', soy.$$escapeHtml(reviewData16.id), '</a></td><td class="title"><span class="ellipsis" title="', soy.$$escapeHtml(reviewData16.title), '">', soy.$$escapeHtml(reviewData16.title), '</span></td><td class="state">');
    JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: reviewData16.state}, output);
    output.append('</td><td class="author">');
    if (reviewData16.author) {
      JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewData16.author, output);
    }
    output.append('</td><td class="reviewer">');
    JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(reviewData16, {countThreshold: opt_data.reviewersThreshold, extraReviewers: reviewData16.extraReviewers}), output);
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: {'commentCount': reviewData16.commentCount, 'url': reviewData16.url}}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(reviewData16, {lastUpdated: reviewData16.lastModified, datetimeFormat: 'longAge', showUpdatedText: false}), output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/util/Helpers.js' */
define("jira-development-status/util/helpers",["underscore"],function(a){return{getContextPath:AJS.contextPath,markStringPropertiesAsSanitised:function b(d){var c=Array.isArray(d)?[]:{};a.each(a.keys(d),function(e){var f=d[e];if(f){if(typeof f==="string"){c[e]=new soydata.SanitizedHtml(f)}else{if(typeof f==="object"){if(a.keys(f).length>0){c[e]=b(f)}}}}});return c}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/util/DevStatusNavigation.js' */
if(!JIRA.DevStatus){AJS.namespace("JIRA.DevStatus")}JIRA.DevStatus.Navigate={getUrl:function(){return window.location.href},reload:function(){_.defer(function(){window.location.reload()})},navigate:function(a){_.defer(function(){window.location=a})},redirectToLogin:function(){this.navigate(AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(window.location.href))}};define("jira-development-status/util/navigate",function(){return JIRA.DevStatus.Navigate});;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/analytics/AnalyticsModel.js' */
Backbone.define("JIRA.DevStatus.AnalyticsModel",Backbone.Model.extend({TO_ANALYTIC_KEY_OVERRIDE:{repository:"commit"},properties:["issue","summary"],initialize:function(a){this.devStatusContainer=a.devStatusContainer;this.devStatusData=a.devStatusData;this._getAllAnalyticData()},getIssue:function(){return this.get("issue")},getSummary:function(){return this.get("summary")},_getAllAnalyticData:function(){this.set("issue",this._getAnalyticIssueData());this._initListenerToData()},_getAnalyticIssueData:function(){return{isAssignee:this.devStatusContainer.data("is-assignee"),isAssignable:this.devStatusContainer.data("is-assignable"),issueStatus:this.devStatusContainer.data("issue-status"),issueType:this.devStatusContainer.data("issue-type")}},_getAnalyticSummaryData:function(c){var a=this;var b={};_.each(c.summary,function(e,d){b[a.TO_ANALYTIC_KEY_OVERRIDE[d]||d]=e.overall.count>0});return b},_initListenerToData:function(){var a=this;this.devStatusData.on("requestSuccess",function(){a.set("summary",a._getAnalyticSummaryData(a.devStatusData.get("aggregatedData")))})}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/CreateReviewFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateReviewFormDialog",Backbone.View.extend({initialize:function(a){this.linkSelector=a.linkSelector;this.applicationType=a.applicationType;this.instances=a.instances;this.issueId=a.issueId;this.dialog.instance=this},renderSuccess:function(){AJS.$(".create-review-instance a").attr("href",JIRA.DevStatus.URL.getCreateReviewDetailUrl(this.applicationType))},_processTargets:function(b){var c=this,a=_.map(b,function(e){var d=_.find(c.instances,function(f){return f.applicationLinkId===e.applicationLinkId});if(!d){return null}return _.extend({},e,d)});return _.sortBy(_.filter(a,_.identity),"name")},dialog:new JIRA.FormDialog({id:"devstatus-cta-create-review-dialog",trigger:".create-review-instance a",width:560,content:function(c){var a=this.instance,b=this;this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:"devstatus.cta.createreview",issueId:this.instance.issueId,processTargets:function(d){return b.instance._processTargets.call(b.instance,d)},uniqueResultAction:function(d){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true);JIRA.DevStatus.Navigate.navigate(d.url)}});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".primary.target").eq(0).focus();AJS.$(".target").click(function(f){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true)})})},autoClose:true})}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/InstancePickerView.js' */
Backbone.define("JIRA.DevStatus.InstancePickerView",Backbone.View.extend({ARROW_KEY_UP_CODE:38,ARROW_KEY_DOWN_CODE:40,template:JIRA.Templates.DevStatus.Dialog.content,events:{"keydown .jira-dialog-content":"_onTargetKeyboardSelect","focus .target":"_onTargetFocus"},initialize:function(a){this.currentSelected=null;this.link=a.activeTrigger;this.cta=a.cta;this.processTargets=a.processTargets;this.issueId=a.issueId;this.uniqueResultAction=a.uniqueResultAction||function(b){JIRA.DevStatus.Navigate.navigate(b.url)}},render:function(){var b=this._getIssueId(this.link),a=AJS.$.Deferred();this._fetchTargets(this.cta,b).done(_.bind(function(c){if(this.processTargets){c.remoteApps=this.processTargets(c.remoteApps)}var e=this._isUniqueResult(c);if(e){this.uniqueResultAction(e)}else{var d=AJS.$(this.template(c));a.resolve(d)}},this)).fail(function(c){a.resolve(c)});return a.promise()},_fetchTargets:function(b,c){var a=AJS.$.Deferred();AJS.$.ajax({url:contextPath+"/rest/dev-status/1.0/issue/targets?cta="+encodeURIComponent(b)+"&issueId="+encodeURIComponent(c)}).done(function(d){a.resolve(d)}).fail(function(e,d){a.reject(JIRA.SmartAjax.buildDialogErrorContent(e).html())});return a.promise()},_getIssueId:function(a){return this.issueId||(a&&a.data("issueid"))||AJS.$("#devstatus-container").data("issue-id")},_isUniqueResult:function(a){return a.remoteApps.length===1&&a.remoteApps[0]},_toggleEntry:function(d,b,a){var c=d.eq(b);a&&c.focus();c.addClass("selected");this.currentSelected=c},_removeSelected:function(){if(this.currentSelected){this.currentSelected.removeClass("selected");this.currentSelected=null}},_onTargetKeyboardSelect:function(d){if(d.type==="keydown"){var c=0;if(d.keyCode===this.ARROW_KEY_UP_CODE){c=-1}else{if(d.keyCode===this.ARROW_KEY_DOWN_CODE){c=1}}if(c!==0){d.preventDefault();var b=this.$el.find(".target");var a=b.index(this.$el.find(".selected"));if(a!==-1){b.eq((a+c)%b.size()).focus()}}}},_onTargetFocus:function(a){this._removeSelected();this._toggleEntry(AJS.$(a.target),0,false)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogView.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogView",Backbone.View.extend({frameEvents:{"click .menu-item":"_doTabClick"},frameTemplate:JIRA.Templates.DevStatus.DetailDialog.frame,oauthStatusTemplate:JIRA.Templates.DevStatus.DetailDialog.oauthStatus,authenticationTemplate:JIRA.Templates.DevStatus.DetailDialog.authenticationScreen,connectionProblemTemplate:JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen,connectionProblemWarningTemplate:JIRA.Templates.DevStatus.connectionProblemAsWarning,noPermissionToViewAllTemplate:JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll,oauthDanceFailedTemplate:JIRA.Templates.DevStatus.DetailDialog.oauthDanceFailed,initialize:function(a){this.options=_.defaults({},a,{width:560,model:new JIRA.DevStatus.BaseDetailDialogModel(a)});this.model=this.options.model;this._initFetchHandlers();this._initFormDialog()},renderSuccess:function(b,a){return this},shouldRefreshOnTabSwitch:function(a){return false},getTitle:function(b,a){console.warn("Unimplemented getTitle() function",this);return a},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more information by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related development information"},getConnectionMessageInCanvas:function(){return "Unable to retrieve development information"},getNoPermissionToViewAllMessageInCanvas:function(){return "Unable to retrieve development information"},getContactAdmistratorsOrLoginMessageInCanvas:function(){if(JIRA.Users.LoggedInUser.isAnonymous()){return "You might be able to view more by authenticating with JIRA."}else{return "Please contact your administrator."}},hasData:function(a){return a.length>0},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},_getPane:function(a){return a?this.$el.find("#tab-content-"+a.replace(/(:|\.|\[|\])/g,"\\$1")):AJS.$()},getContentContainer:function(a){return this._getPane(a||this._getActiveApplicationType()).find(".detail-content-container")},_doTabClick:function(b){b.preventDefault();var a=this._getActiveApplicationType();this.model.switchTab(a,this.shouldRefreshOnTabSwitch(a));this.analytics&&this.analytics.fireDetailTabClicked(a)},_redirectToLoginIf401:function(a){if(a&&a.status===401){JIRA.DevStatus.Navigate.redirectToLogin();return true}return false},_initFetchHandlers:function(){this.model.on("fetchRequested",this._showLoadingIndicator,this);this.model.on("fetchSucceeded",this._handleFetchSucceeded,this);this.model.on("fetchFailed",this._handleFetchFailed,this)},_handleFetchSucceeded:function(c,a){this._hideLoadingIndicator(c);var b=a.detail&&this.hasData(a.detail);if(b){this.renderSuccess(c,a.detail)}this._renderError(c,a.errors,b);this._postRender()},_handleFetchFailed:function(b,a){this._hideLoadingIndicator(b);if(!this._redirectToLoginIf401(a)){this._renderError(b,[],false,true)}},_initAuthenticationCallbacks:function(){this._patchAJSIconsForAppLinks();var a=this;var f=function(h,g){a.model.oauthStatusChanged(g.appType);a.model.fetchAuthenticationStatuses();h.preventDefault()};var c=function(g){var h=null;if(g.id&&g.appUri&&g.appName&&g.appType){h={applicationLinkId:g.id,baseUrl:g.appUri,name:g.appName,type:g.appType}}return h};var b=function(i,h){var g=AJS.$("html");var k=g.is(".msie")&&!g.is(".msie-gt-9");if(k){h.adminErrorDetails=AJS.$.map(h.adminErrorDetails,function(p){return p})}var n=[c(i)];var o=require("jira-development-status/util/helpers");var l=o.markStringPropertiesAsSanitised(h);var m=function(){if(JIRA.isAdmin()){a._renderConnectionError(a.model._getCurrentApplicationType(),n,{message:l.adminError,details:l.adminErrorDetails})}else{a._renderConnectionError(a.model._getCurrentApplicationType(),n)}};var j=function(){a._renderAuthenticationError(a.model._getCurrentApplicationType(),n,[],l.userError)};if(l.adminError){m()}else{if(l.userError){j()}}};var e=function(i,g,h){if(h){b(g,h)}AJS.$.ajax(AJS.contextPath()+"/rest/auth/1/session").promise().fail(function(j){a._redirectToLoginIf401(j)})};var d=AJS.$(document);d.bind("applinks.auth.approved",f);d.bind("applinks.auth.denied",e);AJS.$(this.dialog).bind("Dialog.beforeHide",function(){d.unbind("applinks.auth.approved",f);d.unbind("applinks.auth.denied",e);a.instanceListPopup&&a.instanceListPopup.remove()});AJS.$('<div class="applinks-auth-confirmation-container hidden"></div>').appendTo(this.$el)},_initFetchAuthenticationHandlers:function(){this.model.on("fetchAuthRequested",this._showLoadingIndicator,this);this.model.on("fetchAuthSucceeded",this._handleAuthSucceeded,this);this.model.on("fetchAuthFailed",this._handleAuthFailed,this)},_handleAuthSucceeded:function(b){var a=this;var d=_.filter(b,function(e){return e.configured&&!e.authenticated&&e.source&&e.source.applicationLinkId});var c=this._getOAuthStatusDiv();if(d.length>0&&!JIRA.Users.LoggedInUser.isAnonymous()){c.html(this.oauthStatusTemplate({message:this.getOAuthMessageInFooter(d)}));this._renderUnauthInstancesInFooter(d);c.show()}else{c.hide()}},_handleAuthFailed:function(a){this._redirectToLoginIf401(a);this._getOAuthStatusDiv().hide()},_renderUnauthInstancesInFooter:function(c){var b=this._getOAuthStatusDiv();var d=_.map(_.pluck(c,"source"),this._createOAuthInstanceDiv);if(d.length>0){b.append(d[0]);if(d.length>1){b.append(", ");b.append(d[1]);if(d.length>2){b.append(" ");var e=AJS.$('<span class="more-instances"><a href="#">'+"... more"+"</a></span>");b.append(e);var a=AJS.$('<ul class="instance-list"></ul>');_.each(d.slice(2),function(f){a.append(AJS.$('<li class="instance-in-popup"></li>').append(f))});AJS.InlineDialog(e,"instance-list-popup",function(g,f,h){g.html(a);h();return false},{width:150,offsetX:-100,onTop:true})}}}},_createOAuthInstanceDiv:function(a){var b=ApplinksUtils.createAuthRequestInline(null,{id:a.applicationLinkId,authUri:AJS.contextPath()+"/plugins/servlet/applinks/oauth/login-dance/authorize?applicationLinkID="+encodeURIComponent(a.applicationLinkId),appUri:a.baseUrl,appName:a.name,appType:a.type});return AJS.$('<span class="instance"></span>').append(b.find("a.applink-authenticate").text(a.name))},_patchAJSIconsForAppLinks:function(){AJS.icons=AJS.icons||{};AJS.icons.addIcon=AJS.icons.addIcon||{};AJS.icons.addIcon.init=AJS.icons.addIcon.init||function(){}},_getOAuthStatusDiv:function(){var a=this.$el.find(".buttons-container .oauth-status");if(a.length){return a}else{return AJS.$('<div class="oauth-status" />').appendTo(this.$el.find(".buttons-container.form-footer"))}},_renderError:function(f,g,d,c){var a=_.groupBy(g,function(h){var i=h.error;if(i==="unauthorized"||i==="incapable"){return i}else{return"others"}});var b=_.pluck(a.unauthorized,"instance");var e=_.pluck(a.others,"instance");if(b.length>0){this.model.fetchAuthenticationStatuses()}if(d){if(e.length>0){this._renderConnectionErrorBeforeData(f,e)}}else{if(b.length>0){this._renderAuthenticationError(f,b,e)}else{if(c||e.length>0){this._renderConnectionError(f,e)}else{this._renderNoPermissionToViewAllWarning(f)}}}},_renderConnectionErrorBeforeData:function(b,a){this.getContentContainer(b).prepend(this.connectionProblemWarningTemplate({instances:a,showContactAdminForm:this.options.showContactAdminForm}))},_renderConnectionError:function(c,b,a){this.getContentContainer(c).html(this.connectionProblemTemplate({instances:b,adminError:a,showContactAdminForm:this.options.showContactAdminForm,title:this.getConnectionMessageInCanvas()}))},renderNoPermissionToViewAllWarningAtBottom:function(c,d){var a=this.model.get("tabs")[c]||{};var b=this.model.get("contentMap")[c]||{};if(d<a.count){if((b.errors||[]).length===0||JIRA.Users.LoggedInUser.isAnonymous()){this.getContentContainer(c).append(this._getNoPermissionToViewAllHtml())}}},_getNoPermissionToViewAllHtml:function(){return this.noPermissionToViewAllTemplate({message:this.getNoPermissionToViewAllMessageInCanvas(),secondaryMessage:this.getContactAdmistratorsOrLoginMessageInCanvas()})},_renderNoPermissionToViewAllWarning:function(a){this.getContentContainer(a).html(this._getNoPermissionToViewAllHtml())},_renderAuthenticationError:function(g,d,f,c){var a=this.getContentContainer(g);a.html(this.authenticationTemplate({unauthInstances:d,title:this.getOAuthMessageInCanvas(),otherInstances:f,showContactAdminForm:this.options.showContactAdminForm,userError:c}));var e=_.map(d,this._createOAuthInstanceDiv);var b=a.find(".instances");_.each(e,function(i,h){if(h!==0){b.append(", ")}b.append(i)})},_initFormDialog:function(){var a=this;this.dialog=new JIRA.FormDialog({id:this.options.id,width:this.options.width,content:function(b){a.setElement(this.$popup);a.delegateEvents(_.extend({},a.frameEvents,a.events));a._renderFrame();a._initAuthenticationCallbacks();a._initFetchAuthenticationHandlers();a.model.fetchAuthenticationStatuses();a.model.switchTab(a._getActiveApplicationType());b()},autoClose:true})},_postRender:function(){this.$el.find(".extra-content-in-title").tooltip();this.dialog._positionInCenter();this.$el.find(".active-pane a:eq(0)").focus()},_getActiveApplicationType:function(){return this.$el.find(".menu-item.active-tab").data("applicationType")},_showLoadingIndicator:function(c){var a=this._getPane(c);a._removeClass("ready");a.addClass("loading");var b=a.find(".status-loading");b.spin("large");b.show()},_hideLoadingIndicator:function(c){var a=this._getPane(c);a.addClass("ready");var b=a.find(".status-loading");if(b){a.removeClass("loading");b.hide();b.spinStop()}},_renderFrame:function(){this.$el.html(this.frameTemplate({title:this.getTitle(this.options.count,this.options.issueKey),tabs:this._convertTabsForSoy(),initialTab:this.options.initialTab}));if(this.options.height){this.$el.find(".form-body").css("min-height",this.options.height)}},_convertTabsForSoy:function(){return _.chain(this.model.get("tabs")).map(function(b,a){return _.extend({type:a},b)}).sortBy(function(a){return a.type}).value()},_createReviewersInlineDialog:function(){this.reviewerInlineDialogView=new JIRA.DevStatus.ReviewerInlineDialogView({el:this.$el.find(".extrareviewers-tooltip")});return this.reviewerInlineDialogView},_sortReviewsByStatus:function(a){var b=["REVIEW","APPROVAL","SUMMARIZE","REJECTED","CLOSED"];return _.chain(a).filter(function(c){return _.contains(b,c.state)}).sortBy(function(c){return _.indexOf(b,c.state)}).value()},_setupReviewsPopup:function(f,b,a,c){f.preventDefault();var d=AJS.$(f.currentTarget);if(!d.data("inline-dialog-inited")){var g="commit-reviews-popup-"+(this._tooltipSeq++);this.activeReviewsToolTip=AJS.InlineDialog(d,g,function(i,e,j){var h=b(AJS.$(e));a&&a();i.html(JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog({reviewData:h}));if(c){i.find("a").click(c)}j()},{cacheContent:false,hideDelay:200,showDelay:50,onHover:true,width:false});d.data("inline-dialog-inited",true).mouseenter()}},_removeInlineDialog:function(a){if(this[a]){this[a].hide();this[a].remove();this[a]=undefined}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogModel.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogModel",Backbone.Model.extend({TAB_PREFIX:"#tab-menu-",PANE_PREFIX:"#tab-content-",properties:["tabs","contentMap","oauthStatuses","selectedTab","selectedPane"],namedEvents:["fetchRequested","fetchFailed","fetchSucceeded","fetchAuthRequested","fetchAuthFailed","fetchAuthSucceeded"],initialize:function(a){this.issueKey=a.issueKey;this.issueId=a.issueId;this.type=a.dataType;this.set("contentMap",{});this.set("tabs",a.tabs)},switchTab:function(b,a){this.set("selectedTab",this.TAB_PREFIX+b);this.set("selectedPane",this.PANE_PREFIX+b);if(this.get("contentMap")[b]==null||a){this._fetchContents(b)}},_fetchContents:function(a){this.trigger("fetchRequested",a);this._handleFetch(a,AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/issue/detail",data:{issueId:this.issueId,applicationType:a,dataType:this.type}}).promise())},_handleFetch:function(c,b){var a=this;b.done(function(d){a._fireSuccessResult(c,d)}).fail(function(e,d){a._fireFailResult(c,e)})},_fireSuccessResult:function(b,a){this._updateContents(b,a);this.trigger("fetchSucceeded",b,a)},_fireFailResult:function(b,a){this._updateContents(b);this.trigger("fetchFailed",b,a)},_updateContents:function(b,a){this.get("contentMap")[b]=a},fetchAuthenticationStatuses:function(){var b=_.keys(this.get("tabs")||{});if(!_.isEmpty(b)){var a=this;AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/provider/auth-status",data:{applicationType:b}}).promise().done(function(c){if(c&&c.data){a._updateOAuthStatuses(c.data);a.trigger("fetchAuthSucceeded",c.data)}else{a._updateOAuthStatuses();a.trigger("fetchAuthFailed",null,c)}}).fail(function(d,c){a._updateOAuthStatuses();a.trigger("fetchAuthFailed",d)})}},oauthStatusChanged:function(b){if(_.has(this.get("tabs"),b)){var a=this._getCurrentApplicationType();if(a===b){this._fetchContents(a)}else{this.get("contentMap")[b]=null}}},_getCurrentApplicationType:function(){var a=this.get("selectedTab");if(a){return a.slice(this.TAB_PREFIX.length)}return null},_updateOAuthStatuses:function(a){this.set("oauthStatuses",a)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/ReviewerInlineDialogView.js' */
Backbone.define("JIRA.DevStatus.ReviewerInlineDialogView",JIRA.DevStatus.BaseDetailDialogView.extend({extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{mouseenter:"_onHoverExtraReviewersToolTip",click:"_onClickExtraReviewersToolTip"},_tooltipSeq:1,_onHoverExtraReviewersToolTip:function(c){c.preventDefault();var a=this;var b=AJS.$(c.currentTarget);if(!b.data("inline-dialog-inited")){var d="extrareviewers-tooltip-"+(this._tooltipSeq++);this.activeExtraReviewersToolTip=AJS.InlineDialog(b,d,function(g,f,h){var e=AJS.$(f);g.html(a.extraReviewersToolTipTemplate({reviewers:e.data("reviewers")}));a.activeExtraReviewersToolTip.$content=g;h()},{cacheContent:false,hideDelay:200,onHover:true,width:false});b.data("inline-dialog-inited",true).mouseenter()}},_onClickExtraReviewersToolTip:function(a){if(this.activeExtraReviewersToolTip){a.stopPropagation()}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/build/DetailDialogBuildView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBuildView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.build,events:{"click a.project-link":"_onClickProjectLink","click a.plan-link":"_onClickPlanLink","click a.build-link":"_onClickBuildLink"},initialize:function(a){this.analytics=JIRA.DevStatus.BuildsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"build",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.projects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,projects:this.sortProjectsAndPlans(c),hasArtifacts:this.hasArtifacts(c)}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getBuildCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#build|1\u003cbuilds}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more builds by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related builds"},getConnectionMessageInCanvas:function(){return "Unable to retrieve build information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related builds."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.projects||[])},[]).length>0},sortProjectsAndPlans:function(a){a=_.sortBy(a,function(b){return _.last(_.sortBy(b.plans,function(c){return c.build.finishedDate})).build.finishedDate}).reverse();_.each(a,function(b){b.plans=_.sortBy(b.plans,function(c){return c.build.finishedDate}).reverse()});return a},hasArtifacts:function(a){return _.any(a,function(b){return _.any(b.plans,function(c){return c.build&&c.build.artifacts&&c.build.artifacts.length})})},getBuildCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.plans,"key")})).length},_onClickProjectLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailProjectClicked()},_onClickPlanLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailPlanClicked()},_onClickBuildLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailBuildClicked()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/deployment/DetailDialogDeploymentView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogDeploymentView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment,events:{"click a.project-link":"_onClickProjectLink","click a.environment-link":"_onClickEnvironmentLink","click a.release-link":"_onClickReleaseLink"},initialize:function(a){this.analytics=JIRA.DevStatus.DeploymentsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"deployment",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.deploymentProjects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,deploymentProjects:this.sortProjects(c)}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getEnvironmentCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#deployment|1\u003cdeployments}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more deployments by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related deployments"},getConnectionMessageInCanvas:function(){return "Unable to retrieve deployment information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related deployments."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.deploymentProjects||[])},[]).length>0},sortProjects:function(a){return _.sortBy(a,function(b){return _.last(_.sortBy(b.environments,function(c){return new Date(c.lastDeployed||0).getTime()})).lastDeployed}).reverse()},getEnvironmentCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.environments,"environmentId")})).length},_onClickProjectLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailProjectClicked()},_onClickEnvironmentLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailEnvironmentClicked()},_onClickReleaseLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailReleaseClicked()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogCommitView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogCommitView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.commit,events:{"click a.repository-link":"_onClickRepositoryLink","click a.changesetid":"_onClickChangesetId","click .filecount a":"_onClickFiles","click .file-expand a":"_onClickExpand","click .create-review-commit a":"_onClickCreateReview","click .filename a":"_onClickFile","mouseenter .reviews-link":"_onHoverReviewsToolTip",click:"_onClickReviewsToolTip"},initialize:function(a){this.analytics=JIRA.DevStatus.CommitsAnalytics;this.issueId=a.issueId;var c=AJS.Meta.get("fusion-open-detail-dialog");var b;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(c)){b=JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(c)}JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"commit",width:1000,height:400,initialTab:b},a))},concatResults:function(a){return _.reduce(a,function(b,d){var c=d.repositories||[];_.each(c,function(e){e.showInstance=d._instance&&!d._instance.singleInstance;e.instance=d._instance});return b.concat(c)},[])},_clipEllipsis:function(){function a(b){return b.outerWidth()}this.$el.find(".detail-content-container .file .ellipsis").each(function(b,f){var e=AJS.$(f);var c=a(e);if(c==0){return}var d=e.find("a");if(a(d)>c){var g=d.text();while(a(d)>c){g=g.slice(1);d.text("\u2026"+g)}}})},renderSuccess:function(e,a){var c=this.concatResults(a);var b=this.getContentContainer(e);this.transformedRepositories=this.transformRepositories(c);var d=this.setupCreateReviewDialog(this.transformedRepositories);b.html(this.template({applicationType:e,repositories:this.transformedRepositories,canCreateReview:d}));this.renderNoPermissionToViewAllWarningAtBottom(e,this.getUniqueCommitCount(c));JIRA.DevStatus.Date.addTooltip(b);this.setupBranchesTooltip();this.createReviewDialog&&this.createReviewDialog.renderSuccess();return this},setupCreateReviewDialog:function(a){var c=_.chain(a).filter(function(e){return e.showCreateReview}).pluck("instance").value();var d=false;if(c.length){this.createReviewDialog=new JIRA.DevStatus.CreateReviewFormDialog({analytics:this.analytics,applicationType:this._getActiveApplicationType(),issueId:this.issueId,instances:c});d=true}var b=AJS.Meta.get("fusion-open-detail-dialog");if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(b)&&JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(b)===this._getActiveApplicationType()){AJS.Meta.set("fusion-open-detail-dialog",undefined);if(d){this.createReviewDialog.dialog.show()}}return d},_tooltipSeq:1,_onHoverReviewsToolTip:function(b){var a=this;this._setupReviewsPopup(b,function(c){return a._getCommitDetails(c).reviews},function(){JIRA.DevStatus.CommitsAnalytics.fireDetailReviewsShown(a._getActiveApplicationType())},function(){a._onClickReview(b)})},_onClickReviewsToolTip:function(a){if(this.activeReviewsToolTip){a.stopPropagation()}},setupBranchesTooltip:function(){var a=this;AJS.$(".branches-link").tooltip({title:function(){var b=a._getCommitDetails(AJS.$(this)).branches;JIRA.DevStatus.CommitsAnalytics.fireDetailBranchesShown(a._getActiveApplicationType());return JIRA.Templates.DevStatus.DetailDialog.branchesTooltip({branchData:b})},html:true})},getTitle:function(d,b){var a=_.chain(this.model.get("tabs")).map(function(e){return e.count}).reduce(function(e,f){return e+f},0).value();var c=Math.max(a-d,0);return AJS.$.trim(AJS.format("{1}: {0} unique {0,choice,1#commit|1\u003ccommits}{2,choice,0# |0\u003c (and {2} duplicates)}",d,b,c))},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more commits by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related commits"},getConnectionMessageInCanvas:function(){return "Unable to retrieve commit information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related commits."},hasData:function(a){return this.concatResults(a).length>0},transformRepositories:function(b){b=this.sortRepositoriesAndCommits(b);var a=this;var c=[["reviews","showReviews"],["branches","showBranches"],["files","showFiles"],["createReviewUrl","showCreateReview"]];_.each(c,function(d){b=a._setRepositoryFromFromCommitField(b,d[0],d[1])});b=this.prepareReviews(b);return b},_setRepositoryFromFromCommitField:function(b,c,a){_.each(b,function(d){d[a]=_.find(d.commits,function(e){return e[c]!=null})!=null});return b},prepareReviews:function(b){var a=this;_.each(b,function(c){_.each(c.commits,a._orderCommitReviews,a)});return b},_orderCommitReviews:function(a){if(a.reviews&&a.reviews.reviews){a.reviews.reviews=this._sortReviewsByStatus(a.reviews.reviews)}},sortRepositoriesAndCommits:function(a){a=_.sortBy(a,function(b){return b.name.toLowerCase()});_.each(a,function(b){b.commits=_.sortBy(b.commits,"authorTimestamp").reverse()});return a},getUniqueCommitCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.filter(_.pluck(b.commits,"id"),function(c){return c})})).length},_getRepoDetails:function(a){return this.transformedRepositories[parseInt(a.parents(".detail-commits-container").data("repository-index"))]},_getCommitDetails:function(a){return this._getRepoDetails(a).commits[parseInt(a.parents("tr").data("commit-index"))]},_onClickRepositoryLink:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickChangesetId:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailCommitClicked(this._getActiveApplicationType())},_onClickExpand:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target));if(a.toggle(a.getRows())){JIRA.DevStatus.CommitsAnalytics.fireDetailFilesExpandedClicked(this._getActiveApplicationType())}this._clipEllipsis()},_onClickFiles:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target)).toggle(AJS.$(b.target).closest(".commitrow").next(".filerow"));this._clipEllipsis();if(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileExpandedClicked(this._getActiveApplicationType())}},_onClickCreateReview:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(this._getActiveApplicationType(),false)},_onClickReview:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailReviewClicked(this._getActiveApplicationType())},_onClickFile:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailFileClicked(this._getActiveApplicationType())},_getFileExpand:function(a){var c=a.closest(".detail-commits-container");function b(d){return d.length>d.filter(".hidden").length}return{getRows:function(){return c.find(".filerow")},toggle:function(e){var d=b(e);e.toggleClass("hidden",d);this._updateExpandLabel();return !d},_updateExpandLabel:function(){c.find(".file-expand a").text(b(this.getRows())?"Hide files":"Show all files")}}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogBranchView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBranchView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.branch,pullRequestToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip,STATE_ORDER:["OPEN","MERGED","DECLINED"],events:{"click a.repository-link":"_onClickRepositoryLink","click a.branch-link":"_onClickBranchLink","click a.pullrequest-link":"_onClickPullRequestLink","click a.create-pullrequest-link":"_onClickCreatePullRequestLink","click a.create-review-link":"_onClickCreateReviewLink","mouseenter .pullrequest-tooltip":"_onHoverPullRequestsToolTip","mouseenter .review-link":"_onHoverReviewsToolTip","click .pullrequest-tooltip":"_onClickPullRequestsToolTip"},initialize:function(a){this.analyticIssueData=a.analyticIssueData||{};this.analytics=JIRA.DevStatus.BranchesAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({},a,{type:"branch",width:1000,height:400,dataType:"pullrequest"}))},renderSuccess:function(g,a){var c=this._sortBranchesByName(this._removeWithNoRepos(this._extractAllBranches(a)));var f=this._extractAllPullRequests(a);this._populatePullRequestStateByBranch(c,f);this._prepareBranchReviews(c);var d=this._getBranchFeatures(c);var e=this._getBranchCount(c);var b=this.getContentContainer(g);if(e>0){b.html(this.template({applicationType:g,branches:c,features:d,branchCount:e}));JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(g,e);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#branch|1\u003cbranches}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more branches by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related branches"},getConnectionMessageInCanvas:function(){return "Unable to retrieve branch information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related branches."},hasData:function(a){return this._removeWithNoRepos(this._extractAllBranches(a)).length>0},_extractAllBranches:function(a){return _.compact(_.flatten(_.pluck(a,"branches")))},_getBranchFeatures:function(a){return{pullRequests:_.find(a,function(b){return b.createPullRequestUrl||(b.pullRequestState&&b.pullRequestState.total)})!=null,lastCommitId:_.find(a,function(b){return b.lastCommit&&b.lastCommit.displayId})!=null,lastCommitTimestamp:_.find(a,function(b){return b.lastCommit&&b.lastCommit.authorTimestamp})!=null,reviews:_.find(a,function(b){return b.createReviewUrl||(b.reviews&&b.reviews.totalCount)})!=null}},_removeWithNoRepos:function(a){return _.filter(a,function(b){return b.repository})},_prepareBranchReviews:function(b){var a=this._sortReviewsByStatus;_.each(b,function(c){if(c.reviews){if(c.reviews.reviews){c.reviews.reviews=a(c.reviews.reviews)}c.reviews.json=JSON.stringify(c.reviews)}})},_extractAllPullRequests:function(a){return _.flatten(_.compact(_.pluck(a,"pullRequests")))},_sortBranchesByName:function(a){return _.sortBy(a,function(b){return b.repository.name+b.name})},_onClickRepositoryLink:function(){this.analytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickBranchLink:function(){this.analytics.fireDetailBranchClicked(this._getActiveApplicationType())},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestLozengeClick(this._getActiveApplicationType())},_onClickCreatePullRequestLink:function(){this.analytics.fireDetailCreatePullRequestClicked(this._getActiveApplicationType(),this.analyticIssueData.isAssignee,this.analyticIssueData.isAssignable)},_onClickCreateReviewLink:function(){this.analytics.fireDetailCreateReviewClicked(this._getActiveApplicationType(),this.analyticIssueData.isAssignee,this.analyticIssueData.isAssignable)},_tooltipSeq:1,_onHoverPullRequestsToolTip:function(c){c.preventDefault();var a=this;var b=AJS.$(c.currentTarget);if(!b.data("inline-dialog-inited")){var d="pullrequest-tooltip-"+(this._tooltipSeq++);this.activePullRequestsToolTip=AJS.InlineDialog(b,d,function(g,f,h){var e=AJS.$(f);g.html(a.pullRequestToolTipTemplate({pullRequests:e.data("detail")}));a.activePullRequestsToolTip.$content=g;h()},{onHover:true,hideDelay:200,showDelay:50,offsetX:-200,cacheContent:false,width:400});b.data("inline-dialog-inited",true).trigger("mouseenter")}},_onHoverReviewsToolTip:function(b){var a=this;this._setupReviewsPopup(b,function(c){return c.closest("a").data("detail")},undefined,function(){a.analytics.fireDetailReviewLozengeClick(a._getActiveApplicationType())})},_onClickPullRequestsToolTip:function(a){if(this.activePullRequestsToolTip){a.stopPropagation()}},_getBranchCount:function(a){return a.length},_populatePullRequestStateByBranch:function(b,c){var a=this;_.each(b,function(d){var e=_.filter(c,function(f){return f.source.url===d.url});d.pullRequestState=a._summarisePullRequestState(e)});return b},_sortPullRequestsByStatus:function(a){return _.sortBy(a,function(b){return(b.status==="OPEN"?"2":(b.status==="MERGED"?"1":"0"))+b.lastUpdated}).reverse()},_getFirstStatusWithCount:function(a){return _.find(this.STATE_ORDER,function(b){return a[b]})},_summarisePullRequestState:function(a){var b=_.groupBy(a,function(c){return c.status});return{status:this._getFirstStatusWithCount(b),data:JSON.stringify(this._sortPullRequestsByStatus(a)),total:_.size(a)}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogPullRequestView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogPullRequestView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.pullRequest,extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{"click a.pullrequest-link":"_onClickPullRequestLink"},initialize:function(a){this.analytics=JIRA.DevStatus.PullRequestsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"pullrequest",width:1000,height:400},a))},renderSuccess:function(f,a){var d=this._removeAuthorFromReviewers(this._extractAllPullRequests(a));var e=this._getSortedPullRequestsByDate(d);var c=_.size(e);var b=this.getContentContainer(f);if(c>0){b.html(this.template({pullRequests:e,pullRequestCount:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(f,c);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#pull request|1\u003cpull requests}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more pull requests by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related pull requests"},getConnectionMessageInCanvas:function(){return "Unable to retrieve pull request information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related pull requests."},hasData:function(a){return this._extractAllPullRequests(a).length>0},_extractAllPullRequests:function(a){return _.compact(_.flatten(_.pluck(a,"pullRequests")))},_removeAuthorFromReviewers:function(a){return _.map(a,function(d){if(d.reviewers&&d.author){var c=_.filter(d.reviewers,function(e){return e.name!=d.author.name});if(d.reviewers.length==c.length){return d}var b=_.clone(d);b.reviewers=c;return b}return d})},_sortReviewers:function(b){var a=this.options.reviewersThreshold;_.each(b,function(d,c){if(_.size(d.reviewers)>0){d.reviewers=_.sortBy(_.filter(d.reviewers,function(e){return e.name}),function(e){return e.approved?"0"+e.name:"1"+e.name});if(d.reviewers.length>a+1){d.extraReviewers=JSON.stringify(d.reviewers.slice(a))}}})},_getSortedPullRequestsByDate:function(a){this._sortReviewers(a);return _.sortBy(a,"lastUpdate").reverse()},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestClicked(this._getActiveApplicationType())}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogReviewView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogReviewView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.review,events:{"click a.review-link":"_onClickReviewLink","click a.comment-link":"_onClickReviewLink"},initialize:function(a){this.analytics=JIRA.DevStatus.ReviewsAnalytics;this.finalStates=["REJECTED","CLOSED"];this.nonFinalStates=["REVIEW","APPROVAL","SUMMARIZE"];this.validStates=_.union(this.finalStates,this.nonFinalStates);JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"review",width:1000,height:400},a))},_updateReviewers:function(a){a.reviewers=_.chain(a.reviewers).filter(function(b){if(b&&a.author&&a.author.name&&b.name){return !_.isEqual(b.name,a.author.name)}return true}).sortBy(function(b){return(b.complete?"0":"1")+b.name}).map(function(b){b.approved=b.complete;return b}).value();if(a.moderator&&!_.isEqual(a.moderator,a.author)){a.reviewers=[_.extend(a.moderator,{name:"Moderator:"+" "+a.moderator.name})].concat(a.reviewers)}return a},_updateReview:function(a){return function(b){if(b.state&&b.dueDate&&_.contains(a,b.state)){delete b.dueDate}if(b.dueDate&&moment(b.dueDate).isBefore(moment())){b.overDue=true}return b}},_addExtraReviewersJson:function(a){return function(b){if(b.reviewers){b.extraReviewers=JSON.stringify(b.reviewers.slice(a))}return b}},_reviewCompare:function(b,a){if(b.dueDate&&!a.dueDate){return -1}else{if(!b.dueDate&&a.dueDate){return 1}else{if(b.dueDate&&a.dueDate){return b.dueDate.localeCompare(a.dueDate)}else{if(b.lastModified&&a.lastModified){return a.lastModified.localeCompare(b.lastModified)}}}}return 0},_mergeInstanceData:function(a,b){return a.concat(b.reviews||[])},_prepareReviews:function(b){var a=this;return _.chain(b).reduce(this._mergeInstanceData,[]).filter(function(c){c.state=c.state&&c.state.toUpperCase();return _.contains(a.validStates,c.state)}).map(_.compose(this._addExtraReviewersJson(this.options.reviewersThreshold),this._updateReviewers,this._updateReview(this.finalStates))).sort(this._reviewCompare).value()},renderSuccess:function(d,a){var c=this._prepareReviews(a),b=this.getContentContainer(d);if(c.length>0){b.html(this.template({applicationType:d,reviews:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(d,c.length);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#review|1\u003creviews}",b,a)},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related reviews."},getOAuthMessageInCanvas:function(){return "Authenticate to see related reviews"},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more reviews by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getConnectionMessageInCanvas:function(){return "Unable to retrieve review information"},hasData:function(a){return _.flatten(_.pluck(a,"reviews"),true).length>0},_onClickReviewLink:function(){this.analytics.fireDetailReviewClicked()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusModule.js' */
Backbone.define("JIRA.DevStatus.DevStatusModule",Backbone.Model.extend({initialize:function(a){_.defaults(this,a);this._listeners=new JIRA.DevStatus.Util.Listeners();this.createBranchFormDialog=new JIRA.DevStatus.CreateBranchFormDialog(a);this.devSummaryJson=null;this.triggerHelpTipShown=false;this._initFocusHandler()},initializePanel:function(a){this._listeners.stopListening();this._renderedData=null;this._getContainers(a);this.labsOptIn=JIRA.DevStatus.Labs.LabsOptInModel.createFromDOM(this.parentContainer);a.showTooltip=a.showTooltip&&!(this.labsOptIn.isAllowed()&&!(this.labsOptIn.isOptedIn()||this.labsOptIn.isDismissed()));this._createCreateBranchView(a);this.devSummaryJson=this.devStatusContainer.find(".dev-summary.json-blob").data("json");this._initLabsOptInView();this._initTryLabsView();this._createDevStatusData(a);this._createAnalyticsModel(a);this._createSummaryViews(a);this._setupDataEventHandlers();this.devStatusPanelVisibilityToggler=a.devStatusPanelVisibilityToggler;if(!a.phaseTwoDisabled){this._startDevStatus()}else{this._postRender(false,true)}this.labsOptIn.on("change:optedIn",this._onChangeLabsOptIn,this);if(this.labsOptIn.isAllowed()&&this.labsOptIn.isOptedIn()){this._onChangeLabsOptIn(this.labsOptIn,true)}return this},_createCreateBranchView:function(a){this.createBranchView=new JIRA.DevStatus.CreateBranchView({el:this.createBranchContainer,showTooltip:a.showTooltip})},_createDevStatusData:function(a){this.devStatusData=new JIRA.DevStatus.DevStatusData({issueId:this.devStatusContainer.data("issue-id"),issueKey:this.devStatusContainer.data("issue-key")})},_createSummaryViews:function(a){var c=this;var b=this.devStatusContainer.data();this._summaryModules=_.clone(this.statusPanelContainer.find(".status-panel").map(function(){var d=AJS.$(this);return new JIRA.DevStatus[d.data("module")]({dataAttrs:b,el:d,labsOptIn:c.labsOptIn,analyticsModel:c.analyticsModel})}));this._errorModule=new JIRA.DevStatus.SummaryErrorModule({el:this.messagePanelContainer,dataAttrs:b})},_createAnalyticsModel:function(a){this.analyticsModel=new JIRA.DevStatus.AnalyticsModel({devStatusContainer:this.devStatusContainer,devStatusData:this.devStatusData})},_getContainers:function(a){this.devStatusContainer=a.container;this.parentContainer=a.container.closest(this.parentContainerSelector);this.createBranchContainer=a.container.find(this.linkSelector);this.statusPanelContainer=a.container.find(this.statusPanelSelector);this.headerContainer=this.parentContainer.find(a.headerSelector);this.messagePanelContainer=a.container.find(".message-panel")},_onLoadingStarted:function(){this._startLoadingModuleData()},_onLoadingSuccess:function(b,a,c){this._renderModules({success:true,renderData:this.devStatusData.get("aggregatedData")});this._postRender(!a,c)},_onLoadingFailure:function(){this._renderModules({success:false});this._postRender(false,true)},_setupDataEventHandlers:function(){this._listeners.startListening(this.devStatusData,"beforeRequest",this._onLoadingStarted,this);this._listeners.startListening(this.devStatusData,"requestSuccess",this._onLoadingSuccess,this);this._listeners.startListening(this.devStatusData,"requestFail",this._onLoadingFailure,this)},_startDevStatus:function(){var a=!this.devSummaryJson||this.devSummaryJson.isStale===true;if(this.devSummaryJson){this.devStatusData.setAggregateData(this.devSummaryJson.cachedValue,true,!a)}if(a){this._startLoadingModuleData();this.devStatusData.retrieveAggregateData()}},_initFocusHandler:function(){var a=JIRA.DevStatus.DevStatusModule.MAX_REFRESH_WINDOW;AJS.$(window).on("focus",_.throttle(_.bind(this.refreshSummaryData,this),a,{trailing:false}))},refreshSummaryData:function(){this.devStatusData&&this.devStatusData.retrieveAggregateData()},_onChangeLabsOptIn:function(a,b){if(b===true){}else{}},_initLabsOptInView:function(){this.labsOptInView=new JIRA.DevStatus.Labs.LabsOptInView({el:this.parentContainer.find(".labs-on-off-container"),labsOptIn:this.labsOptIn}).render()},_initTryLabsView:function(){var a=AJS.$('<div class="try-labs-container"></div>').appendTo(this.headerContainer);new JIRA.DevStatus.Labs.TryLabsView({el:a,labsOptIn:this.labsOptIn}).render()},_postRender:function(h,g){var f=this._isAnySummaryViewVisibleOnPanel()||this._isAnyErrorViewVisible();var b=this;if(f){var e=this.analyticsModel.getIssue();JIRA.DevStatus.SummaryAnalytics.fireSummaryShownEvent(e.isAssignee,e.issueType,e.issueStatus,this.analyticsModel.getSummary());this._openDetailDialogUrlLink()}this._togglePanelEmptyStatus(!this._isAnySummaryViewVisibleOnPanel(true));var a=this.parentContainer;function c(){if(g){a.addClass("js-animation-completed");b._attachAutomaticTransitionsHelpTip()}}var d=f||(this.createBranchContainer.size()>0);if(this.devStatusPanelVisibilityToggler&&(a.is(":visible")!==d)){this.devStatusPanelVisibilityToggler(this.parentContainer,d,h,c)}else{c()}},_attachAutomaticTransitionsHelpTip:function(){var a=this.parentContainer.is(":visible");if(!this.triggerHelpTipShown&&JIRA.DevStatus.showAITTooltip&&a){_.defer(_.bind(function(){new AJS.HelpTip({id:"automaticTransitionDevSummaryTooltip",title:"Automate your status updates",bodyHtml:JIRA.Templates.DevStatus.Tooltip.automaticTransitions({aitHelpLinkUrl:this.devStatusContainer.data("ait-help-url-json")}),anchor:"#viewissue-devstatus-panel_heading .toggle-title",isSequence:true,callbacks:{init:function(){AJS.$("#trigger-docs-link").on("click",function(){AJS.trigger("analyticsEvent",{name:"devstatus.automatic.transitions.learn.more.clicked",data:{}})})}},inlineDialogOpts:{width:400}});AJS.HelpTip.Manager.showSequences()},this));this.triggerHelpTipShown=true}},_getModuleByType:function(a){return _.find(this._summaryModules,function(b){return b.data&&b.data.getType&&_.isEqual(b.data.getType(),a)})},_openDetailDialogUrlLink:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a){var c;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(a)){c=this._getModuleByType("repository")}else{c=this._getModuleByType(a);if(c){AJS.Meta.set("fusion-open-detail-dialog",undefined)}}if(c){var b=c.view;if(b&&b.isVisible()){AJS.Meta.set("fusion-analytics-new-context-link",true);b.getSummaryLink().click()}}}},_togglePanelEmptyStatus:function(a){if(this.statusPanelContainer){this.statusPanelContainer.toggleClass("empty-status",a)}},_isAnySummaryViewVisibleOnPanel:function(){return !!_.find(this._summaryModules,function(a){return a.isViewVisible()})},_isAnyErrorViewVisible:function(){return this._errorModule.isViewVisible()},_renderModules:function(a){var b=this._renderedData=a.renderData||this._renderedData;_.each(this._summaryModules,function(c){c.render(b)});this._errorModule.render(a.success?b:undefined)},_startLoadingModuleData:function(){_.each(this._summaryModules,function(a){a.startLoading()})}},{MAX_REFRESH_WINDOW:30000}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusData.js' */
Backbone.define("JIRA.DevStatus.DevStatusData",Backbone.Model.extend({properties:["aggregatedData"],namedEvents:["beforeRequest","requestFail","requestSuccess"],initialize:function(a){this.issueId=a.issueId;this.issueKey=a.issueKey},retrieveAggregateData:function(){var a=AJS.contextPath()+"/rest/dev-status/1.0/issue/summary?issueId="+this.issueId;this.trigger("beforeRequest");return AJS.$.ajax(a).done(_.bind(this.setAggregateData,this)).fail(_.bind(this.setAggregateDataError,this)).promise()},setAggregateData:function(b,a,c){this.set("aggregatedData",b);this.trigger("requestSuccess",this,a===true,!!c)},setAggregateDataError:function(b,a){this.set("aggregatedData",undefined);this.trigger("requestFail",this,b)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/CreateBranchView.js' */
Backbone.define("JIRA.DevStatus.CreateBranchView",Backbone.View.extend({initialize:function(a){this.tooltipShown=!a.showTooltip;this.linkTextSelector=".devstatus-cta-link-text";this.issueContainer=".issue-container";this._processLinkForNavigableURL();this._initTooltip();_.defer(_.bind(this._openCreateBranchDialog,this))},getCreateBranchLink:function(){return this.$el},_processLinkForNavigableURL:function(){this.getCreateBranchLink().data("cta",this._getCta(this.$el));this.getCreateBranchLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam("create-branch"))},_openCreateBranchDialog:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a==="create-branch"){AJS.Meta.set("fusion-open-detail-dialog",undefined);AJS.Meta.set("fusion-analytics-new-context-link",true);this.getCreateBranchLink().click()}},_initTooltip:function(){if(!this.tooltipShown&&this.$el.length>0){_.defer(_.bind(function(){var a=this.$el.data("cta");if(a){new AJS.HelpTip({id:a+".tooltip",title:"Start development",bodyHtml:JIRA.Templates.DevStatus.Tooltip.createBranch(),anchor:this.$el.find(this.linkTextSelector),isSequence:true,inlineDialogOpts:{container:this.issueContainer,width:400}});this.tooltipShown=true;AJS.HelpTip.Manager.showSequences()}},this))}},_getCta:function(c){var b=c.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BasePanelModule.js' */
Backbone.define("JIRA.DevStatus.BasePanelModule",Backbone.Model.extend({initialize:function(a){this.options=_.defaults({},a);this.data=this.createModel()},render:function(a){this.startViews();this.data.updateData(a);this.view.render()},startLoading:function(){this.data.startLoadingData&&this.data.startLoadingData()},startViews:function(){if(!this.view){this.view=this.createView()}},stopViews:function(){if(this.view){this.view.undelegateEvents();this.view.$el.empty();this.view.hide();this.view=null}},isViewVisible:function(){return this.view&&this.view.isVisible()},createView:function(){},createModel:function(){}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryView.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryView",Backbone.View.extend({template:undefined,events:{"simpleClick .summary":"_onSummaryLinkClick"},initialize:function(a){this.options=_.clone(a);this.model.on("change:hasData",this._addOrRemoveHasDataClass,this);this.model.on("change:dataLoading",this._addOrRemoveDataLoadingClass,this);this.transitionView=new JIRA.DevStatus.SummaryTransitionView({model:this.model,el:this.$el})},render:function(){var b=this.isVisible();if(b){var a=AJS.$(this.template(_.extend({issueKey:this.options.dataAttrs.issueKey},this.model.getOverall())));if(this._shouldAnimateDataTransition()){this.transitionView.renderVisible(a)}else{this.$el.html(a);JIRA.DevStatus.Date.addTooltip(a)}this._renderNavigableSummaryLink();this.show()}else{if(!this._isHidden()){if(this._shouldAnimateDataTransition()){this.transitionView.renderHidden(_.bind(this.hide,this))}else{this.hide()}}}this._addOrRemoveDataLoadingClass();this._addOrRemoveHasDataClass()},getDefaultDetailDialogParameters:function(){return{issueKey:this.options.dataAttrs.issueKey,issueId:this.options.dataAttrs.issueId,tabs:this.model.get("byInstanceType"),dataType:this.model.getType(),showContactAdminForm:this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm}},getSummaryLink:function(){return this.$el.find("a.summary")},isVisible:function(){return this.model.getOverall().count>0},_addOrRemoveHasDataClass:function(){var a=this.model.get("hasData");this.$el.toggleClass("js-has-data",a)},_renderNavigableSummaryLink:function(){this.getSummaryLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam(this.model.getType()))},_addOrRemoveDataLoadingClass:function(){var a=this.model.get("dataLoading");this.$el.toggleClass("data-loading",a)},_onSummaryLinkClick:function(a){a.preventDefault();console.log("Summary view not supported: ",this)},_shouldAnimateDataTransition:function(){return !!this.model.getPreviousOverall()},_isHidden:function(){return this.$el.hasClass("hidden")},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryTransitionView.js' */
Backbone.define("JIRA.DevStatus.SummaryTransitionView",Backbone.View.extend({slideTransitionTime:500,initialize:function(){},renderVisible:function(b){var a=!AJS.$.contains(document,this.$el[0]);if(this._hasPreviousData()){if(this._hasDataChanged()){this._prepareContentsForTransition(b,this.$el);this.$el.addClass("roll-transition")}}else{this._preStartSlideTransition();this.$el.addClass("slide-down-transition");a=true}this.$el.html(b);JIRA.DevStatus.Date.addTooltip(b);if(a){_.defer(_.bind(this._initiateTransition,this))}else{this._initiateTransition()}},renderHidden:function(b){var a=this;this.$el.slideUp(this.slideTransitionTime,function(){a.$el.css("display","");b()})},_initiateTransition:function(){if(this.$el.hasClass("slide-down-transition")){this._postStartSlideTransition();this.$el.removeClass("slide-down-transition");this._startSlideDownTransition(this.$el,0)}else{if(this.$el.hasClass("roll-transition")){this.$el.removeClass("roll-transition");this._startRollTransition()}var b=this.$el.find(".sliding-container");if(b.length>0){var a=this;b.each(function(d,c){var e=AJS.$(c);var f=e.data("prevHeight");a._startSlideDownTransition(e,f)})}}},_startSlideDownTransition:function(a,b){var c=a.height();if(b!==c){a.height(b).animate({height:c},this.slideTransitionTime,function(){a.css("height","auto");a.find(".rolling-content").removeClass("transit")})}},_startRollTransition:function(){this.$el.find(".rolling-container").each(_.bind(function(b,a){var f=AJS.$(a);var e=f.find(".rolling-content");var d=e.find(":not(.old-content)");var c=d.height();f.height(c);e.addClass("transit");d.css("margin-top","-"+c+"px").animate({"margin-top":"0"},this.slideTransitionTime,function(){f.css("height","auto");f.find(".old-content").remove();e.removeClass("transit");d.css("margin-top","")})},this))},_prepareContentsForTransition:function(b,d){b=AJS.$("<div></div>").append(b);var c=b.find(".sliding-container");var f=d.find(".sliding-container");c.each(function(h,i){var g=f.get(h);if(g){var j=AJS.$(g);AJS.$(i).data("prevHeight",j.height())}});var e=b.find(".rolling-container");var a=d.find(".rolling-container");e.each(function(i,j){var k=AJS.$(j).find(".rolling-content");var h=a.get(i);if(h){var g=AJS.$(h).find(".rolling-content").children();g.addClass("old-content");k.append(g)}})},_hasPreviousData:function(){var a=this.model.getPreviousOverall();return a&&a.count>0},_hasDataChanged:function(){return !_.isEqual(this.model.getOverall(),this.model.getPreviousOverall())},_preStartSlideTransition:function(){this.$el.css("height","0");this.$el.css("opacity","0")},_postStartSlideTransition:function(){this.$el.css("height","");this.$el.css("opacity","")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModule.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModule",JIRA.DevStatus.BasePanelModule.extend({model:undefined,viewType:undefined,createModel:function(){return new this.model({})},createView:function(){return new this.viewType(_.extend(_.clone(this.options),{model:this.data}))}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModel.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModel",Backbone.Model.extend({typeId:undefined,properties:["byInstanceType","overall","previousOverall","hasData","dataLoading"],startLoadingData:function(){this.set("dataLoading",true)},updateData:function(b){this.set("hasData",b!==undefined);this.set("dataLoading",false);this.set("previousOverall",this.getOverall());if(b&&b.summary&&b.summary[this.typeId]){var a=b.summary[this.typeId];this.set("byInstanceType",a.byInstanceType);this.set("overall",a.overall)}else{this.set("byInstanceType",{});this.set("overall",{count:0})}},getType:function(){return this.typeId},getOverall:function(){return this.get("overall")},getPreviousOverall:function(){return this.get("previousOverall")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/CreateBranchFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateBranchFormDialog",Backbone.View.extend({initialize:function(a){AJS.namespace("JIRA.DevStatus.CtaDialog");this.parentContainerSelector=a.parentContainerSelector;this.panelSelector=a.panelSelector;this.linkSelector=a.linkSelector;this.dialogId="devstatus-cta-dialog";JIRA.DevStatus.CtaDialogAnalytics.initialize(this.parentContainerSelector,this.linkSelector,this.dialogId);this._initFormDialog()},_initFormDialog:function(){var a=this;var b=JIRA.DevStatus.CtaDialog.dialog=new JIRA.FormDialog({id:this.dialogId,width:560,content:function(c){this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:a._getCta(this.$activeTrigger)});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".target").eq(0).focus();JIRA.DevStatus.CtaDialogAnalytics.fireCreateBranchEvent("dialog.open")})},trigger:this.linkSelector,autoClose:true})},_getCta:function(d){var c=d.data("cta");if(c){return c}else{var b=d.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModule.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModule",JIRA.DevStatus.BasePanelModule.extend({createModel:function(){return new JIRA.DevStatus.SummaryErrorModel({})},createView:function(){var a=this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm;return new JIRA.DevStatus.SummaryErrorView({model:this.data,el:this.options.el,showContactAdminForm:a})}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModel.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModel",Backbone.Model.extend({properties:["hasErrors","errorInstances","configInstances"],defaults:function(){return{hasErrors:false,errorInstances:[],configInstances:[]}},updateData:function(b){var c=this._extractErrors(b&&b.errors);var a=this._extractErrors(b&&b.configErrors);this.set("hasErrors",!b||!_.isEmpty(c)||!_.isEmpty(a));this.set("errorInstances",c);this.set("configInstances",a)},_extractErrors:function(a){if(!a){return[]}return _.map(_.filter(a,function(b){return b.error}),function(b){return b.instance})}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorView.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorView",JIRA.DevStatus.BaseSummaryView.extend({initialize:function(a){this.showContactAdminForm=a.showContactAdminForm},render:function(){if(this.isVisible()){this.$el.html(JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon({instances:this.model.get("errorInstances"),notConfiguredInstances:this.model.get("configInstances"),showContactAdminForm:this.showContactAdminForm}));this.show()}else{this.hide()}return this},isVisible:function(){return this.model.get("hasErrors")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInModel.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInModel",Backbone.Model.extend({defaults:{allowed:false,optedIn:false,optedInByAdmin:false,dismissed:false,id:1},isAllowed:function(){return this.get("allowed")},isOptedIn:function(){return this.get("optedIn")},isOptedInByAdmin:function(){return this.get("optedInByAdmin")},setOptedIn:function(a){return this.save({optedIn:a},{wait:true}).done(function(){JIRA.DevStatus.LabsAnalytics.fireLabsEvent(a)})},toggleOptedIn:function(a){var b=this.isOptedIn();return this.setOptedIn(!b)},setDismissed:function(a){return this.save({dismissed:a},{wait:true})},isDismissed:function(){return this.get("dismissed")},url:function(){return AJS.contextPath()+"/rest/dev-status/1.0/labs-opt-in/"}},{createFromDOM:function(b){var a=AJS.$(b).find("#devstatus-container");return new JIRA.DevStatus.Labs.LabsOptInModel(a.data("labs-json"))}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInView.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInView",Backbone.View.extend({events:{"click .toggle-labs":"_onClickToggle","click .labs-close":"_onClickDismiss","click .feedback-link":"_onClickFeedback"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change",this.render,this);this.labsOptIn.on("change:optedIn",this._onChangeOptedIn,this)},render:function(){var a=this.labsOptIn;if(a.isAllowed()&&(a.isOptedInByAdmin()||!a.isDismissed())){this._show()}else{this._hide()}return this},_onClickToggle:function(a){a.preventDefault();this.labsOptIn.toggleOptedIn()},_onClickDismiss:function(a){a.preventDefault();this.labsOptIn.setDismissed(true)},_onClickFeedback:function(a){a.preventDefault();this._showFeedbackDialog()},_onChangeOptedIn:function(b,a){if(a===false){this._showFeedbackDialog({summary:"How can Atlassian improve the development panel?"})}},_showFeedbackDialog:function(b){var a=new JIRA.DevStatus.FeedbackDialog(b);a.show()},_show:function(){this.$el.html(JIRA.Templates.DevStatus.labsOnOff({isOptedIn:this.labsOptIn.isOptedIn(),isOptedInByAdmin:this.labsOptIn.isOptedInByAdmin()}));this.$el.removeClass("hidden")},_hide:function(){this.$el.empty();this.$el.addClass("hidden")}},{COLLECTOR_ID:"effe8b72"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/TryLabsView.js' */
Backbone.define("JIRA.DevStatus.Labs.TryLabsView",Backbone.View.extend({events:{"click .try-labs":"_onClickTryLabs"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change:dismissed",this.render,this)},render:function(){if(!this.labsOptIn.isAllowed()||this.labsOptIn.isOptedIn()||!this.labsOptIn.isDismissed()){this.$el.empty()}else{this.$el.html(JIRA.Templates.DevStatus.tryLabs())}return this},_onClickTryLabs:function(a){a.preventDefault();this.labsOptIn.setDismissed(false)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusInit.js' */
(function(){JIRA.DevStatus.setDetailDialogParam=function(){AJS.Meta.set("fusion-open-detail-dialog",JIRA.DevStatus.URL.getDetailDialogParam())};JIRA.DevStatus.setDetailDialogParam()})();AJS.$(function(){JIRA.DevStatus.showTooltip=true;JIRA.DevStatus.showAITTooltip=true;var d={devStatusContainer:"#devstatus-container",parentContainer:"[id$='devstatus-panel']",link:"a.devstatus-cta-link",statusPanel:".status-panels",viewIssueHeader:".mod-header",agileHeader:".ghx-header",agileNavMenuLink:'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-development-integration-plugin-greenhopper-devstatus-panel"]'};function e(g){return g.find("body").hasClass("page-type-dashboard")}function b(g){return g.find("body").hasClass("ghx-agile")}function c(g){return g.find("body").hasClass("ka ajax-issue-search-and-view")}function a(h,i,g){JIRA.DevStatus.devStatusModule.initializePanel({container:h,showTooltip:JIRA.DevStatus.showTooltip,headerSelector:i,devStatusPanelVisibilityToggler:g,phaseTwoDisabled:!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.phasetwo.enabled")})}function f(g,i,h,j){_.defer(function(){var k=h?1000:0;var l={duration:k,complete:j};if(i){g.slideDown(l)}else{g.slideUp(l)}})}JIRA.DevStatus.documentReadyInit=function(h){JIRA.DevStatus.devStatusModule=new JIRA.DevStatus.DevStatusModule({parentContainerSelector:d.parentContainer,linkSelector:d.link,panelSelector:d.devStatusContainer,statusPanelSelector:d.statusPanel});if(e(h)||b(h)){h.find("body").on("click",d.agileNavMenuLink,JIRA.DevStatus.Analytics.fireAgileDevStatusLinkClicked);JIRA.DevStatus.showTooltip=false;JIRA.DevStatus.showAITTooltip=false}else{if(c(h)){if(JIRA.Issues.Api.isFullScreenIssueVisible()){var g=AJS.$(d.devStatusContainer);if(g.length>0){a(g,d.viewIssueHeader,f)}}}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(j,i){if(i.not(document).is(d.parentContainer)){a(i.find(d.devStatusContainer),d.viewIssueHeader,f);JIRA.DevStatus.showTooltip=false;return true}return false});JIRA.bind("GH.DetailView.updated",function(j,i){a(AJS.$(d.devStatusContainer),d.agileHeader)})};AJS.$(function(){JIRA.DevStatus.documentReadyInit(AJS.$(document))})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitModel.js' */
Backbone.define("JIRA.DevStatus.CommitModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"repository"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'templates/viewissue/commit/devstatus-panel-commit.soy' */
// This file was automatically generated from devstatus-panel-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Commit == 'undefined') { JIRA.Templates.DevStatus.Commit = {}; }


JIRA.Templates.DevStatus.Commit.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Commits related to {0}",opt_data.issueKey)), '">');
  JIRA.Templates.FusionWidget.Common.commits(opt_data, param4);
  param4.append('</a></div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Latest", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitView.js' */
Backbone.define("JIRA.DevStatus.CommitView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Commit.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogCommitView=new JIRA.DevStatus.DetailDialogCommitView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-commit-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.CommitsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogCommitView.show()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitModule.js' */
Backbone.define("JIRA.DevStatus.CommitModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.CommitModel,viewType:JIRA.DevStatus.CommitView}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestModel.js' */
Backbone.define("JIRA.DevStatus.PullRequestModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"pullrequest"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'templates/viewissue/pullrequest/devstatus-panel-pullrequest.soy' */
// This file was automatically generated from devstatus-panel-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.PullRequest == 'undefined') { JIRA.Templates.DevStatus.PullRequest = {}; }


JIRA.Templates.DevStatus.PullRequest.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Pull requests related to {0}",opt_data.issueKey)), '">');
  JIRA.Templates.FusionWidget.Common.pullRequestsText(opt_data, param4);
  param4.append('</a> ');
  JIRA.Templates.FusionWidget.Common.pullRequestsStateViewIssue(opt_data, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Updated", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestView.js' */
Backbone.define("JIRA.DevStatus.PullRequestView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.PullRequest.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogPullRequestView=new JIRA.DevStatus.DetailDialogPullRequestView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-pullrequest-detail-dialog",count:this.model.getOverall().count,reviewersThreshold:2}));JIRA.DevStatus.PullRequestsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogPullRequestView.show()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestModule.js' */
Backbone.define("JIRA.DevStatus.PullRequestModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.PullRequestModel,viewType:JIRA.DevStatus.PullRequestView}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewModel.js' */
Backbone.define("JIRA.DevStatus.ReviewModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"review"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'templates/viewissue/review/devstatus-panel-review.soy' */
// This file was automatically generated from devstatus-panel-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Review == 'undefined') { JIRA.Templates.DevStatus.Review = {}; }


JIRA.Templates.DevStatus.Review.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Reviews related to {0}",opt_data.issueKey)), '">');
  JIRA.Templates.FusionWidget.Common.reviewsText(opt_data, param4);
  param4.append('</a> ');
  JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue(opt_data, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(opt_data, {showUpdatedText: true}), output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Review.reviewDate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.dueDate && ! opt_data.completed) {
    JIRA.Templates.DevStatus.lastUpdated({text: "Due", lastUpdated: opt_data.dueDate, extraClass: opt_data.overDue ? 'overdue' : undefined, datetimeFormat: 'fullAge'}, output);
  } else if (opt_data.lastUpdated) {
    JIRA.Templates.DevStatus.lastUpdated({text: opt_data.showUpdatedText ? "Updated" : '', lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  }
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewView.js' */
Backbone.define("JIRA.DevStatus.ReviewView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Review.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogReviewView=new JIRA.DevStatus.DetailDialogReviewView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-review-detail-dialog",count:this.model.getOverall().count,reviewersThreshold:2,completed:this.model.getOverall().completed}));JIRA.DevStatus.ReviewsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogReviewView.show()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewModule.js' */
Backbone.define("JIRA.DevStatus.ReviewModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.ReviewModel,viewType:JIRA.DevStatus.ReviewView}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchModel.js' */
Backbone.define("JIRA.DevStatus.BranchModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"branch"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'templates/viewissue/branch/devstatus-panel-branch.soy' */
// This file was automatically generated from devstatus-panel-branch.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Branches == 'undefined') { JIRA.Templates.DevStatus.Branches = {}; }


JIRA.Templates.DevStatus.Branches.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Branches related to {0}",opt_data.issueKey)), '">');
  JIRA.Templates.FusionWidget.Common.branches(opt_data, param4);
  param4.append('</a></div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Updated", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchView.js' */
Backbone.define("JIRA.DevStatus.BranchView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Branches.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogBranchView=new JIRA.DevStatus.DetailDialogBranchView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-branch-detail-dialog",count:this.model.getOverall().count,analyticIssueData:this.options.analyticsModel.getIssue()}));JIRA.DevStatus.BranchesAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogBranchView.show()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchModule.js' */
Backbone.define("JIRA.DevStatus.BranchModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.BranchModel,viewType:JIRA.DevStatus.BranchView}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildModel.js' */
Backbone.define("JIRA.DevStatus.BuildModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"build"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'templates/viewissue/build/devstatus-panel-build.soy' */
// This file was automatically generated from devstatus-panel-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Build == 'undefined') { JIRA.Templates.DevStatus.Build = {}; }


JIRA.Templates.DevStatus.Build.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Builds related to {0}",opt_data.issueKey)), '">');
  var countText__soy8 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.buildsText(opt_data, countText__soy8);
  countText__soy8 = countText__soy8.toString();
  param4.append(countText__soy8, '</a> ');
  JIRA.Templates.DevStatus.Build.statusIcon(opt_data, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Latest", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Build.statusIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy27 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.buildsIconClass(opt_data, iconClass__soy27);
  iconClass__soy27 = iconClass__soy27.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy27), '">', soy.$$escapeHtml(opt_data.iconText), '</span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildView.js' */
Backbone.define("JIRA.DevStatus.BuildView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Build.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogBuildView=new JIRA.DevStatus.DetailDialogBuildView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-build-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.BuildsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogBuildView.show()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildModule.js' */
Backbone.define("JIRA.DevStatus.BuildModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.BuildModel,viewType:JIRA.DevStatus.BuildView}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentModel.js' */
Backbone.define("JIRA.DevStatus.DeploymentModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"deployment-environment"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'templates/viewissue/deployment/devstatus-panel-deployment.soy' */
// This file was automatically generated from devstatus-panel-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Deployment == 'undefined') { JIRA.Templates.DevStatus.Deployment = {}; }


JIRA.Templates.DevStatus.Deployment.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dd>');
  var param4 = new soy.StringBuilder('<div class="summary-content" title="', soy.$$escapeHtml(AJS.format("Deployments related to {0}",opt_data.issueKey)), '">');
  if (opt_data.topEnvironments.length) {
    JIRA.Templates.FusionWidget.Common.deployments({anchorStart: '<a class="summary">', anchorEnd: '</a>', showProjects: opt_data.showProjects, successfulCount: opt_data.successfulCount, topEnvironments: opt_data.topEnvironments}, param4);
  } else {
    param4.append(soy.$$escapeHtml("No deployments contain latest commits"));
  }
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dd></dl>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentView.js' */
Backbone.define("JIRA.DevStatus.DeploymentView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Deployment.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogDeploymentView=new JIRA.DevStatus.DetailDialogDeploymentView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-deployment-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.DeploymentsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogDeploymentView.show()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentModule.js' */
Backbone.define("JIRA.DevStatus.DeploymentModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.DeploymentModel,viewType:JIRA.DevStatus.DeploymentView}));;
;/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTip.js' */
(function(f){function a(){return false}function d(){return true}var b="jira-help-tip aui-help";var k=0,g=new Date().getTime();function h(m){m=""+(m||"");return m.replace(/\./g,"-")}function j(n,m){if(AJS.EventQueue&&m&&m.attributes.id){var p={};var o=h(m.attributes.id);var q="";if(m.attributes.eventPrefix){q=m.attributes.eventPrefix;if(q.charAt(q.length-1)!=="."){q+="."}}p.name=q+"helptips."+o+"."+n;p.properties={};AJS.EventQueue.push(p)}}function c(){return"c"+g+(k++)}var e=AJS.HelpTip=function(m){var n;this.attributes=f.extend({},m);this.attributes.id||(this.attributes.id=false);this.attributes.callbacks||(this.attributes.callbacks={});if(this.attributes.isSequence){if(!this.attributes.weight){this.attributes.weight=Number.MAX_VALUE}AJS.HelpTip.Manager.sequences.push(this)}if(this.attributes.body){this.attributes.bodyHtml=this.attributes.body;delete this.attributes.body}this.cid=c();n=this.attributes.anchor;delete this.attributes.anchor;this.view=(n)?new i(this,n):new l(this)};f.extend(e.prototype,{show:function(o){o=o||{};var n=this;var p=f.Deferred();if(this.attributes.callbacks.beforeShow){var m=this.attributes.callbacks.beforeShow();if(m&&_.isFunction(m.done)){m.done(p.resolve)}else{p.resolve()}}else{p.resolve()}p.done(function(){AJS.HelpTip.Manager.show(function(){if(!n.isDismissed()){if(!o.force&&AJS.Popups&&AJS.Popups.DisplayController){AJS.Popups.DisplayController.request({name:n.id,weight:1000,show:function(){n.view.show()}})}else{n.view.show()}j("shown",n)}})})},dismiss:function(){var m=h(arguments[0]||"programmatically");this.view.dismiss();if(m==="close-button"&&this.attributes.isSequence){AJS.HelpTip.Manager.clearSequences()}if(!this.isDismissed()){AJS.HelpTip.Manager.dismiss(this);j("dismissed."+m,this)}},isVisible:function(){return this.view.$el.is(":visible")},isDismissed:function(){return AJS.HelpTip.Manager.isDismissed(this)},refresh:function(){if(!this.isDismissed()){this.view.refresh()}},hide:function(){if(!this.isDismissed()){this.view.dismiss()}},showNextHelpTipInSequence:function(){this.view.clickNext()}});var i=function(n,m){this.initialize(n,m)};f.extend(i.prototype,{initialize:function(n,m){this.model=n;this.anchorSelector=m;this.anchor=AJS.$(m);this._initDialog(m);AJS.$(document).bind("showLayer",function(q,p,o){if(p==="inlineDialog"&&o.id===n.cid){AJS.InlineDialog.current=null;AJS.$(document.body).unbind("click."+n.cid+".inline-dialog-check");o._validateClickToClose=a;o.hide=a}})},show:function(){this.beforeHide=a;this.popup.show()},refresh:function(){var m=AJS.$(this.anchorSelector);if(!m.is(":visible")){this.dismiss()}else{if(m.get(0)!==this.anchor.get(0)){this.changeAnchor(m)}else{if(!this.isVisible()){this.show()}else{this.popup.refresh()}}}},changeAnchor:function(m){var n=this.isVisible();this.dismiss();this.$el.remove();this.anchor=m;this._initDialog(m);if(n){this.show()}},dismiss:function(){this.beforeHide=d;this._popupHide()},clickNext:function(){var m=AJS.$(this.$el).find(".helptip-next");if(m.length>0){m.click()}},isVisible:function(){return this.$el.is(":visible")},_initDialog:function(o){var m=this;var n=this.model;this.popup=AJS.InlineDialog(f(o),n.cid,_.bind(this._createDialog,this),_.extend({container:"#content",noBind:true,preHideCallback:function(){return m.beforeHide()},calculatePositions:function(p,s,v,r){var q=AJS.InlineDialog.opts.calculatePositions(p,s,v,r);var u=f(this.container);var t=u.offset();if(q.popupCss.left!=="auto"){q.popupCss.left-=t.left;q.popupCss.right="auto"}q.popupCss.top-=t.top;return q},addActiveClass:false,initCallback:n.attributes.callbacks.init,hideCallback:n.attributes.callbacks.hide,persistent:true},n.attributes.inlineDialogOpts));this._popupHide=this.popup.hide;this.popup.hide=a;this.$el=f(this.popup[0]);this.$el.addClass(b)},_createDialog:function(r,p,o){var n=this;var q=AJS.HelpTip.Manager.sequences;var m=this.model.attributes.position;var s=this.model.attributes.isSequence;r.removeClass("contents");r.html(f(AJS.Templates.HelpTip.tipContent(_.extend({showNextButton:s&&(q.length>1&&(m+1<q.length)),length:q.length,position:m,showCloseButton:true},this.model.attributes))));r.unbind("mouseover mouseout");r.find(".helptip-link").click(function(){j("learn-more.clicked",n.model)});r.find(".helptip-close").click(function(t){t.preventDefault();n.model.dismiss("close-button")});r.find(".helptip-next").click(function(u){u.preventDefault();n.model.dismiss("next-button");var t=m+1;q[t]&&(q[t].show({force:true}))});o()}});var l=function(m){this.initialize(m)};f.extend(l.prototype,{initialize:function(){this.$el=f("<div></div>");this.$el.addClass(b)},show:function(){},dismiss:function(){}})})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTipManager.js' */
(function(d){var b=AJS.contextPath()+"/rest/helptips/1.0/tips";var c=undefined;if(WRM&&WRM.data){c=WRM.data.claim("com.atlassian.plugins.helptips.jira-help-tips:common.JiraHelpTipData")}var a={dismissedTipIds:[],sequences:[],loaded:d.Deferred(),url:function(){return b},sync:function(g,f){var e=d.Deferred();g||(g="get");f||(f=null);if(g==="get"&&c&&c.dismissed){e.resolve(c.dismissed)}else{d.ajax(this.url(),{type:g,dataType:"json",contentType:"application/json",data:f&&JSON.stringify(f),processData:false}).done(function(h){e.resolve(h)}).fail(function(){e.reject()})}return e.promise()},fetch:function(){var e=this.sync();e.done(d.proxy(function(f){d.merge(this.dismissedTipIds,f);this.loaded.resolve()},this));return e.promise()},show:function(e){this.loaded.done(e)},dismiss:function(e){var f=e.attributes.id;if(!f){e._dismissed=true}else{this.dismissedTipIds.push(f);this.sync("post",{id:f})}},undismiss:function(e){var f=e.attributes.id;if(!f){e._dismissed=false}else{this.dismissedTipIds.splice(d.inArray(f,this.dismissedTipIds),1);this.sync("delete",{id:f})}},isDismissed:function(e){var f=e.attributes.id;return(f)?d.inArray(f,this.dismissedTipIds)>=0:e._dismissed},clearSequences:function(){this.sequences=[]},hideSequences:function(){_.each(this.sequences,function(e){e.view.dismiss()})},showSequences:function(){if(!this._showStarted){var e=this;var f=0;this._showStarted=true;d.when(this.loaded).done(function(){e.sequences.sort(function(h,g){return h.attributes.weight-g.attributes.weight});e.sequences=_.filter(e.sequences,function(h){var g=_.indexOf(e.dismissedTipIds,h.attributes.id)===-1;if(g){h.attributes.position=f++}return g});if(e.sequences.length>0){_.last(e.sequences).attributes.showCloseButton=true;e.sequences[0].show({force:true})}e._showStarted=false})}}};if(!JIRA.Users.LoggedInUser.isAnonymous()){AJS.HelpTip.Manager=a;a.fetch()}})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'templates/HelpTip.soy' */
// This file was automatically generated from HelpTip.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }
if (typeof AJS.Templates.HelpTip == 'undefined') { AJS.Templates.HelpTip = {}; }


AJS.Templates.HelpTip.tipContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? '<h2 class="helptip-title">' + soy.$$escapeHtml(opt_data.title) + '</h2>' : '', '<p class="helptip-body">', opt_data.bodyHtml, '</p>', (opt_data.url) ? '<p><a class="helptip-link" href="' + soy.$$escapeHtml(opt_data.url) + '" target="_blank">' + ((opt_data.linkText) ? soy.$$escapeHtml(opt_data.linkText) : soy.$$escapeHtml("Learn more")) + '</a></p>' : '');
  AJS.Templates.HelpTip.tipFooter(opt_data, output);
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.tipFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="tip-footer">');
  AJS.Templates.HelpTip.nextButton(opt_data, output);
  AJS.Templates.HelpTip.closeButton(opt_data, output);
  AJS.Templates.HelpTip.sequencePaging(opt_data, output);
  output.append('</form>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.nextButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.showNextButton) ? '<button class="aui-button helptip-next" type="button">' + ((opt_data.nextButtonText) ? soy.$$escapeHtml(opt_data.nextButtonText) : soy.$$escapeHtml("Next")) + '</button>' : '');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.closeButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.showCloseButton) ? '<button class="aui-button ' + ((opt_data.showNextButton) ? ' aui-button-link ' : '') + ' helptip-close" type="button">' + ((opt_data.closeButtonText) ? soy.$$escapeHtml(opt_data.closeButtonText) : soy.$$escapeHtml("Close")) + '</button>' : '');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.sequencePaging = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isSequence && opt_data.length > 1) ? '<span class="helptip-sequence-paging">' + soy.$$escapeHtml(opt_data.position + 1) + '/' + soy.$$escapeHtml(opt_data.length) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-tooltip-resources', location = 'templates/viewissue/devstatus-cta-tooltips.soy' */
// This file was automatically generated from devstatus-cta-tooltips.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Tooltip == 'undefined') { JIRA.Templates.DevStatus.Tooltip = {}; }


JIRA.Templates.DevStatus.Tooltip.createBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'create-branch', content: '<span class="branch-illustration"></span><div class="branch-text"><p>' + soy.$$escapeHtml("Create a branch for this issue in your source repository") + '.<br /> <a class="cta-learn-more-link" href="https://www.atlassian.com/git/workflows" target="_blank">' + soy.$$escapeHtml("Learn more about branching strategies") + '.</a></p></div>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.automaticTransitions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'dev-summary-automatic-transitions', content: '<p>' + soy.$$escapeHtml("Now JIRA can automatically update your issue status when pull requests and other actions occur.") + '</p><p><a href="' + soy.$$escapeHtml(opt_data.aitHelpLinkUrl.url) + '" id="trigger-docs-link" target="_blank" title="' + soy.$$escapeHtml("Learn about automating your workflow") + '">' + soy.$$escapeHtml("Learn about automating your workflow") + '</a></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.tooltipLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cta-tooltip', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '">', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-analytics-resources', location = 'js/analytics/devstatus-analytics.js' */
(function(d,a){AJS.namespace("JIRA.DevStatus.Analytics");var b=".edit-permission-link";function c(){return !AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.analytics.disabled")}a.DevStatus.Analytics={fireEvent:function(f,g){if(c()){var e="devstatus."+f;var h=(typeof g!=="object")?{}:g;AJS.trigger("analyticsEvent",{name:e,data:h})}},fireAgileDevStatusLinkClicked:function(){return a.DevStatus.Analytics.fireEvent("panel.agile.icon.clicked")}};a.DevStatus.LabsAnalytics={fireLabsEvent:function(e){var f=e?"on":"off";return a.DevStatus.Analytics.fireEvent("labs.toggle."+f)}};a.DevStatus.SummaryAnalytics={fireSummaryShownEvent:function(g,f,e,h){var j=g?"assignee":"nonassignee";var i=_.extend({issueType:f,issueStatus:e},h);return a.DevStatus.Analytics.fireEvent("summary.shown."+j,i)},fireSummaryClickedEvent:function(f,e){var h=AJS.Meta.get("fusion-analytics-new-context-link");var g=".clicked";if(h){AJS.Meta.set("fusion-analytics-new-context-link",undefined);g+=".newcontext"}return a.DevStatus.Analytics.fireEvent(f+".summary"+g,e)},fireDetailTabClicked:function(f,e){return a.DevStatus.Analytics.fireEvent(e+".detail."+f+".tab.clicked")}};a.DevStatus.BuildsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("builds",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.project.clicked")},fireDetailPlanClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.plan.clicked")},fireDetailBuildClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.build.clicked")}};a.DevStatus.DeploymentsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("deployments",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.project.clicked")},fireDetailEnvironmentClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.environment.clicked")},fireDetailReleaseClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.release.clicked")}};a.DevStatus.CommitsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("commits",e)},fireDetailRepoClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".repo.clicked")},fireDetailCommitClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".commit.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"commits")},fireDetailFileExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.expanded.clicked")},fireDetailFilesExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".files.expanded.clicked")},fireDetailFileClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.clicked")},fireDetailReviewsShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".reviews.shown")},fireDetailReviewClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".review.clicked")},fireDetailBranchesShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".branches.shown")},fireDetailCreateReviewClicked:function(f,e){return a.DevStatus.Analytics.fireEvent("commits.detail."+f+".review.create"+(e?".all":""))}};a.DevStatus.ReviewsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("reviews",e)},fireDetailReviewClicked:function(){return a.DevStatus.Analytics.fireEvent("reviews.detail.review.clicked")}};a.DevStatus.BranchesAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("branches",e)},_fireDetailClickedEvent:function(f,e){return a.DevStatus.Analytics.fireEvent("branches.detail."+f+"."+e+".clicked")},_fireDetailClickedEventAssignable:function(f,g,e,h){if(typeof e!="undefined"&&typeof h!="undefined"){if(e){f+=".assignee"}else{f+=".nonassignee";if(h){f+=".assignable"}else{f+=".nonassignable"}}}this._fireDetailClickedEvent(g,f)},fireDetailRepoClicked:function(e){this._fireDetailClickedEvent(e,"repo")},fireDetailBranchClicked:function(e){this._fireDetailClickedEvent(e,"branch")},fireDetailPullRequestLozengeClick:function(e){this._fireDetailClickedEvent(e,"pullrequest.lozenge")},fireDetailReviewLozengeClick:function(e){this._fireDetailClickedEvent(e,"review.lozenge")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"branches")},fireDetailCreatePullRequestClicked:function(f,e,g){this._fireDetailClickedEventAssignable("pullrequest.create",f,e,g)},fireDetailCreateReviewClicked:function(f,e,g){this._fireDetailClickedEventAssignable("review.create",f,e,g)}};a.DevStatus.PullRequestsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("pullrequests",e)},fireDetailPullRequestClicked:function(e){return a.DevStatus.Analytics.fireEvent("pullrequests.detail."+e+".pullrequest.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"pullrequests")}};a.DevStatus.LearnMoreAnalytics={fireLearnMoreEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("learnmore."+e,f)}};a.DevStatus.CtaDialogAnalytics={issueDetails:{},fireCreateBranchEvent:function(e,g){g=(typeof g!=="object")?{}:g;var f=d.extend({issueStatus:this.issueDetails.status,issueType:this.issueDetails.type},g);return a.DevStatus.Analytics.fireEvent("createbranch."+e+"."+(this.issueDetails.isAssignee?"assignee":"nonassignee"),f)},_populateIssueDetails:function(e){this.issueDetails={status:""+e.data("issueStatus"),type:""+e.data("issueType"),isAssignee:e.data("isAssignee")}},_initHandler:function(h,g,j,i){if(j&&g.not(document).is(j)){var f=this;g.find(i).on("simpleClick",function(){var e=d(this);f._fireCreateBranchEvent(e)})}},_fireCreateBranchEvent:function(f){this._populateIssueDetails(f);var e="click";var g=AJS.Meta.get("fusion-analytics-new-context-link");if(g){AJS.Meta.set("fusion-analytics-new-context-link",undefined);e+=".newcontext"}this.fireCreateBranchEvent(e)},initialize:function(h,g,f){if(c()){var e=this;a.bind(a.Events.NEW_CONTENT_ADDED,_.bind(function(j,i){this._initHandler(j,i,h,g)},this));a.bind("GH.DetailView.updated",_.bind(function(i){this._initHandler(i,AJS.$(h),h,g)},this));d(g).on("simpleClick",function(){var i=d(this);e._fireCreateBranchEvent(i)});d(document).on("click","#"+f+" .jira-dialog-content .target",function(){var i=d(this);e.fireCreateBranchEvent("dialog.click",{title:i.find(".title").attr("title"),applicationType:i.data("applicationType")})});d(document).on("click","#"+f+" .jira-dialog-content button.cancel",function(){e.fireCreateBranchEvent("dialog.cancel")});d(document).on("click",".cta-tooltip .cta-learn-more-link",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.ctahelptipbranching")})}}};a.DevStatus.AdminAnalytics={fireAdminEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("admin."+e,f)},initialize:function(){if(c()){var e=this,f=d("#project-config-panel-dev-status");f.find(b).on("click",function(){e.fireAdminEvent("editpermissionlink.config."+(d("ul.permissions-list li.devstatus-admin-permission-item").length>0?"withpermissions":"nopermissions"))});f.find(".learn-more-link").on("click",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.adminappvertisementlink")});f.find("#project-config-applinks-connect").on("click",function(){e.fireAdminEvent("connect")});f.find(".devstatus-admin-connect-button-option").on("click",function(){var g=d(this).data("key")||"unknown";e.fireAdminEvent("connect."+g)})}}};a.DevStatus.AdminSummaryAnalytics={initialize:function(){if(c()){d("#project-config-webpanel-devstatus-admin-summary-panel").find(b).on("click",function(){a.DevStatus.AdminAnalytics.fireAdminEvent("editpermissionlink.summary.nopermissions")})}}}})(AJS.$,JIRA);;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-analytics', location = 'includes/js/analytics/capture-analytics.js' */
AJS.trigger=AJS.trigger||function(){};jQuery(prepAccountInfo);function prepAccountInfo(){var a=jQuery("#bonfire-build-info").find('[data-bonfire-var="bonfire-gaTrackingCode"]').data("bonfire-value")}function trackEvent(a,b){AJS.trigger("analyticsEvent",{name:a,data:b})}function getBonfire(a){trackEvent("jira.capture.install.extension",{source:"JIRA",browser:a})}function sessionStatusChangeInJira(a){trackEvent("jira.capture.session.status.change",{source:"JIRA",status:a})}function noteStatusChangeInJira(a){trackEvent("jira.capture.session.notes",{source:"JIRA",status:a})}function trackHelpButtonUse(){trackEvent("jira.capture.session.notes.help",{source:"JIRA"})}function trackParticipationLeave(){trackEvent("jira.capture.session.leave",{source:"JIRA"})}function trackParticipationJoin(){trackEvent("jira.capture.session.join",{source:"JIRA"})};;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-shared', location = 'includes/empty.js' */
;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/backbone/backbone.js' */
(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports}else{z=u.Backbone={}}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("underscore")}z.$=u.jQuery||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments)});P._callback=Q;return this.on(N,P,O)},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this}if(!M&&!V&&!N){this._events={};return this}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U)}}}if(!T.length){delete this._events[M]}}}return this},trigger:function(O){if(!this._events){return this}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this}var P=this._events[O];var M=this._events.all;if(P){b(P,N)}if(M){b(M,arguments)}return this},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this}var O=!M&&!R;if(typeof M==="object"){R=this}if(P){(N={})[P._listenerId]=P}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q]}}return this}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q))}return false}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q))}return false}return true};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx)}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N)}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M)}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T)}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P)}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this}Q[M](O,S,this);return this}});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{}}if(P=L.result(this,"defaults")){N=L.defaults({},N,P)}this.set(N,O);this.changed={};this.initialize.apply(this,arguments)};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes)},sync:function(){return z.sync.apply(this,arguments)},get:function(M){return this.attributes[M]},escape:function(M){return L.escape(this.get(M))},has:function(M){return this.get(M)!=null},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this}if(typeof U==="object"){V=U;Y=M}else{(V={})[U]=M}Y||(Y={});if(!this._validate(V,Y)){return false}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={}}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute]}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S)}if(!L.isEqual(O[S],M)){this.changed[S]=M}else{delete this.changed[S]}W?delete Q[S]:Q[S]=M}if(!R){if(T.length){this._pending=true}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y)}}if(X){return this}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y)}}this._pending=false;this._changing=false;return this},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}))},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0}return this.set(M,L.extend({},N,{unset:true}))},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed)}return L.has(this.changed,M)},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue}(P||(P={}))[M]=Q}return P},previous:function(M){if(M==null||!this._previousAttributes){return null}return this._previousAttributes[M]},previousAttributes:function(){return L.clone(this._previousAttributes)},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false}if(O){O(M,P,N)}M.trigger("sync",M,P,N)};H(this,N);return this.sync("read",this,N)},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N}else{(R={})[Q]=N}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false}if(R&&U.wait){this.attributes=L.extend({},O,R)}if(U.parse===void 0){U.parse=true}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V)}if(L.isObject(V)&&!P.set(V,U)){return false}if(S){S(P,W,U)}P.trigger("sync",P,W,U)};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O}return T},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N)};N.success=function(R){if(N.wait||M.isNew()){O()}if(Q){Q(M,R,N)}if(!M.isNew()){M.trigger("sync",M,R,N)}};if(this.isNew()){N.success();return false}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O()}return P},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(N,M){return N},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}))},_validate:function(O,N){if(!N.validate||!this.validate){return true}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N)}});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url}if(M.model){this.model=M.model}if(M.comparator!==void 0){this.comparator=M.comparator}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M))}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M)})},sync:function(){return z.sync.apply(this,arguments)},add:function(N,M){return this.set(N,L.defaults(M||{},K))},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P)}this._removeReference(N)}return this},set:function(N,Z){Z=L.defaults(Z||{},o);if(Z.parse){N=this.parse(N,Z)}if(!L.isArray(N)){N=N?[N]:[]}var U,Q,W,X,O,V;var P=Z.at;var T=this.comparator&&(P==null)&&Z.sort!==false;var R=L.isString(this.comparator)?this.comparator:null;var Y=[],M=[],S={};for(U=0,Q=N.length;U<Q;U++){if(!(W=this._prepareModel(N[U],Z))){continue}if(O=this.get(W)){if(Z.remove){S[O.cid]=true}if(Z.merge){O.set(W.attributes,Z);if(T&&!V&&O.hasChanged(R)){V=true}}}else{if(Z.add){Y.push(W);W.on("all",this._onModelEvent,this);this._byId[W.cid]=W;if(W.id!=null){this._byId[W.id]=W}}}}if(Z.remove){for(U=0,Q=this.length;U<Q;++U){if(!S[(W=this.models[U]).cid]){M.push(W)}}if(M.length){this.remove(M,Z)}}if(Y.length){if(T){V=true}this.length+=Y.length;if(P!=null){t.apply(this.models,[P,0].concat(Y))}else{D.apply(this.models,Y)}}if(V){this.sort({silent:true})}if(Z.silent){return this}for(U=0,Q=Y.length;U<Q;U++){(W=Y[U]).trigger("add",W,this,Z)}if(V){this.trigger("sort",this,Z)}return this},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O])}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N)}return this},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N},shift:function(N){var M=this.at(0);this.remove(M,N);return M},slice:function(N,M){return this.models.slice(N,M)},get:function(M){if(M==null){return void 0}return this._byId[M.id!=null?M.id:M.cid||M]},at:function(M){return this.models[M]},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[]}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false}}return true})},findWhere:function(M){return this.where(M,true)},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(L.bind(this.comparator,this))}if(!M.silent){this.trigger("sort",this,M)}return this},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L.sortedIndex(this.models,M,O,N)},pluck:function(M){return L.invoke(this.models,"get",M)},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M)}N.trigger("sync",N,P,M)};H(this,M);return this.sync("read",this,M)},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false}if(!M.wait){this.add(N,M)}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M)}if(O){O(N,Q,M)}};N.save(null,M);return N},parse:function(N,M){return N},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this}return O}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false}return M},_removeReference:function(M){if(this===M.collection){delete M.collection}M.off("all",this._onModelEvent,this)},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return}if(O==="destroy"){this.remove(N,M)}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N}}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N)}});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L[M](this.models,O,N)}});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(M,N){if(this.$el){this.undelegateEvents()}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents()}return this},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]]}if(!R){continue}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R)}else{this.$el.on(N,M,R)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M)}L.extend(this,L.pick(M,e));this.options=M},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id")}if(this.className){M["class"]=L.result(this,"className")}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false)}else{this.setElement(L.result(this,"el"),false)}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r()}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M))}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{}}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments)}}}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments)};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N)}if(L.isFunction(O)){P=O;O=""}if(!P){P=this[O]}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q)});return this},navigate:function(N,M){z.history.navigate(N,M);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N])}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)"}).replace(d,"(.*?)");return new RegExp("^"+M+"$")},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null})}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:""},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length)}}else{O=this.getHash()}}return O.replace(A,"")},start:function(O){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N)}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false},route:function(M,N){this.handlers.unshift({route:M,callback:N})},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe))}if(M===this.fragment){return false}if(this.iframe){this.navigate(M)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true}});return M},navigate:function(O,N){if(!i.started){return false}if(!N||N===true){N={trigger:N}}O=this.getFragment(O||"");if(this.fragment===O){return}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M)}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,O,N.replace)}}else{return this.location.assign(M)}}if(N.trigger){this.loadUrl(O)}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O)}else{M.hash="#"+O}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor}else{Q=function(){return N.apply(this,arguments)}}L.extend(Q,N,O);var P=function(){this.constructor=Q};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M)}Q.__super__=N.prototype;return Q};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified')};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N)}O.trigger("error",O,P,N)}}}).call(this);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/marionettejs/backbone.marionette-1.6.1.js' */
/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(d,c){var a=function(e){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();c.each(e,this.add,this)};c.extend(a.prototype,{add:function(e,g){var f=e.cid;this._views[f]=e;if(e.model){this._indexByModel[e.model.cid]=f}if(g){this._indexByCustom[g]=f}this._updateLength()},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var f=this._indexByModel[e];return this.findByCid(f)},findByCustom:function(f){var e=this._indexByCustom[f];return this.findByCid(e)},findByIndex:function(e){return c.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var f=e.cid;if(e.model){delete this._indexByModel[e.model.cid]}c.any(this._indexByCustom,function(h,g){if(h===f){delete this._indexByCustom[g];return true}},this);delete this._views[f];this._updateLength()},call:function(e){this.apply(e,c.tail(arguments))},apply:function(f,e){c.each(this._views,function(g){if(c.isFunction(g[f])){g[f].apply(g,e||[])}})},_updateLength:function(){this.length=c.size(this._views)}});var b=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];c.each(b,function(e){a.prototype[e]=function(){var f=c.values(this._views);var g=[f].concat(c.toArray(arguments));return c[e].apply(c,g)}});return a})(Backbone,_);Backbone.Wreqr=(function(d,c,a){var b={};b.Handlers=(function(g,f){var e=function(h){this.options=h;this._wreqrHandlers={};if(f.isFunction(this.initialize)){this.initialize(h)}};e.extend=g.Model.extend;f.extend(e.prototype,g.Events,{setHandlers:function(h){f.each(h,function(k,i){var j=null;if(f.isObject(k)&&!f.isFunction(k)){j=k.context;k=k.callback}this.setHandler(i,k,j)},this)},setHandler:function(i,k,j){var h={callback:k,context:j};this._wreqrHandlers[i]=h;this.trigger("handler:add",i,k,j)},hasHandler:function(h){return !!this._wreqrHandlers[h]},getHandler:function(i){var h=this._wreqrHandlers[i];if(!h){throw new Error("Handler not found for '"+i+"'")}return function(){var j=Array.prototype.slice.apply(arguments);return h.callback.apply(h.context,j)}},removeHandler:function(h){delete this._wreqrHandlers[h]},removeAllHandlers:function(){this._wreqrHandlers={}}});return e})(d,a);b.CommandStorage=(function(){var e=function(f){this.options=f;this._commands={};if(a.isFunction(this.initialize)){this.initialize(f)}};a.extend(e.prototype,d.Events,{getCommands:function(g){var f=this._commands[g];if(!f){f={command:g,instances:[]};this._commands[g]=f}return f},addCommand:function(g,f){var h=this.getCommands(g);h.instances.push(f)},clearCommands:function(f){var g=this.getCommands(f);g.instances=[]}});return e})();b.Commands=(function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(g){this.options=g||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var f=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,f)},execute:function(g,f){g=arguments[0];f=Array.prototype.slice.call(arguments,1);if(this.hasHandler(g)){this.getHandler(g).apply(this,f)}else{this.storage.addCommand(g,f)}},_executeCommands:function(f,h,g){var i=this.storage.getCommands(f);a.each(i.instances,function(j){h.apply(g,j)});this.storage.clearCommands(f)},_initializeStorage:function(f){var h;var g=f.storageType||this.storageType;if(a.isFunction(g)){h=new g()}else{h=g}this.storage=h}})})(b);b.RequestResponse=(function(e){return e.Handlers.extend({request:function(){var g=arguments[0];var f=Array.prototype.slice.call(arguments,1);return this.getHandler(g).apply(this,f)}})})(b);b.EventAggregator=(function(g,e){var f=function(){};f.extend=g.Model.extend;e.extend(f.prototype,g.Events);return f})(d,a);return b})(Backbone,Backbone.Marionette,_);var Marionette=(function(b,g,a){var f={};g.Marionette=f;f.$=g.$;var c=Array.prototype.slice;function d(h){return c.call(h)}function e(j,i){var h=new Error(j);h.name=i||"Error";throw h}f.extend=g.Model.extend;f.getOption=function(j,h){if(!j||!h){return}var i;if(j.options&&(h in j.options)&&(j.options[h]!==undefined)){i=j.options[h]}else{i=j[h]}return i};f.triggerMethod=(function(){var i=/(^|:)(\w)/gi;function j(l,m,k){return k.toUpperCase()}var h=function(l){var k="on"+l.replace(i,j);var m=this[k];if(a.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(a.isFunction(m)){return m.apply(this,a.tail(arguments))}};return h})();f.MonitorDOMRefresh=(function(i){function l(m){m._isShown=true;j(m)}function k(m){m._isRendered=true;j(m)}function j(m){if(m._isShown&&m._isRendered&&h(m)){if(a.isFunction(m.triggerMethod)){m.triggerMethod("dom:refresh")}}}function h(m){return i.contains(m.el)}return function(m){m.listenTo(m,"show",function(){l(m)});m.listenTo(m,"render",function(){k(m)})}})(document.documentElement);(function(m){function l(r,p,n,o){var q=o.split(/\s+/);a.each(q,function(s){var t=r[s];if(!t){e("Method '"+s+"' was configured as an event handler, but does not exist.")}r.listenTo(p,n,t,r)})}function h(p,o,n,q){p.listenTo(o,n,q,p)}function j(r,p,n,o){var q=o.split(/\s+/);a.each(q,function(s){var t=r[s];r.stopListening(p,n,t,r)})}function i(p,o,n,q){p.stopListening(o,n,q,p)}function k(q,n,r,p,o){if(!n||!r){return}if(a.isFunction(r)){r=r.call(q)}a.each(r,function(t,s){if(a.isFunction(t)){p(q,n,s,t)}else{o(q,n,s,t)}})}m.bindEntityEvents=function(o,n,p){k(o,n,p,h,l)};m.unbindEntityEvents=function(o,n,p){k(o,n,p,i,j)}})(f);f.Callbacks=function(){this._deferred=f.$.Deferred();this._callbacks=[]};a.extend(f.Callbacks.prototype,{add:function(i,h){this._callbacks.push({cb:i,ctx:h});this._deferred.done(function(k,j){if(h){k=h}i.call(k,j)})},run:function(h,i){this._deferred.resolve(i,h)},reset:function(){var h=this._callbacks;this._deferred=f.$.Deferred();this._callbacks=[];a.each(h,function(i){this.add(i.cb,i.ctx)},this)}});f.Controller=function(h){this.triggerMethod=f.triggerMethod;this.options=h||{};if(a.isFunction(this.initialize)){this.initialize(this.options)}};f.Controller.extend=f.extend;a.extend(f.Controller.prototype,g.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});f.Region=function(i){this.options=i||{};this.el=f.getOption(this,"el");if(!this.el){var j=new Error("An 'el' must be specified for a region.");j.name="NoElError";throw j}if(this.initialize){var h=Array.prototype.slice.apply(arguments);this.initialize.apply(this,h)}};a.extend(f.Region,{buildRegion:function(i,o){var m=(typeof i==="string");var l=(typeof i.selector==="string");var p=(typeof i.regionType==="undefined");var j=(typeof i==="function");if(!j&&!m&&!l){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var h,k;if(m){h=i}if(i.selector){h=i.selector;delete i.selector}if(j){k=i}if(!j&&p){k=o}if(i.regionType){k=i.regionType;delete i.regionType}if(m||j){i={}}i.el=h;var n=new k(i);if(i.parentEl){n.getEl=function(q){var r=i.parentEl;if(a.isFunction(r)){r=r()}return r.find(q)}}return n}});a.extend(f.Region.prototype,g.Events,{show:function(j){this.ensureEl();var h=j.isClosed||a.isUndefined(j.$el);var i=j!==this.currentView;if(i){this.close()}j.render();if(i||h){this.open(j)}this.currentView=j;f.triggerMethod.call(this,"show",j);f.triggerMethod.call(j,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(h){return f.$(h)},open:function(h){this.$el.empty().append(h.el)},close:function(){var h=this.currentView;if(!h||h.isClosed){return}if(h.close){h.close()}else{if(h.remove){h.remove()}}f.triggerMethod.call(this,"close",h);delete this.currentView},attachView:function(h){this.currentView=h},reset:function(){this.close();delete this.$el}});f.Region.extend=f.extend;f.RegionManager=(function(j){var i=j.Controller.extend({constructor:function(k){this._regions={};j.Controller.prototype.constructor.call(this,k)},addRegions:function(k,l){var m={};a.each(k,function(o,n){if(typeof o==="string"){o={selector:o}}if(o.selector){o=a.defaults({},o,l)}var p=this.addRegion(n,o);m[n]=p},this);return m},addRegion:function(m,n){var p;var l=a.isObject(n);var k=a.isString(n);var o=!!n.selector;if(k||(l&&o)){p=j.Region.buildRegion(n,j.Region)}else{if(a.isFunction(n)){p=j.Region.buildRegion(n,j.Region)}else{p=n}}this._store(m,p);this.triggerMethod("region:add",m,p);return p},get:function(k){return this._regions[k]},removeRegion:function(k){var l=this._regions[k];this._remove(k,l)},removeRegions:function(){a.each(this._regions,function(l,k){this._remove(k,l)},this)},closeRegions:function(){a.each(this._regions,function(l,k){l.close()},this)},close:function(){this.removeRegions();var k=Array.prototype.slice.call(arguments);j.Controller.prototype.close.apply(this,k)},_store:function(k,l){this._regions[k]=l;this._setLength()},_remove:function(k,l){l.close();delete this._regions[k];this._setLength();this.triggerMethod("region:remove",k,l)},_setLength:function(){this.length=a.size(this._regions)}});var h=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];a.each(h,function(k){i.prototype[k]=function(){var m=a.values(this._regions);var l=[m].concat(a.toArray(arguments));return a[k].apply(a,l)}});return i})(f);f.TemplateCache=function(h){this.templateId=h};a.extend(f.TemplateCache,{templateCaches:{},get:function(h){var i=this.templateCaches[h];if(!i){i=new f.TemplateCache(h);this.templateCaches[h]=i}return i.load()},clear:function(){var j;var h=d(arguments);var k=h.length;if(k>0){for(j=0;j<k;j++){delete this.templateCaches[h[j]]}}else{this.templateCaches={}}}});a.extend(f.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var h=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(h);return this.compiledTemplate},loadTemplate:function(h){var i=f.$(h).html();if(!i||i.length===0){e("Could not find template: '"+h+"'","NoTemplateError")}return i},compileTemplate:function(h){return a.template(h)}});f.Renderer={render:function(j,k){if(!j){var h=new Error("Cannot render the template since it's false, null or undefined.");h.name="TemplateNotFoundError";throw h}var i;if(typeof j==="function"){i=j}else{i=f.TemplateCache.get(j)}return i(k)}};f.View=g.View.extend({constructor:function(i){a.bindAll(this,"render");var h=Array.prototype.slice.apply(arguments);this.options=a.extend({},a.result(this,"options"),a.isFunction(i)?i.call(this):i);this.events=this.normalizeUIKeys(a.result(this,"events"));g.View.prototype.constructor.apply(this,h);f.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:f.triggerMethod,getTemplate:function(){return f.getOption(this,"template")},mixinTemplateHelpers:function(h){h=h||{};var i=f.getOption(this,"templateHelpers");if(a.isFunction(i)){i=i.call(this)}return a.extend(h,i)},normalizeUIKeys:function(h){if(typeof(h)==="undefined"){return}a.each(a.keys(h),function(i){var j=i.split("@ui.");if(j.length===2){h[j[0]+this.ui[j[1]]]=h[i];delete h[i]}},this);return h},configureTriggers:function(){if(!this.triggers){return}var i={};var h=this.normalizeUIKeys(a.result(this,"triggers"));a.each(h,function(l,k){var m=a.isObject(l);var j=m?l.event:l;i[k]=function(s){if(s){var n=s.preventDefault;var r=s.stopPropagation;var q=m?l.preventDefault:n;var p=m?l.stopPropagation:r;if(q&&n){n.apply(s)}if(p&&r){r.apply(s)}}var o={view:this,model:this.model,collection:this.collection};this.triggerMethod(j,o)}},this);return i},delegateEvents:function(h){this._delegateDOMEvents(h);f.bindEntityEvents(this,this.model,f.getOption(this,"modelEvents"));f.bindEntityEvents(this,this.collection,f.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(h){h=h||this.events;if(a.isFunction(h)){h=h.call(this)}var j={};var i=this.configureTriggers();a.extend(j,h,i);g.View.prototype.delegateEvents.call(this,j)},undelegateEvents:function(){var h=Array.prototype.slice.call(arguments);g.View.prototype.undelegateEvents.apply(this,h);f.unbindEntityEvents(this,this.model,f.getOption(this,"modelEvents"));f.unbindEntityEvents(this,this.collection,f.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return}var h=this.triggerMethod("before:close");if(h===false){return}this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return}if(!this._uiBindings){this._uiBindings=this.ui}var h=a.result(this,"_uiBindings");this.ui={};a.each(a.keys(h),function(j){var i=h[j];this.ui[j]=this.$(i)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return}a.each(this.ui,function(i,h){delete this.ui[h]},this);this.ui=this._uiBindings;delete this._uiBindings}});f.ItemView=f.View.extend({constructor:function(){f.View.prototype.constructor.apply(this,d(arguments))},serializeData:function(){var h={};if(this.model){h=this.model.toJSON()}else{if(this.collection){h={items:this.collection.toJSON()}}}return h},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var j=this.serializeData();j=this.mixinTemplateHelpers(j);var i=this.getTemplate();var h=f.Renderer.render(i,j);this.$el.html(h);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return}this.triggerMethod("item:before:close");f.View.prototype.close.apply(this,d(arguments));this.triggerMethod("item:closed")}});f.CollectionView=f.View.extend({itemViewEventPrefix:"itemview",constructor:function(h){this._initChildViewStorage();f.View.prototype.constructor.apply(this,d(arguments));this._initialEvents();this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment();this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true},endBuffering:function(){this.isBuffering=false;this.appendBuffer(this,this.elBuffer);this._triggerShowBufferedChildren();this.initRenderBuffer()},_triggerShowBufferedChildren:function(){if(this._isShown){a.each(this._bufferedChildren,function(h){f.triggerMethod.call(h,"show")});this._bufferedChildren=[]}},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(k,l,i){this.closeEmptyView();var j=this.getItemView(k);var h=this.collection.indexOf(k);this.addItemView(k,j,h)},onShowCalled:function(){this.children.each(function(h){f.triggerMethod.call(h,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.startBuffering();this.closeEmptyView();this.closeChildren();if(!this.isEmpty(this.collection)){this.showCollection()}else{this.showEmptyView()}this.endBuffering()},showCollection:function(){var h;this.collection.each(function(j,i){h=this.getItemView(j);this.addItemView(j,h,i)},this)},showEmptyView:function(){var i=this.getEmptyView();if(i&&!this._showingEmptyView){this._showingEmptyView=true;var h=new g.Model();this.addItemView(h,i,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getEmptyView:function(){return f.getOption(this,"emptyView")},getItemView:function(i){var h=f.getOption(this,"itemView");if(!h){e("An `itemView` must be specified","NoItemViewError")}return h},addItemView:function(k,j,i){var l=f.getOption(this,"itemViewOptions");if(a.isFunction(l)){l=l.call(this,k,i)}var h=this.buildItemView(k,j,l);this.addChildViewEventForwarding(h);this.triggerMethod("before:item:added",h);this.children.add(h);this.renderItemView(h,i);if(this._isShown&&!this.isBuffering){f.triggerMethod.call(h,"show")}this.triggerMethod("after:item:added",h);return h},addChildViewEventForwarding:function(h){var i=f.getOption(this,"itemViewEventPrefix");this.listenTo(h,"all",function(){var k=d(arguments);var l=k[0];var j=this.getItemEvents();k[0]=i+":"+l;k.splice(1,0,h);if(typeof j!=="undefined"&&a.isFunction(j[l])){j[l].apply(this,k)}f.triggerMethod.apply(this,k)},this)},getItemEvents:function(){if(a.isFunction(this.itemEvents)){return this.itemEvents.call(this)}return this.itemEvents},renderItemView:function(h,i){h.render();this.appendHtml(this,h,i)},buildItemView:function(j,h,k){var i=a.extend({model:j},k);return new h(i)},removeItemView:function(i){var h=this.children.findByModel(i);this.removeChildView(h);this.checkEmpty()},removeChildView:function(h){if(h){this.stopListening(h);if(h.close){h.close()}else{if(h.remove){h.remove()}}this.children.remove(h)}this.triggerMethod("item:removed",h)},isEmpty:function(h){return !this.collection||this.collection.length===0},checkEmpty:function(){if(this.isEmpty(this.collection)){this.showEmptyView()}},appendBuffer:function(i,h){i.$el.append(h)},appendHtml:function(h,j,i){if(h.isBuffering){h.elBuffer.appendChild(j.el);h._bufferedChildren.push(j)}else{h.$el.append(j.el)}},_initChildViewStorage:function(){this.children=new g.ChildViewContainer()},close:function(){if(this.isClosed){return}this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");f.View.prototype.close.apply(this,d(arguments))},closeChildren:function(){this.children.each(function(h){this.removeChildView(h)},this);this.checkEmpty()}});f.CompositeView=f.CollectionView.extend({constructor:function(){f.CollectionView.prototype.constructor.apply(this,d(arguments))},_initialEvents:function(){this.once("render",function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}})},getItemView:function(i){var h=f.getOption(this,"itemView")||this.constructor;if(!h){e("An `itemView` must be specified","NoItemViewError")}return h},serializeData:function(){var h={};if(this.model){h=this.model.toJSON()}return h},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var h=this.renderModel();this.$el.html(h);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){this.triggerMethod("composite:collection:before:render");f.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var i={};i=this.serializeData();i=this.mixinTemplateHelpers(i);var h=this.getTemplate();return f.Renderer.render(h,i)},appendBuffer:function(i,h){var j=this.getItemViewContainer(i);j.append(h)},appendHtml:function(h,j,i){if(h.isBuffering){h.elBuffer.appendChild(j.el);h._bufferedChildren.push(j)}else{var k=this.getItemViewContainer(h);k.append(j.el)}},getItemViewContainer:function(k){if("$itemViewContainer" in k){return k.$itemViewContainer}var i;var j=f.getOption(k,"itemViewContainer");if(j){var h=a.isFunction(j)?j.call(this):j;i=k.$(h);if(i.length<=0){e("The specified `itemViewContainer` was not found: "+k.itemViewContainer,"ItemViewContainerMissingError")}}else{i=k.$el}k.$itemViewContainer=i;return i},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});f.Layout=f.ItemView.extend({regionType:f.Region,constructor:function(h){h=h||{};this._firstRender=true;this._initializeRegions(h);f.ItemView.prototype.constructor.call(this,h)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var i=Array.prototype.slice.apply(arguments);var h=f.ItemView.prototype.render.apply(this,i);return h},close:function(){if(this.isClosed){return}this.regionManager.close();var h=Array.prototype.slice.apply(arguments);f.ItemView.prototype.close.apply(this,h)},addRegion:function(h,i){var j={};j[h]=i;return this._buildRegions(j)[h]},addRegions:function(h){this.regions=a.extend({},this.regions,h);return this._buildRegions(h)},removeRegion:function(h){delete this.regions[h];return this.regionManager.removeRegion(h)},_buildRegions:function(j){var h=this;var i={regionType:f.getOption(this,"regionType"),parentEl:function(){return h.$el}};return this.regionManager.addRegions(j,i)},_initializeRegions:function(h){var i;this._initRegionManager();if(a.isFunction(this.regions)){i=this.regions(h)}else{i=this.regions||{}}this.addRegions(i)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(h){h.reset()})},_initRegionManager:function(){this.regionManager=new f.RegionManager();this.listenTo(this.regionManager,"region:add",function(h,i){this[h]=i;this.trigger("region:add",h,i)});this.listenTo(this.regionManager,"region:remove",function(h,i){delete this[h];this.trigger("region:remove",h,i)})}});f.AppRouter=g.Router.extend({constructor:function(i){g.Router.prototype.constructor.apply(this,d(arguments));this.options=i||{};var j=f.getOption(this,"appRoutes");var h=this._getController();this.processAppRoutes(h,j)},appRoute:function(j,i){var h=this._getController();this._addAppRoute(h,j,i)},processAppRoutes:function(h,j){if(!j){return}var i=a.keys(j).reverse();a.each(i,function(k){this._addAppRoute(h,k,j[k])},this)},_getController:function(){return f.getOption(this,"controller")},_addAppRoute:function(h,j,i){var k=h[i];if(!k){throw new Error("Method '"+i+"' was not found on the controller")}this.route(j,i,a.bind(k,h))}});f.Application=function(h){this._initRegionManager();this._initCallbacks=new f.Callbacks();this.vent=new g.Wreqr.EventAggregator();this.commands=new g.Wreqr.Commands();this.reqres=new g.Wreqr.RequestResponse();this.submodules={};a.extend(this,h);this.triggerMethod=f.triggerMethod};a.extend(f.Application.prototype,g.Events,{execute:function(){var h=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,h)},request:function(){var h=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,h)},addInitializer:function(h){this._initCallbacks.add(h)},start:function(h){this.triggerMethod("initialize:before",h);this._initCallbacks.run(h,this);this.triggerMethod("initialize:after",h);this.triggerMethod("start",h)},addRegions:function(h){return this._regionManager.addRegions(h)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(h){this._regionManager.removeRegion(h)},getRegion:function(h){return this._regionManager.get(h)},module:function(h,k){var j=f.Module;if(k){j=k.moduleClass||j}var i=d(arguments);i.unshift(this);return j.create.apply(j,i)},_initRegionManager:function(){this._regionManager=new f.RegionManager();this.listenTo(this._regionManager,"region:add",function(h,i){this[h]=i});this.listenTo(this._regionManager,"region:remove",function(h,i){delete this[h]})}});f.Application.extend=f.extend;f.Module=function(i,j,h){this.moduleName=i;this.options=a.extend({},this.options,h);this.initialize=h.initialize||this.initialize;this.submodules={};this._setupInitializersAndFinalizers();this.app=j;this.startWithParent=true;this.triggerMethod=f.triggerMethod;if(a.isFunction(this.initialize)){this.initialize(this.options)}};f.Module.extend=f.extend;a.extend(f.Module.prototype,g.Events,{initialize:function(){},addInitializer:function(h){this._initializerCallbacks.add(h)},addFinalizer:function(h){this._finalizerCallbacks.add(h)},start:function(h){if(this._isInitialized){return}a.each(this.submodules,function(i){if(i.startWithParent){i.start(h)}});this.triggerMethod("before:start",h);this._initializerCallbacks.run(h,this);this._isInitialized=true;this.triggerMethod("start",h)},stop:function(){if(!this._isInitialized){return}this._isInitialized=false;f.triggerMethod.call(this,"before:stop");a.each(this.submodules,function(h){h.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();f.triggerMethod.call(this,"stop")},addDefinition:function(h,i){this._runModuleDefinition(h,i)},_runModuleDefinition:function(i,j){if(!i){return}var h=a.flatten([this,this.app,g,f,f.$,a,j]);i.apply(this,h)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new f.Callbacks();this._finalizerCallbacks=new f.Callbacks()}});a.extend(f.Module,{create:function(n,h,i){var j=n;var l=d(arguments);l.splice(0,3);h=h.split(".");var k=h.length;var m=[];m[k-1]=i;a.each(h,function(o,p){var q=j;j=this._getModule(q,o,n,i);this._addModuleDefinition(q,j,m[p],l)},this);return j},_getModule:function(n,k,o,m,j){var i=f.Module;var h=a.extend({},m);if(m){i=m.moduleClass||i}var l=n[k];if(!l){l=new i(k,o,h);n[k]=l;n.submodules[k]=l}return l},_addModuleDefinition:function(m,i,l,h){var k;var j;if(a.isFunction(l)){k=l;j=true}else{if(a.isObject(l)){k=l.define;j=(typeof l.startWithParent!=="undefined")?l.startWithParent:true}else{j=true}}if(k){i.addDefinition(k,h)}i.startWithParent=i.startWithParent&&j;if(i.startWithParent&&!i.startWithParentIsConfigured){i.startWithParentIsConfigured=true;m.addInitializer(function(n){if(i.startWithParent){i.start(n)}})}}});return f})(this,Backbone,_);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/namespace.js' */
JIRA.ProjectConfig||(JIRA.ProjectConfig={});JIRA.ProjectConfig.Backbone=Backbone.noConflict();;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/lib/jquery-scrollintoview/jquery.scrollintoview.js' */
/*!
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(f){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:0,direction:"y"};var e=/^(?:html)$/i;var g=function(k,j){j=j||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(k,null):k.currentStyle);var i=document.defaultView&&document.defaultView.getComputedStyle?true:false;var h={top:(parseFloat(i?j.borderTopWidth:f.css(k,"borderTopWidth"))||0),left:(parseFloat(i?j.borderLeftWidth:f.css(k,"borderLeftWidth"))||0),bottom:(parseFloat(i?j.borderBottomWidth:f.css(k,"borderBottomWidth"))||0),right:(parseFloat(i?j.borderRightWidth:f.css(k,"borderRightWidth"))||0)};return{top:h.top,left:h.left,bottom:h.bottom,right:h.right,vertical:h.top+h.bottom,horizontal:h.left+h.right}};var d=function(h){var j=f(window);var i=e.test(h[0].nodeName);return{border:i?{top:0,left:0,bottom:0,right:0}:g(h[0]),scroll:{top:(i?j:h).scrollTop(),left:(i?j:h).scrollLeft()},scrollbar:{right:i?0:h.innerWidth()-h[0].clientWidth,bottom:i?0:h.innerHeight()-h[0].clientHeight},rect:(function(){var k=h[0].getBoundingClientRect();return{top:i?0:k.top,left:i?0:k.left,bottom:i?h[0].clientHeight:k.bottom,right:i?h[0].clientWidth:k.right}})()}};f.fn.extend({scrollIntoViewForAuto:function(j){j=f.extend({},b,j);j.direction=c[typeof(j.direction)==="string"&&j.direction.toLowerCase()]||c.both;var n="";if(j.direction.x===true){n="horizontal"}if(j.direction.y===true){n=n?"both":"vertical"}var l=this.eq(0);var i=l.closest(":scrollable("+n+")");if(i.length>0){i=i.eq(0);var m={e:d(l),s:d(i)};var h={top:m.e.rect.top-(m.s.rect.top+m.s.border.top),bottom:m.s.rect.bottom-m.s.border.bottom-m.s.scrollbar.bottom-m.e.rect.bottom,left:m.e.rect.left-(m.s.rect.left+m.s.border.left),right:m.s.rect.right-m.s.border.right-m.s.scrollbar.right-m.e.rect.right};var k={};if(j.direction.y===true){if(h.top<0){k.scrollTop=m.s.scroll.top+h.top-30}else{if(h.top>0&&h.bottom<0){k.scrollTop=m.s.scroll.top+Math.min(h.top,-h.bottom)+30}}}if(j.direction.x===true){if(h.left<0){k.scrollLeft=m.s.scroll.left+h.left}else{if(h.left>0&&h.right<0){k.scrollLeft=m.s.scroll.left+Math.min(h.left,-h.right)}}}if(!f.isEmptyObject(k)){if(e.test(i[0].nodeName)){i=f("html,body")}i.animate(k,j.duration).eq(0).queue(function(o){f.isFunction(j.complete)&&j.complete.call(i[0]);o()})}else{f.isFunction(j.complete)&&j.complete.call(i[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};f.extend(f.expr[":"],{scrollable:function(k,i,n,h){var m=c[typeof(n[3])==="string"&&n[3].toLowerCase()]||c.both;var l=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(k,null):k.currentStyle);var o={x:a[l.overflowX.toLowerCase()]||false,y:a[l.overflowY.toLowerCase()]||false,isRoot:e.test(k.nodeName)};if(!o.x&&!o.y&&!o.isRoot){return false}var j={height:{scroll:k.scrollHeight,client:k.clientHeight},width:{scroll:k.scrollWidth,client:k.clientWidth},scrollableX:function(){return(o.x||o.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(o.y||o.isRoot)&&this.height.scroll>this.height.client}};return m.y&&j.scrollableY()||m.x&&j.scrollableX()}})})(jQuery);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/namespace.js' */
AJS.namespace("JIRA.Admin.CustomFields");;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'global/templates/messages.soy' */
// This file was automatically generated from messages.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Messages == 'undefined') { JIRA.Templates.Messages = {}; }


JIRA.Templates.Messages.msg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), '"><p class="title"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type), '"></span>', (opt_data.title) ? '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', '</p>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Messages.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.msg(soy.$$augmentData(opt_data, {type: 'error'}), output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/customfields.soy' */
// This file was automatically generated from customfields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }


JIRA.Templates.CustomFields.types = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="customfields-types"></ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.type = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type.previewImageUrl) ? '<img class="field-preview" src="' + soy.$$escapeHtml(opt_data.type.previewImageUrl) + '" alt="' + soy.$$escapeHtml(opt_data.type.name) + '" width="120" height="60" />' : '<span class="field-preview-empty"><span class="field-preview-empty-message">' + soy.$$escapeHtml("No field preview") + '</span></span>', (opt_data.type.isManaged) ? '<span class="aui-lozenge aui-lozenge-subtle field-is-managed" title="' + soy.$$escapeHtml(opt_data.type.managedDescription) + '">' + soy.$$escapeHtml("Managed") + '</span>' : '', '<h3 class="field-name">', soy.$$escapeHtml(opt_data.type.name), '</h3>', (opt_data.type.description) ? '<p class="field-description">' + soy.$$escapeHtml(opt_data.type.description) + '</p>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({content: "Your search did not match any custom field types."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeMarketplace = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy35 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.contextPath), '/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&amp;source=custom_fields_create">');
  open__soy35 = open__soy35.toString();
  var close__soy39 = new soy.StringBuilder('</a>');
  close__soy39 = close__soy39.toString();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("Try searching the {0}Atlassian Marketplace{1} for other custom field types.",open__soy35,close__soy39)}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeOtherTab = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("{0}Custom field types{1} have been found in other categories.",'<a href="#" class="customfields-all-category-link">','</a>')}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.quickSearch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="jira-field-search" type="text" title="', soy.$$escapeHtml("Search"), '" placeholder="', soy.$$escapeHtml("Search"), '">');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotification = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-notification"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotificationWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.warningMsg({msg: '<div class="jira-dialog-notification-content"></div>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'dialog-title\'><div class=\'jira-dialog-title-actions\'></div><div class=\'jira-dialog-title-main\'></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.errorDialogTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsComponent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="text" class="text custom-field-options-input" id="custom-field-options-input" maxlength="255"/><button type="button" class="aui-button custom-field-options-add" id="custom-field-options-add">', soy.$$escapeHtml("Add"), '</button><div id="custom-field-options-list-container" class="custom-field-options"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="aui-icon aui-icon-small aui-iconfont-remove-label custom-field-options-delete" href="#"></a><div class="icon-draghandle custom-field-option-handle"></div><div title="', soy.$$escapeHtml(opt_data.name), '" class="custom-field-option-value">', soy.$$escapeHtml(opt_data.name), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.submitHack = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input tabIndex="-1" type="submit" class="custom-field-trigger" value="submit"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.addCompleteError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml(opt_data.message));
  if (opt_data.failedSteps.length > 0) {
    output.append('<ul>');
    var failList85 = opt_data.failedSteps;
    var failListLen85 = failList85.length;
    for (var failIndex85 = 0; failIndex85 < failListLen85; failIndex85++) {
      var failData85 = failList85[failIndex85];
      output.append('<li>', soy.$$escapeHtml(failData85), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.sharedByCreate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy92 = new soy.StringBuilder('<a>');
  open__soy92 = open__soy92.toString();
  var close__soy94 = new soy.StringBuilder('</a>');
  close__soy94 = close__soy94.toString();
  output.append((opt_data.projects.length > 1) ? '<span>' + AJS.format("This custom field will also be visible in {0}{1} other projects{2}.",open__soy92,opt_data.projects.length,close__soy94) + '</span>' : '<span>' + AJS.format("This custom field will also be visible in {0}1 other project{1}.",open__soy92,close__soy94) + '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.shareByInline = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="shared-item-content"><h3>', soy.$$escapeHtml("Other projects where the field will be visible"), ':</h3><ul class="shared-project-list">');
  var projectList111 = opt_data.projects;
  var projectListLen111 = projectList111.length;
  for (var projectIndex111 = 0; projectIndex111 < projectListLen111; projectIndex111++) {
    var projectData111 = projectList111[projectIndex111];
    output.append('<li><a class="shared-project-name" href="', soy.$$escapeHtml(contextPath), '/plugins/servlet/project-config/', soy.$$escapeHtml(projectData111.key), '"><img class="shared-project-icon" width="16" height="16" alt="" src="', soy.$$escapeHtml(contextPath), '/secure/projectavatar?size=small&amp;pid=', soy.$$escapeHtml(projectData111.id), '" /> ', soy.$$escapeHtml(projectData111.name), '</a></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/FieldWisherStep.soy' */
// This file was automatically generated from FieldWisherStep.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.FieldWisherStep == 'undefined') { JIRA.Templates.CustomFields.FieldWisherStep = {}; }


JIRA.Templates.CustomFields.FieldWisherStep.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui"><div class="field-group"><label for="field-name">', soy.$$escapeHtml("Name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("(required)"), '</span></label><select name="field-name" id="field-name"><option data-placeholder="empty"></option>');
  var fieldList8 = opt_data.fields;
  var fieldListLen8 = fieldList8.length;
  for (var fieldIndex8 = 0; fieldIndex8 < fieldListLen8; fieldIndex8++) {
    var fieldData8 = fieldList8[fieldIndex8];
    output.append('<option value="', soy.$$escapeHtml(fieldData8.id), '">', soy.$$escapeHtml(fieldData8.name), '</option>');
  }
  output.append('</select><div class="description">', soy.$$escapeHtml("Search for an existing field, or name a new one."), '</div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/ErrorDialog.soy' */
// This file was automatically generated from ErrorDialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.ErrorDialog == 'undefined') { JIRA.Templates.CustomFields.ErrorDialog = {}; }


JIRA.Templates.CustomFields.ErrorDialog.header = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.ErrorDialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.errorMessage({message: opt_data.text}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/ErrorDialog/ErrorDialog.js' */
(function(b,a,c,d){b.ErrorDialog=function(e){var g,f,h;e||(e={});a.defaults(e,{heading:"",message:""});g=new d.Marionette.View({el:c(JIRA.Templates.CustomFields.ErrorDialog.content({text:e.message}))});f=this.dialog=new b.Dialog();this.$el=f.$el;h=JIRA.Templates.CustomFields.ErrorDialog.header({text:e.heading});f.addHeaderMain(h);f.addPanel("",g);f.addLink({label:"Cancel",click:a.bind(this.cancel,this)});this.listenTo(f,"close",this.cancel)};a.extend(b.ErrorDialog.prototype,d.Events,{show:function(){this.dialog.show()},hide:function(){this.dialog&&this.dialog.hide()},cancel:function(){this.trigger("cancel")},destroy:function(){if(this.dialog){this.dialog.destroy();delete this.dialog}},hideLoading:function(){return this},showLoading:function(){return this},isDirty:function(){return false}})})(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util/util.js' */
(function(b,c,a){function d(e){return e===undefined||e===null}b.lowerCaseLocaleComparator=function(e){return function(g,f){var i=g.get(e),h=f.get(e);if(d(i)&&d(h)){return 0}else{if(d(i)){return -1}else{if(d(h)){return 1}}}return i.toLocaleLowerCase().localeCompare(h.toLocaleLowerCase())}};b.url=function(h,j){if(a.isArray(h)){var g="";for(var f=0;f<h.length;f++){g=g+"/"+encodeURIComponent(""+h[f])}h=g}var e="";if(j){e="?"+c.param(j,true)}return AJS.contextPath()+h+e}})(JIRA.Admin.CustomFields,AJS.$,_);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util/FilteredCollection.js' */
(function(a,b){a.FilteredCollection=b.Collection.extend({initialize:function(){this.filteredModels=[]},filter:function(f){var c=this,e={};var d=_.groupBy(this.filteredModels,function(g){return c.matcher(g,f,e)?"show":"hide"});this.filteredModels=d.hide||[];_.each(d.show,function(g){c.add(g)});_.chain(this.models).filter(function(g){return !c.matcher(g,f,e)}).each(function(g){c.remove(g);c.filteredModels.push(g)})}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Dialog.js' */
(function(b,f,e,a,c){b.Dialog=function(g){g||(g={});a.defaults(g,{width:840,height:530});g.keypressListener=a.bind(this.onKeydown,this);this._dialog=new AJS.Dialog(g);this._page=this._dialog.getPage(0);this._currentPanel=null;this._notification=null;this._isShown=false;this.$el=this._dialog.popup.element;this._page.header=JIRA.Templates.CustomFields.dialogHeader();this.$el.prepend(this._page.header);this.$el.addClass("jira-customfields-wizard")};a.extend(b.Dialog.prototype,f.Events,{_recalcPageSize:function(){if(this.$notification){var h=null;for(var k=0;k<this._page.panel.length;k++){var j=this._page.panel[k];if(!j.isSizeRecalculated){h=h||j.body.outerHeight()-this.$notification.outerHeight();var g=j.body;g.css("height",h);j.isSizeRecalculated=true;if(!this._page.menu.isSizeRecalculated){this._page.menu.css("height",h);this._page.menu.isSizeRecalculated=true}}}}return this},onKeydown:function(g){if(g.keyCode===c.ui.keyCode.ESCAPE){this.trigger("close")}},triggerMethod:e.triggerMethod,_lastButtonElement:function(){var g=a.last(this._page.button);return g.item},_setNotification:function(h,g){if(this._notification&&this._isShown){this._notification._triggerHide()}if(!this.$notification){this.$notification=c(JIRA.Templates.CustomFields.dialogNotification());this.$notification.append(h);this.$el.find(".dialog-components").prepend(this.$notification)}else{this.$notification.html(h)}this._recalcPageSize();this._notification=new d(g);if(this._isShown){this._notification._triggerShow()}return this},setWarningNotification:function(g){var h=c(JIRA.Templates.CustomFields.dialogNotificationWarning());h.find(".jira-dialog-notification-content").html(g.render().$el);return this._setNotification(h,g)},addHeaderMain:function(g){this.$el.find(".jira-dialog-title-main").append(g);this._page.recalcSize();return this},addOrSetHeaderMainText:function(h){var g=this.$el.find(".jira-dialog-title-main .jira-dialog-title-text");if(g.length>0){g.text(h);return this}else{return this.addHeaderMain(c("<h2 class='jira-dialog-title-text'/>").text(h))}},addHeaderAction:function(g){var h=this.$el.find(".jira-dialog-title-actions");h.append(g.render().$el);this._page.recalcSize();return this},showLoading:function(){if(!this.$loading){var g=this.$el.find(".dialog-button-panel button").eq(0);this.$loading=c("<span>").addClass("icon dialog-spinner");this.$loading.insertBefore(g)}this.$loading.spin()},hideLoading:function(){if(this.$loading){this.$loading.spin(false)}},addButton:function(h){var g=h.secondary?" aui-button-secondary":" aui-button-primary";this._dialog.addButton(h.label,h.click,"aui-button"+g);var i=this._lastButtonElement();i.removeClass("button-panel-button");h.id&&i.attr("id",h.id);if(h.submitAccessKey){this._addSubmitKey(i)}return new b.Dialog.Button(i)},addLeftLink:function(g){var h;this._dialog.addLink(g.label,g.click,"secondary",g.url);h=this._lastButtonElement();h=h.removeClass("button-panel-button");if(g.iconClass){c('<span class="icon"/>').addClass(g.iconClass).prependTo(h)}return this},addLink:function(g){this._dialog.addLink(g.label,g.click);var h=this._lastButtonElement();if(g.cancelAccessKey){this._addCancelKey(h)}return this},addPanel:function(i,h){this._dialog.addPanel(i,h.render().el);var j=this._page.getCurrentPanel();var g=new b.Dialog.Panel(this,i,h,j);j.button.click(a.bind(function(){this._onShowPanel(g)},this));this._onShowPanel(g);return g},show:function(){if(!this._isShown){this._dialog.show();this._recalcPageSize();this._isShown=true;this._currentPanel&&this._currentPanel._triggerShow();this._notification&&this._notification._triggerShow()}return this},hide:function(){this.hideLoading();if(this._isShown){this._currentPanel&&this._currentPanel._triggerHide();this._notification&&this._notification._triggerHide();this._dialog&&this._dialog.hide();this._isShown=false}},destroy:function(){this.hide();this._dialog&&this._dialog.remove();delete this._dialog},_addSubmitKey:function(h){var g="s";h.prop("accessKey",g);h.attr("title",AJS.format("Press {1}+{0} to submit this form",g,AJS.Navigator.modifierKey()));return this},_addCancelKey:function(h){var g="`";h.prop("accessKey",g);h.attr("title",AJS.format("Press {1}+{0} to cancel",g,AJS.Navigator.modifierKey()));return this},_onShowPanel:function(g){if(!this._isShown){this._currentPanel=g;return}if(this._currentPanel){if(this._currentPanel!==g){this._currentPanel._triggerHide();this._currentPanel=g;this._currentPanel._triggerShow()}}else{this._currentPanel=g;this._currentPanel._triggerShow()}},currentPanel:function(){return this._currentPanel},showErrors:function(j){if(j&&j.length){var h=c(JIRA.Templates.Messages.errorMessage({message:j.join(" ")}));if(this.$error){this.$error.replaceWith(h)}else{var i=this.$el.find(".dialog-panel-body").filter(":visible");var g=i.find("form").filter(":first");if(g.length){i=g}i.prepend(h)}this.$error=h}else{if(this.$error){this.$error.remove();delete this.$error}}return this},hideErrors:function(){this.$el.find(".dialog-panel-body .error").hide()}});b.Dialog.Panel=function(j,i,h,g){this.dialog=j;this.name=i;this.view=h;this.panel=g};a.extend(b.Dialog.Panel.prototype,f.Events,{_triggerHide:function(){return this.triggerMethod("dialog:panel:hide")},_triggerShow:function(){return this.triggerMethod("dialog:panel:show")},triggerMethod:function(g){e.triggerMethod.call(this,g);this.view.triggerMethod(g);return this},show:function(){this.panel.select();return this}});b.Dialog.Button=function(g){this.element=g};a.extend(b.Dialog.Button.prototype,{disable:function(){this.element.prop("disabled",true);return this},enable:function(){this.element.prop("disabled",false);return this},click:function(){this.element.click.apply(this.element,arguments);return this},setLabel:function(g){this.element.text(g);return this}});var d=function(g){this.view=g};a.extend(d.prototype,{_triggerHide:function(){return this.triggerMethod("dialog:notification:hide")},_triggerShow:function(){return this.triggerMethod("dialog:notification:show")},triggerMethod:function(g){this.view.triggerMethod(g);return this}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,JIRA.ProjectConfig.Backbone.Marionette,_,AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Forms.js' */
(function(c,h,d,j,k){var f=c.Form=h.View.extend({initialize:function(m){var n=this.$form=d(aui.form.form(j.defaults(j.pick(m,"id","action"),{action:"",content:"",extraClasses:k.ClassNames.EXEMPT})));this.setElement(n);this.fields={};this.fieldOrder=[];j.each(m.fields,function(o){this.addField(o)},this);this.$form.submit(j.bind(this._submit,this));if(d.browser.msie){this.$form.bind("keypress",function(o){if(o.keyCode===d.ui.keyCode.ENTER&&d(o.target).is("input")){o.preventDefault();d(this).submit()}})}},addField:function(q){if(q.content){var o=q.content;if(j.isFunction(o)){o=o.call(this)}this.$form.append(o)}else{var n="";if(q.label){n=aui.form.label({forField:q.id,isRequired:!!q.required,content:q.label})}var p=d(aui.form.fieldGroup({content:n}));var r=new this._getField(q);var m=q.name||q.id;if(m){this.fields[m]=r}this.fieldOrder.push(r);this.$form.append(p.append(r.render().$el))}return this},setValueOfFieldWithName:function(m,n){this.fields[m].value(n)},_getField:function(o){if(o.field){return o.field}else{var m=o.type;if(j.isString(m)){m=f.DEFAULT_TYPES[m]}var n=j.extend({},o,{form:this});return new m(n)}},focus:function(){return this._focusFirstField(this.fieldOrder)},blur:function(){j.each(this.fieldOrder,function(m){m.blur()});return this},submit:function(){this.$form.submit();return this},validate:function(){var m=j.reduce(this.fieldOrder,function(o,n){if(!n.validate()){o.push(n)}return o},[],this);if(m.length){this._focusFirstField(m);return false}else{return true}},showErrors:function(m,n){m=m||{};n=n||[];var o=j.reduce(this.fieldOrder,function(q,p){if(p.showRelevantErrors(m,n)){q.push(p)}return q},[],this);if(o.length){this._focusFirstField(o);return true}else{return false}},enable:function(){j.each(this.fieldOrder,function(m){m.enable()});return this},disable:function(){j.each(this.fieldOrder,function(m){m.disable()});return this},isDirty:function(){for(var m=0;m<this.fieldOrder.length;m++){if(this.fieldOrder[m].isDirty()){return true}}return false},toJSON:function(){return j.reduce(this.fieldOrder,function(m,n){n.addValueToData(m);return m},{},this)},_submit:function(m){m.preventDefault();if(!this._interceptSubmit()){if(this.validate()){this.trigger(f.EVENTS.submit)}}},_interceptSubmit:function(){return j.reduce(this.fieldOrder,function(m,n){return n.handleSubmit()||m},false,this)},_focusFirstField:function(m){for(var n=0;n<m.length;n++){if(m[n].focus()){break}}return this}});f.Fields={};var a=f.Fields.FormField=h.View.extend({initialize:function(m){},focus:function(){return true},blur:function(){return true},validate:function(){return true},showRelevantErrors:function(m,n){return false},addValueToData:function(m){},setError:function(m){return this},clearError:function(){return this},value:function(m){return this},disable:function(){return this},enable:function(){return this},handleSubmit:function(){return false},isDirty:function(){return false}});f.Fields.FormField.extend=function(m){if(m.mixin){var n=[];m.initialize&&n.push(m.initialize);j.each(m.mixin,function(o){j.each(o,function(q,p){if(p==="initialize"){n.push(q)}else{m[p]=q}})});m=j.omit(m,"mixin");if(n.length>1){m.initialize=function(){var o=j.toArray(arguments);j.each(n,function(p){p.apply(this,o)},this)}}else{if(n.length===1){m.initialize=n[0]}}}return h.View.extend.call(this,m)};f.Fields.NamedFieldMixin={initialize:function(m){this.name=m.name||m.id},showRelevantErrors:function(m){var n=m[this.name];if(n){this.setError(n);delete m[this.name];return true}else{this.clearError();return false}},addValueToData:function(m){var n=this.value();if(!j.isUndefined(n)&&!j.isNull(n)&&n!==""){m[this.name]=n}return this}};f.Fields.ValidatorMixin={initialize:function(m){this.validator=m.validator||b.always()},validate:function(){return this.validator.call(this)}};var i=a.extend({mixin:[f.Fields.ValidatorMixin,f.Fields.NamedFieldMixin],initialize:function(){this.parent=a.prototype;this.parent.initialize.apply(this,arguments)},isDirty:function(){var m=this.$el[0];return m.value!==m.defaultValue},setError:function(m){if(this.$error){this.$error.text(m)}else{this.$error=d(aui.form.fieldError({message:m}));this.$el.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},value:function(m){if(j.isUndefined(m)){return d.trim(this.$el.val())||""}else{this.$el.val(""+m);return this}},focus:function(){if(!this.isDisabled()){this.$el.focus();return true}else{return false}},blur:function(){if(this.$el.is(":focus")){this.$el.blur();return true}else{return false}},disable:function(){this.$el.prop("disabled",true);return this},enable:function(){this.$el.prop("disabled",false);return this},isDisabled:function(){return this.$el.prop("disabled")},_getStyle:function(m){switch(m){case a.SIZE.large:return"long-field";default:return""}},_getTemplateOptions:function(n,p,m){var q=j.extend(j.pick(n,p),m);var o=this._getStyle(n.size);if(o){q.extraClasses=[o]}return q}});var e=i.extend({initialize:function(m){this.parent=i.prototype;this.parent.initialize.apply(this,arguments);var n=this._getTemplateOptions(m,["id","maxLength","value"],{type:"text"});this.setElement(d(aui.form.input(n)))}});var l=i.extend({initialize:function(m){this.parent=i.prototype;this.parent.initialize.apply(this,arguments);var n=this._getTemplateOptions(m,["id","cols"]);this.setElement(d(aui.form.textarea(n)))}});f.DEFAULT_TYPES={text:e,textarea:l};f.EVENTS={submit:"submit"};a.SIZE={large:"large"};var g=function(){return true};var b=f.Validators={notEmpty:function(m){return function(){if(!this.value()){this.setError(m);return false}else{this.clearError();return true}}},always:function(){return g}}}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,JIRA.DirtyForm));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/OptionsView.js' */
(function(d,c,e,g,b){var f=function(){};c.extend(f.prototype,g.Events);d.OptionsField=b.Fields.FormField.extend({mixin:[b.Fields.NamedFieldMixin],initialize:function(){this.bus=new f();this.options=new a.Models.Options();this.view=new a({collection:this.options,bus:this.bus});this.enabled=true;this.listenTo(this.bus,"removeOption",this._removeOption);this.listenTo(this.bus,"moveOption",this._moveOption)},focus:function(){return this.view.focus()},blur:function(){return this.view.blur()},validate:function(){if(!this.options.length){this.setError("Your custom field must have some options.");return false}else{this.clearError();return true}},setError:function(h){this.view.setError(h);return this},clearError:function(){this.view.clearError();return this},value:function(h){if(c.isUndefined(h)){return this.options.map(function(i){return i.pick("name")})}else{return this}},disable:function(){this.enabled=false;this.view.disable();return this},enable:function(){this.enabled=true;this.view.enable();return this},render:function(){this.setElement(this.view.render().$el);return this},handleSubmit:function(){return this.view.handleSubmit()},isDirty:function(){return this.view.isDirty()},_removeOption:function(h){if(this.enabled){this.options.remove(h);this.focus()}},_moveOption:function(h){if(this.enabled){var i=h.option;this.options.remove(i,{silent:true});this.options.add(i,{silent:true,at:h.newIndex});this.focus()}}});var a=g.Marionette.ItemView.extend({initialize:function(h){this.bus=h.bus;this.options=h.collection;this.optionsView=new a.Views.OptionViews({collection:this.options,bus:this.bus})},ui:{input:"#custom-field-options-input",addBtn:"#custom-field-options-add",listContainer:"#custom-field-options-list-container"},template:JIRA.Templates.CustomFields.singleSelectOptionsComponent,onRender:function(){this.ui.listContainer.append(this.optionsView.render().$el);var h=c.bind(this._addOptionFromUi,this);this.ui.addBtn.click(h);this.ui.input.keydown(function(i){if(i.keyCode===e.ui.keyCode.ENTER){i.preventDefault();h()}})},_addOptionFromUi:function(){var h=[];if(!this.addOption(this.input(),h)){this.setError(h[0])}else{this.clearError().clearInput()}this.focus();return this},handleSubmit:function(){return false},getOptions:function(){return this.options.pick("name")},addOption:function(h,j){j=j||[];h=e.trim(h);if(!h.length){j.push("Option must have a name.");return false}else{var i=this._nameToId(h);if(this.options.get(i)){j.push("This value already exists in the list.");return false}else{this.options.add({name:h,id:i});return true}}},_getFocus:function(){return this.$(":focus")},focus:function(){if(!this.ui.input.prop("disabled")){this.ui.input.focus();return true}else{return false}},blur:function(){var h=this._getFocus();if(h.length){h.blur();return true}else{return false}},clearInput:function(){this.ui.input.val("");return this},input:function(h){if(c.isUndefined(h)){return this.ui.input.val()}else{this.ui.input.val(h);return this}},setError:function(h){if(this.$error){this.$error.text(h)}else{this.$error=e(aui.form.fieldError({message:h}));this.ui.addBtn.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},_nameToId:function(h){return h.toLowerCase()},enable:function(){this.ui.listContainer.removeClass("disabled");this._setInputState(true)},disable:function(){this.ui.listContainer.addClass("disabled");this._setInputState(false)},_setInputState:function(h){this.ui.input.prop("disabled",!h);this.ui.addBtn.prop("disabled",!h)},isDirty:function(){return this.ui.input.val()||this.options.length}});a.Models={};a.Models.Option=g.Model.extend({});a.Models.Options=g.Collection.extend({model:a.Models.Option});a.Views={};a.Views.OptionView=g.Marionette.ItemView.extend({events:{"click .custom-field-options-delete":"_delete",moveOption:"_moveOption"},tagName:"li",template:JIRA.Templates.CustomFields.singleSelectOptionsItem,initialize:function(h){this.bus=h.bus},_delete:function(h){h.preventDefault();this.bus.trigger("removeOption",this.model)},_moveOption:function(i,h){this.bus.trigger("moveOption",{option:this.model,newIndex:h})}});a.Views.OptionViews=g.Marionette.CollectionView.extend({itemView:a.Views.OptionView,tagName:"ul",id:"custom-field-options-list",initialize:function(h){this.bus=h.bus;this.$el.sortable({axis:"y",containment:"#custom-field-options-list-container",tolerance:"pointer",cursor:"move",handle:".custom-field-option-handle",update:this._handleReorder})},itemViewOptions:function(){return{bus:this.bus}},_handleReorder:function(i,h){h.item.trigger("moveOption",h.item.index())}})}(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone,JIRA.Admin.CustomFields.Form));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/SharedByNotification.js' */
(function(a,b,c){a.SharedByView=c.Marionette.ItemView.extend({initialize:function(d){this.projects=d.projects},template:JIRA.Templates.CustomFields.sharedByCreate,serializeData:function(){return{projects:this.projects}},onDialogNotificationHide:function(){if(this.popup){this.popup.hide();this.popup.remove();delete this.popup}},onDialogNotificationShow:function(){var d=this.projects;this.popup=AJS.InlineDialog(this.$el.find("a"),"customfield-project-list",function(f,e,g){f.html(JIRA.Templates.CustomFields.shareByInline({projects:d}));g()},{width:240,onHover:true,hideDelay:500})}})}(JIRA.Admin.CustomFields,AJS.$,JIRA.ProjectConfig.Backbone));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/TypeItemView.js' */
(function(a,b){a.TypeItemView=b.Marionette.ItemView.extend({className:"item",submit:function(){this.select();this.triggerMethod("submit",this.getKey())},events:{click:"onClick",dblclick:"onDoubleClick"},onClick:function(c){this.triggerMethod("select");c.preventDefault()},onDoubleClick:function(c){this.submit();c.preventDefault()},reveal:function(){var c=40;this.$el.scrollIntoViewForAuto({direction:"vertical",marginBottom:c,marginTop:c})},select:function(){this.$el.toggleClass("selected",true);this.reveal()},deselect:function(){this.$el.toggleClass("selected",false)},tagName:"li",template:function(c){return JIRA.Templates.CustomFields.type({type:c})},getKey:function(){return this.model.get("key")}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/EmptyTypeItemView.js' */
(function(a,b){a.EmptyTypeItemView=b.Marionette.ItemView.extend({tagName:"li",className:"empty",triggers:{"click .customfields-all-category-link":"ongotoall"},setEmptyState:function(c){this.emptyState=c;this.render()},serializeData:function(){return this.emptyState},template:function(d){var c;switch(d){case a.EmptyTypeItemView.CHANGE_TAB:c=JIRA.Templates.CustomFields.emptyTypeOtherTab();break;case a.EmptyTypeItemView.MARKETPLACE:c=JIRA.Templates.CustomFields.emptyTypeMarketplace({contextPath:AJS.contextPath()});break;default:c=JIRA.Templates.CustomFields.emptyType()}return c}});_.extend(a.EmptyTypeItemView,{CHANGE_TAB:"otherTab",MARKETPLACE:"marketplace",EMPTY:"empty"})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/FieldTypeCollectionView.js' */
(function(b,d,a,e,c){b.FieldTypeCollectionView=e.Marionette.CompositeView.extend({itemView:b.TypeItemView,emptyView:b.EmptyTypeItemView,itemViewContainer:".customfields-types",indexOf:function(f){if(!f){return -1}return this.collection.indexOf(f.model)},attach:function(){if(this.placeholder){this.placeholder.replaceWith(this.$el);this.$el.parent().scrollTop(this.scrollTopBeforeDetach);delete this.placeholder;delete this.scrollTopBeforeDetach}},detach:function(){this.placeholder=d("<div/>").insertBefore(this.$el);this.scrollTopBeforeDetach=this.$el.parent().scrollTop();this.$el.detach()},initialize:function(){this.selectedView=null;a.bindAll.apply(a,[this].concat(a.functions(this)))},onItemviewSelect:function(f){this.select(f)},onItemRemoved:function(){this.selectByIndex(0)},onAfterItemAdded:function(){this.selectByIndex(0)},onItemviewSubmit:function(f,g){this.triggerMethod("submit",g)},onItemviewOngotoall:function(){this.triggerMethod("changeToAll")},isEmpty:function(){return !this.collection.length},_getEmptyView:function(){return this.isEmpty()&&this.children.findByIndex(0)},setHasMatches:function(f){var g=this._getEmptyView(),h;if(!g){return}if(f){h=b.EmptyTypeItemView.CHANGE_TAB}else{if(JIRA.isSysadmin()){h=b.EmptyTypeItemView.MARKETPLACE}else{h=b.EmptyTypeItemView.EMPTY}}g.setEmptyState(h)},onKeydown:function(f){switch(f.keyCode){case c.UP:this.collection.length&&this.moveSelect(-1);break;case c.DOWN:this.collection.length&&this.moveSelect(1);break;case c.ENTER:this.collection.length&&this.triggerMethod("submit",this.getSelectedKey());break;default:return}f.preventDefault()},moveSelect:function(g){var f=this.indexOf(this.selectedView);if(f>=0){f=Math.min(this.children.length-1,Math.max(0,f+g));this.selectByIndex(f)}},select:function(f){if(this.selectedView){this.selectedView.deselect()}this.selectedView=f;f&&this.selectedView.select();this.triggerMethod("changedSelection",{key:this.getSelectedKey()})},selectByIndex:function(g){var f=this._viewAtIndex(g);this.select(f)},_viewAtIndex:function(g){var f=this.collection.at(g);return f&&this.children.findByModel(f)},template:function(){return JIRA.Templates.CustomFields.types()},onDialogPanelHide:function(){this.detach();d(document).unbind("keydown",this.onKeydown)},onDialogPanelShow:function(){this.attach();d(document).bind("keydown",this.onKeydown)},getSelectedKey:function(){if(this.selectedView){return this.selectedView.getKey()}else{return null}},getSelectedModel:function(){return this.selectedView&&this.selectedView.model},appendHtml:function(f,h,g){var i=this.getItemViewContainer(f);if(g===0){i.prepend(h.el)}else{i.children().eq(g-1).after(h.el)}}})})(JIRA.Admin.CustomFields,AJS.$,_,JIRA.ProjectConfig.Backbone,AJS.$.ui.keyCode);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/QuickSearch.js' */
(function(b,c,a){b.QuickSearch=c.Marionette.ItemView.extend({className:"search",ui:{input:"input"},initialize:function(d){d=d||{};if(d.delay){this.onInputInput=a.debounce(this.onInputInput,d.delay)}},focus:function(){this.ui.input.focus();return this},onInputInput:function(){this.triggerMethod("change",{value:this.value()})},template:function(){return JIRA.Templates.CustomFields.quickSearch()},value:function(){return this.ui.input.val()},render:function(){c.Marionette.ItemView.prototype.render.apply(this,arguments);this.ui.input.on("input",a.bind(this.onInputInput,this));return this}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,_));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Wizard.js' */
(function(b,a,e,d,c){b.Wizard=function(f){f=f||{};this.sharedStepOptions=f.sharedStepOptions||{};this._setCurrentStepWrapper(null,f.firstStep,null);this.autoClose=f.autoClose;this.dirtyMessage=f.dirtyMessage;this.result=c.Deferred();this.loadingTimer=null};a.extend(b.Wizard.prototype,e.Events,{start:function(){this._hasCompleted=false;this._showDelayedLoading(this);this._transitionTo(null,this.currentStepWrapper.step);if(this.dirtyMessage){this._addDirty()}return this.result.promise()},close:function(){this._closeWebsudoDialogIfExists();if(this.currentStepWrapper){if(this.dirtyMessage){this._removeDirty()}this.stopListening();this._applyToEachStep(function(f){this._hideDelayedLoading(f);f.stopStep()});delete this.currentStepWrapper}this._hideDelayedLoading(this)},isDirty:function(){return this._existsSomeStep(function(f){return f.isDirty()})},showLoading:function(){AJS.dim(false);JIRA.Loading.showLoadingIndicator()},hideLoading:function(){JIRA.Loading.hideLoadingIndicator()},_bindToStep:function(f){this.listenTo(f,b.Wizard.EVENTS.next,this._onNextStep);this.listenTo(f,b.Wizard.EVENTS.previous,this._onPreviousStep);this.listenTo(f,b.Wizard.EVENTS.complete,this._onComplete);this.listenTo(f,b.Wizard.EVENTS.cancel,this._onCancel)},_onNextStep:function(){var h=this.currentStepWrapper.nextStepWrapper;var i=this.currentStepWrapper;var g=h&&h.step;var f=this.currentStepWrapper.step.getNextStep(g,this.sharedStepOptions);if(f===g){this.currentStepWrapper=h}else{this._setCurrentStepWrapper(this.currentStepWrapper,f,null)}this.currentStepWrapper.step.setPreviousData(i.step.getAccumulatedData());this._transitionTo(this.currentStepWrapper.previousStepWrapper.step,this.currentStepWrapper.step)},_onPreviousStep:function(){var f=this.currentStepWrapper.previousStepWrapper;if(f){this.currentStepWrapper=f;this._transitionTo(this.currentStepWrapper.nextStepWrapper.step,this.currentStepWrapper.step)}},_transitionTo:function(h,g){var f=this,i=g.startStep();this._bindToStepProgress(i,h);i.always(function(){if(f.websudoDialog){f._closeWebsudoDialog()}else{if(h){f._hideDelayedLoading(h);h.pauseStep()}else{f._hideDelayedLoading(f)}}}).always(a.bind(this._makeStepVisible,this,g))},_bindToStepProgress:function(h,g){var f=this;g&&this.stopListening(g);g&&this._showDelayedLoading(g);h.progress(function(j){if(j===b.Wizard.EVENTS.websudoBeforeShow){if(g){f._hideDelayedLoading(g);g.pauseStep()}else{f._hideDelayedLoading(f)}}else{if(j===b.Wizard.EVENTS.websudoSuccess){var i=arguments[1];f.websudoDialog={close:i}}}})},_makeStepVisible:function(f){f.show();this._bindToStep(f)},_closeWebsudoDialogIfExists:function(){if(this.websudoDialog){this._closeWebsudoDialog()}},_closeWebsudoDialog:function(){this.websudoDialog.close();delete this.websudoDialog},_showDelayedLoading:function(g){var f=this;this._cancelTimer();this.loadingTimer=window.setTimeout(a.bind(function(){f.loadingTimer=null;g.showLoading()},this),500)},_hideDelayedLoading:function(f){this._cancelTimer();f.hideLoading()},_cancelTimer:function(){if(this.loadingTimer!==null){window.clearTimeout(this.loadingTimer)}this.loadingTimer=null},_addDirty:function(){this._unload=window.onbeforeunload;var f=this;window.onbeforeunload=function(){if(!f._hasCompleted&&f.dirtyMessage&&f.isDirty()){return f.dirtyMessage}else{if(a.isFunction(f._unload)){return f._unload.apply(this,arguments)}else{return void 0}}}},_removeDirty:function(){window.onbeforeunload=this._unload;delete this._unload},_onComplete:function(){var f=this.currentStepWrapper.step;var g=f.doComplete();this._bindToStepProgress(g,f);g.done(a.bind(this._onCompleteSuccess,this)).fail(a.bind(this._onCompleteFailure,this))},_onCompleteSuccess:function(){this._hasCompleted=true;this.result.resolve(this.currentStepWrapper.step.getAccumulatedData());if(this.autoClose){this.close()}},_onCompleteFailure:function(g){var f,h;if(g===b.Wizard.FAIL_REASON.recoverableError){f=this.currentStepWrapper.step;h=arguments[1];if(this.websudoDialog){this._closeWebsudoDialog();f.show()}else{this._hideDelayedLoading(f)}this._bindToStep(f);f.showErrors(h.fields,h.general)}else{this.result.reject(g,{data:this.currentStepWrapper.step.getAccumulatedData(),dirty:this.isDirty(),notCompletedDescriptions:arguments[1]});this.close()}},_onCancel:function(f){if(f&&!this._hasCompleted&&this.dirtyMessage&&this.isDirty()){if(!window.confirm(this.dirtyMessage)){return}}this.result.reject(b.Wizard.FAIL_REASON.cancel);this.close()},_applyToEachStep:function(f){this._forEachStep(function(g){f.call(this,g)})},_existsSomeStep:function(f){return !!this._forEachStep(function(g){return f.call(this,g)})},_forEachStep:function(h){var g,f;for(f=this.currentStepWrapper;!!f;f=f.previousStepWrapper){g=h.call(this,f.step);if(g){return g}}for(f=this.currentStepWrapper.nextStepWrapper;!!f;f=f.nextStepWrapper){g=h.call(this,f.step);if(g){return g}}},_setCurrentStepWrapper:function(g,h,f){this.currentStepWrapper={previousStepWrapper:g,step:h,nextStepWrapper:f};g&&(g.nextStepWrapper=this.currentStepWrapper)}});b.Wizard.FAIL_REASON={cancel:"cancel",abort:"abort",recoverableError:"recoverableError",error:"error"}}(JIRA.Admin.CustomFields,_,JIRA.ProjectConfig.Backbone,JIRA.ProjectConfig.Backbone.Marionette,AJS.$));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Events.js' */
(function(a){a.Wizard.EVENTS={next:"next",previous:"previous",fail:"fail",error:"error",complete:"complete",websudoBeforeShow:"websudo:before:show",websudoSuccess:"websudo:success",cancel:"cancel"}})(JIRA.Admin.CustomFields);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CustomFieldsStepHelper.js' */
(function(b,a,c){b.CustomFieldsStepHelper={genericFailHandler:function(d){var e=a.toArray(arguments);if(e[1]===b.IssueCustomFields.STATUS.abort){d.rejectWith(d,[b.Wizard.FAIL_REASON.abort].concat(e.slice(2)))}else{d.rejectWith(d,[b.Wizard.FAIL_REASON.error].concat(e.slice(2)))}},genericProgressHandler:function(e,d){if(d===b.IssueCustomFields.PROGRESS.SHOW){e.notify(b.Wizard.EVENTS.websudoBeforeShow)}else{if(d===b.IssueCustomFields.PROGRESS.SUCCESS){e.notify(b.Wizard.EVENTS.websudoSuccess,arguments[2])}}},createField:{execute:function(e){var d=c.Deferred(),g=e.data,h=g.field,f=g.type;e.api.addField({name:h.name,description:h.description,searcherKey:f.searcherKey,type:f.key}).pipe(function(i){h.id=i.id;d.resolve()},function(i){d.reject(b.Wizard.FAIL_REASON.recoverableError,i)},d.notify);return d.promise()},description:function(){return "Create field."}},addOptions:{execute:function(e){var f=e.data,d=c.Deferred(),g=f.field;e.api.setOptions(g.id,g.options).pipe(d.resolve,a.bind(b.CustomFieldsStepHelper.genericFailHandler,null,d),d.notify);return d.promise()},description:function(){return "Set field options."}},putFieldOnIssue:{execute:function(e){var d=c.Deferred();e.api.addFieldToScreen(e.data.field.id).pipe(d.resolve,a.bind(b.CustomFieldsStepHelper.genericFailHandler,null,d),d.notify);return d.promise()},description:function(){return "Add field to issue."}},refreshIssue:{execute:function(){var d=c.Deferred();JIRA.Issues.Api.refreshSelectedIssue().pipe(d.resolve,a.bind(b.CustomFieldsStepHelper.genericFailHandler,null,d),d.notify);return d.promise()},description:function(){return "Refresh issue."}},executeCompletes:function(e,g){var f=c.Deferred(),h=c.Deferred().resolve().promise(),d;a.each(e,function(i,j){h=h.pipe(function(){return i.execute(g)});h.fail(function(l){d=a.toArray(arguments);if(l!==b.Wizard.FAIL_REASON.recoverableError){var k=a.map(e.slice(j),function(m){return m.description()});d.push(k)}f.reject.apply(f,d)})});h.progress(a.bind(this.genericProgressHandler,this,f));h.done(f.resolve);return f.promise()}}}(JIRA.Admin.CustomFields,_,AJS.$));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Step.js' */
(function(b,c,a,d){b.Wizard.Step=a.extend({},{fireNext:function(){this.trigger(b.Wizard.EVENTS.next)},firePrevious:function(){this.trigger(b.Wizard.EVENTS.previous)},fireCancel:function(e){this.trigger(b.Wizard.EVENTS.cancel,e||false)},fireComplete:function(){this.trigger(b.Wizard.EVENTS.complete)},startStep:function(){},stopStep:function(){},pauseStep:function(){},show:function(){},showLoading:function(){},hideLoading:function(){},doComplete:function(){return c.Deferred().resolve()},showErrors:function(e,f){},isExistingNextStepAppropriate:function(e){},getNextStep:function(e,f){},getAccumulatedData:function(){},setPreviousData:function(e){},isDirty:function(){}},d.Events)})(JIRA.Admin.CustomFields,AJS.$,_,JIRA.ProjectConfig.Backbone);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/AbstractStep.js' */
(function(b,a){b.Wizard.AbstractStep=a.extend({},b.Wizard.Step,{startStep:function(){if(this.hasStarted){return this.restart()}else{this.hasStarted=true;return this.start()}},getAccumulatedData:function(){return a.extend({},this._previousData,this.getStepData())},setPreviousData:function(c){this._previousData=c},start:function(){},restart:function(){return this.start()},getStepData:function(){},getPreviousData:function(){return this._previousData}})})(JIRA.Admin.CustomFields,_);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStep.js' */
(function(c,e,d,b){var a=c.FieldWisherStep=function(f){this.api=f.api;this.stepData={}};b.extend(a.prototype,c.Wizard.AbstractStep,{showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},start:function(){var f=this,g=this._getFields();g.done(function(h){var i=f.dialog=new a.Dialog({fields:h});f.listenTo(i,"cancel",function(j){f.fireCancel(j)});f.listenTo(i,"submit",function(j){f.stepData.field={};f.stepData.field.id=j.id;f.stepData.field.name=j.name;if(j.id){f.stepData.createField=false;f.stepData.addField=!j.onAllScreens;f.fireComplete()}else{f.stepData.createField=true;f.stepData.addField=true;f.fireNext()}})});g.fail(function(i,j){if(c.Wizard.FAIL_REASON.abort===i){f.fireCancel()}else{var h=f.dialog=new c.ErrorDialog({heading:a.Dialog.prototype.text.heading,message:j});f.listenTo(h,"cancel",f.fireCancel)}});return g},restart:function(){return d.Deferred().resolve().promise()},pauseStep:function(){if(this.dialog){this.dialog.resetCanSubmit();this.dialog.resetIsSubmitted();this.dialog.hide()}},stopStep:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.destroy();delete this.dialog}},show:function(){this.dialog&&this.dialog.show()},doComplete:function(){var f,g=this.getAccumulatedData();f=this._resolveCompletesToExecute(g);return this.executeCompletes(f,{api:this.api,data:g})},getStepData:function(){return this.stepData},getNextStep:function(g,f){if(g instanceof c.TypeStep){return g}return new c.TypeStep({api:f.api,inIssueContext:f.inIssueContext})},isDirty:function(){var g=this.stepData.field;var f=g&&(g.id||g.name);return f||(this.dialog&&this.dialog.isDirty())},_getFields:function(){var f=d.Deferred(),g=this.api.addableFields(true);g.done(f.resolve);g.fail(b.bind(this.genericFailHandler,this,f));g.progress(b.bind(this.genericProgressHandler,this,f));return f.promise()},_resolveCompletesToExecute:function(g){var f=[];if(g.addField){f.push(this.putFieldOnIssue);f.push(this.refreshIssue)}return f}},c.CustomFieldsStepHelper)}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStepDialog.js' */
(function(b,d,c,a){b.FieldWisherStep.Dialog=function(e){a.bindAll(this,"submit");this.text=a.clone(this.text);this.text.nextButton=a.bind(this.text.nextButton,this);this.model=new d.Model({fieldId:undefined,fieldName:undefined,fieldOnAllScreens:undefined,canSubmit:undefined,isSubmitted:undefined,isValid:undefined,fieldsOnAllScreens:undefined});this.dialog=new b.Dialog({id:"customfields-field-wisher",height:220,width:520});this.$el=this.dialog.$el;this.panel=new b.FieldWisherStep.Panel({initialValue:e.initialValue||"",fields:e.fields});this.dialog.addPanel("",this.panel);this.dialog.addOrSetHeaderMainText(this.text.heading);this.nextButton=this.dialog.addButton({label:this.text.nextButton(),id:"customfields-field-wisher-next",submitAccessKey:true,click:this.submit});this.dialog.addLink({label:this.text.cancel,click:a.bind(this.cancel,this,false),cancelAccessKey:true});this.listenTo(this.model,"change:fieldId change:fieldName",this.calculateIsValid);this.listenTo(this.model,"change:isValid change:isSubmitted",this.calculateCanSubmit);this.listenTo(this.model,"change:fieldId",this.onChangeFieldId);this.listenTo(this.model,"change:canSubmit",this.onChangeCanSubmit);this.listenTo(this.model,"change:isSubmitted",this.onChangeIsSubmitted);this.listenTo(this.panel,"change:field",this.onPanelChangeField);this.listenTo(this.panel,"request:submit",this.onPanelRequestSubmit);this.listenTo(this.dialog,"close",a.bind(this.cancel,this,true));this.calculateIsValid(this.model);this.calculateCanSubmit(this.model);this._initializeFieldsOnScreen(this.model,e.fields)};a.extend(b.FieldWisherStep.Dialog.prototype,d.Events,{text:{cancel:"Cancel",create:"Create",add:"Add",edit:"Edit",heading:"Add Field",nextButton:function(){if(!this.model.get("fieldId")){return this.text.create}else{if(this.model.get("fieldOnAllScreens")){return this.text.edit}}return this.text.add}},triggerMethod:d.Marionette.triggerMethod,show:function(){this.dialog.show();return this},hide:function(){this.dialog&&this.dialog.hide();return this},destroy:function(){this.stopListening(this.panel);this.dialog&&this.dialog.destroy();return this},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},resetCanSubmit:function(){this.model.set("canSubmit",true)},resetIsSubmitted:function(){this.model.set("isSubmitted",false)},submit:function(){var e={id:this.model.get("fieldId"),name:this.model.get("fieldName"),onAllScreens:this.model.get("fieldOnAllScreens")};if(!e.id){delete e.id}this.model.set("isSubmitted",true);this.triggerMethod("submit",e)},cancel:function(e){this.triggerMethod("cancel",e||false)},onPanelChangeField:function(e){var f=e.id;this.model.set({fieldId:f,fieldName:e.name,fieldOnAllScreens:!!this.model.get("fieldsOnAllScreens")[f]})},onPanelRequestSubmit:function(){if(this.model.get("canSubmit")){this.submit()}},onChangeFieldId:function(){this.nextButton.setLabel(this.text.nextButton())},onChangeCanSubmit:function(e){if(e.get("canSubmit")){this.nextButton.enable()}else{this.nextButton.disable()}},onChangeIsSubmitted:function(e){if(e.get("isSubmitted")){this.panel.disable()}else{this.panel.enable()}},calculateIsValid:function(e){e.set("isValid",!!e.get("fieldName"))},calculateCanSubmit:function(e){e.set("canSubmit",e.get("isValid")&&!e.get("isSubmitted"))},isDirty:function(){return !!this.model.get("fieldName")||this.panel.isDirty()},_initializeFieldsOnScreen:function(f,e){var g={};a.each(e,function(h){g[h.id]=h.onAllScreens});f.set("fieldsOnAllScreens",g)}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStepPanel.js' */
(function(b,d,c,a){b.FieldWisherStep.Panel=d.Marionette.ItemView.extend({ui:{select:"select"},initialize:function(e){this.template=a.bind(this.template,this);this.model=new d.Model({fieldId:null,fieldName:null,fields:e.fields})},template:function(){return JIRA.Templates.CustomFields.FieldWisherStep.form({fields:this.model.get("fields")})},onRender:function(){this.fieldSelect=new AJS.SingleSelect({element:this.ui.select,itemAttrDisplayed:"label",suggestionsHandler:this.ExistingOrCreateSuggester,errorMessage:""});this.bindUIElements()},events:{"selected select":"onFrotherSelected","unselect select":"onFrotherUnselect","submit form":"onSubmit"},onFrotherSelected:function(g,f){var e;e="fieldText" in f.properties?f.properties.fieldText:f.properties.label;this.model.set({fieldId:f.properties.value,fieldName:e})},onFrotherUnselect:function(){this.model.set({fieldId:null,fieldName:null})},onSubmit:function(e){e.preventDefault();this.trigger("request:submit")},enable:function(){this.fieldSelect&&this.fieldSelect.enable()},disable:function(){this.fieldSelect&&this.fieldSelect.disable()},isDirty:function(){return !!(this.fieldSelect&&(this.fieldSelect.getQueryVal()||this.fieldSelect.getSelectedDescriptor()))},modelEvents:{"change:fieldId":"onChangeField","change:fieldName":"onChangeField"},onChangeField:function(e){var f={id:e.get("fieldId"),name:e.get("fieldName")};if(!f.id){delete f.id}this.trigger("change:field",f)},ExistingOrCreateSuggester:AJS.SelectSuggestHandler.extend({formatSuggestions:function(f,g){var e;e=this.sorted(f);if(g.length>0){e.push(this.creationSuggestion(g))}return e},sorted:function(f){var e;e=AJS.SuggestHelper.extractItems(f).sort(function(h,g){h=h.label().toLowerCase();g=g.label().toLowerCase();return h.localeCompare(g)});return[new AJS.GroupDescriptor({items:e})]},creationSuggestion:function(e){var f;f=new AJS.ItemDescriptor({value:"",label:AJS.format("{0} (Create new field)",e),fieldText:e,title:e,allowDuplicate:false,noExactMatch:true});return new AJS.GroupDescriptor({label:"user inputted option",showLabel:false,replace:true,items:[f]})}})})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/TypeStep/TypeStep.js' */
(function(b,a,d,e){var c=b.TypeStep=function(f){this.options=a.extend({initialCategory:"STANDARD",view:c.Views.TypeChoice},f);this.api=f.api;this.inIssueContext=!!f.inIssueContext;this.categories=null;this.stepData={}};a.extend(c.prototype,b.Wizard.AbstractStep,{showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},start:function(){var g=this,h=this._getCategories(),f;h.done(function(i,j){var k=j&&j.length&&new b.SharedByView({projects:j});f=g.view=new g.options.view(i,200,k,g.inIssueContext);g.listenTo(f,"submit",function(l){g.stepData.type=g._getUpdateData(l);g.fireNext()});g.listenTo(f,"previous",function(){g.firePrevious()});g.listenTo(f,"cancel",function(l){g.fireCancel(l)})});h.fail(function(j,i){if(b.Wizard.FAIL_REASON.abort===j){g.fireCancel()}else{f=g.view=new b.ErrorDialog({heading:c.Views.Text.heading,message:i});g.listenTo(f,"cancel",g.fireCancel)}});return h},restart:function(){return d.Deferred().resolve().promise()},pauseStep:function(){this.view&&this.view.hide()},stopStep:function(){if(this.view){this.stopListening(this.view);this.view.destroy();delete this.view}},show:function(){this.view&&this.view.show()},getStepData:function(){return this.stepData},getNextStep:function(g,f){if(g instanceof b.CreateFieldStep){return g}return new b.CreateFieldStep({api:f.api,inIssueContext:f.inIssueContext})},_getUpdateData:function(g){var h={};if(g){h.key=g.get("key");h.name=g.get("name");h.options=g.get("options");h.cascading=g.get("cascading");var f=g.get("searchers");if(f&&f.length>0){h.searcherKey=f[0]}}return h},_getCategories:function(){var g=d.Deferred(),f=this;var h=this.api.getSharedBy(this.api.getCustomFieldTypes());h.done(function(j){var i=[];a.each(j.categories,function(k){var m=a.filter(j.types,function(n){return a.contains(n.categories,k.id)});var l=new c.Models.Types(m,{parse:true});i.push({initial:k.id===f.options.initialCategory,id:k.id,name:k.name,types:l})});g.resolveWith(f,[i,j.sharedBy])});h.fail(a.bind(this.genericFailHandler,this,g));h.progress(a.bind(this.genericProgressHandler,this,g));return g.promise()}},b.CustomFieldsStepHelper);c.Models={};c.Models.Type=e.Model.extend({initialize:function(){this.get("name")||this.set("name",this.get("key"))},parse:function(f){return a.omit(f,"categories")}});c.Models.Types=b.FilteredCollection.extend({model:c.Models.Type,comparator:b.lowerCaseLocaleComparator("name"),matcher:function(f,j,i){var h=f.get("name").toLowerCase(),g=i.needles;if(!g){i.needles=g=a.filter(j.toLowerCase().split(/\s+/),function(k){return k})}return a.all(g,function(k){return h.indexOf(k)!==-1})}})})(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/TypeStep/TypeStepDialog.js' */
(function(b,a,d,g){var e={marketplace:AJS.contextPath()+"/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&source=custom_fields_create"};var c=b.TypeStep;c.Views={};var f=c.Views.Text={heading:"Select a Field Type",panel:"",cancel:"Cancel",previous:"Previous",next:"Next",marketPlace:"Find More Custom Fields"};c.Views.TypeChoice=function(h,j,i,k){this.categories=h;this.searchDelay=j||0;this.sharedBy=i;this.inIssueContext=k};a.extend(c.Views.TypeChoice.prototype,g.Events,{show:function(){if(!this.dialog){var j,l=[],o=[],k=null,i=new b.Dialog({id:"customfields-select-type",focusSelector:".dialog-title input"}),h=this,n,m=new b.QuickSearch({delay:this.searchDelay});this.listenTo(m,"change",function(q){a.each(h.categories,function(r){r.types.filter(q.value)});var p=a.any(a.pluck(h.categories,"types"),function(r){return r.length});a.each(o,function(r){r.setHasMatches(p)})});i.addOrSetHeaderMainText(f.heading);i.addHeaderAction(m);if(this.sharedBy){i.setWarningNotification(this.sharedBy)}if(JIRA.isSysadmin()){i.addLeftLink({label:f.marketPlace,url:e.marketplace,iconClass:"jira-icon-marketplace"})}if(this.inIssueContext){i.addButton({secondary:true,label:f.previous,click:function(){h._firePrevious(i.currentPanel().view.getSelectedModel())},id:"customfields-select-type-previous"})}n=i.addButton({label:f.next,submitAccessKey:true,click:function(){h._fireSubmit(i.currentPanel().view.getSelectedModel())},id:"customfields-select-type-next"});this.listenTo(i,"close",a.bind(this._fireCancel,this,true));i.addLink({label:f.cancel,click:a.bind(this._fireCancel,this,false),cancelAccessKey:true});a.each(this.categories,function(p,s){var r=new b.FieldTypeCollectionView({collection:p.types});o.push(r);h.listenTo(r,"submit",function(){h._fireSubmit(r.getSelectedModel())});h.listenTo(r,"dialog:panel:show",function(){m.focus();var t=function(u){u.key?n.enable():n.disable()};h.listenTo(r,"changedSelection",t);r.once("dialog:panel:hide",function(){h.stopListening(r,"changedSelection",t)},h);t({key:r.getSelectedKey()})});h.listenTo(r,"changeToAll",function(){j&&j.show()});l.push(function(){h._initAnalytics(p,r)});var q=i.addPanel(p.name,r);if(p.initial){k=q;h.__currentCategory=p}if(s===0){j=q}});k&&k.show();i.show();a.each(l,function(p){p()});this.dialog=i}else{this.dialog.show()}},hide:function(){this.dialog&&this.dialog.hide()},destroy:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.destroy();delete this.dialog}},_initAnalytics:function(j,i){var h=this;this.listenTo(i,"dialog:panel:show",function(){h.__currentCategory=j;AJS.trigger("analytics",{name:"administration.customfields.addwizard.changecategory",data:{id:j.id,name:j.name}})})},_fireSubmit:function(h){AJS.trigger("analytics",{name:"administration.customfields.addwizard.submittype",data:{key:h.get("key"),category:this.__currentCategory.id}});this.trigger("submit",h)},_firePrevious:function(h){this.trigger("previous",h)},_fireCancel:function(h){this.trigger("cancel",h)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},isDirty:function(){return true}})})(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone);;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CreateFieldStep/CreateFieldStep.js' */
(function(c,e,d,b){var a=c.CreateFieldStep=function(f){this.options=b.extend({view:a.Views.CreateDialog},f);this.api=f.api;this.inIssueContext=!!f.inIssueContext;this.stepData={}};b.extend(a.prototype,c.Wizard.AbstractStep,{start:function(){var h=this.getPreviousData();var i=h.type;this.fieldTypeName=i.name;var g=b.extend(b.pick(this.options,["nextLabel","previousLabel"]),{configureOptions:!!i.options&&!i.cascading,typeName:i.name,fieldName:(h.field&&h.field.name)||""});var f=this.view=new this.options.view(g);this.listenTo(f,"submit",function(j){this.stepData.field={};this.stepData.field.name=j.name;this.stepData.field.description=j.description;this.stepData.field.options=j.options;this.view.disable();this.fireComplete()});this.listenTo(f,"previous",function(){this.firePrevious()});this.listenTo(f,"cancel",function(j){this.fireCancel(j)});return d.Deferred().resolve().promise()},restart:function(){var f=this.getPreviousData();if(this._hasFieldTypeChanged(f.type.name)){this.stopStep();return this.start()}else{this.view.updateData({typeName:f.type.name,fieldName:(f.field&&f.field.name)||""});return d.Deferred().resolve().promise()}},stopStep:function(){if(this.view){this.stopListening(this.view);this.view.destroy();delete this.view}},pauseStep:function(){this.view&&this.view.hide()},show:function(){this.view&&this.view.show()},doComplete:function(){var f,g=this.getAccumulatedData();f=this._resolveCompletesToExecute(g);return this.executeCompletes(f,{api:this.api,data:g})},showErrors:function(f,g){this.view.enable();this.view.showErrors(f,g)},showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},getStepData:function(){return this.stepData},isDirty:function(){var g=this.stepData.field;var f=g&&(g.name||g.options||g.description);return f||(this.view&&this.view.isDirty())},_hasFieldTypeChanged:function(f){return this.fieldTypeName!==f},_resolveCompletesToExecute:function(g){var f=[];f.push(this.createField);if(g.field.options){f.push(this.addOptions)}if(this.inIssueContext){f.push(this.putFieldOnIssue);f.push(this.refreshIssue)}return f}},c.CustomFieldsStepHelper)}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CreateFieldStep/CreateFieldStepDialog.js' */
(function(d,g,f,c,b){var a=d.CreateFieldStep;var e=b.Fields.FormField;a.Views={};a.Views.CreateDialog=function(h){this.options=c.defaults({},h,{previousLabel:"Previous",nextLabel:"Create",cancelLabel:"Cancel",panel:a.Views.CreatePanel,fieldName:""});this.enabled=true};c.extend(a.Views.CreateDialog.prototype,g.Events,{initialize:function(h){this.options=h},show:function(){if(!this.dialog){var i=this.dialog=new d.Dialog({id:"customfields-configure-field",focusSelector:"#custom-field-name"});i.addOrSetHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",this.options.typeName));var j=c.defaults({},c.pick(this.options,"configureOptions"),{fieldName:this.options.fieldName});var h=this.panel=i.addPanel("",new this.options.panel(j));this.listenTo(h.view,"submit",c.bind(this._submit,this));this.previousButton=i.addButton({secondary:true,label:this.options.previousLabel,id:"customfields-configure-previous",click:c.bind(this._previous,this)});this.nextButton=i.addButton({label:this.options.nextLabel,id:"customfields-configure-next",submitAccessKey:true,click:function(){h.view.triggerSubmit()}});i.addLink({label:this.options.cancelLabel,click:c.bind(this._cancel,this,false),cancelAccessKey:true});this.listenTo(i,"close",c.bind(this._cancel,this,true))}else{this.dialog.hideErrors()}this.dialog.show();return this},updateData:function(h){this.dialog.addOrSetHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",h.typeName));this.panel.view.updateData(h)},_previous:function(){this.trigger("previous")},_submit:function(){var h=this.panel.view;if(this.enabled){this.trigger("submit",h.getData())}},hide:function(){this.dialog&&this.dialog.hide()},destroy:function(){this.stopListening(this.panel);if(this.dialog){this.dialog.destroy();delete this.dialog}return this},showErrors:function(h,j){if(!this.panel.view.showErrors(h,j)){this.panel.view.focus()}var i=c.union(j,c.values(h));this.dialog.showErrors(i)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},disable:function(){this.enabled=false;this.panel.view.disable();this.nextButton.disable();this.previousButton.disable()},enable:function(){this.enabled=true;this.panel.view.enable();this.nextButton.enable();this.previousButton.enable()},isDirty:function(){return this.panel.view.isDirty()},_cancel:function(h){this.enabled&&this.trigger("cancel",h)}});a.Views.CreatePanel=g.Marionette.ItemView.extend({initialize:function(h){h=h||{};this.template=c.bind(this.template,this);this.form=h.form||this._createForm(h);this.listenTo(this.form,b.EVENTS.submit,this._submit)},template:function(){return this.form.render().$el},_submit:function(){this.triggerMethod("submit")},triggerSubmit:function(){this.form.submit();return this},updateData:function(h){this.form.setValueOfFieldWithName("name",h.fieldName)},getData:function(){return this.form.toJSON()},onDialogPanelShow:function(){this.form.blur().focus()},showErrors:function(h,i){return this.form.showErrors(h,i)},focus:function(){this.form.focus();return this},disable:function(){this.form.disable();return this},enable:function(){this.form.enable();return this},isDirty:function(){return this.form.isDirty()},setValueOfFieldWithName:function(h,i){this.form.setValueOfFieldWithName(h,i)},_createForm:function(h){return new b(this._createFormParams(h))},_createFormParams:function(i){var h=[{content:JIRA.Templates.CustomFields.submitHack},{id:"custom-field-name",label:"Name",name:"name",type:"text",maxLength:255,required:true,size:e.SIZE.large,validator:b.Validators.notEmpty("You must specify a name for this custom field."),value:i.fieldName},{id:"custom-field-description",label:"Description",name:"description",type:"textarea",rows:2,size:e.SIZE.large}];if(i.configureOptions){h.push({required:true,label:"Options",field:new d.OptionsField({name:"options"}),id:"custom-field-options-input"})}return{fields:h}}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,JIRA.Admin.CustomFields.Form));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/io/IssueCustomFields.js' */
(function(c,d,b){c.IssueCustomFields=function(f){f||(f={});b.extend(this,b.defaults(f,{autoCloseWebsudo:true}))};var e=function(h,g,f){if(g!=="abort"){h.reject(c.IssueCustomFields.STATUS.error,JIRA.SmartAjax.buildSimpleErrorContent(f))}else{h.reject(c.IssueCustomFields.STATUS.abort,null)}};var a=function(f){return b.bind.apply(b,[f,undefined].concat(b.toArray(arguments).slice(1)))};b.extend(c.IssueCustomFields.prototype,{getSharedBy:function(g){var f=this;var h=d.Deferred();g.done(function(l){var i=this,j;if(b.isUndefined(f.issue)){l.sharedBy=[];h.resolveWith(this,arguments)}else{j=b.toArray(arguments);var k=f._ajax({type:"GET",url:c.url(["rest","globalconfig",1,"issuecustomfields",f.issue,"affectedProjects"]),dataType:"json",contentType:"application/json"});k.done(function(m){l.sharedBy=m;h.resolveWith(i,j)});k.fail(function(){l.sharedBy=[];h.resolveWith(i,j)});k.progress(function(){h.notifyWith(i,arguments)})}});g.fail(function(){h.rejectWith(this,arguments)});g.progress(function(){h.notifyWith(this,arguments)});return h.promise()},addFieldToScreen:function(h){var f=d.Deferred();if(b.isUndefined(this.issue)){f.reject(c.IssueCustomFields.STATUS.error,"No issue provided.")}else{var g=this._ajax({type:"POST",url:c.url(["rest","globalconfig",1,"issuecustomfields",this.issue]),data:h,dataType:"json",contentType:"application/json"});g.done(f.resolve);g.progress(f.notify);g.fail(a(e,f))}return f.promise()},addField:function(i){var f=this,h=b.pick(i,"name","description","searcherKey","type");var g=this._ajax({type:"POST",url:c.url("/rest/api/2/field"),context:this,data:JSON.stringify(h),dataType:"json",contentType:"application/json"});return g.pipe(undefined,function(k,j){return f._parseErrorCollection(j,{fieldName:"name"})})},addableFields:function(g){var f=d.Deferred();if(b.isUndefined(this.issue)){f.reject(c.IssueCustomFields.STATUS.error,"No issue provided.")}else{var h=this._ajax({type:"GET",url:c.url(["rest","globalconfig",1,"issuecustomfields",this.issue,"fields"],{onAllScreensFlag:!!g}),contentType:"application/json"});h.done(f.resolve);h.progress(f.notify);h.fail(a(e,f))}return f.promise()},setOptions:function(g,h){var i=this._ajax({type:"POST",url:c.url(["rest","globalconfig","1","customfieldoptions",g]),context:this,data:JSON.stringify(h),dataType:"json",contentType:"application/json"});var f=d.Deferred();i.done(f.resolve);i.progress(f.notify);i.fail(a(e,f));return f},getCustomFieldTypes:function(){var f=this._ajax({type:"GET",url:c.url("/rest/globalconfig/1/customfieldtypes"),dataType:"json",contentType:"application/json"});var g=d.Deferred();f.done(g.resolve);f.progress(g.notify);f.fail(a(e,g));return g},_remapObject:function(h,g){var f={};b.each(h,function(k,j){var i=g[j]||j;f[i]=k});return f},_parseErrorCollection:function(h,i){var k,f;if(h.hasData){try{var g=JSON.parse(h.data);if(!b.isEmpty(g.errorMessages)){k=g.errorMessages}if(!b.isEmpty(g.errors)){f=g.errors;if(i){f=this._remapObject(f,i)}}}catch(j){}}if(!k&&!f){k=[JIRA.SmartAjax.buildSimpleErrorContent(h)]}return{fields:f||{},general:k||[]}},_ajax:function(h){var f=this;var g=d.Deferred();var i=JIRA.SmartAjax.makeWebSudoRequest(h,{beforeShow:function(){g.notify(c.IssueCustomFields.PROGRESS.SHOW)},success:function(j){g.notify(c.IssueCustomFields.PROGRESS.SUCCESS,j);f.autoCloseWebsudo&&j()},cancel:function(j){j.preventDefault();g.rejectWith(f,["abort",undefined])}});i.done(function(){g.resolveWith(this,b.toArray(arguments))});i.fail(function(m,l,k,j){g.rejectWith(this,[l,j])});return g.promise()}});c.IssueCustomFields.STATUS={abort:"abort",error:"error"};c.IssueCustomFields.PROGRESS={SHOW:"websudoShow",SUCCESS:"websudoSuccess"}}(JIRA.Admin.CustomFields,AJS.$,_));;
;/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/main.js' */
(function(c,a,b){b.addCustomField=function(){var e,d;e=new b.IssueCustomFields({autoCloseWebsudo:false});d={api:e,inIssueContext:false};return new b.Wizard({sharedStepOptions:d,firstStep:new b.TypeStep(d),autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing."}).start().done(function(){AJS.trigger("analytics",{name:"administration.customfields.created.from.global"})})};b.addCustomFieldToIssue=function(d){var f,e,g;f=new b.IssueCustomFields({autoCloseWebsudo:false,issue:d});e={api:f,inIssueContext:true};g=new b.Wizard({sharedStepOptions:e,firstStep:new b.FieldWisherStep(e),autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing."});return g.start().fail(b.addCustomFieldToIssue._notifyFailure).done(b.addCustomFieldToIssue._analytics).done(function(h){g.close();b.addCustomFieldToIssue.editOrNotify(h.field)})};a.extend(b.addCustomFieldToIssue,{editOrNotify:function(d){if(!b.addCustomFieldToIssue._editValue(d)){b.addCustomFieldToIssue._notifySuccess()}},_editValue:function(e){var d=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.editFieldOnSelectedIssue;return d&&d(e.id)},_notifyFailure:(function(){var d=function(g,f){e(JIRA.Templates.CustomFields.addCompleteError({message:g,failedSteps:f||[]}))};var e=function(f){JIRA.Messages.showMsg(f,{type:JIRA.Messages.Types.ERROR,closeable:true})};return function(i,f){var g=b.Wizard.FAIL_REASON,h;f=f||{};h=f.data||{};if(i===g.abort){if(f.dirty){if(h.createField){d("The field was created but the following operations were aborted:",f.notCompletedDescriptions)}else{e("Unable to add field to issue.")}}}else{if(i===g.error){if(h.createField){d("The field was created but the following operations failed:",f.notCompletedDescriptions)}else{e("Unable to add field to issue.")}}}}}()),_notifySuccess:function(){JIRA.Messages.showMsg("The field was added successfully, but you do not have edit permissions.",{type:JIRA.Messages.Types.SUCCESS,closeable:true})},_analytics:function(d){if(d.createField){AJS.trigger("analytics",{name:"administration.customfields.created.and.added.to.issue"})}else{if(d.addField){AJS.trigger("analytics",{name:"administration.customfields.existing.added.to.issue"})}else{if(b.addCustomFieldToIssue._isFieldVisible(d.field.id)){AJS.trigger("analytics",{name:"administration.customfields.existing.on.issue.screens.edited.has.value"})}else{AJS.trigger("analytics",{name:"administration.customfields.existing.on.issue.screens.edited.has.no.value"})}}}},_isFieldVisible:function(f){var g,e,d;d=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.getFieldsOnSelectedIssue;e=d&&d();g=e&&e.get(f);return g&&g.matchesFieldSelector()}});c(document).on("click",".issueaction-fields-add",function(e){e.preventDefault();var d=JIRA.Issues.Api.getSelectedIssueId();JIRA.Admin.CustomFields.addCustomFieldToIssue(d)});c(document).on("click","#add_custom_fields",function(d){d.preventDefault();JIRA.Admin.CustomFields.addCustomField().done(function(f){var e=b.url("/secure/admin/AssociateFieldToScreens!default.jspa",{fieldId:f.field.id,returnUrl:"ViewCustomFields.jspa"});AJS.reloadViaWindowLocation(e)})})})(AJS.$,_,JIRA.Admin.CustomFields);;
;/* module-key = 'jira.webresources:jquery-easing', location = '/includes/jquery/plugins/easing/jquery.easing.1.3.js' */
jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return jQuery.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}});;
;/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox-1.3.4.js' */
(function($){var tmp,loading,overlay,wrap,outer,content,close,title,nav_left,nav_right,selectedIndex=0,selectedOpts={},selectedArray=[],currentIndex=0,currentOpts={},currentArray=[],ajaxLoader=null,imgPreloader=new Image(),imgRegExp=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,swfRegExp=/[^\.]\.(swf)\s*$/i,loadingTimer,loadingFrame=1,titleHeight=0,titleStr="",start_pos,final_pos,busy=false,fx=$.extend($("<div/>")[0],{prop:0}),isIE6=$.browser.msie&&$.browser.version<7&&!window.XMLHttpRequest,_abort=function(){loading.hide();imgPreloader.onerror=imgPreloader.onload=null;if(ajaxLoader){ajaxLoader.abort()}tmp.empty()},_error=function(){if(false===selectedOpts.onError(selectedArray,selectedIndex,selectedOpts)){loading.hide();busy=false;return }selectedOpts.titleShow=false;selectedOpts.width="auto";selectedOpts.height="auto";tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');_process_inline()},_start=function(){var obj=selectedArray[selectedIndex],href,type,title,str,emb,ret;_abort();selectedOpts=$.extend({},$.fn.fancybox.defaults,(typeof $(obj).data("fancybox")=="undefined"?selectedOpts:$(obj).data("fancybox")));ret=selectedOpts.onStart(selectedArray,selectedIndex,selectedOpts);if(ret===false){busy=false;return }else{if(typeof ret=="object"){selectedOpts=$.extend(selectedOpts,ret)}}title=selectedOpts.title||(obj.nodeName?$(obj).attr("title"):obj.title)||"";if(obj.nodeName&&!selectedOpts.orig){selectedOpts.orig=$(obj).children("img:first").length?$(obj).children("img:first"):$(obj)}if(title===""&&selectedOpts.orig&&selectedOpts.titleFromAlt){title=selectedOpts.orig.attr("alt")}href=selectedOpts.href||(obj.nodeName?$(obj).attr("href"):obj.href)||null;if((/^(?:javascript)/i).test(href)||href=="#"){href=null}if(selectedOpts.type){type=selectedOpts.type;if(!href){href=selectedOpts.content}}else{if(selectedOpts.content){type="html"}else{if(href){if(href.match(imgRegExp)){type="image"}else{if(href.match(swfRegExp)){type="swf"}else{if($(obj).hasClass("iframe")){type="iframe"}else{if(href.indexOf("#")===0){type="inline"}else{type="ajax"}}}}}}}if(!type){_error();return }if(type=="inline"){obj=href.substr(href.indexOf("#"));type=$(obj).length>0?"inline":"ajax"}selectedOpts.type=type;selectedOpts.href=href;selectedOpts.title=title;if(selectedOpts.autoDimensions){if(selectedOpts.type=="html"||selectedOpts.type=="inline"||selectedOpts.type=="ajax"){selectedOpts.width="auto";selectedOpts.height="auto"}else{selectedOpts.autoDimensions=false}}if(selectedOpts.modal){selectedOpts.overlayShow=true;selectedOpts.hideOnOverlayClick=false;selectedOpts.hideOnContentClick=false;selectedOpts.enableEscapeButton=false;selectedOpts.showCloseButton=false}selectedOpts.padding=parseInt(selectedOpts.padding,10);selectedOpts.margin=parseInt(selectedOpts.margin,10);tmp.css("padding",(selectedOpts.padding+selectedOpts.margin));$(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){$(this).replaceWith(content.children())});switch(type){case"html":tmp.html(selectedOpts.content);_process_inline();break;case"inline":if($(obj).parent().is("#fancybox-content")===true){busy=false;return }$('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup",function(){$(this).replaceWith(content.children())}).bind("fancybox-cancel",function(){$(this).replaceWith(tmp.children())});$(obj).appendTo(tmp);_process_inline();break;case"image":busy=false;$.fancybox.showActivity();imgPreloader=new Image();imgPreloader.onerror=function(){_error()};imgPreloader.onload=function(){busy=true;imgPreloader.onerror=imgPreloader.onload=null;_process_image()};imgPreloader.src=href;break;case"swf":selectedOpts.scrolling="no";str='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"><param name="movie" value="'+href+'"></param>';emb="";$.each(selectedOpts.swf,function(name,val){str+='<param name="'+name+'" value="'+val+'"></param>';emb+=" "+name+'="'+val+'"'});str+='<embed src="'+href+'" type="application/x-shockwave-flash" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"'+emb+"></embed></object>";tmp.html(str);_process_inline();break;case"ajax":busy=false;$.fancybox.showActivity();selectedOpts.ajax.win=selectedOpts.ajax.success;ajaxLoader=$.ajax($.extend({},selectedOpts.ajax,{url:href,data:selectedOpts.ajax.data||{},error:function(XMLHttpRequest,textStatus,errorThrown){if(XMLHttpRequest.status>0){_error()}},success:function(data,textStatus,XMLHttpRequest){var o=typeof XMLHttpRequest=="object"?XMLHttpRequest:ajaxLoader;if(o.status==200){if(typeof selectedOpts.ajax.win=="function"){ret=selectedOpts.ajax.win(href,data,textStatus,XMLHttpRequest);if(ret===false){loading.hide();return }else{if(typeof ret=="string"||typeof ret=="object"){data=ret}}}tmp.html(data);_process_inline()}}}));break;case"iframe":_show();break}},_process_inline=function(){var w=selectedOpts.width,h=selectedOpts.height;if(w.toString().indexOf("%")>-1){w=parseInt(($(window).width()-(selectedOpts.margin*2))*parseFloat(w)/100,10)+"px"}else{w=w=="auto"?"auto":w+"px"}if(h.toString().indexOf("%")>-1){h=parseInt(($(window).height()-(selectedOpts.margin*2))*parseFloat(h)/100,10)+"px"}else{h=h=="auto"?"auto":h+"px"}tmp.wrapInner('<div style="width:'+w+";height:"+h+";overflow: "+(selectedOpts.scrolling=="auto"?"auto":(selectedOpts.scrolling=="yes"?"scroll":"hidden"))+';position:relative;"></div>');selectedOpts.width=tmp.width();selectedOpts.height=tmp.height();_show()},_process_image=function(){selectedOpts.width=imgPreloader.width;selectedOpts.height=imgPreloader.height;$("<img />").attr({"id":"fancybox-img","src":imgPreloader.src,"alt":selectedOpts.title}).appendTo(tmp);_show()},_show=function(){var pos,equal;loading.hide();if(wrap.is(":visible")&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){$.event.trigger("fancybox-cancel");busy=false;return }busy=true;$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");if(wrap.is(":visible")&&currentOpts.titlePosition!=="outside"){wrap.css("height",wrap.height())}currentArray=selectedArray;currentIndex=selectedIndex;currentOpts=selectedOpts;if(currentOpts.overlayShow){overlay.css({"background-color":currentOpts.overlayColor,"opacity":currentOpts.overlayOpacity,"cursor":currentOpts.hideOnOverlayClick?"pointer":"auto","height":$(document).height()});if(!overlay.is(":visible")){if(isIE6){$("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({"visibility":"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}overlay.show()}}else{overlay.hide()}final_pos=_get_zoom_to();_process_title();if(wrap.is(":visible")){$(close.add(nav_left).add(nav_right)).hide();pos=wrap.position(),start_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};equal=(start_pos.width==final_pos.width&&start_pos.height==final_pos.height);content.fadeTo(currentOpts.changeFade,0.3,function(){var finish_resizing=function(){content.html(tmp.contents()).fadeTo(currentOpts.changeFade,1,_finish)};$.event.trigger("fancybox-change");content.empty().removeAttr("filter").css({"border-width":currentOpts.padding,"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2});if(equal){finish_resizing()}else{fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.changeSpeed,easing:currentOpts.easingChange,step:_draw,complete:finish_resizing})}});return }wrap.removeAttr("style");content.css("border-width",currentOpts.padding);if(currentOpts.transitionIn=="elastic"){start_pos=_get_zoom_from();content.html(tmp.contents());wrap.show();if(currentOpts.opacity){final_pos.opacity=0}fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.speedIn,easing:currentOpts.easingIn,step:_draw,complete:_finish});return }if(currentOpts.titlePosition=="inside"&&titleHeight>0){title.show()}content.css({"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2}).html(tmp.contents());wrap.css(final_pos).fadeIn(currentOpts.transitionIn=="none"?0:currentOpts.speedIn,_finish)},_format_title=function(title){if(title&&title.length){if(currentOpts.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+currentOpts.titlePosition+'">'+title+"</div>"}return false},_process_title=function(){titleStr=currentOpts.title||"";titleHeight=0;title.empty().removeAttr("style").removeClass();if(currentOpts.titleShow===false){title.hide();return }titleStr=$.isFunction(currentOpts.titleFormat)?currentOpts.titleFormat(titleStr,currentArray,currentIndex,currentOpts):_format_title(titleStr);if(!titleStr||titleStr===""){title.hide();return }title.addClass("fancybox-title-"+currentOpts.titlePosition).html(titleStr).appendTo("body").show();switch(currentOpts.titlePosition){case"inside":title.css({"width":final_pos.width-(currentOpts.padding*2),"marginLeft":currentOpts.padding,"marginRight":currentOpts.padding});titleHeight=title.outerHeight(true);title.appendTo(outer);final_pos.height+=titleHeight;break;case"over":title.css({"marginLeft":currentOpts.padding,"width":final_pos.width-(currentOpts.padding*2),"bottom":currentOpts.padding}).appendTo(outer);break;case"float":title.css("left",parseInt((title.width()-final_pos.width-40)/2,10)*-1).appendTo(wrap);break;default:title.css({"width":final_pos.width-(currentOpts.padding*2),"paddingLeft":currentOpts.padding,"paddingRight":currentOpts.padding}).appendTo(wrap);break}title.hide()},_set_navigation=function(){if(currentOpts.enableEscapeButton||currentOpts.enableKeyboardNav){$(document).bind("keydown.fb",function(e){if(e.keyCode==27&&currentOpts.enableEscapeButton){e.preventDefault();$.fancybox.close()}else{if((e.keyCode==37||e.keyCode==39)&&currentOpts.enableKeyboardNav&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&e.target.tagName!=="SELECT"){e.preventDefault();$.fancybox[e.keyCode==37?"prev":"next"]()}}})}if(!currentOpts.showNavArrows){nav_left.hide();nav_right.hide();return }if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!==0){nav_left.show()}if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!=(currentArray.length-1)){nav_right.show()}},_finish=function(){if(!$.support.opacity){content.get(0).style.removeAttribute("filter");wrap.get(0).style.removeAttribute("filter")}if(selectedOpts.autoDimensions){content.css("height","auto")}wrap.css("height","auto");if(titleStr&&titleStr.length){title.show()}if(currentOpts.showCloseButton){close.show()}_set_navigation();if(currentOpts.hideOnContentClick){content.bind("click",$.fancybox.close)}if(currentOpts.hideOnOverlayClick){overlay.bind("click",$.fancybox.close)}$(window).bind("resize.fb",$.fancybox.resize);if(currentOpts.centerOnScroll){$(window).bind("scroll.fb",$.fancybox.center)}if(currentOpts.type=="iframe"){$('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+($.browser.msie?'allowtransparency="true""':"")+' scrolling="'+selectedOpts.scrolling+'" src="'+currentOpts.href+'"></iframe>').appendTo(content)}wrap.show();busy=false;$.fancybox.center();currentOpts.onComplete(currentArray,currentIndex,currentOpts);_preload_images()},_preload_images=function(){var href,objNext;if((currentArray.length-1)>currentIndex){href=currentArray[currentIndex+1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}if(currentIndex>0){href=currentArray[currentIndex-1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}},_draw=function(pos){var dim={width:parseInt(start_pos.width+(final_pos.width-start_pos.width)*pos,10),height:parseInt(start_pos.height+(final_pos.height-start_pos.height)*pos,10),top:parseInt(start_pos.top+(final_pos.top-start_pos.top)*pos,10),left:parseInt(start_pos.left+(final_pos.left-start_pos.left)*pos,10)};if(typeof final_pos.opacity!=="undefined"){dim.opacity=pos<0.5?0.5:pos}wrap.css(dim);content.css({"width":dim.width-currentOpts.padding*2,"height":dim.height-(titleHeight*pos)-currentOpts.padding*2})},_get_viewport=function(){return[$(window).width()-(currentOpts.margin*2),$(window).height()-(currentOpts.margin*2),$(document).scrollLeft()+currentOpts.margin,$(document).scrollTop()+currentOpts.margin]},_get_zoom_to=function(){var view=_get_viewport(),to={},resize=currentOpts.autoScale,double_padding=currentOpts.padding*2,ratio;if(currentOpts.width.toString().indexOf("%")>-1){to.width=parseInt((view[0]*parseFloat(currentOpts.width))/100,10)}else{to.width=currentOpts.width+double_padding}if(currentOpts.height.toString().indexOf("%")>-1){to.height=parseInt((view[1]*parseFloat(currentOpts.height))/100,10)}else{to.height=currentOpts.height+double_padding}if(resize&&(to.width>view[0]||to.height>view[1])){if(selectedOpts.type=="image"||selectedOpts.type=="swf"){ratio=(currentOpts.width)/(currentOpts.height);if((to.width)>view[0]){to.width=view[0];to.height=parseInt(((to.width-double_padding)/ratio)+double_padding,10)}if((to.height)>view[1]){to.height=view[1];to.width=parseInt(((to.height-double_padding)*ratio)+double_padding,10)}}else{to.width=Math.min(to.width,view[0]);to.height=Math.min(to.height,view[1])}}to.top=parseInt(Math.max(view[3]-20,view[3]+((view[1]-to.height-40)*0.5)),10);to.left=parseInt(Math.max(view[2]-20,view[2]+((view[0]-to.width-40)*0.5)),10);return to},_get_obj_pos=function(obj){var pos=obj.offset();pos.top+=parseInt(obj.css("paddingTop"),10)||0;pos.left+=parseInt(obj.css("paddingLeft"),10)||0;pos.top+=parseInt(obj.css("border-top-width"),10)||0;pos.left+=parseInt(obj.css("border-left-width"),10)||0;pos.width=obj.width();pos.height=obj.height();return pos},_get_zoom_from=function(){var orig=selectedOpts.orig?$(selectedOpts.orig):false,from={},pos,view;if(orig&&orig.length){pos=_get_obj_pos(orig);from={width:pos.width+(currentOpts.padding*2),height:pos.height+(currentOpts.padding*2),top:pos.top-currentOpts.padding-20,left:pos.left-currentOpts.padding-20}}else{view=_get_viewport();from={width:currentOpts.padding*2,height:currentOpts.padding*2,top:parseInt(view[3]+view[1]*0.5,10),left:parseInt(view[2]+view[0]*0.5,10)}}return from},_animate_loading=function(){if(!loading.is(":visible")){clearInterval(loadingTimer);return }$("div",loading).css("top",(loadingFrame*-40)+"px");loadingFrame=(loadingFrame+1)%12};$.fn.fancybox=function(options){if(!$(this).length){return this}$(this).data("fancybox",$.extend({},options,($.metadata?$(this).metadata():{}))).unbind("click.fb").bind("click.fb",function(e){e.preventDefault();if(busy){return }busy=true;$(this).blur();selectedArray=[];selectedIndex=0;var rel=$(this).attr("rel")||"";if(!rel||rel==""||rel==="nofollow"){selectedArray.push(this)}else{selectedArray=$("a[rel="+rel+"], area[rel="+rel+"]");selectedIndex=selectedArray.index(this)}_start();return });return this};$.fancybox=function(obj){var opts;if(busy){return }busy=true;opts=typeof arguments[1]!=="undefined"?arguments[1]:{};selectedArray=[];selectedIndex=parseInt(opts.index,10)||0;if($.isArray(obj)){for(var i=0,j=obj.length;i<j;i++){if(typeof obj[i]=="object"){$(obj[i]).data("fancybox",$.extend({},opts,obj[i]))}else{obj[i]=$({}).data("fancybox",$.extend({content:obj[i]},opts))}}selectedArray=jQuery.merge(selectedArray,obj)}else{if(typeof obj=="object"){$(obj).data("fancybox",$.extend({},opts,obj))}else{obj=$({}).data("fancybox",$.extend({content:obj},opts))}selectedArray.push(obj)}if(selectedIndex>selectedArray.length||selectedIndex<0){selectedIndex=0}_start()};$.fancybox.showActivity=function(){clearInterval(loadingTimer);loading.show();loadingTimer=setInterval(_animate_loading,66)};$.fancybox.hideActivity=function(){loading.hide()};$.fancybox.next=function(){return $.fancybox.pos(currentIndex+1)};$.fancybox.prev=function(){return $.fancybox.pos(currentIndex-1)};$.fancybox.pos=function(pos){if(busy){return }pos=parseInt(pos);selectedArray=currentArray;if(pos>-1&&pos<currentArray.length){selectedIndex=pos;_start()}else{if(currentOpts.cyclic&&currentArray.length>1){selectedIndex=pos>=currentArray.length?0:currentArray.length-1;_start()}}return };$.fancybox.cancel=function(){if(busy){return }busy=true;$.event.trigger("fancybox-cancel");_abort();selectedOpts.onCancel(selectedArray,selectedIndex,selectedOpts);busy=false};$.fancybox.close=function(){if(busy||wrap.is(":hidden")){return }busy=true;if(currentOpts&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){busy=false;return }_abort();$(close.add(nav_left).add(nav_right)).hide();$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");content.find("iframe").attr("src",isIE6&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");if(currentOpts.titlePosition!=="inside"){title.empty()}wrap.stop();function _cleanup(){overlay.fadeOut("fast");title.empty().hide();wrap.hide();$.event.trigger("fancybox-cleanup");content.empty();currentOpts.onClosed(currentArray,currentIndex,currentOpts);currentArray=selectedOpts=[];currentIndex=selectedIndex=0;currentOpts=selectedOpts={};busy=false}if(currentOpts.transitionOut=="elastic"){start_pos=_get_zoom_from();var pos=wrap.position();final_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};if(currentOpts.opacity){final_pos.opacity=1}title.empty().hide();fx.prop=1;$(fx).animate({prop:0},{duration:currentOpts.speedOut,easing:currentOpts.easingOut,step:_draw,complete:_cleanup})}else{wrap.fadeOut(currentOpts.transitionOut=="none"?0:currentOpts.speedOut,_cleanup)}};$.fancybox.resize=function(){if(overlay.is(":visible")){overlay.css("height",$(document).height())}$.fancybox.center(true)};$.fancybox.center=function(){var view,align;if(busy){return }align=arguments[0]===true?1:0;view=_get_viewport();if(!align&&(wrap.width()>view[0]||wrap.height()>view[1])){return }wrap.stop().animate({"top":parseInt(Math.max(view[3]-20,view[3]+((view[1]-content.height()-40)*0.5)-currentOpts.padding)),"left":parseInt(Math.max(view[2]-20,view[2]+((view[0]-content.width()-40)*0.5)-currentOpts.padding))},typeof arguments[0]=="number"?arguments[0]:200)};$.fancybox.init=function(){if($("#fancybox-wrap").length){return }$("body").append(tmp=$('<div id="fancybox-tmp"></div>'),loading=$('<div id="fancybox-loading"><div></div></div>'),overlay=$('<div id="fancybox-overlay"></div>'),wrap=$('<div id="fancybox-wrap"></div>'));outer=$('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);outer.append(content=$('<div id="fancybox-content"></div>'),close=$('<a id="fancybox-close"></a>'),title=$('<div id="fancybox-title"></div>'),nav_left=$('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),nav_right=$('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));close.click($.fancybox.close);loading.click($.fancybox.cancel);nav_left.click(function(e){e.preventDefault();$.fancybox.prev()});nav_right.click(function(e){e.preventDefault();$.fancybox.next()});if($.fn.mousewheel){wrap.bind("mousewheel.fb",function(e,delta){if(busy){e.preventDefault()}else{if($(e.target).get(0).clientHeight==0||$(e.target).get(0).scrollHeight===$(e.target).get(0).clientHeight){e.preventDefault();$.fancybox[delta>0?"prev":"next"]()}}})}if(!$.support.opacity){wrap.addClass("fancybox-ie")}if(isIE6){loading.addClass("fancybox-ie6");wrap.addClass("fancybox-ie6");$('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)}};$.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};$(document).ready(function(){$.fancybox.init()})})(jQuery);;
;/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox.jira.js' */
AJS.$.fn.fancybox.defaults.titleFormat=function(title){if(title&&title.length){title=AJS.escapeHtml(title);if(this.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+this.titlePosition+'">'+title+"</div>"}};;
;/* module-key = 'com.atlassian.auiplugin:aui-alignment', location = 'js/aui/internal/alignment.js' */
(function(A){AJS.Alignment=A(window.Tether);if(typeof window.define==="function"){define("aui/internal/alignment",["aui/internal/tether"],function(){return AJS.Alignment})}})(function(E){var C="data-aui-alignment";var J="data-aui-alignment-static";var H="aui-alignment";var A="aui-alignment-side-";var K="aui-alignment-snap-";var D="right middle";var I={"top left":{el:"bottom left",target:"top left"},"top center":{el:"bottom center",target:"top center"},"top right":{el:"bottom right",target:"top right"},"right top":{el:"top left",target:"top right"},"right middle":{el:"middle left",target:"middle right"},"right bottom":{el:"bottom left",target:"bottom right"},"bottom left":{el:"top left",target:"bottom left"},"bottom center":{el:"top center",target:"bottom center"},"bottom right":{el:"top right",target:"bottom right"},"left top":{el:"top right",target:"top left"},"left middle":{el:"middle right",target:"middle left"},"left bottom":{el:"bottom right",target:"bottom left"}};function G(Q,P,M){var N=A+P;var O=K+M;Q.className+=" "+N+" "+O}function B(M){var N=(M.getAttribute(C)||D).split(" ");return{side:N[0],snap:N[1]}}function F(N,M){return I[N+" "+M]||I[D]}function L(O,P){var R=B(O);var Q=F(R.side,R.snap);var N=O.hasAttribute(J);var M=new E({enabled:false,element:O,target:P,attachment:Q.el,targetAttachment:Q.target,classPrefix:H,constraints:[{to:"window",attachment:N===true?"none":"together"}]});G(O,R.side,R.snap);this._auiTether=M}L.prototype={destroy:function(){this._auiTether.destroy();return this},disable:function(){this._auiTether.disable();return this},enable:function(){this._auiTether.enable();return this}};return L});;
;/* module-key = 'com.atlassian.auiplugin:aui-trigger', location = '/js/aui/trigger.js' */
(function(A){define("aui/trigger",[],function(){return A(AJS.$,window.skate)})})(function(E,B){function D(G,H){var F=E(H).closest("a[href]",G);return !!F.length&&F[0]!==G}function C(F){return document.getElementById(F.getAttribute("aria-controls"))}function A(G,H){if(G.isEnabled()){var F=C(G);if(F&&F.message){F.message(H)}}}B("data-aui-trigger",{type:B.types.ATTR,insert:function(F){E(F).on({click:function(G){if(!D(F,G.target)){A(F,G);G.preventDefault()}},"mouseenter mouseleave focus blur":function(G){A(F,G)}})},prototype:{disable:function(){this.setAttribute("aria-disabled","true")},enable:function(){this.setAttribute("aria-disabled","false")},isEnabled:function(){return this.getAttribute("aria-disabled")!=="true"}}})});;
;/* module-key = 'com.atlassian.auiplugin:aui-trigger', location = '/soy/trigger.soy' */
// This file was automatically generated from trigger.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.trigger == 'undefined') { aui.trigger = {}; }


aui.trigger.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="');
  aui.renderExtraClasses(opt_data, output);
  output.append('" aria-owns="', soy.$$escapeHtml(opt_data.menu.id), '" aria-controls="', soy.$$escapeHtml(opt_data.menu.id), '" aria-haspopup="true"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', (opt_data.container) ? ' data-container="' + soy.$$escapeHtml(opt_data.container) + '"' : '', ((! opt_data.tagName || opt_data.tagName == 'a') && (! opt_data.extraAttributes || Object.prototype.toString.call(opt_data.extraAttributes) === '[object Object]' && ! opt_data.extraAttributes.href && ! opt_data.extraAttributes.tabindex)) ? ' tabindex="0"' : '', ' data-aui-trigger');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', (opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', (! (opt_data.showIcon == false)) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.iconClasses ? opt_data.iconClasses : 'aui-icon-dropdown') + '">' + ((opt_data.iconText) ? soy.$$escapeHtml(opt_data.iconText) : '') + '</span>' : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a'), '>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.auiplugin:internal-aui-browser', location = 'js/aui/internal/browser.js' */
(function(A){AJS._internal=AJS._internal||{};AJS._internal.browser=A(AJS.$)})(function(B){var A={};var C=null;A.supportsCalc=function(){if(C===null){var D=B('<div style="height: 10px; height: -webkit-calc(20px + 0); height: calc(20px);"></div>');C=(20===D.appendTo(document.documentElement).height());D.remove()}return C};A.supportsRequestAnimationFrame=function(){return !!window.requestAnimationFrame};return A});;
;/* module-key = 'com.atlassian.auiplugin:aui-inline-dialog2', location = '/js/aui/inline-dialog2.js' */
(function(A){define("aui/inline-dialog2",["./internal/alignment","./trigger"],function(B){return A(B,AJS.layer,window.skate)})})(function(J,C,E){var I=1000;function K(M){return document.querySelector('[aria-controls="'+M.id+'"]')}function F(N,O){var M=K(N);if(M){O(M)}}function G(M,O){var N=M.getAttribute("data-aui-responds-to")==="hover";if(N){O(M)}}function L(N,M){if(!N._auiAlignment){N._auiAlignment=new J(N,M)}}function B(N,M){L(N,M);N._auiAlignment.enable()}function A(N,M){L(N,M);N._auiAlignment.disable()}E("aui-inline-dialog2",{type:E.types.TAG,ready:function(M){F(M,function(N){N.setAttribute("aria-expanded",M.isVisible());N.setAttribute("aria-haspopup","true")});G(M,function(){M.mouseInside=false;M.addEventListener("mouseenter",function(){M.mouseInside=true;M.message({type:"mouseenter"})});M.addEventListener("mouseleave",function(){M.mouseInside=false;M.message({type:"mouseleave"})})})},remove:function(M){if(M._auiAlignment){M._auiAlignment.destroy()}},prototype:{remove:function(){C(this).remove()},show:function(){var M=this;C(this).show();F(this,function(N){B(M,N);N.setAttribute("aria-expanded","true")});return this},hide:function(){var M=this;C(this).hide();F(this,function(N){A(M,N);N.setAttribute("aria-expanded","false")});return this},isVisible:function(){return C(this).isVisible()},message:function(M){D(this,M);return this}}});function D(O,Q){var N={toggle:["click"],hover:["mouseenter","mouseleave","focus","blur"]};var M=O.getAttribute("data-aui-responds-to");var P=N[M];if(P&&P.indexOf(Q.type)>-1){H[Q.type](O,Q)}}var H={click:function(M){if(M.isVisible()){if(!C(M).isPersistent()){M.hide()}}else{M.show()}},mouseenter:function(M){if(!M.isVisible()){M.show()}if(M._clearMouseleaveTimeout){M._clearMouseleaveTimeout()}},mouseleave:function(M){if(C(M).isPersistent()||!M.isVisible()){return }if(M._clearMouseleaveTimeout){M._clearMouseleaveTimeout()}var N=setTimeout(function(){if(!M.mouseInside){M.hide()}},I);M._clearMouseleaveTimeout=function(){clearTimeout(N);M._clearMouseleaveTimeout=null}},focus:function(M){if(!M.isVisible()){M.show()}},blur:function(M){if(!C(M).isPersistent()&&M.isVisible()){M.hide()}}}});;
;/* module-key = 'com.atlassian.auiplugin:aui-inline-dialog2', location = 'soy/inline-dialog2.soy' */
// This file was automatically generated from inline-dialog2.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.inlineDialog2 == 'undefined') { aui.inlineDialog2 = {}; }


aui.inlineDialog2.inlineDialog2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<aui-inline-dialog2 ', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', '  class="aui-layer aui-inline-dialog');
  aui.renderExtraClasses(opt_data, output);
  output.append('" data-aui-alignment="', soy.$$escapeHtml(opt_data.alignment ? opt_data.alignment : ''), '" data-aui-responds-to="', soy.$$escapeHtml(opt_data.respondsTo ? opt_data.respondsTo : ''), '" aria-hidden="true"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>');
  aui.inlineDialog2.inlineDialog2Content(opt_data, output);
  output.append('</aui-inline-dialog2>');
  return opt_sb ? '' : output.toString();
};


aui.inlineDialog2.inlineDialog2Content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-inline-dialog-contents">', (opt_data.content) ? opt_data.content : '', '</div>');
  return opt_sb ? '' : output.toString();
};


aui.inlineDialog2.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.trigger.trigger(soy.$$augmentData(opt_data, {showIcon: opt_data.showIcon ? opt_data.showIcon : false}), output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/issuecomponents.soy' */
// This file was automatically generated from issuecomponents.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.watchersWithBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel" role="button"><span class="icon-default aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Close"), '</span></a><fieldset><label class="js-add-watchers-label">', soy.$$escapeHtml("Add Watchers"), '</label><div class="autocomplete-user-target"><select id="watchers" name="watchers" data-description="', soy.$$escapeHtml("Start Typing for Users"), '" class="watchers-user-picker hidden" multiple="multiple">');
  var watcherList10 = opt_data.watchers;
  var watcherListLen10 = watcherList10.length;
  for (var watcherIndex10 = 0; watcherIndex10 < watcherListLen10; watcherIndex10++) {
    var watcherData10 = watcherList10[watcherIndex10];
    output.append('<option style="background-image:url(\'', soy.$$escapeHtml(watcherData10.avatarUrls['16x16']), '\')" selected="selected" value="', soy.$$escapeHtml(watcherData10.name), '">', soy.$$escapeHtml(watcherData10.displayName), '</option>');
  }
  output.append('</select></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.watchersNoBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel" role="button"><span class="icon-default aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Close"), '</span></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div><input type="text" class="text" id="watchers-nosearch" /><div class="description">', soy.$$escapeHtml("Type username and press enter."), '</div></div><div class="recipients"><ol class="watchers">');
  var watcherList28 = opt_data.watchers;
  var watcherListLen28 = watcherList28.length;
  for (var watcherIndex28 = 0; watcherIndex28 < watcherListLen28; watcherIndex28++) {
    var watcherData28 = watcherList28[watcherIndex28];
    JIRA.Templates.Fields.recipientUsername({username: watcherData28.name, icon: watcherData28.avatarUrls['16x16'], displayName: watcherData28.displayName, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml(opt_data.msg), '</p><ul>');
  var messageList40 = opt_data.errors;
  var messageListLen40 = messageList40.length;
  for (var messageIndex40 = 0; messageIndex40 < messageListLen40; messageIndex40++) {
    var messageData40 = messageList40[messageIndex40];
    output.append('<li>', soy.$$escapeHtml(messageData40), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.usersListReadOnly = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui recipients-form"><a href="#" class="cancel" role="button"><span class="icon-default aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Close"), '</span></a><fieldset><div class="recipients"><ol class="voters">');
  var voterList50 = opt_data.users;
  var voterListLen50 = voterList50.length;
  for (var voterIndex50 = 0; voterIndex50 < voterListLen50; voterIndex50++) {
    var voterData50 = voterList50[voterIndex50];
    JIRA.Templates.Fields.recipientUsername({username: voterData50.name, icon: voterData50.avatarUrls['16x16'], displayName: voterData50.displayName, readOnly: true, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jquery/plugins/shorten/shorten.js' */
define("jira/ajs/shorten/shortener",["jira/ajs/control","jira/data/local-storage","jquery"],function(Control,localStorage,jQuery){return Control.extend({_getDefaultOptions:function(){return{items:"a, span",numRows:1,shortenText:"hide",shortenOnInit:true,persist:true,expandButtonTooltip:"Click to view {0} more",collapseButtonTooltip:"Hide"}},init:function(options){if(typeof options==="string"){options={element:options}}options=options||{};this.options=jQuery.extend(this._getDefaultOptions(),options);this._timerId=0;this.expanded=false;this.$container=jQuery(this.options.element);this._assignEvents("body",document.body);this._ready()},_isValid:function(){return !this.initialized&&this.$container.is(":visible")&&this.$container.children().length>0},_ready:function(){if(this._isValid()){this.$items=this.$container.children(this.options.items);this.$expandButton=this._render("expandButton");this.$collapseButton=this._render("collapseButton");this._assignEvents("expand-button",".shortener-expand");this._assignEvents("collapse-button",".shortener-collapse");if(!jQuery.browser.msie||jQuery.browser.version>="9"){this._assignEvents("resize-region",window)}if(this._isCollapsedOnInit()){this.collapse()}else{this.expand()}this.initialized=true}},_renders:{"expandButton":function(){return jQuery("<a href='#' class='ellipsis shortener-expand' title='"+this.options.expandButtonTooltip+"'></a><br>")},"collapseButton":function(){return jQuery("<a title='Hide' class='icon icon-hide shortener-collapse' href='#'><span>"+this.options.collapseButtonTooltip+"</span></a>")}},_events:{"expand-button":{"click":function(event){if(event.currentTarget===this.$expandButton[0]){event.preventDefault();this.expand();this._saveState("expanded")}}},"collapse-button":{"click":function(event){if(event.currentTarget===this.$collapseButton[0]){event.preventDefault();this.collapse();this._saveState("collapsed");this.$container.scrollIntoView()}}},"resize-region":{"resize":function(){clearTimeout(this._timerId);if(!this.expanded){var instance=this;this._timerId=setTimeout(function(){instance.collapse()},400)}}},"body":{tabSelect:function(){this._ready()}}},_saveState:function(value){try{localStorage.setItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"),value)}catch(QUOTA_EXCEEDED_ERR){}},_loadState:function(){return localStorage.getItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"))},_isCollapsedOnInit:function(){var shortenOnInit=this._loadState();if(shortenOnInit!==null){return shortenOnInit!=="expanded"}return this.options.shortenOnInit},_removeButtons:function(){this.$expandButton.remove();this.$collapseButton.remove()},_getOverflowIndex:function(){if(this.$items.length>1){var currentRow=1;var prevItemPageX=-1;for(var i=0;i<this.$items.length;i++){var itemPageX=this.$items.eq(i).offset().left;if(itemPageX<=prevItemPageX){currentRow++;if(currentRow>this.options.numRows){return i}}prevItemPageX=itemPageX}}return -1},expand:function(){this._removeButtons();if(this._getOverflowIndex()>0){this.$collapseButton=this._render("collapseButton");this.$container.append(this.$collapseButton);this.$container.css("height","auto");if(jQuery.browser.msie&&jQuery.browser.version<"9"){jQuery("body").toggleClass("reflow")}}this.expanded=true},collapse:function(){this._removeButtons();var i=this._getOverflowIndex();if(i>0){this.$container.css({"position":"absolute","visibility":"hidden","width":this.$container[0].clientWidth+"px"});var $expandButtonContent=this.$expandButton.first();do{var remainingItemCount=(this.$items.length-i);$expandButtonContent.text("("+remainingItemCount+")");this.$expandButton.insertBefore(this.$items[i]);i--;var oi=this.$items.eq(i).offset();var ob=this.$expandButton.offset();if(oi.left<ob.left&&ob.top<oi.top+10){break}}while(i>0);var height=(i<this.$items.length-1)?(this.$items.eq(i+1).offset().top-this.$container.offset().top)+"px":"auto";this.$container.css({"height":height,"position":"static","visibility":"visible","width":"auto"});$expandButtonContent.attr("title",AJS.format(this.options.expandButtonTooltip,remainingItemCount));if(jQuery.browser.msie&&jQuery.browser.version<"9"){jQuery("body").toggleClass("reflow")}}else{this.$container.css("height","auto")}this.expanded=false}})});define("jira/jquery/plugins/shorten/shorten",["jira/ajs/shorten/shortener","jquery"],function(Shortener,jQuery){jQuery.fn.shorten=function(options){var res=[];options=options||{};this.each(function(){options.element=this;res.push(new Shortener(options))});return res}});AJS.namespace("AJS.Shortener",null,require("jira/ajs/shorten/shortener"));(function(){require("jira/jquery/plugins/shorten/shorten")})();;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initShorten.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var jQuery=require("jquery");require("jira/jquery/plugins/shorten/shorten");Events.bind(Types.NEW_CONTENT_ADDED,function(e,$ctx){jQuery(".shorten",$ctx).shorten()})})();;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initToggleBlock.js' */
AJS.$(function(){new JIRA.ToggleBlock({blockSelector:".toggle-wrap",triggerSelector:".mod-header .toggle-title",storageCollectionName:"block-states",});if(JIRA.Events.ISSUE_REFRESHED){JIRA.bind(JIRA.Events.ISSUE_REFRESHED,function(){if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS)}})}});;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSlideshow.js' */
(function($){var defaultOpts={type:"image",centerOnScroll:true,onStart:AJS.disableKeyboardShortcuts,onClosed:AJS.enableKeyboardShortcuts};function initGallery($ctx){var transition="elastic";var galleryOpts=$.extend({},defaultOpts,{transitionIn:transition,transitionOut:transition});$ctx.find(".gallery, [id$='_thumb']").each(function(){$(this).fancybox(galleryOpts)});$ctx.find("#attachment_thumbnails .attachment-title").click(function(e){if(e.which===1){e.preventDefault();$(this).closest(".attachment-content").find(".gallery").click()}})}function initWorkflow($ctx){$ctx.find("a.issueaction-viewworkflow:not(.new-workflow-designer)").each(function(){$(this).fancybox(defaultOpts)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx,reason){initGallery($ctx);initWorkflow($ctx)});$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="attachmentmodule"){initGallery($new)}else{if(panel==="details-module"){initWorkflow($new)}}})}})})(AJS.$);;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initComment.js' */
(function($){var commentFormIsBeingSubmitted=false;var isInPreviewMode=false;var commentForm=JIRA.Issue.CommentForm={setCaretAtEndOfCommentField:function(){var $field=this.getField(),field=$field[0],length;if($field.length){length=$field.val().length;$field.scrollTop($field.attr("scrollHeight"));if(field.setSelectionRange&&length>0){field.setSelectionRange(length,length)}}},disable:function(){this.getForm().find("textarea").attr("readonly","readonly");this.getForm().find(":submit").attr("disabled","disabled")},isDirty:function(){var field=this.getField();if(field.length){return field[0].value!==field[0].defaultValue}return false},handleBrowseAway:function(){var isDirty=commentForm.isDirty(),isVisible=commentForm.getForm()&&commentForm.getForm().is(":visible");if(isDirty&&isVisible){return "You have entered a comment on this issue. If you navigate away from this page without first saving, the comment will be lost."}},setSubmitState:function(){if(jQuery.trim(this.getField().val()).length>0){this.getForm().find(":submit").removeAttr("disabled")}else{this.getForm().find(":submit").attr("disabled","disabled")}},enable:function(){this.getForm().find("textarea").removeAttr("readonly");this.getForm().find(":submit").removeAttr("disabled")},getCommentVisibility:function(){var visibility=$("#commentLevel :selected").val();if(visibility){var split_v=visibility.split(":");return{"type":split_v[0],"value":$("#commentLevel :selected").text()}}return null},ajaxSubmit:function(callback){var $loading=jQuery('<span class="icon throbber loading"></span>');var issueId=JIRA.Issue.getIssueId();var issueKey=JIRA.Issue.getIssueKey();var restURL=contextPath+"/rest/api/2/issue/"+issueKey+"/comment";var newComment={"body":this.getField()[0].value.replace(/\r?\n/g,"\r\n")};var visibility=this.getCommentVisibility();if(visibility){newComment["visibility"]=visibility}$.ajax({url:restURL,type:"POST",contentType:"application/json",data:JSON.stringify(newComment),success:function(data){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"]);JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[issueId,{complete:function(){var newCommentId="comment-"+data.id;jQuery("#"+newCommentId).scrollIntoView({marginBottom:200,marginTop:200});var $focusedTabs=$("#issue_actions_container > .issue-data-block.focused");$focusedTabs.removeClass("focused");var $newfocusedTab=$("#"+newCommentId);$newfocusedTab.addClass("focused");$loading.remove();footerComment.hide(true);commentForm.enable()}}])},error:function(xhr){function buildErrorDialog(errorMessage){var errorContent="<h2>"+"Error"+"</h2>"+'<div class="ajaxerror">'+'<div class="aui-message error">'+'<span class="aui-icon icon-warning"/>'+errorMessage+"</div>"+"</div>";return $(errorContent)}var response=$.parseJSON(xhr.responseText);var content;if(response&&response.errors&&response.errors.comment){content=buildErrorDialog(response.errors.comment)}else{content=JIRA.SmartAjax.buildDialogErrorContent(xhr)}new JIRA.FormDialog({content:content}).show();$loading.remove();commentForm.enable()}});$loading.appendTo(this.getForm().find(":submit").parent())},getForm:function(){var $form=$("form#issue-comment-add");if($form.length===1){this.$form=$form}return this.$form||$()},getField:function(){return this.getForm().find("#comment")},getSubmitButton:function(){return this.getForm().find("#issue-comment-add-submit")},hide:function(cancel){if(cancel){this.cancel()}this.getForm().detach();if(JIRA.Events.UNLOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"])}},show:function(){this.focus();if(JIRA.Events.LOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.LOCK_PANEL_REFRESHING,["addcommentmodule"])}},focus:function(){this.focusField();this.setCaretAtEndOfCommentField()},focusField:function(){this.getField().focus().trigger("keyup");this.getSubmitButton().scrollIntoView({marginBottom:200})},showNoCommentMsg:function(e){if(this.getField().val()===""){$("#emptyCommentErrMsg").show();return true}},cancel:function(){var instance=this;setTimeout(function(){instance.getField().val("")},100);$("#comment-preview_link.selected").click()}};var footerComment={getModule:function(){return $("#addcomment")},isActive:function(){return this.getModule().hasClass("active")},hide:function(cancel){if(this.isActive()){var dirtyMessage=commentForm.handleBrowseAway();if(isInPreviewMode||commentFormIsBeingSubmitted||!dirtyMessage||confirm(dirtyMessage)){this.getModule().removeClass("active");commentForm.hide(cancel)}}},ajaxSubmit:function(){commentFormIsBeingSubmitted=true;commentForm.ajaxSubmit(function(){footerComment.hide()})},show:function(){if(!this.isActive()){commentFormIsBeingSubmitted=false;this.getModule().addClass("active");this.appendForm();commentForm.show()}else{commentForm.focusField()}},appendForm:function(){this.getModule().find(".mod-content").append(commentForm.getForm())}};var oldBeforeUnload=window.onbeforeunload;$(document).delegate("#addcomment #issue-comment-add","submit",function(e){footerComment.ajaxSubmit();e.preventDefault()}).delegate(".issue-header #comment-issue","click",function(e){footerComment.show();e.preventDefault()}).delegate("#footer-comment-button","click",function(e){footerComment.show();e.preventDefault()}).delegate("#addcomment .cancel","click",function(e){e.preventDefault();footerComment.hide(true)}).delegate("#issue-comment-add","submit",function(){window.setTimeout(function(){commentForm.disable()},0)}).delegate("#issue-comment-add #comment","input",function(){commentForm.setSubmitState()}).delegate("#issue-comment-add input[type='submit']","click",function(e){if(commentForm.showNoCommentMsg()){e.preventDefault()}}).bind("showWikiInput",function(){isInPreviewMode=false;var $commentField=commentForm.getField();if($commentField.is(":visible:enabled")){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated");if($commentField.length>0){$commentField.focus()}commentForm.setCaretAtEndOfCommentField()}}).bind("showWikiPreview",function(){isInPreviewMode=true;JIRA.Issue.getStalker().trigger("stalkerHeightUpdated")});window.onbeforeunload=function(){return oldBeforeUnload.apply(this,arguments)||commentForm.handleBrowseAway.apply(this,arguments)};$(function(){new AJS.SecurityLevelSelect($("#commentLevel"))});JIRA.Issue.getDirtyCommentWarning=commentForm.handleBrowseAway;JIRA.Issue.invokeCommentTrigger=function(){var addIssueComment=AJS.$(".add-issue-comment");if(addIssueComment.length===0){return }var toolbarTrigger=addIssueComment.filter(".toolbar-trigger");if(toolbarTrigger.length>0){toolbarTrigger.click()}else{addIssueComment.click()}}})(AJS.$);AJS.$(function(){if(parseUri(window.location.href).anchor==="add-comment"){AJS.$("#footer-comment-button").click()}});;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initCustomFieldTabs.js' */
(function($,scope){var activateTab=function(tabName){var tabTrigger;if(typeof tabName!=="string"&&tabName.length>0){return }if(tabName[0]!=="#"){tabName="#"+tabName}console.log("activating tab",tabName);tabTrigger=$("a[href='"+tabName+"']",scope);if(tabTrigger.length){AJS.tabs.change(tabTrigger)}};var revealer=function(e){var $containingTab=$(e.target).closest(".tabs-pane");if($containingTab.length>0){activateTab($containingTab.attr("id"))}};$(function(){if(JIRA.Events.NEW_CONTENT_ADDED){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context){var $customFieldModule=$context.find(scope);$customFieldModule.unbind("reveal");$customFieldModule.bind("reveal",revealer);AJS.tabs.setup()})}if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="details-module"){var $activeTab=$existing.find(scope).find(".active-tab");if($activeTab.length===1){activateTab($activeTab.find("a").attr("href"))}}})}$(scope).bind("reveal",revealer)})})(AJS.$,"#customfieldmodule");;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSubtaskTimeLogging.js' */
(function($){$(document).delegate("#tt_include_subtasks input","click",function(e){if(AJS.$(this).is(":checked")){AJS.$("#tt_info_single").hide();AJS.$("#tt_info_aggregate").show()}else{AJS.$("#tt_info_aggregate").hide();AJS.$("#tt_info_single").show()}})})(AJS.$);;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVotersModel.js' */
(function(){var JIRAUserModel=Backbone.Model.extend({idAttribute:"key"});var WatchersAndVoterUsers=Backbone.Collection.extend({model:JIRAUserModel,initialize:function(options){if(options===undefined){throw new Error("Must supply options")}if(options.issueKey){this.issueKey=options.issueKey}else{throw new Error("Must supply issue key")}if(options.endpoint){this.endpoint=options.endpoint}else{throw new Error("Must supply an endpoint")}if(options.modelKey){this.modelKey=options.modelKey}else{throw new Error("Must supply an model key")}},url:function(){return[AJS.contextPath(),"rest/api/2/issue",this.issueKey,this.endpoint].join("/")},parse:function(response){return(response&&response[this.modelKey])?response[this.modelKey]:[]},ajax:function(options){options=_.extend({url:this.url(),headers:{"Content-Type":"application/json"},success:_.bind(function(){this.fetch()},this),error:_.bind(function(xhr){if(xhr.status!==404){this.handleErrorResponse(xhr,"There was an error adding watcher")}},this)},options);return AJS.$.ajax(options)},getUser:function(username){return AJS.$.ajax({url:AJS.contextPath()+"/rest/api/2/user?username="+encodeURIComponent(username),error:_.bind(function(xhr){if(xhr.status!==404){this.handleErrorResponse(xhr,"There was an error adding watcher")}},this)})},handleErrorResponse:function(xhr,msg){var errorCollection=this._parseResponse(xhr.responseText);if(errorCollection.errorMessages){var html=JIRA.Templates.Issue.error({msg:msg,errors:errorCollection.errorMessages});JIRA.Messages.showErrorMsg(html,{closeable:true})}this.trigger("errorOccurred")},_parseResponse:function(responseText){try{return JSON.parse(responseText)}catch(e){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var msg="<p>"+"Communications Breakdown"+"</p>"+"<p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(msg,{closeable:true})}});JIRA.VotersUsersCollection=WatchersAndVoterUsers.extend({initialize:function(issueKey){var options={issueKey:issueKey,endpoint:"votes",modelKey:"voters"};WatchersAndVoterUsers.prototype.initialize.apply(this,[options])},vote:function(){return this.ajax({type:"POST"})},unvote:function(){return this.ajax({type:"DELETE"})}});JIRA.WatchersUsersCollection=WatchersAndVoterUsers.extend({initialize:function(issueKey){this.canBrowseUsers=AJS.Meta.get("can-search-users");this.isReadOnly=!AJS.Meta.get("can-edit-watchers");var options={issueKey:issueKey,endpoint:"watchers",modelKey:"watchers"};WatchersAndVoterUsers.prototype.initialize.apply(this,[options])},addWatcher:function(user){return this.ajax({type:"POST",data:'"'+user+'"'})},removeWatcher:function(user){return this.ajax({type:"DELETE",url:this.url()+"?username="+user})}})})();;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVotersView.js' */
(function(){JIRA.VotersView=Backbone.View.extend({$empty:undefined,initialize:function(options){this.collection=options.collection;this.collection.bind("replace reset add remove",this.render,this)},renderNoWatchers:function(){if(this.$(".recipients li").length===0){this.$empty=AJS.messages.info({closeable:false,body:"There are no voters for this issue"});this.$("fieldset").append(this.$empty)}else{if(this.$empty){this.$empty.remove()}}},render:function(){var deferred=jQuery.Deferred();this.collection.fetch().done(_.bind(function(){this.$el.html(JIRA.Templates.Issue.usersListReadOnly({users:this.collection.toJSON()}));this.renderNoWatchers();deferred.resolve(this.$el)},this));return deferred.promise()}});var AbstractWatchersView=Backbone.View.extend({$empty:undefined,renderNoWatchers:function(){if(this.$(".recipients li").length===0){this.$empty=AJS.messages.info({closeable:false,body:"There are no watchers."});this.$("fieldset").append(this.$empty)}else{if(this.$empty){this.$empty.remove()}}},render:function(){var deferred=jQuery.Deferred();this.collection.fetch().done(_.bind(function(){this._render();this.renderNoWatchers();deferred.resolve(this.$el);window.setTimeout(_.bind(function(){this.focus()},this),0)},this));return deferred.promise()},watch:function(){AJS.$("#watching-toggle").text("Stop watching this issue")},unwatch:function(){AJS.$("#watching-toggle").text("Start watching this issue")},focus:AJS.$.noop,_incrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount+1);this.renderNoWatchers()},_decrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount-1);this.renderNoWatchers()}});JIRA.WatchersView=AbstractWatchersView.extend({events:{selected:"addWatcherToModel",unselect:"removeWatcherFromModel"},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersWithBrowse({watchers:this.collection.toJSON()}));var picker=new JIRA.MultiUserListPicker({element:this.$el.find(".watchers-user-picker"),width:220});this.$el.find(".js-add-watchers-label").attr("for",picker.$field.attr("id"))},focus:function(){this.$el.find("#watchers-textarea").focus()},addWatcherToModel:function(e,descriptor){e.preventDefault();this.collection.addWatcher(descriptor.value()).done(_.bind(function(){this._incrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.watch()}},this))},removeWatcherFromModel:function(e,descriptor){this.collection.removeWatcher(descriptor.value()).done(_.bind(function(){this._decrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.unwatch();JIRA.trace("jira.issue.watcher.deleted")}},this))}});JIRA.WatchersNoBrowseView=AbstractWatchersView.extend({events:{"click .remove-recipient":"removeWatcher","submit":"addWatcher"},addWatcher:function(e){e.preventDefault();this.removeInlineError();var $field=AJS.$("#watchers-nosearch");var username=AJS.$.trim(AJS.$("#watchers-nosearch").val());$field.attr("disabled","disabled");if(this.hasUsername(username)){$field.removeAttr("disabled");this.showInlineError(AJS.format("User {0} is already watching this issue",username));$field.val("")}else{this.collection.getUser(username).done(_.bind(function(data){var html=JIRA.Templates.Fields.recipientUsername({icon:data.avatarUrls["16x16"],username:data.name,displayName:data.displayName});if(username===AJS.Meta.get("remote-user")){this.watch()}$field.val("");this.$(".watchers").append(html);this.collection.addWatcher(data.name);this._incrementWatcherCount()},this)).fail(_.bind(function(xhr){if(xhr.status===404){this.showInlineError("User does not exist")}},this)).always(function(){$field.removeAttr("disabled").focus()})}},hasUsername:function(username){var result=false;this.$(".watchers li").each(function(){if(AJS.$(this).attr("data-username")===username){result=true;return false}});return result},removeInlineError:function(){this.$(".error").remove()},showInlineError:function(msg){AJS.$("<div />").addClass("error").text(msg).insertAfter(this.$(".description"))},focus:function(){AJS.$("#watchers-nosearch").focus()},removeWatcher:function(e){e.preventDefault();var $item=AJS.$(e.target).closest("li");var username=$item.attr("data-username");if(username){$item.remove();this.collection.removeWatcher(username);this._decrementWatcherCount();if(username===AJS.Meta.get("remote-user")){this.unwatch()}}JIRA.trace("jira.issue.watcher.deleted")},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersNoBrowse({watchers:this.collection.toJSON()}))}});JIRA.WatchersReadOnly=AbstractWatchersView.extend({_render:function(){this.$el.html(JIRA.Templates.Issue.usersListReadOnly({users:this.collection.toJSON()}))}})})();;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initWatchers.js' */
AJS.$(function(){function getView(collection){if(collection.isReadOnly){return JIRA.WatchersReadOnly}else{if(collection.canBrowseUsers){return JIRA.WatchersView}else{return JIRA.WatchersNoBrowseView}}}require(["aui/inline-dialog2"]);AJS.$(document).on("click","#view-watcher-list",function(e){e.preventDefault();var dialog=AJS.$("#inline-dialog-watchers");var loadingIcon=AJS.$("#watching-toggle").next(".icon");var collection=new JIRA.WatchersUsersCollection(JIRA.Issue.getIssueKey());loadingIcon.addClass("loading");var ViewClass=getView(collection);new ViewClass({collection:collection}).render().done(function(viewHtml){viewHtml.find(".cancel").click(function(closeEvent){dialog[0].hide();closeEvent.preventDefault()});loadingIcon.removeClass("loading");dialog.find(".aui-inline-dialog-contents").html(viewHtml);dialog[0].show()});collection.on("errorOccurred",function(){dialog[0].hide()})});AJS.$(document).bind("keydown",function(e){var dialog=AJS.$("#inline-dialog-watchers");if(e.keyCode===27&&AJS.InlineDialog.current!=dialog&&dialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}dialog[0].hide()}});AJS.$(document).click(function(e){var dialog=AJS.$("#inline-dialog-watchers");var watchersDialogOrSuggestionClicked=AJS.$(e.target).closest("#inline-dialog-watchers, #watchers-suggestions").length;if(dialog[0]&&dialog[0].isVisible()&&watchersDialogOrSuggestionClicked===0){dialog[0].hide()}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.panelRefreshed&&context.is("#peoplemodule")){var movedDialog=AJS.$(document.body).children("#inline-dialog-watchers");if(movedDialog.length!==0){movedDialog.remove()}}else{var dialog=AJS.$("#inline-dialog-watchers");dialog.attr("data-aui-persistent",true)}})});;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initVoters.js' */
AJS.$(function(){var dialog=AJS.InlineDialog("#view-voter-list","voters",function(contents,trigger,doShowPopup){var loadingIcon=AJS.$("#vote-toggle").next(".icon");var collection=new JIRA.VotersUsersCollection(JIRA.Issue.getIssueKey());loadingIcon.addClass("loading");new JIRA.VotersView({collection:collection}).render().done(function(viewHtml){contents.html(viewHtml);contents.find(".cancel").click(function(e){dialog.hide();e.preventDefault()});loadingIcon.removeClass("loading");doShowPopup()});collection.on("errorOccurred",function(){dialog.hide()})},{width:240,useLiveEvents:true,items:"#view-voters-list",preHideCallback:function(){return !AJS.InlineLayer.current}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===27&&AJS.InlineDialog.current!=dialog&&dialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}dialog.hide()}});AJS.$(document).click(function(e){var currentDialog=AJS.InlineDialog.current;if(currentDialog&&currentDialog.id==="voters"){if(!jQuery(e.target).closest("#inline-dialog-voters").length){currentDialog.hide()}}})});;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/ViewIssueTabs.js' */
JIRA.ViewIssueTabs=(function(){var useHistoryApi=AJS.Meta.get("viewissue-use-history-api")!==false;var AJAX_LOAD_CLASS="ajax-activity-content";var CONTAINER_SELECTOR="#activitymodule div.mod-content";var AJAX_LINK_SELECTOR=AJS.format("a.{0}",AJAX_LOAD_CLASS);var issueTabLoadedListeners=[];var $tabWrapper,$tabContents;var xhrInProgress;function dispatchIssueTabLoadedEvent(container){container=container||document;AJS.$.each(issueTabLoadedListeners,function(i,fn){fn(container)})}function bindToTabDivs(container){var $newTabWrapper=AJS.$(container).find(".issuePanelWrapper");var $newTabContents=AJS.$(container).find("#issue_actions_container");$tabContents=$newTabContents.length?$newTabContents:$tabContents;$tabWrapper=$newTabWrapper.length?$newTabWrapper:$tabWrapper}function dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey){var errorPopup=new JIRA.FormDialog({id:"issue-tab-error-dialog",widthClass:"small",content:JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,false)});setActiveTab(activeTabKey);$tabContents.show();errorPopup.show()}function setActiveTab(activeTabKey){AJS.$("#issue-tabs li").each(function(){var $li=AJS.$(this);var tabKey=$li.data("key");var labelHtml=AJS.format("<strong>{0}</strong>",$li.data("label"));if(tabKey==activeTabKey){$li.addClass("active");$li.html(labelHtml)}else{$li.removeClass("active");var id=$li.data("id");var href=$li.data("href");$li.html(AJS.format('<a id="{0}" href="{1}" class="{2}">{3}</a>',id,href,AJAX_LOAD_CLASS,labelHtml))}});enableAjaxOnLinks(AJS.$("#issue-tabs"))}function putTabInLoadingState(activeTabKey){setActiveTab(activeTabKey)}function isTriggerByKeyBoard(event,$trigger){var eventX=event.pageX;var eventY=event.pageY;var triggerOffset=$trigger.offset();var triggerWidth=$trigger.outerWidth();var triggerHeight=$trigger.outerHeight();if(eventX==0&&eventY==0){return true}else{return !(eventX>=triggerOffset.left&&eventX<=(triggerOffset.left+triggerWidth)&&eventY>=triggerOffset.top&&eventY<=(triggerOffset.top+triggerHeight))}}function enableAjaxOnLinks(context){var activeTabKey=AJS.$(context).find("li.active").data("key");AJS.$(context).find(AJAX_LINK_SELECTOR).click(function(event){if(event.metaKey){return }event.preventDefault();var $trigger=AJS.$(this);var isTriggerByKeyboard=isTriggerByKeyBoard(event,$trigger);var loadingTabKey=$trigger.parent().data("key");if(loadingTabKey){putTabInLoadingState(loadingTabKey)}handleAjaxContentsLoading(activeTabKey,$trigger.attr("href")).done(function($container){if(!isTriggerByKeyboard){return }if(loadingTabKey){$container.find("#"+$trigger.attr("id")+" > :first-child").focus()}else{$container.find(".sortwrap  > :first-child").focus()}}).done(dispatchIssueTabLoadedEvent)})}function handleAjaxContentsLoading(activeTabKey,loadingUrl){var deferred=jQuery.Deferred();if(xhrInProgress){xhrInProgress.abort()}var xhr=JIRA.SmartAjax.makeRequest({jqueryAjaxFn:useHistoryApi?AJS.$.pjax:AJS.$.ajax,headers:{"X-PJAX":true},container:CONTAINER_SELECTOR,url:loadingUrl,timeout:null,complete:function(xhr,status,smartAjaxResult){if(status!="abort"){xhrInProgress=null;if(!smartAjaxResult.successful){if(smartAjaxResult.status<300||smartAjaxResult.status>=400){dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey)}return }var $container=AJS.$(this.container);var newElementsHtml=document.createElement("div");newElementsHtml.innerHTML=smartAjaxResult.data;var newElements=document.createDocumentFragment().appendChild(newElementsHtml);if(!useHistoryApi){smartUpdate($container,newElements)}JIRA.trace("jira.issue.tab.loaded");deferred.resolve($container)}}});jQuery(xhr).throbber({target:$tabWrapper});xhrInProgress=xhr;return deferred}function smartUpdate(container,newElements){var newTabs=newElements.querySelectorAll(".tabwrap");var oldTabs=container.find(".tabwrap");var newContents=AJS.$(newElements.querySelectorAll("#issue_actions_container")).contents();var oldContents=$tabContents.contents();if(newTabs.length&&oldTabs.length&&newContents.length&&oldContents.length){oldTabs.replaceWith(newTabs);var currentContentHeight=$tabContents.height();$tabContents.append(newContents);var newContentHeight=$tabContents.height()-currentContentHeight;var visibleHeightDifference=AJS.$(window).scrollTop()+AJS.$(window).height()-($tabContents.offset().top+newContentHeight);if(visibleHeightDifference>0){$tabContents.css("height",newContentHeight+visibleHeightDifference);oldContents.remove();var preDelay=150;setTimeout(function(){var pixelsPerSecond=500;var animSpeed=visibleHeightDifference/pixelsPerSecond*1000;$tabContents.animate({height:newContentHeight},animSpeed,"easeOutQuart",function(){$tabContents.css("height","auto")})},preDelay)}else{$tabContents.empty().append(newContents)}AJS.$(newElements.querySelectorAll("script")).each(function(){AJS.$.globalEval(this.text||this.textContent||this.innerHTML||"")})}else{container.empty().append(newElements)}}function appendHashCodeToLinks(context){AJS.$(context).find(AJAX_LINK_SELECTOR).each(function(){var $a=AJS.$(this);$a.attr("href",$a.attr("href")+"#issue-tabs")})}function processActivityModuleLinks(context){if(!useHistoryApi||AJS.$.support.pjax){enableAjaxOnLinks(context)}else{appendHashCodeToLinks(context)}}function setupMouseoverBehaviour(context){jQuery(context).bind("moveToFinished",function(event,target){jQuery("a.twixi:visible",target).focus()})}function initLivestamp(context){context.find("time.livestamp").livestamp()}function onTabReady(listener){if(jQuery.inArray(listener,issueTabLoadedListeners)<0){issueTabLoadedListeners.push(listener)}}onTabReady(bindToTabDivs);onTabReady(processActivityModuleLinks);onTabReady(setupMouseoverBehaviour);onTabReady(JIRA.userhover);onTabReady(initLivestamp);return{onTabReady:onTabReady,domReady:dispatchIssueTabLoadedEvent}})();AJS.$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="activitymodule"){var $focusedTab=$existing.find("#issue_actions_container > .issue-data-block.focused");if($focusedTab.length===1){$new.find("#"+$focusedTab.attr("id")).addClass("focused")}}})}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(event,$el){JIRA.ViewIssueTabs.domReady($el)});;
;/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVoters.js' */
AJS.$(function(){var toggleVotingAndWatching=function(trigger,className,resultContainer,issueOpTrigger,i18n){var classNameOn=className+"-on",classNameOff=className+"-off",restPath="/voters",spinner=trigger.next(".icon"),data,method="POST";if(trigger.hasClass(classNameOn)){method="DELETE"}if(className.indexOf("watch")!==-1){restPath="/watchers"}trigger.removeClass(classNameOn).removeClass(classNameOff);if(method==="POST"){data={dummy:true}}AJS.$(JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/api/1.0/issues/"+trigger.attr("rel")+restPath,type:method,dataType:"json",data:data,contentType:"application/json",complete:function(xhr,textStatus,smartAjaxResult){var optIn=method==="POST";if(smartAjaxResult.successful){if(optIn){trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}else{trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}resultContainer.text(smartAjaxResult.data.count);resultContainer[optIn?"addClass":"removeClass"](classNameOn);resultContainer[optIn?"removeClass":"addClass"](classNameOff)}else{if(!smartAjaxResult.aborted){displayErrorMessage(smartAjaxResult)}if(optIn){trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}else{trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}}}})).throbber({target:spinner})};var displayErrorMessage=function(smartAjaxResult){var message=JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult,{alert:true});if(smartAjaxResult.hasData){var data=JSON.parse(smartAjaxResult.data);if(data.errorMessages){message=data.errorMessages[0]}}JIRA.Messages.showErrorMsg(message,{closeable:true})};AJS.$(document).delegate("#toggle-vote-issue","click",function(e){e.preventDefault();AJS.$("#vote-toggle").click()});AJS.$(document).delegate("#toggle-watch-issue","click",function(e){e.preventDefault();AJS.$("#watching-toggle").click()});var addI18nErrorCodes=function(i18n){AJS.$("input[type=hidden][id|=error]").each(function(index,elem){var i18n_id=elem.id.replace("error-","");i18n[i18n_id]=elem.value})};AJS.$(document).delegate("#vote-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Remove vote for this issue",titleOff:"Vote for this issue",textOn:"Remove Vote",textOff:"Add Vote",actionTextOff:"Vote",actionTextOn:"Voted"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"vote-state",AJS.$("#vote-data"),AJS.$("#toggle-vote-issue"),i18n)});AJS.$(document).delegate("#watching-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Stop watching this issue",titleOff:"Start watching this issue",textOn:"Stop Watching",textOff:"Watch Issue",actionTextOff:"Watch",actionTextOn:"Watching"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"watch-state",AJS.$("#watcher-data"),AJS.$("#toggle-watch-issue"),i18n)})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-bitbucket-connector-plugin:requiredResourceForAjaxCommitsTab', location = 'javascripts/dvcs-tabs.js' */
if(typeof(com)=="undefined"){com={}}if(typeof(com.atlassian)=="undefined"){com.atlassian={}}if(typeof(com.atlassian.jira)=="undefined"){com.atlassian.jira={}}if(typeof(com.atlassian.jira.dvcs)=="undefined"){com.atlassian.jira.dvcs={}}com.atlassian.jira.dvcs.showChangesetByFork=function(d,b,c,a){AJS.$("#"+d+" .CommitPanel").each(function(f,e){AJS.$(e).hide()});AJS.$("#"+d+"-"+b).show();com.atlassian.jira.dvcs.registerForksTooltip(d,c,a)};com.atlassian.jira.dvcs.registerForksTooltip=function(c,b,a){com.atlassian.jira.dvcs.registerInlineDialogTooltip(AJS.$("#fork-drop-down-"+c),"This changeset is present in multiple repositories (forks). Currently showing <a href='"+a+"' target='_blank'>"+b+"</a>.")};com.atlassian.jira.dvcs.registerInlineDialogTooltip=function(b,a){AJS.InlineDialog(AJS.$(b),"tooltip_"+AJS.$(b).attr("id"),function(d,c,e){d.css({padding:"10px"}).html(a);e();return false},{onHover:true,hideDelay:200,showDelay:1000,arrowOffsetX:-8,offsetX:-80,addActiveClass:false})};AJS.$(document).on("click","#dvcs-commits-tabpanel.ajax-activity-content",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.tabclick",data:{source:"issue"}})});AJS.$(document).on("click",".dvcs-link",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.linkclick",data:{type:AJS.$(this).attr("data-link-type")}})});AJS.$(document).on("click",'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-bitbucket-connector-plugin-dvcs-commits-greenhopper-tab"]',function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.tabclick",data:{source:"agile"}})});;
;/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:marionette', location = 'lib/backbone/marionette/backbone.marionette.js' */
// MarionetteJS (Backbone.Marionette)
// ----------------------------------
// v2.1.0
//
// Copyright (c)2014 Derick Bailey, Muted Solutions, LLC.
// Distributed under MIT license
//
// http://marionettejs.com

(function(root, factory) {

  if (typeof define === 'function' && define.amd) {
    define(['backbone', 'underscore', 'backbone.wreqr', 'backbone.babysitter'], function(Backbone, _) {
      return (root.Marionette = factory(root, Backbone, _));
    });
  } else if (typeof exports !== 'undefined') {
    var Backbone = require('backbone');
    var _ = require('underscore');
    var Wreqr = require('backbone.wreqr');
    var BabySitter = require('backbone.babysitter');
    module.exports = factory(root, Backbone, _);
  } else {
    root.Marionette = factory(root, root.Backbone, root._);
  }

}(this, function(root, Backbone, _) {
  'use strict';

  var previousMarionette = root.Marionette;

  var Marionette = Backbone.Marionette = {};

  Marionette.VERSION = '2.1.0';

  Marionette.noConflict = function() {
    root.Marionette = previousMarionette;
    return this;
  };

  // Get the Deferred creator for later use
  Marionette.Deferred = Backbone.$.Deferred;

  /* jshint unused: false */
  
  // Helpers
  // -------
  
  // For slicing `arguments` in functions
  var slice = Array.prototype.slice;
  
  function throwError(message, name) {
    var error = new Error(message);
    error.name = name || 'Error';
    throw error;
  }
  
  // Marionette.extend
  // -----------------
  
  // Borrow the Backbone `extend` method so we can use it as needed
  Marionette.extend = Backbone.Model.extend;
  
  // Marionette.getOption
  // --------------------
  
  // Retrieve an object, function or other value from a target
  // object or its `options`, with `options` taking precedence.
  Marionette.getOption = function(target, optionName) {
    if (!target || !optionName) { return; }
    var value;
  
    if (target.options && (target.options[optionName] !== undefined)) {
      value = target.options[optionName];
    } else {
      value = target[optionName];
    }
  
    return value;
  };
  
  // Proxy `Marionette.getOption`
  Marionette.proxyGetOption = function(optionName) {
    return Marionette.getOption(this, optionName);
  };
  
  // Marionette.normalizeMethods
  // ----------------------
  
  // Pass in a mapping of events => functions or function names
  // and return a mapping of events => functions
  Marionette.normalizeMethods = function(hash) {
    var normalizedHash = {};
    _.each(hash, function(method, name) {
      if (!_.isFunction(method)) {
        method = this[method];
      }
      if (!method) {
        return;
      }
      normalizedHash[name] = method;
    }, this);
    return normalizedHash;
  };
  
  
  // allows for the use of the @ui. syntax within
  // a given key for triggers and events
  // swaps the @ui with the associated selector
  Marionette.normalizeUIKeys = function(hash, ui) {
    if (typeof(hash) === 'undefined') {
      return;
    }
  
    _.each(_.keys(hash), function(v) {
      var pattern = /@ui\.[a-zA-Z_$0-9]*/g;
      if (v.match(pattern)) {
        hash[v.replace(pattern, function(r) {
          return ui[r.slice(4)];
        })] = hash[v];
        delete hash[v];
      }
    });
  
    return hash;
  };
  
  // Mix in methods from Underscore, for iteration, and other
  // collection related features.
  // Borrowing this code from Backbone.Collection:
  // http://backbonejs.org/docs/backbone.html#section-121
  Marionette.actAsCollection = function(object, listProperty) {
    var methods = ['forEach', 'each', 'map', 'find', 'detect', 'filter',
      'select', 'reject', 'every', 'all', 'some', 'any', 'include',
      'contains', 'invoke', 'toArray', 'first', 'initial', 'rest',
      'last', 'without', 'isEmpty', 'pluck'];
  
    _.each(methods, function(method) {
      object[method] = function() {
        var list = _.values(_.result(this, listProperty));
        var args = [list].concat(_.toArray(arguments));
        return _[method].apply(_, args);
      };
    });
  };
  
  // Trigger an event and/or a corresponding method name. Examples:
  //
  // `this.triggerMethod("foo")` will trigger the "foo" event and
  // call the "onFoo" method.
  //
  // `this.triggerMethod("foo:bar")` will trigger the "foo:bar" event and
  // call the "onFooBar" method.
  Marionette.triggerMethod = (function() {
  
    // split the event name on the ":"
    var splitter = /(^|:)(\w)/gi;
  
    // take the event section ("section1:section2:section3")
    // and turn it in to uppercase name
    function getEventName(match, prefix, eventName) {
      return eventName.toUpperCase();
    }
  
    // actual triggerMethod implementation
    var triggerMethod = function(event) {
      // get the method name from the event name
      var methodName = 'on' + event.replace(splitter, getEventName);
      var method = this[methodName];
      var result;
  
      // call the onMethodName if it exists
      if (_.isFunction(method)) {
        // pass all arguments, except the event name
        result = method.apply(this, _.tail(arguments));
      }
  
      // trigger the event, if a trigger method exists
      if (_.isFunction(this.trigger)) {
        this.trigger.apply(this, arguments);
      }
  
      return result;
    };
  
    return triggerMethod;
  })();
  
  // DOMRefresh
  // ----------
  //
  // Monitor a view's state, and after it has been rendered and shown
  // in the DOM, trigger a "dom:refresh" event every time it is
  // re-rendered.
  
  Marionette.MonitorDOMRefresh = (function(documentElement) {
    // track when the view has been shown in the DOM,
    // using a Marionette.Region (or by other means of triggering "show")
    function handleShow(view) {
      view._isShown = true;
      triggerDOMRefresh(view);
    }
  
    // track when the view has been rendered
    function handleRender(view) {
      view._isRendered = true;
      triggerDOMRefresh(view);
    }
  
    // Trigger the "dom:refresh" event and corresponding "onDomRefresh" method
    function triggerDOMRefresh(view) {
      if (view._isShown && view._isRendered && isInDOM(view)) {
        if (_.isFunction(view.triggerMethod)) {
          view.triggerMethod('dom:refresh');
        }
      }
    }
  
    function isInDOM(view) {
      return Backbone.$.contains(documentElement, view.el);
    }
  
    // Export public API
    return function(view) {
      view.listenTo(view, 'show', function() {
        handleShow(view);
      });
  
      view.listenTo(view, 'render', function() {
        handleRender(view);
      });
    };
  })(document.documentElement);
  

  /* jshint maxparams: 5 */
  
  // Marionette.bindEntityEvents & unbindEntityEvents
  // ---------------------------
  //
  // These methods are used to bind/unbind a backbone "entity" (collection/model)
  // to methods on a target object.
  //
  // The first parameter, `target`, must have a `listenTo` method from the
  // EventBinder object.
  //
  // The second parameter is the entity (Backbone.Model or Backbone.Collection)
  // to bind the events from.
  //
  // The third parameter is a hash of { "event:name": "eventHandler" }
  // configuration. Multiple handlers can be separated by a space. A
  // function can be supplied instead of a string handler name.
  
  (function(Marionette) {
    'use strict';
  
    // Bind the event to handlers specified as a string of
    // handler names on the target object
    function bindFromStrings(target, entity, evt, methods) {
      var methodNames = methods.split(/\s+/);
  
      _.each(methodNames, function(methodName) {
  
        var method = target[methodName];
        if (!method) {
          throwError('Method "' + methodName +
            '" was configured as an event handler, but does not exist.');
        }
  
        target.listenTo(entity, evt, method);
      });
    }
  
    // Bind the event to a supplied callback function
    function bindToFunction(target, entity, evt, method) {
      target.listenTo(entity, evt, method);
    }
  
    // Bind the event to handlers specified as a string of
    // handler names on the target object
    function unbindFromStrings(target, entity, evt, methods) {
      var methodNames = methods.split(/\s+/);
  
      _.each(methodNames, function(methodName) {
        var method = target[methodName];
        target.stopListening(entity, evt, method);
      });
    }
  
    // Bind the event to a supplied callback function
    function unbindToFunction(target, entity, evt, method) {
      target.stopListening(entity, evt, method);
    }
  
  
    // generic looping function
    function iterateEvents(target, entity, bindings, functionCallback, stringCallback) {
      if (!entity || !bindings) { return; }
  
      // allow the bindings to be a function
      if (_.isFunction(bindings)) {
        bindings = bindings.call(target);
      }
  
      // iterate the bindings and bind them
      _.each(bindings, function(methods, evt) {
  
        // allow for a function as the handler,
        // or a list of event names as a string
        if (_.isFunction(methods)) {
          functionCallback(target, entity, evt, methods);
        } else {
          stringCallback(target, entity, evt, methods);
        }
  
      });
    }
  
    // Export Public API
    Marionette.bindEntityEvents = function(target, entity, bindings) {
      iterateEvents(target, entity, bindings, bindToFunction, bindFromStrings);
    };
  
    Marionette.unbindEntityEvents = function(target, entity, bindings) {
      iterateEvents(target, entity, bindings, unbindToFunction, unbindFromStrings);
    };
  
    // Proxy `bindEntityEvents`
    Marionette.proxyBindEntityEvents = function(entity, bindings) {
      return Marionette.bindEntityEvents(this, entity, bindings);
    };
  
    // Proxy `unbindEntityEvents`
    Marionette.proxyUnbindEntityEvents = function(entity, bindings) {
      return Marionette.unbindEntityEvents(this, entity, bindings);
    };
  })(Marionette);
  

  // Callbacks
  // ---------
  
  // A simple way of managing a collection of callbacks
  // and executing them at a later point in time, using jQuery's
  // `Deferred` object.
  Marionette.Callbacks = function() {
    this._deferred = Marionette.Deferred();
    this._callbacks = [];
  };
  
  _.extend(Marionette.Callbacks.prototype, {
  
    // Add a callback to be executed. Callbacks added here are
    // guaranteed to execute, even if they are added after the
    // `run` method is called.
    add: function(callback, contextOverride) {
      var promise = _.result(this._deferred, 'promise');
  
      this._callbacks.push({cb: callback, ctx: contextOverride});
  
      promise.then(function(args) {
        if (contextOverride){ args.context = contextOverride; }
        callback.call(args.context, args.options);
      });
    },
  
    // Run all registered callbacks with the context specified.
    // Additional callbacks can be added after this has been run
    // and they will still be executed.
    run: function(options, context) {
      this._deferred.resolve({
        options: options,
        context: context
      });
    },
  
    // Resets the list of callbacks to be run, allowing the same list
    // to be run multiple times - whenever the `run` method is called.
    reset: function() {
      var callbacks = this._callbacks;
      this._deferred = Marionette.Deferred();
      this._callbacks = [];
  
      _.each(callbacks, function(cb) {
        this.add(cb.cb, cb.ctx);
      }, this);
    }
  });
  
  // Marionette Controller
  // ---------------------
  //
  // A multi-purpose object to use as a controller for
  // modules and routers, and as a mediator for workflow
  // and coordination of other objects, views, and more.
  Marionette.Controller = function(options) {
    this.options = options || {};
  
    if (_.isFunction(this.initialize)) {
      this.initialize(this.options);
    }
  };
  
  Marionette.Controller.extend = Marionette.extend;
  
  // Controller Methods
  // --------------
  
  // Ensure it can trigger events with Backbone.Events
  _.extend(Marionette.Controller.prototype, Backbone.Events, {
    destroy: function() {
      var args = slice.call(arguments);
      this.triggerMethod.apply(this, ['before:destroy'].concat(args));
      this.triggerMethod.apply(this, ['destroy'].concat(args));
  
      this.stopListening();
      this.off();
      return this;
    },
  
    // import the `triggerMethod` to trigger events with corresponding
    // methods if the method exists
    triggerMethod: Marionette.triggerMethod,
  
    // Proxy `getOption` to enable getting options from this or this.options by name.
    getOption: Marionette.proxyGetOption
  
  });
  
  // Marionette Object
  // ---------------------
  //
  // A Base Class that other Classes should descend from.
  // Object borrows many conventions and utilities from Backbone.
  Marionette.Object = function(options) {
  
    this.options = _.extend({}, _.result(this, 'options'), options);
  
    this.initialize(this.options);
  };
  
  Marionette.Object.extend = Marionette.extend;
  
  // Object Methods
  // --------------
  
  _.extend(Marionette.Object.prototype, {
  
    //this is a noop method intended to be overridden by classes that extend from this base
    initialize: function() {},
  
    destroy: function() {
      this.triggerMethod('before:destroy');
      this.triggerMethod('destroy');
      this.stopListening();
    },
  
    // Import the `triggerMethod` to trigger events with corresponding
    // methods if the method exists
    triggerMethod: Marionette.triggerMethod,
  
    // Proxy `getOption` to enable getting options from this or this.options by name.
    getOption: Marionette.proxyGetOption,
  
    // Proxy `unbindEntityEvents` to enable binding view's events from another entity.
    bindEntityEvents: Marionette.proxyBindEntityEvents,
  
    // Proxy `unbindEntityEvents` to enable unbinding view's events from another entity.
    unbindEntityEvents: Marionette.proxyUnbindEntityEvents
  });
  
  // Ensure it can trigger events with Backbone.Events
  _.extend(Marionette.Object.prototype, Backbone.Events);
  
  /* jshint maxcomplexity: 10, maxstatements: 29 */
  
  // Region
  // ------
  //
  // Manage the visual regions of your composite application. See
  // http://lostechies.com/derickbailey/2011/12/12/composite-js-apps-regions-and-region-managers/
  
  Marionette.Region = function(options) {
    this.options = options || {};
    this.el = this.getOption('el');
  
    // Handle when this.el is passed in as a $ wrapped element.
    this.el = this.el instanceof Backbone.$ ? this.el[0] : this.el;
  
    if (!this.el) {
      throwError('An "el" must be specified for a region.', 'NoElError');
    }
  
    this.$el = this.getEl(this.el);
  
    if (this.initialize) {
      var args = slice.apply(arguments);
      this.initialize.apply(this, args);
    }
  };
  
  
  // Region Class methods
  // -------------------
  
  _.extend(Marionette.Region, {
  
    // Build an instance of a region by passing in a configuration object
    // and a default region class to use if none is specified in the config.
    //
    // The config object should either be a string as a jQuery DOM selector,
    // a Region class directly, or an object literal that specifies both
    // a selector and regionClass:
    //
    // ```js
    // {
    //   selector: "#foo",
    //   regionClass: MyCustomRegion
    // }
    // ```
    //
    buildRegion: function(regionConfig, DefaultRegionClass) {
      if (_.isString(regionConfig)) {
        return this._buildRegionFromSelector(regionConfig, DefaultRegionClass);
      }
  
      if (regionConfig.selector || regionConfig.el || regionConfig.regionClass) {
        return this._buildRegionFromObject(regionConfig, DefaultRegionClass);
      }
  
      if (_.isFunction(regionConfig)) {
        return this._buildRegionFromRegionClass(regionConfig);
      }
  
      throwError('Improper region configuration type. Please refer ' +
        'to http://marionettejs.com/docs/marionette.region.html#region-configuration-types');
    },
  
    // Build the region from a string selector like '#foo-region'
    _buildRegionFromSelector: function(selector, DefaultRegionClass) {
      return new DefaultRegionClass({ el: selector });
    },
  
    // Build the region from a configuration object
    // ```js
    // { selector: '#foo', regionClass: FooRegion }
    // ```
    _buildRegionFromObject: function(regionConfig, DefaultRegionClass) {
      var RegionClass = regionConfig.regionClass || DefaultRegionClass;
      var options = _.omit(regionConfig, 'selector', 'regionClass');
  
      if (regionConfig.selector && !options.el) {
        options.el = regionConfig.selector;
      }
  
      var region = new RegionClass(options);
  
      // override the `getEl` function if we have a parentEl
      // this must be overridden to ensure the selector is found
      // on the first use of the region. if we try to assign the
      // region's `el` to `parentEl.find(selector)` in the object
      // literal to build the region, the element will not be
      // guaranteed to be in the DOM already, and will cause problems
      if (regionConfig.parentEl) {
        region.getEl = function(el) {
          if (_.isObject(el)) {
            return Backbone.$(el);
          }
          var parentEl = regionConfig.parentEl;
          if (_.isFunction(parentEl)) {
            parentEl = parentEl();
          }
          return parentEl.find(el);
        };
      }
  
      return region;
    },
  
    // Build the region directly from a given `RegionClass`
    _buildRegionFromRegionClass: function(RegionClass) {
      return new RegionClass();
    }
  
  });
  
  // Region Instance Methods
  // -----------------------
  
  _.extend(Marionette.Region.prototype, Backbone.Events, {
  
    // Displays a backbone view instance inside of the region.
    // Handles calling the `render` method for you. Reads content
    // directly from the `el` attribute. Also calls an optional
    // `onShow` and `onDestroy` method on your view, just after showing
    // or just before destroying the view, respectively.
    // The `preventDestroy` option can be used to prevent a view from
    // the old view being destroyed on show.
    // The `forceShow` option can be used to force a view to be
    // re-rendered if it's already shown in the region.
  
    show: function(view, options){
      this._ensureElement();
  
      var showOptions = options || {};
      var isDifferentView = view !== this.currentView;
      var preventDestroy =  !!showOptions.preventDestroy;
      var forceShow = !!showOptions.forceShow;
  
      // we are only changing the view if there is a view to change to begin with
      var isChangingView = !!this.currentView;
  
      // only destroy the view if we don't want to preventDestroy and the view is different
      var _shouldDestroyView = !preventDestroy && isDifferentView;
  
      if (_shouldDestroyView) {
        this.empty();
      }
  
      // show the view if the view is different or if you want to re-show the view
      var _shouldShowView = isDifferentView || forceShow;
  
      if (_shouldShowView) {
  
        // We need to listen for if a view is destroyed
        // in a way other than through the region.
        // If this happens we need to remove the reference
        // to the currentView since once a view has been destroyed
        // we can not reuse it.
        view.once('destroy', _.bind(this.empty, this));
        view.render();
  
        if (isChangingView) {
          this.triggerMethod('before:swap', view);
        }
  
        this.triggerMethod('before:show', view);
  
        if (_.isFunction(view.triggerMethod)) {
          view.triggerMethod('before:show');
        } else {
          this.triggerMethod.call(view, 'before:show');
        }
  
        this.attachHtml(view);
        this.currentView = view;
  
        if (isChangingView) {
          this.triggerMethod('swap', view);
        }
  
        this.triggerMethod('show', view);
  
        if (_.isFunction(view.triggerMethod)) {
          view.triggerMethod('show');
        } else {
          this.triggerMethod.call(view, 'show');
        }
  
        return this;
      }
  
      return this;
    },
  
    _ensureElement: function(){
      if (!_.isObject(this.el)) {
        this.$el = this.getEl(this.el);
        this.el = this.$el[0];
      }
  
      if (!this.$el || this.$el.length === 0) {
        throwError('An "el" ' + this.$el.selector + ' must exist in DOM');
      }
    },
  
    // Override this method to change how the region finds the
    // DOM element that it manages. Return a jQuery selector object.
    getEl: function(el) {
      return Backbone.$(el);
    },
  
    // Override this method to change how the new view is
    // appended to the `$el` that the region is managing
    attachHtml: function(view) {
      // empty the node and append new view
      this.el.innerHTML='';
      this.el.appendChild(view.el);
    },
  
    // Destroy the current view, if there is one. If there is no
    // current view, it does nothing and returns immediately.
    empty: function() {
      var view = this.currentView;
  
      // If there is no view in the region
      // we should not remove anything
      if (!view) { return; }
  
      this.triggerMethod('before:empty', view);
      this._destroyView();
      this.triggerMethod('empty', view);
  
      // Remove region pointer to the currentView
      delete this.currentView;
      return this;
    },
  
    // call 'destroy' or 'remove', depending on which is found
    // on the view (if showing a raw Backbone view or a Marionette View)
    _destroyView: function() {
      var view = this.currentView;
  
      if (view.destroy && !view.isDestroyed) {
        view.destroy();
      } else if (view.remove) {
        view.remove();
      }
    },
  
    // Attach an existing view to the region. This
    // will not call `render` or `onShow` for the new view,
    // and will not replace the current HTML for the `el`
    // of the region.
    attachView: function(view) {
      this.currentView = view;
      return this;
    },
  
    // Checks whether a view is currently present within
    // the region. Returns `true` if there is and `false` if
    // no view is present.
    hasView: function() {
      return !!this.currentView;
    },
  
    // Reset the region by destroying any existing view and
    // clearing out the cached `$el`. The next time a view
    // is shown via this region, the region will re-query the
    // DOM for the region's `el`.
    reset: function() {
      this.empty();
  
      if (this.$el) {
        this.el = this.$el.selector;
      }
  
      delete this.$el;
      return this;
    },
  
    // Proxy `getOption` to enable getting options from this or this.options by name.
    getOption: Marionette.proxyGetOption,
  
    // import the `triggerMethod` to trigger events with corresponding
    // methods if the method exists
    triggerMethod: Marionette.triggerMethod
  });
  
  // Copy the `extend` function used by Backbone's classes
  Marionette.Region.extend = Marionette.extend;
  
  // Marionette.RegionManager
  // ------------------------
  //
  // Manage one or more related `Marionette.Region` objects.
  Marionette.RegionManager = (function(Marionette) {
  
    var RegionManager = Marionette.Controller.extend({
      constructor: function(options) {
        this._regions = {};
        Marionette.Controller.call(this, options);
      },
  
      // Add multiple regions using an object literal or a
      // function that returns an object literal, where
      // each key becomes the region name, and each value is
      // the region definition.
      addRegions: function(regionDefinitions, defaults) {
        if (_.isFunction(regionDefinitions)) {
          regionDefinitions = regionDefinitions.apply(this, arguments);
        }
  
        var regions = {};
  
        _.each(regionDefinitions, function(definition, name) {
          if (_.isString(definition)) {
            definition = {selector: definition};
          }
  
          if (definition.selector) {
            definition = _.defaults({}, definition, defaults);
          }
  
          var region = this.addRegion(name, definition);
          regions[name] = region;
        }, this);
  
        return regions;
      },
  
      // Add an individual region to the region manager,
      // and return the region instance
      addRegion: function(name, definition) {
        var region;
  
        var isObject = _.isObject(definition);
        var isString = _.isString(definition);
        var hasSelector = !!definition.selector;
  
        if (isString || (isObject && hasSelector)) {
          region = Marionette.Region.buildRegion(definition, Marionette.Region);
        } else if (_.isFunction(definition)) {
          region = Marionette.Region.buildRegion(definition, Marionette.Region);
        } else {
          region = definition;
        }
  
        this.triggerMethod('before:add:region', name, region);
  
        this._store(name, region);
  
        this.triggerMethod('add:region', name, region);
        return region;
      },
  
      // Get a region by name
      get: function(name) {
        return this._regions[name];
      },
  
      // Gets all the regions contained within
      // the `regionManager` instance.
      getRegions: function(){
        return _.clone(this._regions);
      },
  
      // Remove a region by name
      removeRegion: function(name) {
        var region = this._regions[name];
        this._remove(name, region);
  
        return region;
      },
  
      // Empty all regions in the region manager, and
      // remove them
      removeRegions: function() {
        var regions = this.getRegions();
        _.each(this._regions, function(region, name) {
          this._remove(name, region);
        }, this);
  
        return regions;
      },
  
      // Empty all regions in the region manager, but
      // leave them attached
      emptyRegions: function() {
        var regions = this.getRegions();
        _.each(regions, function(region) {
          region.empty();
        }, this);
  
        return regions;
      },
  
      // Destroy all regions and shut down the region
      // manager entirely
      destroy: function() {
        this.removeRegions();
        return Marionette.Controller.prototype.destroy.apply(this, arguments);
      },
  
      // internal method to store regions
      _store: function(name, region) {
        this._regions[name] = region;
        this._setLength();
      },
  
      // internal method to remove a region
      _remove: function(name, region) {
        this.triggerMethod('before:remove:region', name, region);
        region.empty();
        region.stopListening();
        delete this._regions[name];
        this._setLength();
        this.triggerMethod('remove:region', name, region);
      },
  
      // set the number of regions current held
      _setLength: function() {
        this.length = _.size(this._regions);
      }
  
    });
  
    Marionette.actAsCollection(RegionManager.prototype, '_regions');
  
    return RegionManager;
  })(Marionette);
  

  // Template Cache
  // --------------
  
  // Manage templates stored in `<script>` blocks,
  // caching them for faster access.
  Marionette.TemplateCache = function(templateId) {
    this.templateId = templateId;
  };
  
  // TemplateCache object-level methods. Manage the template
  // caches from these method calls instead of creating
  // your own TemplateCache instances
  _.extend(Marionette.TemplateCache, {
    templateCaches: {},
  
    // Get the specified template by id. Either
    // retrieves the cached version, or loads it
    // from the DOM.
    get: function(templateId) {
      var cachedTemplate = this.templateCaches[templateId];
  
      if (!cachedTemplate) {
        cachedTemplate = new Marionette.TemplateCache(templateId);
        this.templateCaches[templateId] = cachedTemplate;
      }
  
      return cachedTemplate.load();
    },
  
    // Clear templates from the cache. If no arguments
    // are specified, clears all templates:
    // `clear()`
    //
    // If arguments are specified, clears each of the
    // specified templates from the cache:
    // `clear("#t1", "#t2", "...")`
    clear: function() {
      var i;
      var args = slice.call(arguments);
      var length = args.length;
  
      if (length > 0) {
        for (i = 0; i < length; i++) {
          delete this.templateCaches[args[i]];
        }
      } else {
        this.templateCaches = {};
      }
    }
  });
  
  // TemplateCache instance methods, allowing each
  // template cache object to manage its own state
  // and know whether or not it has been loaded
  _.extend(Marionette.TemplateCache.prototype, {
  
    // Internal method to load the template
    load: function() {
      // Guard clause to prevent loading this template more than once
      if (this.compiledTemplate) {
        return this.compiledTemplate;
      }
  
      // Load the template and compile it
      var template = this.loadTemplate(this.templateId);
      this.compiledTemplate = this.compileTemplate(template);
  
      return this.compiledTemplate;
    },
  
    // Load a template from the DOM, by default. Override
    // this method to provide your own template retrieval
    // For asynchronous loading with AMD/RequireJS, consider
    // using a template-loader plugin as described here:
    // https://github.com/marionettejs/backbone.marionette/wiki/Using-marionette-with-requirejs
    loadTemplate: function(templateId) {
      var template = Backbone.$(templateId).html();
  
      if (!template || template.length === 0) {
        throwError('Could not find template: "' + templateId + '"', 'NoTemplateError');
      }
  
      return template;
    },
  
    // Pre-compile the template before caching it. Override
    // this method if you do not need to pre-compile a template
    // (JST / RequireJS for example) or if you want to change
    // the template engine used (Handebars, etc).
    compileTemplate: function(rawTemplate) {
      return _.template(rawTemplate);
    }
  });
  
  // Renderer
  // --------
  
  // Render a template with data by passing in the template
  // selector and the data to render.
  Marionette.Renderer = {
  
    // Render a template with data. The `template` parameter is
    // passed to the `TemplateCache` object to retrieve the
    // template function. Override this method to provide your own
    // custom rendering and template handling for all of Marionette.
    render: function(template, data) {
      if (!template) {
        throwError('Cannot render the template since its false, null or undefined.',
          'TemplateNotFoundError');
      }
  
      var templateFunc;
      if (typeof template === 'function') {
        templateFunc = template;
      } else {
        templateFunc = Marionette.TemplateCache.get(template);
      }
  
      return templateFunc(data);
    }
  };
  

  /* jshint maxlen: 114, nonew: false */
  // Marionette.View
  // ---------------
  
  // The core view class that other Marionette views extend from.
  Marionette.View = Backbone.View.extend({
  
    constructor: function(options) {
      _.bindAll(this, 'render');
  
      // this exposes view options to the view initializer
      // this is a backfill since backbone removed the assignment
      // of this.options
      // at some point however this may be removed
      this.options = _.extend({}, _.result(this, 'options'), _.isFunction(options) ? options.call(this) : options);
      // parses out the @ui DSL for events
      this.events = this.normalizeUIKeys(_.result(this, 'events'));
  
      if (_.isObject(this.behaviors)) {
        new Marionette.Behaviors(this);
      }
  
      Backbone.View.apply(this, arguments);
  
      Marionette.MonitorDOMRefresh(this);
      this.listenTo(this, 'show', this.onShowCalled);
    },
  
    // Get the template for this view
    // instance. You can set a `template` attribute in the view
    // definition or pass a `template: "whatever"` parameter in
    // to the constructor options.
    getTemplate: function() {
      return this.getOption('template');
    },
  
    // Serialize a model by returning its attributes. Clones
    // the attributes to allow modification.
    serializeModel: function(model){
      return model.toJSON.apply(model, slice.call(arguments, 1));
    },
  
    // Mix in template helper methods. Looks for a
    // `templateHelpers` attribute, which can either be an
    // object literal, or a function that returns an object
    // literal. All methods and attributes from this object
    // are copies to the object passed in.
    mixinTemplateHelpers: function(target) {
      target = target || {};
      var templateHelpers = this.getOption('templateHelpers');
      if (_.isFunction(templateHelpers)) {
        templateHelpers = templateHelpers.call(this);
      }
      return _.extend(target, templateHelpers);
    },
  
  
    normalizeUIKeys: function(hash) {
      var ui = _.result(this, 'ui');
      var uiBindings = _.result(this, '_uiBindings');
      return Marionette.normalizeUIKeys(hash, uiBindings || ui);
    },
  
    // Configure `triggers` to forward DOM events to view
    // events. `triggers: {"click .foo": "do:foo"}`
    configureTriggers: function() {
      if (!this.triggers) { return; }
  
      var triggerEvents = {};
  
      // Allow `triggers` to be configured as a function
      var triggers = this.normalizeUIKeys(_.result(this, 'triggers'));
  
      // Configure the triggers, prevent default
      // action and stop propagation of DOM events
      _.each(triggers, function(value, key) {
  
        var hasOptions = _.isObject(value);
        var eventName = hasOptions ? value.event : value;
  
        // build the event handler function for the DOM event
        triggerEvents[key] = function(e) {
  
          // stop the event in its tracks
          if (e) {
            var prevent = e.preventDefault;
            var stop = e.stopPropagation;
  
            var shouldPrevent = hasOptions ? value.preventDefault : prevent;
            var shouldStop = hasOptions ? value.stopPropagation : stop;
  
            if (shouldPrevent && prevent) { prevent.apply(e); }
            if (shouldStop && stop) { stop.apply(e); }
          }
  
          // build the args for the event
          var args = {
            view: this,
            model: this.model,
            collection: this.collection
          };
  
          // trigger the event
          this.triggerMethod(eventName, args);
        };
  
      }, this);
  
      return triggerEvents;
    },
  
    // Overriding Backbone.View's delegateEvents to handle
    // the `triggers`, `modelEvents`, and `collectionEvents` configuration
    delegateEvents: function(events) {
      this._delegateDOMEvents(events);
      this.bindEntityEvents(this.model, this.getOption('modelEvents'));
      this.bindEntityEvents(this.collection, this.getOption('collectionEvents'));
      return this;
    },
  
    // internal method to delegate DOM events and triggers
    _delegateDOMEvents: function(events) {
      events = events || this.events;
      if (_.isFunction(events)) { events = events.call(this); }
  
      // normalize ui keys
      events = this.normalizeUIKeys(events);
  
      var combinedEvents = {};
  
      // look up if this view has behavior events
      var behaviorEvents = _.result(this, 'behaviorEvents') || {};
      var triggers = this.configureTriggers();
  
      // behavior events will be overriden by view events and or triggers
      _.extend(combinedEvents, behaviorEvents, events, triggers);
  
      Backbone.View.prototype.delegateEvents.call(this, combinedEvents);
    },
  
    // Overriding Backbone.View's undelegateEvents to handle unbinding
    // the `triggers`, `modelEvents`, and `collectionEvents` config
    undelegateEvents: function() {
      var args = slice.call(arguments);
      Backbone.View.prototype.undelegateEvents.apply(this, args);
      this.unbindEntityEvents(this.model, this.getOption('modelEvents'));
      this.unbindEntityEvents(this.collection, this.getOption('collectionEvents'));
      return this;
    },
  
    // Internal method, handles the `show` event.
    onShowCalled: function() {},
  
    // Internal helper method to verify whether the view hasn't been destroyed
    _ensureViewIsIntact: function() {
      if (this.isDestroyed) {
        var err = new Error('Cannot use a view thats already been destroyed.');
        err.name = 'ViewDestroyedError';
        throw err;
      }
    },
  
    // Default `destroy` implementation, for removing a view from the
    // DOM and unbinding it. Regions will call this method
    // for you. You can specify an `onDestroy` method in your view to
    // add custom code that is called after the view is destroyed.
    destroy: function() {
      if (this.isDestroyed) { return; }
  
      var args = slice.call(arguments);
  
      this.triggerMethod.apply(this, ['before:destroy'].concat(args));
  
      // mark as destroyed before doing the actual destroy, to
      // prevent infinite loops within "destroy" event handlers
      // that are trying to destroy other views
      this.isDestroyed = true;
      this.triggerMethod.apply(this, ['destroy'].concat(args));
  
      // unbind UI elements
      this.unbindUIElements();
  
      // remove the view from the DOM
      this.remove();
      return this;
    },
  
    // This method binds the elements specified in the "ui" hash inside the view's code with
    // the associated jQuery selectors.
    bindUIElements: function() {
      if (!this.ui) { return; }
  
      // store the ui hash in _uiBindings so they can be reset later
      // and so re-rendering the view will be able to find the bindings
      if (!this._uiBindings) {
        this._uiBindings = this.ui;
      }
  
      // get the bindings result, as a function or otherwise
      var bindings = _.result(this, '_uiBindings');
  
      // empty the ui so we don't have anything to start with
      this.ui = {};
  
      // bind each of the selectors
      _.each(_.keys(bindings), function(key) {
        var selector = bindings[key];
        this.ui[key] = this.$(selector);
      }, this);
    },
  
    // This method unbinds the elements specified in the "ui" hash
    unbindUIElements: function() {
      if (!this.ui || !this._uiBindings) { return; }
  
      // delete all of the existing ui bindings
      _.each(this.ui, function($el, name) {
        delete this.ui[name];
      }, this);
  
      // reset the ui element to the original bindings configuration
      this.ui = this._uiBindings;
      delete this._uiBindings;
    },
  
    // import the `triggerMethod` to trigger events with corresponding
    // methods if the method exists
    triggerMethod: Marionette.triggerMethod,
  
    // Imports the "normalizeMethods" to transform hashes of
    // events=>function references/names to a hash of events=>function references
    normalizeMethods: Marionette.normalizeMethods,
  
    // Proxy `getOption` to enable getting options from this or this.options by name.
    getOption: Marionette.proxyGetOption,
  
    // Proxy `unbindEntityEvents` to enable binding view's events from another entity.
    bindEntityEvents: Marionette.proxyBindEntityEvents,
  
    // Proxy `unbindEntityEvents` to enable unbinding view's events from another entity.
    unbindEntityEvents: Marionette.proxyUnbindEntityEvents
  });
  
  // Item View
  // ---------
  
  // A single item view implementation that contains code for rendering
  // with underscore.js templates, serializing the view's model or collection,
  // and calling several methods on extended views, such as `onRender`.
  Marionette.ItemView = Marionette.View.extend({
  
    // Setting up the inheritance chain which allows changes to
    // Marionette.View.prototype.constructor which allows overriding
    constructor: function() {
      Marionette.View.apply(this, arguments);
    },
  
    // Serialize the model or collection for the view. If a model is
    // found, the view's `serializeModel` is called. If a collection is found,
    // each model in the collection is serialized by calling
    // the view's `serializeCollection` and put into an `items` array in
    // the resulting data. If both are found, defaults to the model.
    // You can override the `serializeData` method in your own view definition,
    // to provide custom serialization for your view's data.
    serializeData: function(){
      var data = {};
  
      if (this.model) {
        data = _.partial(this.serializeModel, this.model).apply(this, arguments);
      }
      else if (this.collection) {
        data = { items: _.partial(this.serializeCollection, this.collection).apply(this, arguments) };
      }
  
      return data;
    },
  
    // Serialize a collection by serializing each of its models.
    serializeCollection: function(collection){
      return collection.toJSON.apply(collection, slice.call(arguments, 1));
    },
  
    // Render the view, defaulting to underscore.js templates.
    // You can override this in your view definition to provide
    // a very specific rendering for your view. In general, though,
    // you should override the `Marionette.Renderer` object to
    // change how Marionette renders views.
    render: function() {
      this._ensureViewIsIntact();
  
      this.triggerMethod('before:render', this);
  
      this._renderTemplate();
      this.bindUIElements();
  
      this.triggerMethod('render', this);
  
      return this;
    },
  
    // Internal method to render the template with the serialized data
    // and template helpers via the `Marionette.Renderer` object.
    // Throws an `UndefinedTemplateError` error if the template is
    // any falsely value but literal `false`.
    _renderTemplate: function() {
      var template = this.getTemplate();
  
      // Allow template-less item views
      if (template === false) {
        return;
      }
  
      if (!template) {
        throwError('Cannot render the template since it is null or undefined.',
          'UndefinedTemplateError');
      }
  
      // Add in entity data and template helpers
      var data = this.serializeData();
      data = this.mixinTemplateHelpers(data);
  
      // Render and add to el
      var html = Marionette.Renderer.render(template, data, this);
      this.attachElContent(html);
  
      return this;
    },
  
    // Attaches the content of a given view.
    // This method can be overriden to optimize rendering,
    // or to render in a non standard way.
    //
    // For example, using `innerHTML` instead of `$el.html`
    //
    // ```js
    // attachElContent: function(html) {
    //   this.el.innerHTML = html;
    //   return this;
    // }
    // ```
    attachElContent: function(html) {
      this.$el.html(html);
  
      return this;
    },
  
    // Override the default destroy event to add a few
    // more events that are triggered.
    destroy: function() {
      if (this.isDestroyed) { return; }
  
      return Marionette.View.prototype.destroy.apply(this, arguments);
    }
  });
  
  /* jshint maxstatements: 14 */
  
  // Collection View
  // ---------------
  
  // A view that iterates over a Backbone.Collection
  // and renders an individual child view for each model.
  Marionette.CollectionView = Marionette.View.extend({
  
    // used as the prefix for child view events
    // that are forwarded through the collectionview
    childViewEventPrefix: 'childview',
  
    // constructor
    // option to pass `{sort: false}` to prevent the `CollectionView` from
    // maintaining the sorted order of the collection.
    // This will fallback onto appending childView's to the end.
    constructor: function(options){
      var initOptions = options || {};
      this.sort = _.isUndefined(initOptions.sort) ? true : initOptions.sort;
  
      this._initChildViewStorage();
  
      Marionette.View.apply(this, arguments);
  
      this._initialEvents();
      this.initRenderBuffer();
    },
  
    // Instead of inserting elements one by one into the page,
    // it's much more performant to insert elements into a document
    // fragment and then insert that document fragment into the page
    initRenderBuffer: function() {
      this.elBuffer = document.createDocumentFragment();
      this._bufferedChildren = [];
    },
  
    startBuffering: function() {
      this.initRenderBuffer();
      this.isBuffering = true;
    },
  
    endBuffering: function() {
      this.isBuffering = false;
      this._triggerBeforeShowBufferedChildren();
      this.attachBuffer(this, this.elBuffer);
      this._triggerShowBufferedChildren();
      this.initRenderBuffer();
    },
  
    _triggerBeforeShowBufferedChildren: function() {
      if (this._isShown) {
        _.invoke(this._bufferedChildren, 'triggerMethod', 'before:show');
      }
    },
  
    _triggerShowBufferedChildren: function() {
      if (this._isShown) {
        _.each(this._bufferedChildren, function (child) {
          if (_.isFunction(child.triggerMethod)) {
            child.triggerMethod('show');
          } else {
            Marionette.triggerMethod.call(child, 'show');
          }
        });
        this._bufferedChildren = [];
      }
    },
  
    // Configured the initial events that the collection view
    // binds to.
    _initialEvents: function() {
      if (this.collection) {
        this.listenTo(this.collection, 'add', this._onCollectionAdd);
        this.listenTo(this.collection, 'remove', this._onCollectionRemove);
        this.listenTo(this.collection, 'reset', this.render);
  
        if (this.sort) {
          this.listenTo(this.collection, 'sort', this._sortViews);
        }
      }
    },
  
    // Handle a child added to the collection
    _onCollectionAdd: function(child) {
      this.destroyEmptyView();
      var ChildView = this.getChildView(child);
      var index = this.collection.indexOf(child);
      this.addChild(child, ChildView, index);
    },
  
    // get the child view by model it holds, and remove it
    _onCollectionRemove: function(model) {
      var view = this.children.findByModel(model);
      this.removeChildView(view);
      this.checkEmpty();
    },
  
    // Override from `Marionette.View` to trigger show on child views
    onShowCalled: function(){
      this.children.each(function(child){
        if (_.isFunction(child.triggerMethod)) {
          child.triggerMethod('show');
        } else {
          Marionette.triggerMethod.call(child, 'show');
        }
      });
    },
  
    // Render children views. Override this method to
    // provide your own implementation of a render function for
    // the collection view.
    render: function() {
      this._ensureViewIsIntact();
      this.triggerMethod('before:render', this);
      this._renderChildren();
      this.triggerMethod('render', this);
      return this;
    },
  
    // Render view after sorting. Override this method to
    // change how the view renders after a `sort` on the collection.
    // An example of this would be to only `renderChildren` in a `CompositeView`
    // rather than the full view.
    resortView: function() {
      this.render();
    },
  
    // Internal method. This checks for any changes in the order of the collection.
    // If the index of any view doesn't match, it will render.
    _sortViews: function() {
      // check for any changes in sort order of views
      var orderChanged = this.collection.find(function(item, index){
        var view = this.children.findByModel(item);
        return !view || view._index !== index;
      }, this);
  
      if (orderChanged) {
        this.resortView();
      }
    },
  
    // Internal method. Separated so that CompositeView can have
    // more control over events being triggered, around the rendering
    // process
    _renderChildren: function() {
      this.destroyEmptyView();
      this.destroyChildren();
  
      if (this.isEmpty(this.collection)) {
        this.showEmptyView();
      } else {
        this.triggerMethod('before:render:collection', this);
        this.startBuffering();
        this.showCollection();
        this.endBuffering();
        this.triggerMethod('render:collection', this);
      }
    },
  
    // Internal method to loop through collection and show each child view.
    showCollection: function() {
      var ChildView;
      this.collection.each(function(child, index) {
        ChildView = this.getChildView(child);
        this.addChild(child, ChildView, index);
      }, this);
    },
  
    // Internal method to show an empty view in place of
    // a collection of child views, when the collection is empty
    showEmptyView: function() {
      var EmptyView = this.getEmptyView();
  
      if (EmptyView && !this._showingEmptyView) {
        this.triggerMethod('before:render:empty');
  
        this._showingEmptyView = true;
        var model = new Backbone.Model();
        this.addEmptyView(model, EmptyView);
  
        this.triggerMethod('render:empty');
      }
    },
  
    // Internal method to destroy an existing emptyView instance
    // if one exists. Called when a collection view has been
    // rendered empty, and then a child is added to the collection.
    destroyEmptyView: function() {
      if (this._showingEmptyView) {
        this.destroyChildren();
        delete this._showingEmptyView;
      }
    },
  
    // Retrieve the empty view class
    getEmptyView: function() {
      return this.getOption('emptyView');
    },
  
    // Render and show the emptyView. Similar to addChild method
    // but "child:added" events are not fired, and the event from
    // emptyView are not forwarded
    addEmptyView: function(child, EmptyView){
  
      // get the emptyViewOptions, falling back to childViewOptions
      var emptyViewOptions = this.getOption('emptyViewOptions') ||
                            this.getOption('childViewOptions');
  
      if (_.isFunction(emptyViewOptions)){
        emptyViewOptions = emptyViewOptions.call(this);
      }
  
      // build the empty view
      var view = this.buildChildView(child, EmptyView, emptyViewOptions);
  
      // trigger the 'before:show' event on `view` if the collection view
      // has already been shown
      if (this._isShown){
        this.triggerMethod.call(view, 'before:show');
      }
  
      // Store the `emptyView` like a `childView` so we can properly
      // remove and/or close it later
      this.children.add(view);
  
      // Render it and show it
      this.renderChildView(view, -1);
  
      // call the 'show' method if the collection view
      // has already been shown
      if (this._isShown){
        this.triggerMethod.call(view, 'show');
      }
    },
  
    // Retrieve the `childView` class, either from `this.options.childView`
    // or from the `childView` in the object definition. The "options"
    // takes precedence.
    // This method receives the model that will be passed to the instance
    // created from this `childView`. Overriding methods may use the child
    // to determine what `childView` class to return.
    getChildView: function(child) {
      var childView = this.getOption('childView');
  
      if (!childView) {
        throwError('A "childView" must be specified', 'NoChildViewError');
      }
  
      return childView;
    },
  
    // Render the child's view and add it to the
    // HTML for the collection view at a given index.
    // This will also update the indices of later views in the collection
    // in order to keep the children in sync with the collection.
    addChild: function(child, ChildView, index) {
      var childViewOptions = this.getOption('childViewOptions');
      if (_.isFunction(childViewOptions)) {
        childViewOptions = childViewOptions.call(this, child, index);
      }
  
      var view = this.buildChildView(child, ChildView, childViewOptions);
  
      // increment indices of views after this one
      this._updateIndices(view, true, index);
  
      this._addChildView(view, index);
  
      return view;
    },
  
    // Internal method. This decrements or increments the indices of views after the
    // added/removed view to keep in sync with the collection.
    _updateIndices: function(view, increment, index) {
      if (!this.sort) {
        return;
      }
  
      if (increment) {
        // assign the index to the view
        view._index = index;
  
        // increment the index of views after this one
        this.children.each(function (laterView) {
          if (laterView._index >= view._index) {
            laterView._index++;
          }
        });
      }
      else {
        // decrement the index of views after this one
        this.children.each(function (laterView) {
          if (laterView._index >= view._index) {
            laterView._index--;
          }
        });
      }
    },
  
  
    // Internal Method. Add the view to children and render it at
    // the given index.
    _addChildView: function(view, index) {
      // set up the child view event forwarding
      this.proxyChildEvents(view);
  
      this.triggerMethod('before:add:child', view);
  
      // Store the child view itself so we can properly
      // remove and/or destroy it later
      this.children.add(view);
      this.renderChildView(view, index);
  
      if (this._isShown && !this.isBuffering){
        if (_.isFunction(view.triggerMethod)) {
          view.triggerMethod('show');
        } else {
          Marionette.triggerMethod.call(view, 'show');
        }
      }
  
      this.triggerMethod('add:child', view);
    },
  
    // render the child view
    renderChildView: function(view, index) {
      view.render();
      this.attachHtml(this, view, index);
      return view;
    },
  
    // Build a `childView` for a model in the collection.
    buildChildView: function(child, ChildViewClass, childViewOptions) {
      var options = _.extend({model: child}, childViewOptions);
      return new ChildViewClass(options);
    },
  
    // Remove the child view and destroy it.
    // This function also updates the indices of
    // later views in the collection in order to keep
    // the children in sync with the collection.
    removeChildView: function(view) {
  
      if (view) {
        this.triggerMethod('before:remove:child', view);
        // call 'destroy' or 'remove', depending on which is found
        if (view.destroy) { view.destroy(); }
        else if (view.remove) { view.remove(); }
  
        this.stopListening(view);
        this.children.remove(view);
        this.triggerMethod('remove:child', view);
  
        // decrement the index of views after this one
        this._updateIndices(view, false);
      }
  
      return view;
    },
  
    // check if the collection is empty
    isEmpty: function(collection) {
      return !this.collection || this.collection.length === 0;
    },
  
    // If empty, show the empty view
    checkEmpty: function() {
      if (this.isEmpty(this.collection)) {
        this.showEmptyView();
      }
    },
  
    // You might need to override this if you've overridden attachHtml
    attachBuffer: function(collectionView, buffer) {
      collectionView.$el.append(buffer);
    },
  
    // Append the HTML to the collection's `el`.
    // Override this method to do something other
    // than `.append`.
    attachHtml: function(collectionView, childView, index) {
      if (collectionView.isBuffering) {
        // buffering happens on reset events and initial renders
        // in order to reduce the number of inserts into the
        // document, which are expensive.
        collectionView.elBuffer.appendChild(childView.el);
        collectionView._bufferedChildren.push(childView);
      }
      else {
        // If we've already rendered the main collection, append
        // the new child into the correct order if we need to. Otherwise
        // append to the end.
        if (!collectionView._insertBefore(childView, index)){
          collectionView._insertAfter(childView);
        }
      }
    },
  
    // Internal method. Check whether we need to insert the view into
    // the correct position.
    _insertBefore: function(childView, index) {
      var currentView;
      var findPosition = this.sort && (index < this.children.length - 1);
      if (findPosition) {
        // Find the view after this one
        currentView = this.children.find(function (view) {
          return view._index === index + 1;
        });
      }
  
      if (currentView) {
        currentView.$el.before(childView.el);
        return true;
      }
  
      return false;
    },
  
    // Internal method. Append a view to the end of the $el
    _insertAfter: function(childView) {
      this.$el.append(childView.el);
    },
  
    // Internal method to set up the `children` object for
    // storing all of the child views
    _initChildViewStorage: function() {
      this.children = new Backbone.ChildViewContainer();
    },
  
    // Handle cleanup and other destroying needs for the collection of views
    destroy: function() {
      if (this.isDestroyed) { return; }
  
      this.triggerMethod('before:destroy:collection');
      this.destroyChildren();
      this.triggerMethod('destroy:collection');
  
      return Marionette.View.prototype.destroy.apply(this, arguments);
    },
  
    // Destroy the child views that this collection view
    // is holding on to, if any
    destroyChildren: function() {
      var childViews = this.children.map(_.identity);
      this.children.each(this.removeChildView, this);
      this.checkEmpty();
      return childViews;
    },
  
    // Set up the child view event forwarding. Uses a "childview:"
    // prefix in front of all forwarded events.
    proxyChildEvents: function(view) {
      var prefix = this.getOption('childViewEventPrefix');
  
      // Forward all child view events through the parent,
      // prepending "childview:" to the event name
      this.listenTo(view, 'all', function() {
        var args = slice.call(arguments);
        var rootEvent = args[0];
        var childEvents = this.normalizeMethods(_.result(this, 'childEvents'));
  
        args[0] = prefix + ':' + rootEvent;
        args.splice(1, 0, view);
  
        // call collectionView childEvent if defined
        if (typeof childEvents !== 'undefined' && _.isFunction(childEvents[rootEvent])) {
          childEvents[rootEvent].apply(this, args.slice(1));
        }
  
        this.triggerMethod.apply(this, args);
      }, this);
    }
  });
  
  /* jshint maxstatements: 17, maxlen: 117 */
  
  // Composite View
  // --------------
  
  // Used for rendering a branch-leaf, hierarchical structure.
  // Extends directly from CollectionView and also renders an
  // a child view as `modelView`, for the top leaf
  Marionette.CompositeView = Marionette.CollectionView.extend({
  
    // Setting up the inheritance chain which allows changes to
    // Marionette.CollectionView.prototype.constructor which allows overriding
    // option to pass '{sort: false}' to prevent the CompositeView from
    // maintaining the sorted order of the collection.
    // This will fallback onto appending childView's to the end.
    constructor: function() {
      Marionette.CollectionView.apply(this, arguments);
    },
  
    // Configured the initial events that the composite view
    // binds to. Override this method to prevent the initial
    // events, or to add your own initial events.
    _initialEvents: function() {
  
      // Bind only after composite view is rendered to avoid adding child views
      // to nonexistent childViewContainer
      this.once('render', function() {
        if (this.collection) {
          this.listenTo(this.collection, 'add', this._onCollectionAdd);
          this.listenTo(this.collection, 'remove', this._onCollectionRemove);
          this.listenTo(this.collection, 'reset', this._renderChildren);
  
          if (this.sort) {
            this.listenTo(this.collection, 'sort', this._sortViews);
          }
        }
      });
  
    },
  
    // Retrieve the `childView` to be used when rendering each of
    // the items in the collection. The default is to return
    // `this.childView` or Marionette.CompositeView if no `childView`
    // has been defined
    getChildView: function(child) {
      var childView = this.getOption('childView') || this.constructor;
  
      if (!childView) {
        throwError('A "childView" must be specified', 'NoChildViewError');
      }
  
      return childView;
    },
  
    // Serialize the collection for the view.
    // You can override the `serializeData` method in your own view
    // definition, to provide custom serialization for your view's data.
    serializeData: function() {
      var data = {};
  
      if (this.model){
        data = _.partial(this.serializeModel, this.model).apply(this, arguments);
      }
  
      return data;
    },
  
    // Renders the model once, and the collection once. Calling
    // this again will tell the model's view to re-render itself
    // but the collection will not re-render.
    render: function() {
      this._ensureViewIsIntact();
      this.isRendered = true;
      this.resetChildViewContainer();
  
      this.triggerMethod('before:render', this);
  
      this._renderTemplate();
      this._renderChildren();
  
      this.triggerMethod('render', this);
      return this;
    },
  
    _renderChildren: function() {
      if (this.isRendered) {
        Marionette.CollectionView.prototype._renderChildren.call(this);
      }
    },
  
    // Render the root template that the children
    // views are appended to
    _renderTemplate: function() {
      var data = {};
      data = this.serializeData();
      data = this.mixinTemplateHelpers(data);
  
      this.triggerMethod('before:render:template');
  
      var template = this.getTemplate();
      var html = Marionette.Renderer.render(template, data, this);
      this.attachElContent(html);
  
      // the ui bindings is done here and not at the end of render since they
      // will not be available until after the model is rendered, but should be
      // available before the collection is rendered.
      this.bindUIElements();
      this.triggerMethod('render:template');
    },
  
    // Attaches the content of the root.
    // This method can be overriden to optimize rendering,
    // or to render in a non standard way.
    //
    // For example, using `innerHTML` instead of `$el.html`
    //
    // ```js
    // attachElContent: function(html) {
    //   this.el.innerHTML = html;
    //   return this;
    // }
    // ```
    attachElContent: function(html) {
      this.$el.html(html);
  
      return this;
    },
  
    // You might need to override this if you've overridden attachHtml
    attachBuffer: function(compositeView, buffer) {
      var $container = this.getChildViewContainer(compositeView);
      $container.append(buffer);
    },
  
    // Internal method. Append a view to the end of the $el.
    // Overidden from CollectionView to ensure view is appended to
    // childViewContainer
    _insertAfter: function (childView) {
      var $container = this.getChildViewContainer(this);
      $container.append(childView.el);
    },
  
    // Internal method to ensure an `$childViewContainer` exists, for the
    // `attachHtml` method to use.
    getChildViewContainer: function(containerView) {
      if ('$childViewContainer' in containerView) {
        return containerView.$childViewContainer;
      }
  
      var container;
      var childViewContainer = Marionette.getOption(containerView, 'childViewContainer');
      if (childViewContainer) {
  
        var selector = _.isFunction(childViewContainer) ? childViewContainer.call(containerView) : childViewContainer;
  
        if (selector.charAt(0) === '@' && containerView.ui) {
          container = containerView.ui[selector.substr(4)];
        } else {
          container = containerView.$(selector);
        }
  
        if (container.length <= 0) {
          throwError('The specified "childViewContainer" was not found: ' +
            containerView.childViewContainer, 'ChildViewContainerMissingError');
        }
  
      } else {
        container = containerView.$el;
      }
  
      containerView.$childViewContainer = container;
      return container;
    },
  
    // Internal method to reset the `$childViewContainer` on render
    resetChildViewContainer: function() {
      if (this.$childViewContainer) {
        delete this.$childViewContainer;
      }
    }
  });
  
  // LayoutView
  // ----------
  
  // Used for managing application layoutViews, nested layoutViews and
  // multiple regions within an application or sub-application.
  //
  // A specialized view class that renders an area of HTML and then
  // attaches `Region` instances to the specified `regions`.
  // Used for composite view management and sub-application areas.
  Marionette.LayoutView = Marionette.ItemView.extend({
    regionClass: Marionette.Region,
  
    // Ensure the regions are available when the `initialize` method
    // is called.
    constructor: function(options) {
      options = options || {};
  
      this._firstRender = true;
      this._initializeRegions(options);
  
      Marionette.ItemView.call(this, options);
    },
  
    // LayoutView's render will use the existing region objects the
    // first time it is called. Subsequent calls will destroy the
    // views that the regions are showing and then reset the `el`
    // for the regions to the newly rendered DOM elements.
    render: function() {
      this._ensureViewIsIntact();
  
      if (this._firstRender) {
        // if this is the first render, don't do anything to
        // reset the regions
        this._firstRender = false;
      } else {
        // If this is not the first render call, then we need to
        // re-initialize the `el` for each region
        this._reInitializeRegions();
      }
  
      return Marionette.ItemView.prototype.render.apply(this, arguments);
    },
  
    // Handle destroying regions, and then destroy the view itself.
    destroy: function() {
      if (this.isDestroyed) { return this; }
  
      this.regionManager.destroy();
      return Marionette.ItemView.prototype.destroy.apply(this, arguments);
    },
  
    // Add a single region, by name, to the layoutView
    addRegion: function(name, definition) {
      this.triggerMethod('before:region:add', name);
      var regions = {};
      regions[name] = definition;
      return this._buildRegions(regions)[name];
    },
  
    // Add multiple regions as a {name: definition, name2: def2} object literal
    addRegions: function(regions) {
      this.regions = _.extend({}, this.regions, regions);
      return this._buildRegions(regions);
    },
  
    // Remove a single region from the LayoutView, by name
    removeRegion: function(name) {
      this.triggerMethod('before:region:remove', name);
      delete this.regions[name];
      return this.regionManager.removeRegion(name);
    },
  
    // Provides alternative access to regions
    // Accepts the region name
    // getRegion('main')
    getRegion: function(region) {
      return this.regionManager.get(region);
    },
  
    // Get all regions
    getRegions: function(){
      return this.regionManager.getRegions();
    },
  
    // internal method to build regions
    _buildRegions: function(regions) {
      var that = this;
  
      var defaults = {
        regionClass: this.getOption('regionClass'),
        parentEl: function() { return that.$el; }
      };
  
      return this.regionManager.addRegions(regions, defaults);
    },
  
    // Internal method to initialize the regions that have been defined in a
    // `regions` attribute on this layoutView.
    _initializeRegions: function(options) {
      var regions;
      this._initRegionManager();
  
      if (_.isFunction(this.regions)) {
        regions = this.regions(options);
      } else {
        regions = this.regions || {};
      }
  
      // Enable users to define `regions` as instance options.
      var regionOptions = this.getOption.call(options, 'regions');
  
      // enable region options to be a function
      if (_.isFunction(regionOptions)) {
        regionOptions = regionOptions.call(this, options);
      }
  
      _.extend(regions, regionOptions);
  
      this.addRegions(regions);
    },
  
    // Internal method to re-initialize all of the regions by updating the `el` that
    // they point to
    _reInitializeRegions: function() {
      this.regionManager.emptyRegions();
      this.regionManager.each(function(region) {
        region.reset();
      });
    },
  
    // Enable easy overiding of the default `RegionManager`
    // for customized region interactions and buisness specific
    // view logic for better control over single regions.
    getRegionManager: function() {
      return new Marionette.RegionManager();
    },
  
    // Internal method to initialize the region manager
    // and all regions in it
    _initRegionManager: function() {
      this.regionManager = this.getRegionManager();
  
      this.listenTo(this.regionManager, 'before:add:region', function(name) {
        this.triggerMethod('before:add:region', name);
      });
  
      this.listenTo(this.regionManager, 'add:region', function(name, region) {
        this[name] = region;
        this.triggerMethod('add:region', name, region);
      });
  
      this.listenTo(this.regionManager, 'before:remove:region', function(name) {
        this.triggerMethod('before:remove:region', name);
      });
  
      this.listenTo(this.regionManager, 'remove:region', function(name, region) {
        delete this[name];
        this.triggerMethod('remove:region', name, region);
      });
    }
  });
  

  // Behavior
  // -----------
  
  // A Behavior is an isolated set of DOM /
  // user interactions that can be mixed into any View.
  // Behaviors allow you to blackbox View specific interactions
  // into portable logical chunks, keeping your views simple and your code DRY.
  
  Marionette.Behavior = (function(_, Backbone) {
    function Behavior(options, view) {
      // Setup reference to the view.
      // this comes in handle when a behavior
      // wants to directly talk up the chain
      // to the view.
      this.view = view;
      this.defaults = _.result(this, 'defaults') || {};
      this.options  = _.extend({}, this.defaults, options);
  
      // proxy behavior $ method to the view
      // this is useful for doing jquery DOM lookups
      // scoped to behaviors view.
      this.$ = function() {
        return this.view.$.apply(this.view, arguments);
      };
  
      // Call the initialize method passing
      // the arguments from the instance constructor
      this.initialize.apply(this, arguments);
    }
  
    _.extend(Behavior.prototype, Backbone.Events, {
      initialize: function() {},
  
      // stopListening to behavior `onListen` events.
      destroy: function() {
        this.stopListening();
      },
  
      // import the `triggerMethod` to trigger events with corresponding
      // methods if the method exists
      triggerMethod: Marionette.triggerMethod,
  
      // Proxy `getOption` to enable getting options from this or this.options by name.
      getOption: Marionette.proxyGetOption,
  
      // Proxy `unbindEntityEvents` to enable binding view's events from another entity.
      bindEntityEvents: Marionette.proxyBindEntityEvents,
  
      // Proxy `unbindEntityEvents` to enable unbinding view's events from another entity.
      unbindEntityEvents: Marionette.proxyUnbindEntityEvents
    });
  
    // Borrow Backbones extend implementation
    // this allows us to setup a proper
    // inheritence pattern that follow in suite
    // with the rest of Marionette views.
    Behavior.extend = Marionette.extend;
  
    return Behavior;
  })(_, Backbone);
  
  /* jshint maxlen: 143, nonew: false */
  // Marionette.Behaviors
  // --------
  
  // Behaviors is a utility class that takes care of
  // glueing your behavior instances to their given View.
  // The most important part of this class is that you
  // **MUST** override the class level behaviorsLookup
  // method for things to work properly.
  
  Marionette.Behaviors = (function(Marionette, _) {
  
    function Behaviors(view, behaviors) {
      // Behaviors defined on a view can be a flat object literal
      // or it can be a function that returns an object.
      behaviors = Behaviors.parseBehaviors(view, behaviors || _.result(view, 'behaviors'));
  
      // Wraps several of the view's methods
      // calling the methods first on each behavior
      // and then eventually calling the method on the view.
      Behaviors.wrap(view, behaviors, _.keys(methods));
    }
  
    var methods = {
      setElement: function(setElement, behaviors) {
        setElement.apply(this, _.tail(arguments, 2));
  
        // proxy behavior $el to the view's $el.
        // This is needed because a view's $el proxy
        // is not set until after setElement is called.
        _.each(behaviors, function(b) {
          b.$el = this.$el;
          b.el = this.el;
        }, this);
  
        return this;
      },
  
      destroy: function(destroy, behaviors) {
        var args = _.tail(arguments, 2);
        destroy.apply(this, args);
  
        // Call destroy on each behavior after
        // destroying the view.
        // This unbinds event listeners
        // that behaviors have registerd for.
        _.invoke(behaviors, 'destroy', args);
        return this;
      },
  
      bindUIElements: function(bindUIElements, behaviors) {
        bindUIElements.apply(this);
        _.invoke(behaviors, bindUIElements);
      },
  
      unbindUIElements: function(unbindUIElements, behaviors) {
        unbindUIElements.apply(this);
        _.invoke(behaviors, unbindUIElements);
      },
  
      triggerMethod: function(triggerMethod, behaviors) {
        var args = _.tail(arguments, 2);
        triggerMethod.apply(this, args);
  
        _.each(behaviors, function(b) {
          triggerMethod.apply(b, args);
        });
      },
  
      delegateEvents: function(delegateEvents, behaviors) {
        var args = _.tail(arguments, 2);
        delegateEvents.apply(this, args);
  
        _.each(behaviors, function(b) {
          Marionette.bindEntityEvents(b, this.model, Marionette.getOption(b, 'modelEvents'));
          Marionette.bindEntityEvents(b, this.collection, Marionette.getOption(b, 'collectionEvents'));
        }, this);
  
        return this;
      },
  
      undelegateEvents: function(undelegateEvents, behaviors) {
        var args = _.tail(arguments, 2);
        undelegateEvents.apply(this, args);
  
        _.each(behaviors, function(b) {
          Marionette.unbindEntityEvents(b, this.model, Marionette.getOption(b, 'modelEvents'));
          Marionette.unbindEntityEvents(b, this.collection, Marionette.getOption(b, 'collectionEvents'));
        }, this);
  
        return this;
      },
  
      behaviorEvents: function(behaviorEvents, behaviors) {
        var _behaviorsEvents = {};
        var viewUI = _.result(this, 'ui');
  
        _.each(behaviors, function(b, i) {
          var _events = {};
          var behaviorEvents = _.clone(_.result(b, 'events')) || {};
          var behaviorUI = _.result(b, 'ui');
  
          // Construct an internal UI hash first using
          // the views UI hash and then the behaviors UI hash.
          // This allows the user to use UI hash elements
          // defined in the parent view as well as those
          // defined in the given behavior.
          var ui = _.extend({}, viewUI, behaviorUI);
  
          // Normalize behavior events hash to allow
          // a user to use the @ui. syntax.
          behaviorEvents = Marionette.normalizeUIKeys(behaviorEvents, ui);
  
          _.each(_.keys(behaviorEvents), function(key) {
            // Append white-space at the end of each key to prevent behavior key collisions.
            // This is relying on the fact that backbone events considers "click .foo" the same as
            // "click .foo ".
  
            // +2 is used because new Array(1) or 0 is "" and not " "
            var whitespace = (new Array(i + 2)).join(' ');
            var eventKey   = key + whitespace;
            var handler    = _.isFunction(behaviorEvents[key]) ? behaviorEvents[key] : b[behaviorEvents[key]];
  
            _events[eventKey] = _.bind(handler, b);
          });
  
          _behaviorsEvents = _.extend(_behaviorsEvents, _events);
        });
  
        return _behaviorsEvents;
      }
    };
  
    _.extend(Behaviors, {
  
      // Placeholder method to be extended by the user.
      // The method should define the object that stores the behaviors.
      // i.e.
      //
      // ```js
      // Marionette.Behaviors.behaviorsLookup: function() {
      //   return App.Behaviors
      // }
      // ```
      behaviorsLookup: function() {
        throw new Error('You must define where your behaviors are stored.' +
          'See https://github.com/marionettejs/backbone.marionette' +
          '/blob/master/docs/marionette.behaviors.md#behaviorslookup');
      },
  
      // Takes care of getting the behavior class
      // given options and a key.
      // If a user passes in options.behaviorClass
      // default to using that. Otherwise delegate
      // the lookup to the users `behaviorsLookup` implementation.
      getBehaviorClass: function(options, key) {
        if (options.behaviorClass) {
          return options.behaviorClass;
        }
  
        // Get behavior class can be either a flat object or a method
        return _.isFunction(Behaviors.behaviorsLookup) ? Behaviors.behaviorsLookup.apply(this, arguments)[key] : Behaviors.behaviorsLookup[key];
      },
  
      // Iterate over the behaviors object, for each behavior
      // instantiate it and get its grouped behaviors.
      parseBehaviors: function(view, behaviors) {
        return _.chain(behaviors).map(function(options, key) {
          var BehaviorClass = Behaviors.getBehaviorClass(options, key);
  
          var behavior = new BehaviorClass(options, view);
          var nestedBehaviors = Behaviors.parseBehaviors(view, _.result(behavior, 'behaviors'));
  
          return [behavior].concat(nestedBehaviors);
        }).flatten().value();
      },
  
      // Wrap view internal methods so that they delegate to behaviors. For example,
      // `onDestroy` should trigger destroy on all of the behaviors and then destroy itself.
      // i.e.
      //
      // `view.delegateEvents = _.partial(methods.delegateEvents, view.delegateEvents, behaviors);`
      wrap: function(view, behaviors, methodNames) {
        _.each(methodNames, function(methodName) {
          view[methodName] = _.partial(methods[methodName], view[methodName], behaviors);
        });
      }
    });
  
    return Behaviors;
  
  })(Marionette, _);
  

  // AppRouter
  // ---------
  
  // Reduce the boilerplate code of handling route events
  // and then calling a single method on another object.
  // Have your routers configured to call the method on
  // your object, directly.
  //
  // Configure an AppRouter with `appRoutes`.
  //
  // App routers can only take one `controller` object.
  // It is recommended that you divide your controller
  // objects in to smaller pieces of related functionality
  // and have multiple routers / controllers, instead of
  // just one giant router and controller.
  //
  // You can also add standard routes to an AppRouter.
  
  Marionette.AppRouter = Backbone.Router.extend({
  
    constructor: function(options) {
      Backbone.Router.apply(this, arguments);
  
      this.options = options || {};
  
      var appRoutes = this.getOption('appRoutes');
      var controller = this._getController();
      this.processAppRoutes(controller, appRoutes);
      this.on('route', this._processOnRoute, this);
    },
  
    // Similar to route method on a Backbone Router but
    // method is called on the controller
    appRoute: function(route, methodName) {
      var controller = this._getController();
      this._addAppRoute(controller, route, methodName);
    },
  
    // process the route event and trigger the onRoute
    // method call, if it exists
    _processOnRoute: function(routeName, routeArgs) {
      // find the path that matched
      var routePath = _.invert(this.getOption('appRoutes'))[routeName];
  
      // make sure an onRoute is there, and call it
      if (_.isFunction(this.onRoute)) {
        this.onRoute(routeName, routePath, routeArgs);
      }
    },
  
    // Internal method to process the `appRoutes` for the
    // router, and turn them in to routes that trigger the
    // specified method on the specified `controller`.
    processAppRoutes: function(controller, appRoutes) {
      if (!appRoutes) { return; }
  
      var routeNames = _.keys(appRoutes).reverse(); // Backbone requires reverted order of routes
  
      _.each(routeNames, function(route) {
        this._addAppRoute(controller, route, appRoutes[route]);
      }, this);
    },
  
    _getController: function() {
      return this.getOption('controller');
    },
  
    _addAppRoute: function(controller, route, methodName) {
      var method = controller[methodName];
  
      if (!method) {
        throwError('Method "' + methodName + '" was not found on the controller');
      }
  
      this.route(route, methodName, _.bind(method, controller));
    },
  
    // Proxy `getOption` to enable getting options from this or this.options by name.
    getOption: Marionette.proxyGetOption
  });
  
  // Application
  // -----------
  
  // Contain and manage the composite application as a whole.
  // Stores and starts up `Region` objects, includes an
  // event aggregator as `app.vent`
  Marionette.Application = function(options) {
    this._initializeRegions(options);
    this._initCallbacks = new Marionette.Callbacks();
    this.submodules = {};
    _.extend(this, options);
    this._initChannel();
  };
  
  _.extend(Marionette.Application.prototype, Backbone.Events, {
    // Command execution, facilitated by Backbone.Wreqr.Commands
    execute: function() {
      this.commands.execute.apply(this.commands, arguments);
    },
  
    // Request/response, facilitated by Backbone.Wreqr.RequestResponse
    request: function() {
      return this.reqres.request.apply(this.reqres, arguments);
    },
  
    // Add an initializer that is either run at when the `start`
    // method is called, or run immediately if added after `start`
    // has already been called.
    addInitializer: function(initializer) {
      this._initCallbacks.add(initializer);
    },
  
    // kick off all of the application's processes.
    // initializes all of the regions that have been added
    // to the app, and runs all of the initializer functions
    start: function(options) {
      this.triggerMethod('before:start', options);
      this._initCallbacks.run(options, this);
      this.triggerMethod('start', options);
    },
  
    // Add regions to your app.
    // Accepts a hash of named strings or Region objects
    // addRegions({something: "#someRegion"})
    // addRegions({something: Region.extend({el: "#someRegion"}) });
    addRegions: function(regions) {
      return this._regionManager.addRegions(regions);
    },
  
    // Empty all regions in the app, without removing them
    emptyRegions: function() {
      return this._regionManager.emptyRegions();
    },
  
    // Removes a region from your app, by name
    // Accepts the regions name
    // removeRegion('myRegion')
    removeRegion: function(region) {
      return this._regionManager.removeRegion(region);
    },
  
    // Provides alternative access to regions
    // Accepts the region name
    // getRegion('main')
    getRegion: function(region) {
      return this._regionManager.get(region);
    },
  
    // Get all the regions from the region manager
    getRegions: function(){
      return this._regionManager.getRegions();
    },
  
    // Create a module, attached to the application
    module: function(moduleNames, moduleDefinition) {
  
      // Overwrite the module class if the user specifies one
      var ModuleClass = Marionette.Module.getClass(moduleDefinition);
  
      // slice the args, and add this application object as the
      // first argument of the array
      var args = slice.call(arguments);
      args.unshift(this);
  
      // see the Marionette.Module object for more information
      return ModuleClass.create.apply(ModuleClass, args);
    },
  
    // Enable easy overriding of the default `RegionManager`
    // for customized region interactions and business-specific
    // view logic for better control over single regions.
    getRegionManager: function() {
      return new Marionette.RegionManager();
    },
  
    // Internal method to initialize the regions that have been defined in a
    // `regions` attribute on the application instance
    _initializeRegions: function(options) {
      var regions = _.isFunction(this.regions) ? this.regions(options) : this.regions || {};
  
      this._initRegionManager();
  
      // Enable users to define `regions` in instance options.
      var optionRegions = Marionette.getOption(options, 'regions');
  
      // Enable region options to be a function
      if (_.isFunction(optionRegions)) {
        optionRegions = optionRegions.call(this, options);
      }
  
      // Overwrite current regions with those passed in options
      _.extend(regions, optionRegions);
  
      this.addRegions(regions);
  
      return this;
    },
  
    // Internal method to set up the region manager
    _initRegionManager: function() {
      this._regionManager = this.getRegionManager();
  
      this.listenTo(this._regionManager, 'before:add:region', function(name) {
        this.triggerMethod('before:add:region', name);
      });
  
      this.listenTo(this._regionManager, 'add:region', function(name, region) {
        this[name] = region;
        this.triggerMethod('add:region', name, region);
      });
  
      this.listenTo(this._regionManager, 'before:remove:region', function(name) {
        this.triggerMethod('before:remove:region', name);
      });
  
      this.listenTo(this._regionManager, 'remove:region', function(name, region) {
        delete this[name];
        this.triggerMethod('remove:region', name, region);
      });
    },
  
    // Internal method to setup the Wreqr.radio channel
    _initChannel: function() {
      this.channelName = _.result(this, 'channelName') || 'global';
      this.channel = _.result(this, 'channel') || Backbone.Wreqr.radio.channel(this.channelName);
      this.vent = _.result(this, 'vent') || this.channel.vent;
      this.commands = _.result(this, 'commands') || this.channel.commands;
      this.reqres = _.result(this, 'reqres') || this.channel.reqres;
    },
  
    // import the `triggerMethod` to trigger events with corresponding
    // methods if the method exists
    triggerMethod: Marionette.triggerMethod,
  
    // Proxy `getOption` to enable getting options from this or this.options by name.
    getOption: Marionette.proxyGetOption
  });
  
  // Copy the `extend` function used by Backbone's classes
  Marionette.Application.extend = Marionette.extend;
  
  /* jshint maxparams: 9 */
  
  // Module
  // ------
  
  // A simple module system, used to create privacy and encapsulation in
  // Marionette applications
  Marionette.Module = function(moduleName, app, options) {
    this.moduleName = moduleName;
    this.options = _.extend({}, this.options, options);
    // Allow for a user to overide the initialize
    // for a given module instance.
    this.initialize = options.initialize || this.initialize;
  
    // Set up an internal store for sub-modules.
    this.submodules = {};
  
    this._setupInitializersAndFinalizers();
  
    // Set an internal reference to the app
    // within a module.
    this.app = app;
  
    // By default modules start with their parents.
    this.startWithParent = true;
  
    if (_.isFunction(this.initialize)) {
      this.initialize(moduleName, app, this.options);
    }
  };
  
  Marionette.Module.extend = Marionette.extend;
  
  // Extend the Module prototype with events / listenTo, so that the module
  // can be used as an event aggregator or pub/sub.
  _.extend(Marionette.Module.prototype, Backbone.Events, {
  
    // Initialize is an empty function by default. Override it with your own
    // initialization logic when extending Marionette.Module.
    initialize: function() {},
  
    // Initializer for a specific module. Initializers are run when the
    // module's `start` method is called.
    addInitializer: function(callback) {
      this._initializerCallbacks.add(callback);
    },
  
    // Finalizers are run when a module is stopped. They are used to teardown
    // and finalize any variables, references, events and other code that the
    // module had set up.
    addFinalizer: function(callback) {
      this._finalizerCallbacks.add(callback);
    },
  
    // Start the module, and run all of its initializers
    start: function(options) {
      // Prevent re-starting a module that is already started
      if (this._isInitialized) { return; }
  
      // start the sub-modules (depth-first hierarchy)
      _.each(this.submodules, function(mod) {
        // check to see if we should start the sub-module with this parent
        if (mod.startWithParent) {
          mod.start(options);
        }
      });
  
      // run the callbacks to "start" the current module
      this.triggerMethod('before:start', options);
  
      this._initializerCallbacks.run(options, this);
      this._isInitialized = true;
  
      this.triggerMethod('start', options);
    },
  
    // Stop this module by running its finalizers and then stop all of
    // the sub-modules for this module
    stop: function() {
      // if we are not initialized, don't bother finalizing
      if (!this._isInitialized) { return; }
      this._isInitialized = false;
  
      this.triggerMethod('before:stop');
  
      // stop the sub-modules; depth-first, to make sure the
      // sub-modules are stopped / finalized before parents
      _.each(this.submodules, function(mod) { mod.stop(); });
  
      // run the finalizers
      this._finalizerCallbacks.run(undefined, this);
  
      // reset the initializers and finalizers
      this._initializerCallbacks.reset();
      this._finalizerCallbacks.reset();
  
      this.triggerMethod('stop');
    },
  
    // Configure the module with a definition function and any custom args
    // that are to be passed in to the definition function
    addDefinition: function(moduleDefinition, customArgs) {
      this._runModuleDefinition(moduleDefinition, customArgs);
    },
  
    // Internal method: run the module definition function with the correct
    // arguments
    _runModuleDefinition: function(definition, customArgs) {
      // If there is no definition short circut the method.
      if (!definition) { return; }
  
      // build the correct list of arguments for the module definition
      var args = _.flatten([
        this,
        this.app,
        Backbone,
        Marionette,
        Backbone.$, _,
        customArgs
      ]);
  
      definition.apply(this, args);
    },
  
    // Internal method: set up new copies of initializers and finalizers.
    // Calling this method will wipe out all existing initializers and
    // finalizers.
    _setupInitializersAndFinalizers: function() {
      this._initializerCallbacks = new Marionette.Callbacks();
      this._finalizerCallbacks = new Marionette.Callbacks();
    },
  
    // import the `triggerMethod` to trigger events with corresponding
    // methods if the method exists
    triggerMethod: Marionette.triggerMethod
  });
  
  // Class methods to create modules
  _.extend(Marionette.Module, {
  
    // Create a module, hanging off the app parameter as the parent object.
    create: function(app, moduleNames, moduleDefinition) {
      var module = app;
  
      // get the custom args passed in after the module definition and
      // get rid of the module name and definition function
      var customArgs = slice.call(arguments);
      customArgs.splice(0, 3);
  
      // Split the module names and get the number of submodules.
      // i.e. an example module name of `Doge.Wow.Amaze` would
      // then have the potential for 3 module definitions.
      moduleNames = moduleNames.split('.');
      var length = moduleNames.length;
  
      // store the module definition for the last module in the chain
      var moduleDefinitions = [];
      moduleDefinitions[length - 1] = moduleDefinition;
  
      // Loop through all the parts of the module definition
      _.each(moduleNames, function(moduleName, i) {
        var parentModule = module;
        module = this._getModule(parentModule, moduleName, app, moduleDefinition);
        this._addModuleDefinition(parentModule, module, moduleDefinitions[i], customArgs);
      }, this);
  
      // Return the last module in the definition chain
      return module;
    },
  
    _getModule: function(parentModule, moduleName, app, def, args) {
      var options = _.extend({}, def);
      var ModuleClass = this.getClass(def);
  
      // Get an existing module of this name if we have one
      var module = parentModule[moduleName];
  
      if (!module) {
        // Create a new module if we don't have one
        module = new ModuleClass(moduleName, app, options);
        parentModule[moduleName] = module;
        // store the module on the parent
        parentModule.submodules[moduleName] = module;
      }
  
      return module;
    },
  
    // ## Module Classes
    //
    // Module classes can be used as an alternative to the define pattern.
    // The extend function of a Module is identical to the extend functions
    // on other Backbone and Marionette classes.
    // This allows module lifecyle events like `onStart` and `onStop` to be called directly.
    getClass: function(moduleDefinition) {
      var ModuleClass = Marionette.Module;
  
      if (!moduleDefinition) {
        return ModuleClass;
      }
  
      // If all of the module's functionality is defined inside its class,
      // then the class can be passed in directly. `MyApp.module("Foo", FooModule)`.
      if (moduleDefinition.prototype instanceof ModuleClass) {
        return moduleDefinition;
      }
  
      return moduleDefinition.moduleClass || ModuleClass;
    },
  
    // Add the module definition and add a startWithParent initializer function.
    // This is complicated because module definitions are heavily overloaded
    // and support an anonymous function, module class, or options object
    _addModuleDefinition: function(parentModule, module, def, args) {
      var fn = this._getDefine(def);
      var startWithParent = this._getStartWithParent(def, module);
  
      if (fn) {
        module.addDefinition(fn, args);
      }
  
      this._addStartWithParent(parentModule, module, startWithParent);
    },
  
    _getStartWithParent: function(def, module) {
      var swp;
  
      if (_.isFunction(def) && (def.prototype instanceof Marionette.Module)) {
        swp = module.constructor.prototype.startWithParent;
        return _.isUndefined(swp) ? true : swp;
      }
  
      if (_.isObject(def)) {
        swp = def.startWithParent;
        return _.isUndefined(swp) ? true : swp;
      }
  
      return true;
    },
  
    _getDefine: function(def) {
      if (_.isFunction(def) && !(def.prototype instanceof Marionette.Module)) {
        return def;
      }
  
      if (_.isObject(def)) {
        return def.define;
      }
  
      return null;
    },
  
    _addStartWithParent: function(parentModule, module, startWithParent) {
      module.startWithParent = module.startWithParent && startWithParent;
  
      if (!module.startWithParent || !!module.startWithParentIsConfigured) {
        return;
      }
  
      module.startWithParentIsConfigured = true;
  
      parentModule.addInitializer(function(options) {
        if (module.startWithParent) {
          module.start(options);
        }
      });
    }
  });
  

  return Marionette;
}));
;
;/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:marionette', location = 'lib/backbone/marionette/backbone.marionette-amd.js' */
(function loadMarionette() {
    var jiraViewIssuePluginMarionette = Marionette;
    define('jira/view-issue-plugin/lib/marionette', [], function defineMarionette() {
        return jiraViewIssuePluginMarionette.noConflict();
    });
})();;
;/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:draggableattachment', location = 'viewissue/initDraggableAttachment.js' */
(function($) {
    $.event.props.push("dataTransfer");

    $('[draggable=true]').live("dragstart", function(evt) {
        var $this = AJS.$(this);
        var dataTransfer = evt.dataTransfer;
        dataTransfer.effectAllowed = 'copy';
        dataTransfer.dropEffect = 'copy';
        dataTransfer.setData("DownloadURL", $this.data('downloadurl'));
        if (!$this.find('img').length) {
            dataTransfer.setDragImage($this.closest('li').find('img:visible')[0], 8, 8);
        }
    });
})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:asynchronous-attachment-expansion', location = 'viewissue/attachment/attachment-contents-view.js' */
(function loadAttachmentContentsView() {
    define('jira/attachment/attachment-contents-view', [
        'jira/view-issue-plugin/lib/marionette'
    ], function defineAttachmentContentsView(Marionette) {
        'use strict';

        return Marionette.ItemView.extend({
            template: JIRA.Templates.ViewIssue.attachmentContents,

            initialize: function initialize(options) {
                this.attachment = options.attachment;
                this.issueId = options.issueId;
                this.baseUrl = options.baseUrl;
            },

            serializeData: function serializeData() {
                return {
                    attachment: this.attachment,
                    issueId: this.issueId,
                    baseUrl: this.baseUrl
                };
            }

        });
    });
})();;
;/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:asynchronous-attachment-expansion', location = 'viewissue/attachment/archive-expansion-initialization.js' */
AJS.$(function loadArchiveExpansion() {

    require([
        'jquery',
        'jira/view-issue-plugin/lib/marionette',
        'jira/attachment/attachment-contents-view'
    ], function initializeArchiveExpansion($, Marionette, AttachmentContentsView) {
        'use strict';

        JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED, function rewireArchiveExpansion(e, $element) {
            if (contains($element, '#file_attachments')) {
                wireArchiveExpansion($element);
            }
        });

        wireArchiveExpansion($('#file_attachments'));

        function contains($element, selector) {
            return $element.is(selector) || $element.find(selector).length > 0;
        }

        function wireArchiveExpansion($root) {
            var expanders = $root.find('.attachment-content .expander');
            expanders.each(function wireExpander(expanderIndex, expander) {
                $(expander).one('expandBlock', expandArchive);
            });
        }

        function expandArchive() {
            var $expander = $(this);
            var $attachmentRow = $expander.parents('.attachment-content').first();
            var attachmentId = $attachmentRow.data('attachment-id');
            var issueId = $attachmentRow.data('issue-id');
            var expansionResource = AJS.contextPath() + "/rest/api/2/attachment/" + attachmentId + "/expand/human";
            var promise = $.get(expansionResource);
            promise.done(function renderAttachmentContents(data) {
                var region = new Marionette.Region({
                    el: $expander.find('.zip-contents').first()
                });
                var view = new AttachmentContentsView({
                    attachment: data,
                    issueId: issueId,
                    baseUrl: window.location.protocol + "//" + window.location.host + AJS.contextPath()
                });
                region.show(view);
            });
            promise.error(function handleAttachmentExpansionError(data) {
                console.error(data);
            });
        }

    });
});;
;/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:asynchronous-attachment-expansion', location = 'viewissue/attachment/attachment.soy' */
// This file was automatically generated from attachment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }


JIRA.Templates.ViewIssue.attachmentContents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="archive-expanded">');
  var entries__soy4 = opt_data.attachment.entries;
  var entryList5 = entries__soy4;
  var entryListLen5 = entryList5.length;
  for (var entryIndex5 = 0; entryIndex5 < entryListLen5; entryIndex5++) {
    var entryData5 = entryList5[entryIndex5];
    JIRA.Templates.ViewIssue.attachmentArchiveEntry(soy.$$augmentData(opt_data, {entry: entryData5}), output);
  }
  output.append((opt_data.attachment.totalEntryCount == 0) ? '<li><div class="aui-message aui-message-warning" style="display: inline-block"><p>' + soy.$$escapeHtml("This archive is either corrupt, empty or not an archive at all") + '.</p></div></li>' : '', '</ol><span class="zip-contents-trailer">', (entries__soy4.length < opt_data.attachment.totalEntryCount) ? '<span class="limit-info">' + soy.$$escapeHtml(AJS.format("Showing {0} of {1} items",entries__soy4.length,opt_data.attachment.totalEntryCount)) + ' </span>' : '');
  var attachmentUrl__soy20 = new soy.StringBuilder(soy.$$escapeHtml(opt_data.baseUrl), '/secure/attachment/', soy.$$escapeHtml(opt_data.attachment.id), '/');
  attachmentUrl__soy20 = attachmentUrl__soy20.toString();
  output.append('<a href="', soy.$$escapeHtml(attachmentUrl__soy20), '" draggable="true" data-downloadurl="', soy.$$escapeHtml(opt_data.attachment.mediaType), ':', soy.$$escapeHtml(opt_data.attachment.name), ':', soy.$$escapeHtml(attachmentUrl__soy20), '">', soy.$$escapeHtml("Download Zip"), '</a></span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.attachmentArchiveEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var entryUrl__soy37 = new soy.StringBuilder(soy.$$escapeHtml(opt_data.baseUrl), '/secure/attachmentzip/unzip/', soy.$$escapeHtml(opt_data.issueId), '/', soy.$$escapeHtml(opt_data.attachment.id), '%5B', soy.$$escapeHtml(opt_data.entry.index), '%5D/');
  entryUrl__soy37 = entryUrl__soy37.toString();
  var entryDownloadUrl__soy49 = new soy.StringBuilder(opt_data.entry.mediaType, ':', opt_data.entry.path, ':', entryUrl__soy37);
  entryDownloadUrl__soy49 = entryDownloadUrl__soy49.toString();
  output.append('<li class="archive-entry" data-entry-index="', soy.$$escapeHtml(opt_data.entry.index), '"><div class="attachment-thumb"><a href="', soy.$$escapeHtml(entryUrl__soy37), '" draggable="true" data-downloadurl="', soy.$$escapeHtml(entryDownloadUrl__soy49), '"><img src="', soy.$$escapeHtml(opt_data.baseUrl), '/images/icons/attach/', soy.$$escapeHtml(opt_data.entry.icon), '" height="16" width="16" border="0" alt="', soy.$$escapeHtml(opt_data.entry.alternativeText), '"/></a></div><a class="file-path" href="', soy.$$escapeHtml(entryUrl__soy37), '" title="', soy.$$escapeHtml(opt_data.entry.path), '" draggable="true" data-downloadurl="', soy.$$escapeHtml(entryDownloadUrl__soy49), '" >', soy.$$escapeHtml(opt_data.entry.label), '</a><span class="attachment-size">', soy.$$escapeHtml(opt_data.entry.size), '</span></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:attach-screenshot-resources', location = '/includes/jira/issue/attachScreenshot.js' */
AJS.namespace("JIRA.Issue.AttachScreenshot");(function initializeAttachScreenshot(){AJS.EventQueue=AJS.EventQueue||[];AJS.$(document).on("click","#attach-screenshot",function(){AJS.EventQueue.push({name:"attach.screenshot.display",properties:{}})})})();;
;/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};;
;/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/Namespaces.js' */
if(typeof GH==="undefined"){window.GH={}}if(typeof GH.view=="undefined"){GH.view={}}if(typeof GH.view.model=="undefined"){GH.view.model={}}if(typeof GH.Global=="undefined"){GH.Global={}}if(typeof GH.Dialog=="undefined"){GH.Dialog={}}if(typeof GH.Dialogs=="undefined"){GH.Dialogs={}}if(typeof GH.State=="undefined"){GH.State={}}if(typeof GH.XBoard=="undefined"){GH.XBoard={}}if(typeof GH.RapidBoard=="undefined"){GH.RapidBoard={}}if(typeof GH.HelpPaths=="undefined"){GH.HelpPaths={}}if(typeof GH.JQLAutoComplete=="undefined"){GH.JQLAutoComplete={}}if(typeof GH.RapidBoard.Util=="undefined"){GH.RapidBoard.Util={}}if(typeof GH.NumberFormat=="undefined"){GH.NumberFormat={}}if(typeof GH.UrlFormat=="undefined"){GH.UrlFormat={}}AJS.format=function(i){var b=/'(?!')/g,h=/^\d+$/,e=/^(\d+),number$/,c=/^(\d+),choice,(.+)/,g=/^\s*(-?\d+)([#<])(.*)/;var f=function(s,q){var p="",n,j;if(n=s.match(h)){p=q.length>++s?q[s]:""}else{if(n=s.match(e)){j=GH.NumberFormat&&GH.NumberFormat.format||_.identity;p=q.length>++n[1]?j(q[n[1]]):""}else{if(n=s.match(c)){var t=(q.length>++n[1]?q[n[1]]:null);if(t!==null){var u=n[2].split("|");var o=null;for(var m=0;m<u.length;m++){var l=u[m].match(g);if(!l){console.log("Bad formatting of message: "+s);break}var r=parseInt(l[1],10);if(t<r){if(o){p=o;break}else{p=l[3];break}}if(t==r&&l[2]=="#"){p=l[3];break}else{}if(m==u.length-1){p=l[3]}o=l[3]}var k=[p].concat(Array.prototype.slice.call(q,1));p=AJS.format.apply(AJS,k)}}}}return p};var d=function(o){var m=false,j=-1,n=0;for(var l=0;l<o.length;l++){var p=o.charAt(l);if(p=="'"){m=!m}if(m){continue}if(p==="{"){if(n===0){j=l}n++}else{if(p==="}"){if(n>0){n--;if(n===0){var k=[];k.push(o.substring(0,l+1));k.push(o.substring(0,j));k.push(o.substring(j+1,l));return k}}}}}return null};var a=function(m){var k=arguments,l="",j=d(m);while(j){m=m.substring(j[0].length);l+=j[1].replace(b,"");l+=f(j[2],k);j=d(m)}l+=m.replace(b,"");return l};return a.apply(AJS,arguments)};;
;/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});;
;/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/Ajax.js' */
GH.namespace("GH.Ajax");GH.Ajax={};GH.Ajax.CONTEXT_PATH=AJS.contextPath();GH.Ajax.REST_URL_BASE="/rest/greenhopper/1.0";GH.Ajax.xhrRegistery={};GH.Ajax.stallTimeout=300;GH.Ajax.get=function(a,c){AJS.$.extend(a,{type:"GET",headers:{"X-Atlassian-GreenHopper-Gadget":!_.isUndefined(GH.gadget)}});var b=GH.Ajax._executeGet(a,c);return b.pipe(function(d,f,e){return AJS.$.Deferred().resolveWith(this,[d.success,f,e])})};GH.Ajax.post=function(a){a=GH.Ajax._getSettings(a,true);AJS.$.extend(a,{type:"POST",contentType:"application/json"});return GH.Ajax._executeStore(a)};GH.Ajax.put=function(a){a=GH.Ajax._getSettings(a,true);a.type="PUT";return GH.Ajax._executeStore(a)};GH.Ajax.del=function(a){a=GH.Ajax._getSettings(a,true);a.type="DELETE";return GH.Ajax._executeStore(a)};GH.Ajax._getSettings=function(a,b){if(!a.bareUrl&&a.url){a.bareUrl=GH.Ajax.buildRestUrl(a.url)}if(a.bareUrl){a.url=a.bareUrl}if(!a.dataType){a.dataType="json"}if(a.data&&b){a.data=JSON.stringify(a.data)}a.contentType="application/json";return a};GH.Ajax._getXhrData=function(b){var a={timestamp:0};if(b){if(GH.Ajax.xhrRegistery[b]){a=GH.Ajax.xhrRegistery[b]}else{a=GH.Ajax.xhrRegistery[b]=a}}return a};GH.Ajax._executeGet=function(c,g){c=GH.Ajax._getSettings(c);var b=GH.Ajax._getXhrData(g);if(b.xhr){GH.log("aborting request for "+g,GH.Logger.Contexts.ajax);b.xhr.abort();delete b.xhr;delete b.xhrAbort;delete b.timeoutId}var f=b.timestamp;b.timestamp=new Date().getTime();if(b.timestamp-f<GH.Ajax.stallTimeout){GH.log("stalling request for "+g+", time since last request: "+(b.timestamp-f),GH.Logger.Contexts.ajax);var a=AJS.$.Deferred();var e;var d=function(){e=GH.Ajax._executeGet(c,g);e.then(a.resolve,a.reject)};b.timeoutId=window.setTimeout(d,GH.Ajax.stallTimeout);b.xhr=a.promise();b.xhr.abort=function(){if(e){e.abort.apply(e,arguments)}else{clearTimeout(b.timeoutId)}}}else{GH.log("executing request for "+g,GH.Logger.Contexts.ajax);b.xhr=GH.Ajax.makeRequest(c)}b.xhrAbort=b.xhr.abort;b.xhr.abort=function(){var i=b.xhr;var h=b.xhrAbort;if(i&&h){return h.apply(i,arguments)}};b.xhr.done(function(){if(b.xhr){delete b.xhr}}).fail(function(){if(b.xhr){delete b.xhr}});return b.xhr};GH.Ajax._executeStore=function(b){b=b||{};if(b.data&&typeof(b.data)==="string"){if(/\?\?/.test(b.data)){var a="\\u003F\\u003F";b.data=b.data.replace(/\?\?/g,a)}}b.dataType="json";return GH.Ajax.makeRequest(b)};GH.Ajax.makeRequest=function(d){var a=AJS.$.Deferred();d=_.extend(d,{success:function(){a.resolveWith(this,arguments)},error:function(){a.rejectWith(this,arguments)}});var c=a.promise(JIRA.SmartAjax.makeRequest(d));var e=c.abort;c.abort=function(f){c.abortMarker=f!="timeout";return e.apply(c,arguments)};var b=c.pipe(GH.Ajax._generateDoneInterceptor(),GH.Ajax._generateFailInterceptor(d.errorsNoAutoEscape));if(!d.deferErrorHandling){b.fail(GH.Ajax._generateErrorHandler(d.onGlobalError,d.errorContextMap,d.contextualErrorRenderer,d.globalErrorDismissable))}return b};GH.Ajax._generateDoneInterceptor=function(){return function(a,c,b){a=a||{};a=GH.Ajax._createExtendedResult(a);if(!GH.Ajax.matchesCurrentUser(b)){return GH.Ajax._handleCurrentUserChanged(b)}if(!a.isSuccess()){return AJS.$.Deferred().rejectWith(this,[a,b,c,null])}return AJS.$.Deferred().resolveWith(this,[a,c,b])}};GH.Ajax._generateFailInterceptor=function(a){return function(d,h,g){if(d.abortMarker){return AJS.$.Deferred()}if(!GH.Ajax.matchesCurrentUser(d)){return GH.Ajax._handleCurrentUserChanged(d)}var c={},b=null;if(d.responseText){try{c=JSON.parse(d.responseText)}catch(f){}}if(c.errors||c.errorMessages){b=GH.Ajax._convertJiraErrors(c,a)}else{if(c.message){b=GH.Ajax._convertFrameworkErrors(c)}}if(!b){b=GH.Ajax._convertGenericErrors(d,g)}return AJS.$.Deferred().rejectWith(this,[b,d,h,g])}};GH.Ajax.handleContextualErrors=function(b,a,c){a=a||{};if(!b.hasContextualErrors()){return false}AJS.$(b.getContextualErrors()).each(function(e,f){var d=a[f.contextId];if(!d){AJS.$(f.errors).each(function(h,i){b.addGlobalError(i)})}else{if(AJS.$.isFunction(d)){d(f,b)}else{d=AJS.$(d);d.siblings(".ghx-error").remove();var g;if(c){g=c(f)}else{g=GH.tpl.rapid.notification.renderContextualErrors({errors:f.errors})}d.after(g)}}});return true};GH.Ajax.handleGlobalErrors=function(c,b,a){if(!c.hasGlobalErrors()){return false}GH.Notification.showErrors({errors:c.getGlobalErrors()},a);if(b&&(b instanceof Function)){b(c)}return true};GH.Ajax.buildRestUrl=function(a){if(a.indexOf("/")!==0){a="/"+a}return GH.Ajax.buildBareRestUrl(GH.Ajax.REST_URL_BASE+a)};GH.Ajax.buildBareRestUrl=function(a){if(a.indexOf("/")!==0){a="/"+a}return GH.Ajax.CONTEXT_PATH+a};GH.Ajax._createExtendedResult=function(a){if(!a){return GH.Ajax._extendResult({success:true})}else{return GH.Ajax._extendResult({success:a})}};GH.Ajax._extendResult=function(a){return AJS.$.extend(a,{getGlobalErrors:function(){return a.error?a.error.errors:null},getContextualErrors:function(){return a.error?a.error.contextualErrors:null},hasGlobalErrors:function(){return a.error&&a.error.errors&&a.error.errors.length>0},hasContextualErrors:function(){return a.error&&a.error.contextualErrors},addGlobalError:function(b){if(!a.error){a.error={}}if(!a.error.errors){a.error.errors=[]}a.error.errors[a.error.errors.length]=b},getSuccessObject:function(){return a.success},isSuccess:function(){return !a.error}})};GH.Ajax._generateErrorHandler=function(d,b,c,a){return function(e){GH.Ajax.handleContextualErrors(e,b,c);GH.Ajax.handleGlobalErrors(e,d,a)}};GH.Ajax._convertJiraErrors=function(a,e){var c=a.errorMessages?a.errorMessages:[];c=_.map(c,function(f){return{message:f,noAutoescape:e}});var b=a.errors?a.errors:{};b=_.map(b,function(g,f){return{contextId:f,errors:[{message:g,noAutoescape:e}]}});var d={error:{errors:c,contextualErrors:b}};return GH.Ajax._extendResult(d)};GH.Ajax._convertFrameworkErrors=function(a){var b={error:{errors:[{message:a.message}],contextualErrors:[]}};return GH.Ajax._extendResult(b)};GH.Ajax._convertGenericErrors=function(b,c){var a=GH.Ajax._extendResult({});if(b.responseText){GH.log("Got an error response with text that we don't know how to parse: "+b.responseText)}if(b.status===0&&c==="abort"){a.addGlobalError({message:"Request timed out"})}else{if(c){a.addGlobalError({message:c})}else{GH.log("Got an Ajax request error response with empty 'errorThrown' value. Silently logging")}}return a};GH.Ajax._hasUsernameResponseHeader=function(a){return !!a.getResponseHeader("X-AUSERNAME")};GH.Ajax._getUserForResponse=function(a){return a.getResponseHeader("X-AUSERNAME")?decodeURIComponent(a.getResponseHeader("X-AUSERNAME")):"anonymous"};GH.Ajax.getUserFromAJS=function(){var a=AJS.Meta.get("remote-user");return a?a:"anonymous"};GH.Ajax.matchesCurrentUser=function(a){return !a.getResponseHeader||!a.getAllResponseHeaders||!GH.Ajax._hasUsernameResponseHeader(a)||GH.Ajax.getUserFromAJS()===GH.Ajax._getUserForResponse(a)||(a.status===204&&!a.getAllResponseHeaders()&&AJS.$.browser.msie)};GH.Ajax._handleCurrentUserChanged=function(c){var b=GH.Ajax.getUserFromAJS();var a=GH.Ajax._getUserForResponse(c);if(b!=="anonymous"&&a==="anonymous"){GH.log("User changed. original: "+b+" new: "+a+". Redirecting to the login page");location.href=GH.Navigation.getLoginUrl()}else{GH.log("User changed. original: "+b+" new: "+a+". Reloading the page");location.reload()}return AJS.$.Deferred()};;
;/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/viewissue/QuickCreateIssueInEpic.js' */
GH.QuickCreateIssueInEpic={};GH.QuickCreateIssueInEpic.epicKey=null;GH.QuickCreateIssueInEpic.epicName=null;AJS.$(function(){GH.QuickCreateIssueInEpic.init();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(c,a,b){if(b===JIRA.CONTENT_ADDED_REASON.pageLoad){GH.QuickCreateIssueInEpic.init()}});AJS.$(document).undelegate("#gh-create-issue-in-epic-lnk","click");AJS.$(document).delegate("#gh-create-issue-in-epic-lnk","click",function(b){var a=GH.QuickCreateIssueInEpic.createQuickCreateIssueForEpicDialog();a.show();b.preventDefault()})});GH.QuickCreateIssueInEpic.init=function(){var a=AJS.$("#ghx-epic-key").text();var d=AJS.$("#ghx-epic-name").text();var c=AJS.$("#ghx-hide-table").text()=="true";GH.QuickCreateIssueInEpic.epicKey=a;GH.QuickCreateIssueInEpic.epicName=d;JIRA.unbind("QuickCreateIssueInEpic.sessionComplete");JIRA.bind("QuickCreateIssueInEpic.sessionComplete",function(g,f){AJS.$(document).unbind(JIRA.EpicPicker.READY_EVENT);GH.QuickCreateIssueInEpic.handleIssuesCreated(f)});if(c){var b=AJS.$("#ghx-issues-in-epic-table");b.addClass("hidden")}};GH.QuickCreateIssueInEpic.createQuickCreateIssueForEpicDialog=function(){var b=new JIRA.Forms.Container(function(){var d={title:AJS.format("Create issue in epic : {0}",GH.QuickCreateIssueInEpic.epicKey),id:"create-issue-in-epic-form",globalEventNamespaces:["QuickCreateIssueInEpic"]};var c=new JIRA.Forms.CreateIssueModel({projectId:d.pid,issueType:d.issueType}),f=new JIRA.Forms.ConfigurableCreateIssueForm({model:c,title:d.title,globalEventNamespaces:d.globalEventNamespaces}),e=new JIRA.Forms.UnconfigurableCreateIssueForm({model:c,title:d.title,globalEventNamespaces:d.globalEventNamespaces});return{globalEventNamespaces:d.globalEventNamespaces,model:c,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:f,unconfigurableForm:e}});b.bind("contentRefreshed",function(){AJS.$(document).unbind("QuickCreateIssueInEpic.validationError");AJS.$(document).unbind(JIRA.EpicPicker.READY_EVENT);AJS.$(document).bind(JIRA.EpicPicker.READY_EVENT,function(d,c){c.setSelection(new AJS.ItemDescriptor({value:"key:"+GH.QuickCreateIssueInEpic.epicKey,label:GH.QuickCreateIssueInEpic.epicName}));setTimeout(function(){c.disable()},0);AJS.$(document).bind("QuickCreateIssueInEpic.validationError",function(f){c.disable()})})});var a=b.asDialog({windowTitle:AJS.format("Create issue in epic : {0}",GH.QuickCreateIssueInEpic.epicKey),id:"create-issue-dialog"});a.bind("Dialog.hide",function(){AJS.$(document).unbind(JIRA.EpicPicker.READY_EVENT);AJS.$(document).unbind("QuickCreateIssueInEpic.validationError")});return a};GH.QuickCreateIssueInEpic.handleIssuesCreated=function(b){var a=_.pluck(b,"issueKey");GH.QuickCreateIssueInEpic.addIssuesToEpic(b).done(function(){GH.QuickCreateIssueInEpic.refreshIssuesInEpicTable(a)})};GH.QuickCreateIssueInEpic.addIssuesToEpic=function(b){var a=_.pluck(b,"issueKey");var c={ignoreEpics:true,issueKeys:a};return GH.Ajax.put({url:"/epics/"+GH.QuickCreateIssueInEpic.epicKey+"/add",data:c})};GH.QuickCreateIssueInEpic.refreshIssuesInEpicTable=function(a){var b=AJS.$("#greenhopper-epics-issue-web-panel");b.addClass("updating");AJS.$.ajax({url:contextPath+"/secure/ViewIssuesInEpic.jspa?epicKey="+GH.QuickCreateIssueInEpic.epicKey+"&decorator=none"}).done(function(d){b.find(".mod-content").html(d);JIRA.Dropdowns.bindIssueActionsDds(b);AJS.$.each(a,function(g,f){b.find(".issuerow[data-issuekey='"+f+"']").fadeInBackground()});var c=AJS.$("#ghx-issues-in-epic-table");var e=AJS.$("#ghx-hide-table").text()=="true";if(e){c.addClass("hidden")}else{AJS.$("#ghx-issues-in-epic-empty-message").remove();c.removeClass("hidden")}b.removeClass("updating")})};;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:css', location = 'templates/plugins/bamboo/script/common.js' */
(function(c,b,d){var a=require("jira/util/events");if(typeof b.CONFIG==="undefined"){b.CONFIG={$planSelect:c(),$buildTypes:c(),buildResultsContainerId:"bamboo-build-results",stagesContainerId:"bamboo-plan-stages",variablesContainerId:"bamboo-override-variables",initialised:false,updateTimeout:null,init:function(){if(b.CONFIG.initialised){return}c(document).bind("dialogContentReady",function(h){var g=b.CONFIG.buildResultsContainerId,f=b.CONFIG.stagesContainerId,i=b.CONFIG.variablesContainerId;b.CONFIG.$planSelect=c("#bamboo-plan").change(b.CONFIG.onPlanChange);b.CONFIG.BuildResults.init({container:{id:g,insertAfter:b.CONFIG.$planSelect.closest(".field-group")}});b.CONFIG.Stages.init({container:{id:f,insertAfter:"#"+g}});b.CONFIG.Variables.init({container:{id:i,insertAfter:"#"+f}});b.CONFIG.$buildTypes=c("input:radio[name='buildType']").change(b.CONFIG.onBuildTypeChange).filter(":checked").change().end()});b.CONFIG.initialised=true}};b.CONFIG.Spinner=function(e,f){this.beforeShow=f;this.add=function(){return c(bamboo.components.icon({type:"loading"})).appendTo(e)}};b.CONFIG.Spinner.prototype.show=function(){var e=this.$spinner;this.beforeShow();if(!e||(e&&(!e.length||!e.parent().length))){this.$spinner=this.add()}else{e.show()}return this};b.CONFIG.Spinner.prototype.hide=function(){if(this.$spinner){this.$spinner.hide()}return this}}b.CONFIG.onPlanChange=function(l){var h=c("#existing-build").is(":checked"),k=c(this),g=k.add(b.CONFIG.$buildTypes).attr("disabled",true),p=k.find("option:selected"),o=c("#release"),j=(h?p.attr("data-selected-build-result"):null),q=(h?null:p.attr("data-selected-stages")),m=(h?null:p.attr("data-selected-variables")),n,i,f;if(!k.val()){return}o.attr("disabled","disabled");if(m){m=c.parseJSON(m)}b.CONFIG.BuildResults.updateSelectedBuildResult(j);b.CONFIG.Stages.updateSelectedStages(q);b.CONFIG.Variables.updateSelectedVariables(m);b.CONFIG.Variables.hide();if(h){b.CONFIG.Stages.hide();b.CONFIG.BuildResults.showSpinner();n=b.restURL+"history/"+b.jiraProjectKey+"/"+k.val()+"/5";i={continuable:true,buildstate:"successful"};f=function(e){if(e.results.result&&e.results.result.length){o.removeAttr("disabled");b.CONFIG.BuildResults.show(e.results.result)}else{b.CONFIG.BuildResults.showNoResultsMsg()}g.attr("disabled",false)}}else{o.removeAttr("disabled");b.CONFIG.BuildResults.hide();b.CONFIG.Stages.showSpinner();n=b.restURL+"plan/"+b.jiraProjectKey+"/"+k.val();f=function(e){if(e.stages.stage&&e.stages.stage.length){b.CONFIG.Stages.show(e.stages.stage)}else{b.CONFIG.Stages.showNoStagesMsg()}if(e.variableContext.variable&&e.variableContext.variable.length){b.CONFIG.Variables.show(e.variableContext.variable)}g.attr("disabled",false)}}c.ajax({url:n,dataType:"json",data:i,beforeSend:function(){k.attr("disabled","true")},success:f,error:function(x,y){var t,w,r,s,u=c('<div class="form-body"></div><div class="form-footer"><a class="cancel">Cancel</a></div>');u.find(".cancel").click(function(z){if(b.CONFIG.FormDialog&&b.CONFIG.FormDialog.hide){b.CONFIG.FormDialog.hide()}});try{s=x.responseText||x.response;if(s){t=c.parseJSON(s);w=t.message;r=(t.messageBody?"<p>"+t.messageBody+"</p>":null);if(t.oauthCallback){u.filter(".content-footer").prepend('<a href="'+t.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(b.baseURL)+'">Login &amp; Approve</a> | ')}}else{throw"noJSONResponse"}}catch(v){w="An error occurred while trying to retrieve the build information."}AJS.messages.warning(u.filter(".form-body"),{title:w,body:r,closeable:false});k.closest("form").replaceWith(u)},ajaxComplete:function(){k.attr("disabled","false")}})};b.CONFIG.onBuildTypeChange=function(i){var f=c(this),h=f.closest("fieldset.group"),g=h.nextAll(".field-group,.group"),j=c("#"+b.CONFIG.buildResultsContainerId);c("#release").removeAttr("disabled");switch(f.val()){case"no-build":g.hide();h.css({"margin-bottom":0,"padding-bottom":0});break;case"new-build":g.show();j.hide();h.css({"margin-bottom":"","padding-bottom":""});b.CONFIG.$planSelect.change();break;case"existing-build":g.show();h.css({"margin-bottom":"","padding-bottom":""});b.CONFIG.$planSelect.change();break}};b.CONFIG.Stages=(function(){var f={container:{id:null,insertAfter:null,i18n:{legend:"Stages"}},selectedStages:null},m,l,h,i=function(){l=c("<fieldset/>",{id:m.container.id,"class":"group",html:h}).insertAfter(m.container.insertAfter).delegate("input:checkbox","click",j)},e=function(o){var n=false,x,q,z;for(q=0,z=o.length;q<z;q++){var s=o[q],t=!!(s.state&&s.state!="Unknown"),y=!!(s.manual),p=!!(!s.manual||t),r,v,w="stage-"+q,u;if(!n&&s.manual&&!t){n=true}v=c('<input type="checkbox" />').attr({name:"selectedStages",id:w,"class":"checkbox",checked:y,disabled:p}).val(s.name);u=c("<label />",{text:s.name,"for":w});r=c("<div/>",{"class":"checkbox"+(s.manual?(t?" already-run":" manual"):"")+(!n?" selected":"")}).append(v).append(u).appendTo(l);if(!t&&y){x=r}}if(x){x.find("input:checkbox").trigger("click",true)}},g=function(){l.find("div.checkbox,p").remove()},j=function(r,n){if(n){r.preventDefault()}var o=c(this),q=o.is(":checked"),p=false;o.closest("div.checkbox").toggleClass("selected",q).prevAll("div.checkbox").each(function(u){var t=c(this),v=t.children("input:checkbox"),s=t.hasClass("manual");if(q){t.addClass("selected");if(s){v.attr("checked","checked").attr("disabled","disabled")}}else{if(s&&!p){v.removeAttr("disabled");p=true}}}).end().nextAll("div.checkbox").each(function(t){var s=c(this);if(s.hasClass("manual")){return false}else{s.toggleClass("selected",q)}})},k;return{init:function(n){m=c.extend(true,f,n);h="<legend><span>"+m.container.i18n.legend+"</span></legend>";i();k=new b.CONFIG.Spinner(l,g)},show:function(n){l.html(h).show();e(n)},hide:function(){l.hide().html(h)},showNoStagesMsg:function(){k.hide();l.append(c("<p/>",{text:"No stages found."}))},showSpinner:function(){k.show()},updateSelectedStages:function(n){m.selectedStages=n}}})();b.CONFIG.Variables=(function(){var e={container:{id:null,insertAfter:null,i18n:{legend:"Build Variables"}},selectedVariables:null},n,l,m,i,j=function(){l=c("<fieldset/>",{id:n.container.id,"class":"group",html:i}).insertAfter(n.container.insertAfter).delegate("#override-another","click",k).delegate(".bamboo-icon-variable-delete","click",h).delegate("select","change",g)},f=function(t){var o,s,q,r;m=c("<select/>",{"class":"select"});for(q=0,r=t.length;q<r;q++){var p=t[q];if(o!=p.variableType){o=p.variableType;s=c("<optgroup/>",{label:o}).appendTo(m)}c("<option/>",{text:p.key,data:{"server-value":p.value}}).appendTo(s)}},k=function(){var p=m.clone(true),q,r,s,o="";if(arguments.length==2){r=p.find("option[text='"+arguments[0]+"']");o=arguments[1]}else{r=p.find("option:first")}r.attr("selected","selected");s=c('<input type="text" />').attr({name:"variable_"+r.val(),placeholder:r.data("server-value"),"class":"text medium-field"}).val(o);q=c("<div/>",{"class":"field-group"}).append(p).append(s).append(bamboo.components.icon({type:"variable-delete"})).insertBefore(l.children("a"))},h=function(o){c(this).closest(".field-group").remove()},g=function(q){var o=c(this),p=o.find("option:selected");o.nextAll(".text").attr({name:"variable_"+p.val(),placeholder:p.data("server-value")})};return{init:function(o){n=c.extend(true,e,o);i="<legend><span>"+n.container.i18n.legend+'</span></legend><a id="override-another" class="aui-button aui-button-link">Override variable<span class="icon icon-edit-sml"></span></a>';j()},show:function(o){f(o);if(n.selectedVariables&&n.selectedVariables.variables){c.each(n.selectedVariables.variables,k)}l.show()},hide:function(){l.hide().html(i)},updateSelectedVariables:function(o){n.selectedVariables=o}}})();b.CONFIG.BuildResults=(function(){var h={container:{id:null,insertAfter:null,i18n:{legend:"Existing build"}},selectedBuildResult:null},n,m,j,k=function(){m=c("<fieldset/>",{id:n.container.id,"class":"group",html:j}).insertAfter(n.container.insertAfter).delegate("input:radio","change",i).delegate("a","click",function(o){o.preventDefault();window.open(this.href)})},g=function(u){var s,v,q="build-result-"+u.number,o,p=(u.lifeCycleState=="Finished"?(u.continuable?"SuccessfulPartial":u.state):u.lifeCycleState),r=(u.key==n.selectedBuildResult),t=(u.stages.stage&&u.stages.stage.length?u.stages.stage:[]);v=c('<input type="radio" />').attr({name:"buildResult",id:q,"class":"radio",checked:r}).val(u.key).data("stages",t);o=c("<label />",{html:'<a href="'+b.bambooBaseURL+"/browse/"+u.key+'" class="'+p+'">#'+u.number+'</a><span class="trigger-reason">'+b.replaceWithBambooIcon(u.buildReason)+"</span>","for":q}).prepend(bamboo.components.icon({type:p}));s=c("<div/>",{"class":"radio"}).append(v).append(o).appendTo(m);if(r){f(t)}},f=function(o){if(o&&o.length){b.CONFIG.Stages.show(o)}else{b.CONFIG.Stages.showNoStagesMsg()}},e=function(){m.find("div.radio,p").remove()},i=function(o){var p=c(this).data("stages");f(p)},l;return{init:function(o){n=c.extend(true,h,o);j="<legend><span>"+n.container.i18n.legend+"</span></legend>";k();l=new b.CONFIG.Spinner(m,e)},show:function(q){m.html(j).show();if(q.length>0&&!n.selectedBuildResult){n.selectedBuildResult=q[0].key}for(var o=0,p=q.length;o<p;o++){g(q[o])}},hide:function(){m.hide().html(j)},showNoResultsMsg:function(){l.hide();m.append(c("<p/>",{text:"No builds found with unbuilt manual stages."})).show()},showSpinner:function(){l.show()},updateSelectedBuildResult:function(o){n.selectedBuildResult=o}}})();b.flagNotification=function(g,f,e){require(["aui/flag"],function(h){h({type:g,title:f,close:"manual",body:e})})};b.getNewUrlObject=function(f,h){var k=URI.parse(f);var j=URI.parseQuery(k.query);if(h&&h.length>0){for(var g=0;g<h.length;g++){delete j[h[g]];if(k.fragment){var e=new URI("?"+k.fragment);e.removeQuery(h[g]);k.fragment=e.toString().substring(1)}}}k.query=URI.buildQuery(j);return k};b.excludeParamsFromUrl=function(e,f){var g=b.getNewUrlObject(e,f);return URI.build(g)};b.getReloadUrl=function(){return b.excludeParamsFromUrl(window.location.href,["showReleaseDialog"])};b.replaceState=function(e,f){if(window.history.replaceState){var h=b.getNewUrlObject(e,f);var g=URI.build(h);window.history.replaceState(h,"",g)}};b.CheckReleaseBuildStatus=function(f,e){c.ajax({url:b.restURL+"status/"+b.jiraVersionId+"/"+f,dataType:"json",success:function(j){var h=j.bamboo,i=(h.lifeCycleState=="Finished"?(h.continuable?"SuccessfulPartial":h.state):h.lifeCycleState),g;if((h.lifeCycleState!="InProgress"&&h.lifeCycleState!="Queued")||(j.jira&&j.jira.forceRefresh)){AJS.reloadViaWindowLocation(b.getReloadUrl());return}else{if(h.lifeCycleState=="InProgress"&&h.progress){if(!e){g=c("#build-details");e=c(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:h.progress.prettyBuildTime+" &ndash; <span>"+h.progress.prettyTimeRemaining+"</span>"})).appendTo(g).find("dd");g.find(".build + dd > span.bamboo-icon").replaceWith(bamboo.components.icon({type:i}))}else{e.html(h.progress.prettyBuildTime+" &ndash; <span>"+h.progress.prettyTimeRemaining+"</span>")}clearTimeout(b.CONFIG.updateTimeout);b.CONFIG.updateTimeout=setTimeout(function(){b.CheckReleaseBuildStatus(f,e)},5000)}}},error:function(m,n){var j,l,h,i,g=c("#build-details").empty();try{i=m.responseText||m.response;if(i){j=c.parseJSON(i);l=j.message;h=(j.messageBody?"<p>"+j.messageBody+"</p>":"");if(j.oauthCallback){h+='<p><a href="'+j.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(b.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(k){l="An error occurred while trying to retrieve the build information."}b.flagNotification("warning",l,h)}})};b.ShowBuildReleaseDetails=function(g){var f=c("#build-details"),e=c(bamboo.components.icon({type:"loading"}));if(f.length){e.appendTo(f);c.ajax({url:b.restURL+"status/"+b.jiraVersionId+"/"+g,dataType:"json",success:function(k){var h=k.bamboo,i=(h.lifeCycleState=="Finished"?(h.continuable?"SuccessfulPartial":h.state):h.lifeCycleState),j;if(k.jira&&k.jira.forceRefresh){AJS.reloadViaWindowLocation(b.getReloadUrl());return}e.remove();f.append(bamboo.components.buildDetail({key:"Build",keyClass:"build",value:bamboo.components.icon({type:i})+' <a class="build-link" href="'+b.bambooBaseURL+"/browse/"+g+'" title="'+h.planName+'"><span class="'+i+'">#'+h.number+"</span> "+h.planName+"</a>"}));if(h.lifeCycleState=="InProgress"||h.lifeCycleState=="Queued"){if(h.lifeCycleState=="InProgress"&&h.progress){j=c(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:h.progress.prettyBuildTime+" &ndash; <span>"+h.progress.prettyTimeRemaining+"</span>"})).appendTo(f).find("dd")}clearTimeout(b.CONFIG.updateTimeout);b.CONFIG.updateTimeout=setTimeout(function(){b.CheckReleaseBuildStatus(g,j)},5000)}else{if(h.lifeCycleState=="Finished"){if(h.buildCompletedTime){f.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+h.buildCompletedTime+'">'+h.buildRelativeTime+"</time>"}))}}else{if(h.lifeCycleState=="NotBuilt"){if(h.buildCompletedTime){f.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+h.buildCompletedTime+'">'+h.buildRelativeTime+"</time>"}))}}}}if(h.artifacts.artifact&&h.artifacts.artifact.length){f.append(bamboo.components.buildDetail({key:"Artifacts",keyClass:"artifacts",value:bamboo.components.artifacts({artifacts:h.artifacts.artifact})}))}},error:function(m,n){var j,l,h,i;e.remove();try{i=m.responseText||m.response;if(i){j=c.parseJSON(i);l=j.message;h=(j.messageBody?"<p>"+j.messageBody+"</p>":"");if(j.oauthCallback){h+='<p><a href="'+j.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(b.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(k){l="An error occurred while trying to retrieve the build information."}b.flagNotification("warning",l,h)}})}};b.replaceWithBambooIcon=function(e){return e.replace(/(\b)icon(\b)/g,"$1bamboo-icon$2")};b.clearReleaseErrors=function(){var e=b.restURL+"errors/"+b.jiraVersionId;c.ajax({url:e,type:"DELETE"}).done(function(f){})};b.publishAnalyticsForReleaseClicked=function(f,g,e){AJS.trigger("analyticsEvent",{name:"jira.project.versions.version-detail.release.clicked",data:{versionId:f,overdue:g,daysRemaining:e}})};b.publishAnalyticsForReleaseDialogClicked=function(f,e){AJS.trigger("analyticsEvent",{name:"jira.project.versions.version-detail.release.dialog.clicked",data:{versionId:f,released:e}})};b.init=function(f){b.CONFIG.init();var e=c("#runRelease",f);if(e.length){b.CONFIG.FormDialog=new JIRA.FormDialog({trigger:e,widthClass:"large",autoClose:true});a.bind("dialogContentReady",function(g,p,l){var n=AJS.$('#release-form-date-picker input[title="currentReleaseDate"]').val();var j=AJS.$('#release-form-date-picker input[title="formattedReleaseDate"]').val();var k=AJS.$('#release-form-date-picker input[title="firstDay"]').val();var o=AJS.$('#release-form-date-picker input[title="currentMillis"]').val();var i=AJS.$('#release-form-date-picker input[title="useISO8601"]').val();var h=AJS.$('#release-form-date-picker input[title="dateFormat"]').val();var m=AJS.$("#release-form-release-date-field")[0];d.setup({singleClick:true,align:"Bl",firstDay:k,button:AJS.$("#release-form-release-date-trigger")[0],inputField:m,currentMillis:o,useISO8601WeekNumbers:i,ifFormat:h});if(typeof j==="string"&&j.length>0){m.value=j}});if(e.attr("href").indexOf("redirectUrlOnSuccess")===-1){e.attr("href",e.attr("href")+"&redirectUrlOnSuccess="+URI.encode(b.getReloadUrl()))}if(/showReleaseDialog=true/.test(window.location.href)){b.replaceState(window.location.href,["showReleaseDialog"]);e.click()}}};c(function(){b.init(AJS.$(document))});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f,g){if(g===JIRA.CONTENT_ADDED_REASON.tabUpdated){b.init(f)}})}(AJS.$,window.JBAM=(window.JBAM||{}),Calendar));;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:css', location = 'templates/plugins/bamboo/script/uri/URI.js' */
/*! URI.js v1.14.1 http://medialize.github.io/URI.js/ */
(function(b,a){"object"===typeof exports?module.exports=a(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"===typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],a):b.URI=a(b.punycode,b.IPv6,b.SecondLevelDomains,b)})(this,function(R,o,K,S){function U(e,d){if(!(this instanceof U)){return new U(e,d)}void 0===e&&(e="undefined"!==typeof location?location.href+"":"");this.href(e);return void 0!==d?this.absoluteTo(d):this}function N(d){return d.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function g(d){return void 0===d?"Undefined":String(Object.prototype.toString.call(d)).slice(8,-1)}function T(d){return"Array"===g(d)}function i(l,d){var q,p;if(T(d)){q=0;for(p=d.length;q<p;q++){if(!i(l,d[q])){return !1}}return !0}var m=g(d);q=0;for(p=l.length;q<p;q++){if("RegExp"===m){if("string"===typeof l[q]&&l[q].match(d)){return !0}}else{if(l[q]===d){return !0}}}return !1}function Q(l,d){if(!T(l)||!T(d)||l.length!==d.length){return !1}l.sort();d.sort();for(var p=0,m=l.length;p<m;p++){if(l[p]!==d[p]){return !1}}return !0}function s(d){return escape(d)}function c(d){return encodeURIComponent(d).replace(/[!'()*]/g,s).replace(/\*/g,"%2A")}function k(d){return function(e,l){if(void 0===e){return this._parts[d]||""}this._parts[d]=e||null;this.build(!l);return this}}function O(e,d){return function(m,l){if(void 0===m){return this._parts[e]||""}null!==m&&(m+="",m.charAt(0)===d&&(m=m.substring(1)));this._parts[e]=m;this.build(!l);return this}}var n=S&&S.URI;U.version="1.14.1";var V=U.prototype,P=Object.prototype.hasOwnProperty;U._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:U.duplicateQueryParameters,escapeQuerySpace:U.escapeQuerySpace}};U.duplicateQueryParameters=!1;U.escapeQuerySpace=!0;U.protocol_expression=/^[a-z][a-z0-9.+-]*$/i;U.idn_expression=/[^a-z0-9\.-]/i;U.punycode_expression=/(xn--)/i;U.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;U.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;U.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/ig;U.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u201e\u2018\u2019]+$/};U.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"};U.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;U.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"};U.getDomAttribute=function(e){if(e&&e.nodeName){var d=e.nodeName.toLowerCase();return"input"===d&&"image"!==e.type?void 0:U.domAttributes[d]}};U.encode=c;U.decode=decodeURIComponent;U.iso8859=function(){U.encode=escape;U.decode=unescape};U.unicode=function(){U.encode=c;U.decode=decodeURIComponent};U.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}};U.encodeQuery=function(e,d){var l=U.encode(e+"");void 0===d&&(d=U.escapeQuerySpace);return d?l.replace(/%20/g,"+"):l};U.decodeQuery=function(e,d){e+="";void 0===d&&(d=U.escapeQuerySpace);try{return U.decode(d?e.replace(/\+/g,"%20"):e)}catch(l){return e}};U.recodePath=function(e){e=(e+"").split("/");for(var d=0,l=e.length;d<l;d++){e[d]=U.encodePathSegment(U.decode(e[d]))}return e.join("/")};U.decodePath=function(e){e=(e+"").split("/");for(var d=0,l=e.length;d<l;d++){e[d]=U.decodePathSegment(e[d])}return e.join("/")};var M={encode:"encode",decode:"decode"},a,L=function(e,d){return function(m){try{return U[d](m+"").replace(U.characters[e][d].expression,function(p){return U.characters[e][d].map[p]})}catch(l){return m}}};for(a in M){U[a+"PathSegment"]=L("pathname",M[a])}U.encodeReserved=L("reserved","encode");U.parse=function(e,d){var l;d||(d={});l=e.indexOf("#");-1<l&&(d.fragment=e.substring(l+1)||null,e=e.substring(0,l));l=e.indexOf("?");-1<l&&(d.query=e.substring(l+1)||null,e=e.substring(0,l));"//"===e.substring(0,2)?(d.protocol=null,e=e.substring(2),e=U.parseAuthority(e,d)):(l=e.indexOf(":"),-1<l&&(d.protocol=e.substring(0,l)||null,d.protocol&&!d.protocol.match(U.protocol_expression)?d.protocol=void 0:"//"===e.substring(l+1,l+3)?(e=e.substring(l+3),e=U.parseAuthority(e,d)):(e=e.substring(l+1),d.urn=!0)));d.path=e;return d};U.parseHost=function(l,d){var p=l.indexOf("/"),m;-1===p&&(p=l.length);"["===l.charAt(0)?(m=l.indexOf("]"),d.hostname=l.substring(1,m)||null,d.port=l.substring(m+2,p)||null,"/"===d.port&&(d.port=null)):l.indexOf(":")!==l.lastIndexOf(":")?(d.hostname=l.substring(0,p)||null,d.port=null):(m=l.substring(0,p).split(":"),d.hostname=m[0]||null,d.port=m[1]||null);d.hostname&&"/"!==l.substring(p).charAt(0)&&(p++,l="/"+l);return l.substring(p)||"/"};U.parseAuthority=function(e,d){e=U.parseUserinfo(e,d);return U.parseHost(e,d)};U.parseUserinfo=function(e,d){var m=e.indexOf("/"),l=e.lastIndexOf("@",-1<m?m:e.length-1);-1<l&&(-1===m||l<m)?(m=e.substring(0,l).split(":"),d.username=m[0]?U.decode(m[0]):null,m.shift(),d.password=m[0]?U.decode(m.join(":")):null,e=e.substring(l+1)):(d.username=null,d.password=null);return e};U.parseQuery=function(l,e){if(!l){return{}}l=l.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!l){return{}}for(var u={},q=l.split("&"),p=q.length,r,m,t=0;t<p;t++){r=q[t].split("="),m=U.decodeQuery(r.shift(),e),r=r.length?U.decodeQuery(r.join("="),e):null,P.call(u,m)?("string"===typeof u[m]&&(u[m]=[u[m]]),u[m].push(r)):u[m]=r}return u};U.build=function(e){var d="";e.protocol&&(d+=e.protocol+":");e.urn||!d&&!e.hostname||(d+="//");d+=U.buildAuthority(e)||"";"string"===typeof e.path&&("/"!==e.path.charAt(0)&&"string"===typeof e.hostname&&(d+="/"),d+=e.path);"string"===typeof e.query&&e.query&&(d+="?"+e.query);"string"===typeof e.fragment&&e.fragment&&(d+="#"+e.fragment);return d};U.buildHost=function(e){var d="";if(e.hostname){d=U.ip6_expression.test(e.hostname)?d+("["+e.hostname+"]"):d+e.hostname}else{return""}e.port&&(d+=":"+e.port);return d};U.buildAuthority=function(d){return U.buildUserinfo(d)+U.buildHost(d)};U.buildUserinfo=function(e){var d="";e.username&&(d+=U.encode(e.username),e.password&&(d+=":"+U.encode(e.password)),d+="@");return d};U.buildQuery=function(l,e,u){var q="",p,r,m,t;for(r in l){if(P.call(l,r)&&r){if(T(l[r])){for(p={},m=0,t=l[r].length;m<t;m++){void 0!==l[r][m]&&void 0===p[l[r][m]+""]&&(q+="&"+U.buildQueryParameter(r,l[r][m],u),!0!==e&&(p[l[r][m]+""]=!0))}}else{void 0!==l[r]&&(q+="&"+U.buildQueryParameter(r,l[r],u))}}}return q.substring(1)};U.buildQueryParameter=function(e,d,l){return U.encodeQuery(e,l)+(null!==d?"="+U.encodeQuery(d,l):"")};U.addQuery=function(e,d,m){if("object"===typeof d){for(var l in d){P.call(d,l)&&U.addQuery(e,l,d[l])}}else{if("string"===typeof d){void 0===e[d]?e[d]=m:("string"===typeof e[d]&&(e[d]=[e[d]]),T(m)||(m=[m]),e[d]=(e[d]||[]).concat(m))}else{throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")}}};U.removeQuery=function(l,e,t){var q;if(T(e)){for(t=0,q=e.length;t<q;t++){l[e[t]]=void 0}}else{if("object"===typeof e){for(q in e){P.call(e,q)&&U.removeQuery(l,q,e[q])}}else{if("string"===typeof e){if(void 0!==t){if(l[e]===t){l[e]=void 0}else{if(T(l[e])){q=l[e];var r={},p,m;if(T(t)){for(p=0,m=t.length;p<m;p++){r[t[p]]=!0}}else{r[t]=!0}p=0;for(m=q.length;p<m;p++){void 0!==r[q[p]]&&(q.splice(p,1),m--,p--)}l[e]=q}}}else{l[e]=void 0}}else{throw new TypeError("URI.removeQuery() accepts an object, string as the first parameter")}}}};U.hasQuery=function(l,e,q,m){if("object"===typeof e){for(var p in e){if(P.call(e,p)&&!U.hasQuery(l,p,e[p])){return !1}}return !0}if("string"!==typeof e){throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter")}switch(g(q)){case"Undefined":return e in l;case"Boolean":return l=Boolean(T(l[e])?l[e].length:l[e]),q===l;case"Function":return !!q(l[e],e,l);case"Array":return T(l[e])?(m?i:Q)(l[e],q):!1;case"RegExp":return T(l[e])?m?i(l[e],q):!1:Boolean(l[e]&&l[e].match(q));case"Number":q=String(q);case"String":return T(l[e])?m?i(l[e],q):!1:l[e]===q;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}};U.commonPath=function(l,d){var p=Math.min(l.length,d.length),m;for(m=0;m<p;m++){if(l.charAt(m)!==d.charAt(m)){m--;break}}if(1>m){return l.charAt(0)===d.charAt(0)&&"/"===l.charAt(0)?"/":""}if("/"!==l.charAt(m)||"/"!==d.charAt(m)){m=l.substring(0,m).lastIndexOf("/")}return l.substring(0,m+1)};U.withinString=function(y,x,w){w||(w={});var u=w.start||U.findUri.start,v=w.end||U.findUri.end,t=w.trim||U.findUri.trim,r=/[a-z0-9-]=["']?$/i;for(u.lastIndex=0;;){var e=u.exec(y);if(!e){break}e=e.index;if(w.ignoreHtml){var q=y.slice(Math.max(e-3,0),e);if(q&&r.test(q)){continue}}var q=e+y.slice(e).search(v),p=y.slice(e,q).replace(t,"");w.ignore&&w.ignore.test(p)||(q=e+p.length,p=x(p,e,q,y),y=y.slice(0,e)+p+y.slice(q),u.lastIndex=e+p.length)}u.lastIndex=0;return y};U.ensureValidHostname=function(d){if(d.match(U.invalid_hostname_characters)){if(!R){throw new TypeError('Hostname "'+d+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available')}if(R.toASCII(d).match(U.invalid_hostname_characters)){throw new TypeError('Hostname "'+d+'" contains characters other than [A-Z0-9.-]')}}};U.noConflict=function(d){if(d){return d={URI:this.noConflict()},S.URITemplate&&"function"===typeof S.URITemplate.noConflict&&(d.URITemplate=S.URITemplate.noConflict()),S.IPv6&&"function"===typeof S.IPv6.noConflict&&(d.IPv6=S.IPv6.noConflict()),S.SecondLevelDomains&&"function"===typeof S.SecondLevelDomains.noConflict&&(d.SecondLevelDomains=S.SecondLevelDomains.noConflict()),d}S.URI===this&&(S.URI=n);return this};V.build=function(d){if(!0===d){this._deferred_build=!0}else{if(void 0===d||this._deferred_build){this._string=U.build(this._parts),this._deferred_build=!1}}return this};V.clone=function(){return new U(this)};V.valueOf=V.toString=function(){return this.build(!1)._string};V.protocol=k("protocol");V.username=k("username");V.password=k("password");V.hostname=k("hostname");V.port=k("port");V.query=O("query","?");V.fragment=O("fragment","#");V.search=function(e,d){var l=this.query(e,d);return"string"===typeof l&&l.length?"?"+l:l};V.hash=function(e,d){var l=this.fragment(e,d);return"string"===typeof l&&l.length?"#"+l:l};V.pathname=function(e,d){if(void 0===e||!0===e){var l=this._parts.path||(this._parts.hostname?"/":"");return e?U.decodePath(l):l}this._parts.path=e?U.recodePath(e):"/";this.build(!d);return this};V.path=V.pathname;V.href=function(l,e){var q;if(void 0===l){return this.toString()}this._string="";this._parts=U._parts();var m=l instanceof U,p="object"===typeof l&&(l.hostname||l.path||l.pathname);l.nodeName&&(p=U.getDomAttribute(l),l=l[p]||"",p=!1);!m&&p&&void 0!==l.pathname&&(l=l.toString());if("string"===typeof l||l instanceof String){this._parts=U.parse(String(l),this._parts)}else{if(m||p){for(q in m=m?l._parts:l,m){P.call(this._parts,q)&&(this._parts[q]=m[q])}}else{throw new TypeError("invalid input")}}this.build(!e);return this};V.is=function(x){var w=!1,v=!1,t=!1,u=!1,r=!1,q=!1,p=!1,e=!this._parts.urn;this._parts.hostname&&(e=!1,v=U.ip4_expression.test(this._parts.hostname),t=U.ip6_expression.test(this._parts.hostname),w=v||t,r=(u=!w)&&K&&K.has(this._parts.hostname),q=u&&U.idn_expression.test(this._parts.hostname),p=u&&U.punycode_expression.test(this._parts.hostname));switch(x.toLowerCase()){case"relative":return e;case"absolute":return !e;case"domain":case"name":return u;case"sld":return r;case"ip":return w;case"ip4":case"ipv4":case"inet4":return v;case"ip6":case"ipv6":case"inet6":return t;case"idn":return q;case"url":return !this._parts.urn;case"urn":return !!this._parts.urn;case"punycode":return p}return null};var j=V.protocol,h=V.port,f=V.hostname;V.protocol=function(e,d){if(void 0!==e&&e&&(e=e.replace(/:(\/\/)?$/,""),!e.match(U.protocol_expression))){throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]")}return j.call(this,e,d)};V.scheme=V.protocol;V.port=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0!==e&&(0===e&&(e=null),e&&(e+="",":"===e.charAt(0)&&(e=e.substring(1)),e.match(/[^0-9]/)))){throw new TypeError('Port "'+e+'" contains characters other than [0-9]')}return h.call(this,e,d)};V.hostname=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0!==e){var l={};U.parseHost(e,l);e=l.hostname}return f.call(this,e,d)};V.host=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){return this._parts.hostname?U.buildHost(this._parts):""}U.parseHost(e,this._parts);this.build(!d);return this};V.authority=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){return this._parts.hostname?U.buildAuthority(this._parts):""}U.parseAuthority(e,this._parts);this.build(!d);return this};V.userinfo=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){if(!this._parts.username){return""}var l=U.buildUserinfo(this._parts);return l.substring(0,l.length-1)}"@"!==e[e.length-1]&&(e+="@");U.parseUserinfo(e,this._parts);this.build(!d);return this};V.resource=function(e,d){var l;if(void 0===e){return this.path()+this.search()+this.hash()}l=U.parse(e);this._parts.path=l.path;this._parts.query=l.query;this._parts.fragment=l.fragment;this.build(!d);return this};V.subdomain=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e){if(!this._parts.hostname||this.is("IP")){return""}var l=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,l)||""}l=this._parts.hostname.length-this.domain().length;l=this._parts.hostname.substring(0,l);l=new RegExp("^"+N(l));e&&"."!==e.charAt(e.length-1)&&(e+=".");e&&U.ensureValidHostname(e);this._parts.hostname=this._parts.hostname.replace(l,e);this.build(!d);return this};V.domain=function(e,d){if(this._parts.urn){return void 0===e?"":this}"boolean"===typeof e&&(d=e,e=void 0);if(void 0===e){if(!this._parts.hostname||this.is("IP")){return""}var l=this._parts.hostname.match(/\./g);if(l&&2>l.length){return this._parts.hostname}l=this._parts.hostname.length-this.tld(d).length-1;l=this._parts.hostname.lastIndexOf(".",l-1)+1;return this._parts.hostname.substring(l)||""}if(!e){throw new TypeError("cannot set domain empty")}U.ensureValidHostname(e);!this._parts.hostname||this.is("IP")?this._parts.hostname=e:(l=new RegExp(N(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(l,e));this.build(!d);return this};V.tld=function(e,d){if(this._parts.urn){return void 0===e?"":this}"boolean"===typeof e&&(d=e,e=void 0);if(void 0===e){if(!this._parts.hostname||this.is("IP")){return""}var l=this._parts.hostname.lastIndexOf("."),l=this._parts.hostname.substring(l+1);return !0!==d&&K&&K.list[l.toLowerCase()]?K.get(this._parts.hostname)||l:l}if(e){if(e.match(/[^a-zA-Z0-9-]/)){if(K&&K.is(e)){l=new RegExp(N(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(l,e)}else{throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]')}}else{if(!this._parts.hostname||this.is("IP")){throw new ReferenceError("cannot set TLD on non-domain host")}l=new RegExp(N(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(l,e)}}else{throw new TypeError("cannot set TLD empty")}this.build(!d);return this};V.directory=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname){return""}if("/"===this._parts.path){return"/"}var l=this._parts.path.length-this.filename().length-1,l=this._parts.path.substring(0,l)||(this._parts.hostname?"/":"");return e?U.decodePath(l):l}l=this._parts.path.length-this.filename().length;l=this._parts.path.substring(0,l);l=new RegExp("^"+N(l));this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e));e&&"/"!==e.charAt(e.length-1)&&(e+="/");e=U.recodePath(e);this._parts.path=this._parts.path.replace(l,e);this.build(!d);return this};V.filename=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path){return""}var m=this._parts.path.lastIndexOf("/"),m=this._parts.path.substring(m+1);return e?U.decodePathSegment(m):m}m=!1;"/"===e.charAt(0)&&(e=e.substring(1));e.match(/\.?\//)&&(m=!0);var l=new RegExp(N(this.filename())+"$");e=U.recodePath(e);this._parts.path=this._parts.path.replace(l,e);m?this.normalizePath(d):this.build(!d);return this};V.suffix=function(e,d){if(this._parts.urn){return void 0===e?"":this}if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path){return""}var m=this.filename(),l=m.lastIndexOf(".");if(-1===l){return""}m=m.substring(l+1);m=/^[a-z0-9%]+$/i.test(m)?m:"";return e?U.decodePathSegment(m):m}"."===e.charAt(0)&&(e=e.substring(1));if(m=this.suffix()){l=e?new RegExp(N(m)+"$"):new RegExp(N("."+m)+"$")}else{if(!e){return this}this._parts.path+="."+U.recodePath(e)}l&&(e=U.recodePath(e),this._parts.path=this._parts.path.replace(l,e));this.build(!d);return this};V.segment=function(m,l,u){var r=this._parts.urn?":":"/",t=this.path(),q="/"===t.substring(0,1),t=t.split(r);void 0!==m&&"number"!==typeof m&&(u=l,l=m,m=void 0);if(void 0!==m&&"number"!==typeof m){throw Error('Bad segment "'+m+'", must be 0-based integer')}q&&t.shift();0>m&&(m=Math.max(t.length+m,0));if(void 0===l){return void 0===m?t:t[m]}if(null===m||void 0===t[m]){if(T(l)){t=[];m=0;for(var p=l.length;m<p;m++){if(l[m].length||t.length&&t[t.length-1].length){t.length&&!t[t.length-1].length&&t.pop(),t.push(l[m])}}}else{if(l||"string"===typeof l){""===t[t.length-1]?t[t.length-1]=l:t.push(l)}}}else{l?t[m]=l:t.splice(m,1)}q&&t.unshift("");return this.path(t.join(r),u)};V.segmentCoded=function(l,e,q){var p,m;"number"!==typeof l&&(q=e,e=l,l=void 0);if(void 0===e){l=this.segment(l,e,q);if(T(l)){for(p=0,m=l.length;p<m;p++){l[p]=U.decode(l[p])}}else{l=void 0!==l?U.decode(l):void 0}return l}if(T(e)){for(p=0,m=e.length;p<m;p++){e[p]=U.decode(e[p])}}else{e="string"===typeof e||e instanceof String?U.encode(e):e}return this.segment(l,e,q)};var b=V.query;V.query=function(l,e){if(!0===l){return U.parseQuery(this._parts.query,this._parts.escapeQuerySpace)}if("function"===typeof l){var p=U.parseQuery(this._parts.query,this._parts.escapeQuerySpace),m=l.call(this,p);this._parts.query=U.buildQuery(m||p,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);this.build(!e);return this}return void 0!==l&&"string"!==typeof l?(this._parts.query=U.buildQuery(l,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this):b.call(this,l,e)};V.setQuery=function(l,e,q){var p=U.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"===typeof l||l instanceof String){p[l]=void 0!==e?e:null}else{if("object"===typeof l){for(var m in l){P.call(l,m)&&(p[m]=l[m])}}else{throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")}}this._parts.query=U.buildQuery(p,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof l&&(q=e);this.build(!q);return this};V.addQuery=function(l,e,p){var m=U.parseQuery(this._parts.query,this._parts.escapeQuerySpace);U.addQuery(m,l,void 0===e?null:e);this._parts.query=U.buildQuery(m,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof l&&(p=e);this.build(!p);return this};V.removeQuery=function(l,e,p){var m=U.parseQuery(this._parts.query,this._parts.escapeQuerySpace);U.removeQuery(m,l,e);this._parts.query=U.buildQuery(m,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof l&&(p=e);this.build(!p);return this};V.hasQuery=function(l,e,p){var m=U.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return U.hasQuery(m,l,e,p)};V.setSearch=V.setQuery;V.addSearch=V.addQuery;V.removeSearch=V.removeQuery;V.hasSearch=V.hasQuery;V.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()};V.normalizeProtocol=function(d){"string"===typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!d));return this};V.normalizeHostname=function(d){this._parts.hostname&&(this.is("IDN")&&R?this._parts.hostname=R.toASCII(this._parts.hostname):this.is("IPv6")&&o&&(this._parts.hostname=o.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!d));return this};V.normalizePort=function(d){"string"===typeof this._parts.protocol&&this._parts.port===U.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!d));return this};V.normalizePath=function(l){if(this._parts.urn||!this._parts.path||"/"===this._parts.path){return this}var e,r=this._parts.path,q="",m,p;"/"!==r.charAt(0)&&(e=!0,r="/"+r);r=r.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/");e&&(q=r.substring(1).match(/^(\.\.\/)+/)||"")&&(q=q[0]);for(;;){m=r.indexOf("/..");if(-1===m){break}else{if(0===m){r=r.substring(3);continue}}p=r.substring(0,m).lastIndexOf("/");-1===p&&(p=m);r=r.substring(0,p)+r.substring(m+3)}e&&this.is("relative")&&(r=q+r.substring(1));r=U.recodePath(r);this._parts.path=r;this.build(!l);return this};V.normalizePathname=V.normalizePath;V.normalizeQuery=function(d){"string"===typeof this._parts.query&&(this._parts.query.length?this.query(U.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!d));return this};V.normalizeFragment=function(d){this._parts.fragment||(this._parts.fragment=null,this.build(!d));return this};V.normalizeSearch=V.normalizeQuery;V.normalizeHash=V.normalizeFragment;V.iso8859=function(){var e=U.encode,d=U.decode;U.encode=escape;U.decode=decodeURIComponent;this.normalize();U.encode=e;U.decode=d;return this};V.unicode=function(){var e=U.encode,d=U.decode;U.encode=c;U.decode=unescape;this.normalize();U.encode=e;U.decode=d;return this};V.readable=function(){var l=this.clone();l.username("").password("").normalize();var e="";l._parts.protocol&&(e+=l._parts.protocol+"://");l._parts.hostname&&(l.is("punycode")&&R?(e+=R.toUnicode(l._parts.hostname),l._parts.port&&(e+=":"+l._parts.port)):e+=l.host());l._parts.hostname&&l._parts.path&&"/"!==l._parts.path.charAt(0)&&(e+="/");e+=l.path(!0);if(l._parts.query){for(var t="",r=0,p=l._parts.query.split("&"),q=p.length;r<q;r++){var m=(p[r]||"").split("="),t=t+("&"+U.decodeQuery(m[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"));void 0!==m[1]&&(t+="="+U.decodeQuery(m[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}e+="?"+t.substring(1)}return e+=U.decodeQuery(l.hash(),!0)};V.absoluteTo=function(l){var e=this.clone(),q=["protocol","username","password","hostname","port"],p,m;if(this._parts.urn){throw Error("URNs do not have any generally defined hierarchical components")}l instanceof U||(l=new U(l));e._parts.protocol||(e._parts.protocol=l._parts.protocol);if(this._parts.hostname){return e}for(p=0;m=q[p];p++){e._parts[m]=l._parts[m]}e._parts.path?".."===e._parts.path.substring(-2)&&(e._parts.path+="/"):(e._parts.path=l._parts.path,e._parts.query||(e._parts.query=l._parts.query));"/"!==e.path().charAt(0)&&(l=l.directory(),e._parts.path=(l?l+"/":"")+e._parts.path,e.normalizePath());e.build();return e};V.relativeTo=function(l){var e=this.clone().normalize(),r,q,m,p;if(e._parts.urn){throw Error("URNs do not have any generally defined hierarchical components")}l=(new U(l)).normalize();r=e._parts;q=l._parts;m=e.path();p=l.path();if("/"!==m.charAt(0)){throw Error("URI is already relative")}if("/"!==p.charAt(0)){throw Error("Cannot calculate a URI relative to another relative URI")}r.protocol===q.protocol&&(r.protocol=null);if(r.username===q.username&&r.password===q.password&&null===r.protocol&&null===r.username&&null===r.password&&r.hostname===q.hostname&&r.port===q.port){r.hostname=null,r.port=null}else{return e.build()}if(m===p){return r.path="",e.build()}l=U.commonPath(e.path(),l.path());if(!l){return e.build()}q=q.path.substring(l.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");r.path=q+r.path.substring(l.length);return e.build()};V.equals=function(l){var e=this.clone();l=new U(l);var r={},q={},m={},p;e.normalize();l.normalize();if(e.toString()===l.toString()){return !0}r=e.query();q=l.query();e.query("");l.query("");if(e.toString()!==l.toString()||r.length!==q.length){return !1}r=U.parseQuery(r,this._parts.escapeQuerySpace);q=U.parseQuery(q,this._parts.escapeQuerySpace);for(p in r){if(P.call(r,p)){if(!T(r[p])){if(r[p]!==q[p]){return !1}}else{if(!Q(r[p],q[p])){return !1}}m[p]=!0}}for(p in q){if(P.call(q,p)&&!m[p]){return !1}}return !0};V.duplicateQueryParameters=function(d){this._parts.duplicateQueryParameters=!!d;return this};V.escapeQuerySpace=function(d){this._parts.escapeQuerySpace=!!d;return this};return U});;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/backbone-brace/backbone.brace.min.js' */
//     Backbone Brace - 2012/10/29
//     Copyright 2012 Atlassian Software Systems Pty Ltd
//     Licensed under the Apache License, Version 2.0
(function(){function i(e){return n.isArray(e)?n.reduce(e,function(e,t){return e[t]=null,e},{}):e}function s(e,t){if(!e||t==null)return t;if(typeof e=="string"||e instanceof String){if(typeof t!=""+e)throw"The typeof "+t+" is "+typeof t+" but expected it to be "+e;return t}if(n.isArray(e)||e===Array){if(!u(t))throw"Array type expected, but nonnull, non-Array value provided.";return e===Array||!e[0]?t:n.map(t,n.bind(s,null,e[0]))}if(typeof e!="function")throw"Invalid expected type "+e+". Should be falsy, String, Array, Backbone.Collection constructor, or function.";return t instanceof e?t:o(e)?new e(s([e.model],t)):new e(t)}function o(e,t){return e&&(e.__super__ instanceof(t||r.Collection)||e.__super__===(t||r.Collection).prototype||e===(t||r.Collection))}function u(e){return n.has(e,"length")&&!(e instanceof String||n.has({string:1,"function":1},typeof e)||e instanceof r.Collection)}function a(e,t){var r={};return n.each(e,function(e,n){if(!!t[n]&&!f(e,t[n])){if(!e||f(t[n],e))return;throw n+" has conflicted type descriptors."}r[n]=e}),r}function f(e,t){return!t||t===e?!0:!e||typeof e=="string"?!1:e instanceof Array?t===Array||t instanceof Array&&f(e[0],t[0]):typeof t!="function"?!1:o(t)?o(e,t):e.prototype instanceof t}function l(e){return n.isObject(e)?n.reduce(e,function(e,t,r){return t&&n.isFunction(t.toJSON)?e[r]=t.toJSON():n.isArray(t)&&(e[r]=n.map(t,function(e){return e&&n.isFunction(e.toJSON)?e.toJSON():e})),e},e):e}function c(e){return function(){var n=e.call(this);return l(n)}}function h(e){return function r(s,o){var u,a=n.extend({},s),f;return s&&s.mixins&&(f=s.mixins,delete a.mixins),u=e.call(this,a,o),this.prototype.namedEvents&&t.Mixins.applyMixin(u,{namedEvents:this.prototype.namedEvents}),this.prototype.namedAttributes&&t.Mixins.applyMixin(u,{namedAttributes:this.prototype.namedAttributes}),f&&n.each(s.mixins,function(e){t.Mixins.applyMixin(u,e)}),u.prototype.namedEvents&&t.Mixins.applyMixin(u,t.EventsMixinCreator.create(u.prototype.namedEvents)),u.prototype.namedAttributes&&(u.prototype.namedAttributes=i(u.prototype.namedAttributes),t.Mixins.applyMixin(u,t.AttributesMixinCreator.create(u.prototype.namedAttributes))),u.prototype.toJSON&&(u.prototype.toJSON=c(u.prototype.toJSON)),u.extend=r,u}}function p(e,t){var r=e.prototype,i=t.prototype,o=r.set;i.set=function(e,t,r){var i,u=this.namedAttributes;if(!u||e==null)return o.apply(this,arguments);n.isObject(e)?(i=n.clone(e),r=t):(i={},i[e]=t);for(var a in i){if(!n.has(i,a))continue;if(!n.has(u,a))throw"Attribute '"+a+"' does not exist";i[a]=s(u[a],i[a])}return o.call(this,i,r)};var u=r.get;i.get=function(e){if(this.namedAttributes&&!n.has(this.namedAttributes,e))throw"Attribute '"+e+"' does not exist";return u.apply(this,arguments)}}function d(e){var t=e.extend(),n=e.extend;return t.extend=h(n),t}function v(e){var t=d(e);return p(e,t),t}var e=this,t;typeof exports!="undefined"?t=exports:t=e.Brace={};var n=e._;!n&&typeof require!="undefined"&&(n=require("underscore"));var r=e.Backbone;!r&&typeof require!="undefined"&&(r=require("backbone")),t.Mixins={createMethodName:function(e,t){return e+t.charAt(0).toUpperCase()+t.substr(1)},applyMixin:function(e,t){n.forEach(n.keys(t),function(r){var s=e.prototype;if("initialize"===r){var o=s.initialize;s.initialize=function(){o&&o.apply(this,arguments),t.initialize.apply(this,arguments)};return}if("validate"===r){var u=s.validate;s.validate=function(){if(u){var e=u.apply(this,arguments);if(e)return e}return t.validate.apply(this,arguments)};return}if("defaults"===r){var f=s.defaults||(s.defaults={}),l=t[r];for(var c in l){if(f.hasOwnProperty(c))throw"Mixin error: class already has default '"+c+"' defined";f[c]=l[c]}return}if("namedAttributes"===r){var h=i(s.namedAttributes)||{},p=i(t[r]);s.namedAttributes=n.extend(h,a(p,h));return}if("namedEvents"===r){if(!n.isArray(t[r]))throw"Expects events member on mixin to be an array";s.namedEvents||(s.namedEvents=[]),s.namedEvents=n.uniq(s.namedEvents.concat(t[r]));return}if(s.hasOwnProperty(r))throw"Mixin error: class already has property '"+r+"' defined";s[r]=t[r]},this)}},t.AttributesMixinCreator={create:function(e){var r={};return e||(e={}),n.has(e,"id")||(e.id=null),n.each(e,function(e,n){var i=t.Mixins.createMethodName("set",n);r[i]=function(e,t){return this.set(n,e,t)};var s=t.Mixins.createMethodName("get",n);r[s]=function(){return this.get(n)}}),r},ensureType:s},t.EventsMixinCreator={create:function(e){var r={},i=function(e){var i=t.Mixins.createMethodName("on",e);r[i]=function(){return this.on.apply(this,[e].concat(n.toArray(arguments)))};var s=t.Mixins.createMethodName("trigger",e);r[s]=function(){return this.trigger.apply(this,[e].concat(n.toArray(arguments)))}};return n.each(e,n.bind(i,this)),r}},t.Model=v(r.Model),t.Collection=d(r.Collection),t.View=d(r.View),t.Router=d(r.Router)})();;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/deployments.js' */
(function(c,b){b.Model={};b.Model.DeploymentProject=Brace.Model.extend({namedAttributes:{name:"string",bambooId:"number",url:"string",environmentCount:"number",upToDateEnvironmentCount:"number",applinkId:"string"}});b.Model.Version=Brace.Model.extend({namedAttributes:{name:"string",id:"number",url:"string"}});b.Model.Environment=Brace.Model.extend({namedAttributes:{name:"string",id:"number",issueStatus:"string",statusOk:"boolean",url:"string",version:b.Model.Version}});b.Model.IssueDeploymentStatus=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProject:b.Model.DeploymentProject,versions:Brace.Collection.extend({model:b.Model.Version}),environments:Brace.Collection.extend({model:b.Model.Environment})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.Model.ErrorMessage=Brace.Model.extend({namedAttributes:{message:"string",messageBody:"string"}});b.Model.OauthCallback=Brace.Model.extend({namedAttributes:{oauthCallback:"string",serverName:"string"}});b.Model.RelatedDeploymentProjects=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProjects:Brace.Collection.extend({model:b.Model.DeploymentProject}),errorMessages:Brace.Collection.extend({model:b.Model.ErrorMessage}),oauthCallbacks:Brace.Collection.extend({model:b.Model.OauthCallback})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.IssueDeploymentStatus={};b.IssueDeploymentStatus.View=Brace.View.extend({oAuthDanceReturnUrl:"",initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.model=new b.Model.IssueDeploymentStatus(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){this.$el.html(bamboo.deployments.issueDetailsDialogContent({data:this.model.toJSON()}));return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.removeSpinner,this)).fail(_.bind(this.clearError,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){a(d,f,e,this.$el)},clearError:function(){this.$el.children(".aui-message").remove()},removeSpinner:function(){this.$el.children(".bamboo-icon-loading").remove()}});b.RelatedDeploymentProjects={};b.RelatedDeploymentProjects.PopupDialog=b.RelatedDeploymentProjects.PopupDialog||new JIRA.FormDialog({trigger:".bamboo-deployments-details-link",width:640,autoClose:true});b.RelatedDeploymentProjects.View=Brace.View.extend({initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.issueId=d.issueId||"";this.selector=d.el;this.model=new b.Model.RelatedDeploymentProjects(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){c(this.selector).html(bamboo.deployments.issuePanelContent({data:this.model.toJSON(),issueId:this.issueId,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}));return this.showPanelIfNotEmpty()},showPanelIfNotEmpty:function(){if(!c(this.selector).is(":empty")){c("#bamboo-deployment-projects-right").show()}else{c("#bamboo-deployment-projects-right").hide()}return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){c(this.selector).children(".aui-message").remove();a(d,f,e,c(this.selector))}});function a(h,l,j,g){var f,k,d;try{d=h.responseText||h.response;if(d){f=c.parseJSON(d);g.append(bamboo.components.errorResponseMessage({errorMessage:f,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}))}else{k="Unknown error: no response from server"}}catch(i){k="An error occurred while trying to retrieve the deployment project information."}if(k){AJS.messages.warning(g,{title:k,closeable:false})}c("#bamboo-deployment-projects-right").show()}}(AJS.$,window.JBAM_DEPLOYMENT=(window.JBAM_DEPLOYMENT||{})));;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/deployments/deployments.soy' */
// This file was automatically generated from deployments.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.deployments == 'undefined') { bamboo.deployments = {}; }


bamboo.deployments.issueDetailsDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Issue deployment details"), '</h2><div id=\'bamboo-deployments-issue-status-container\'><span class="bamboo-icon bamboo-icon-loading" title="loading"><span> </span></span></div><script>new JBAM_DEPLOYMENT.IssueDeploymentStatus.View({el: \'#bamboo-deployments-issue-status-container\', fetchUrl: \'', soy.$$escapeHtml("" + '/rest/bamboo/latest/deploy/' + opt_data.issueKey + '/' + opt_data.applinkId + '/' + opt_data.deploymentProjectId), '\', oAuthDanceReturnUrl: \'', soy.$$escapeHtml(opt_data.returnUrl), '\'});<\/script>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issuePanelContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.data.deploymentProjects) {
    output.append('<ul class=\'property-list\'>');
    var deploymentProjectList14 = opt_data.data.deploymentProjects;
    var deploymentProjectListLen14 = deploymentProjectList14.length;
    for (var deploymentProjectIndex14 = 0; deploymentProjectIndex14 < deploymentProjectListLen14; deploymentProjectIndex14++) {
      var deploymentProjectData14 = deploymentProjectList14[deploymentProjectIndex14];
      output.append('<li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml(deploymentProjectData14.name), '</strong><span class=\'value\'>', (deploymentProjectData14.environmentCount == 0) ? '<span class="aui-icon aui-icon-info"> </span> ' + soy.$$escapeHtml("No environments defined") : (deploymentProjectData14.upToDateEnvironmentCount == 0) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml("None of the environments have all related commits.") : (deploymentProjectData14.environmentCount > deploymentProjectData14.upToDateEnvironmentCount) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml(AJS.format("{0} of {1} environments don\x27\x27t have all related commits.",deploymentProjectData14.environmentCount - deploymentProjectData14.upToDateEnvironmentCount,deploymentProjectData14.environmentCount)) : '<span class="aui-icon aui-icon-success"> </span> ' + soy.$$escapeHtml("All environments have all related commits."), ' <a id="bamboo-deployment-details_', soy.$$escapeHtml(deploymentProjectData14.bambooId), '" class="bamboo-deployments-details-link" href="', soy.$$escapeHtml(""), '/secure/ViewIssueDeploymentStatus.jspa?id=', soy.$$escapeHtml(opt_data.issueId), '&deploymentProjectId=', soy.$$escapeHtml(deploymentProjectData14.bambooId), '&applicationLinkId=', soy.$$escapeHtml(deploymentProjectData14.applinkId), '">', "Details\x26hellip;", '</a></span></div></li>');
    }
    output.append('</ul>');
  }
  if (opt_data.data.errorMessages) {
    var errorMessageList49 = opt_data.data.errorMessages;
    var errorMessageListLen49 = errorMessageList49.length;
    for (var errorMessageIndex49 = 0; errorMessageIndex49 < errorMessageListLen49; errorMessageIndex49++) {
      var errorMessageData49 = errorMessageList49[errorMessageIndex49];
      bamboo.components.errorResponseMessage({errorMessage: errorMessageData49, oAuthDanceReturnUrl: opt_data.oAuthDanceReturnUrl}, output);
    }
  }
  if (opt_data.data.oauthCallbacks && opt_data.data.oauthCallbacks.length) {
    output.append('<div class="aui-message no-border no-background"><span class="aui-icon icon-warning"></span> ', soy.$$escapeHtml("For more deployment information, you need to log in to and approve the following servers:"), '<ul>');
    var oauthCallbackList59 = opt_data.data.oauthCallbacks;
    var oauthCallbackListLen59 = oauthCallbackList59.length;
    for (var oauthCallbackIndex59 = 0; oauthCallbackIndex59 < oauthCallbackListLen59; oauthCallbackIndex59++) {
      var oauthCallbackData59 = oauthCallbackList59[oauthCallbackIndex59];
      output.append('<li><a href="', oauthCallbackData59.oauthCallback, '&amp;redirectUrl=', opt_data.oAuthDanceReturnUrl, '">', soy.$$escapeHtml(oauthCallbackData59.serverName), '</a></li>');
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueDetailsDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Bamboo releases with related commits"), '</h3><ul class=\'property-list\'><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Deployment project"), '</strong><span class=\'value\'>');
  bamboo.deployments.itemLink({item: opt_data.data.deploymentProject}, output);
  output.append('</span></div></li><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Releases with commits"), '</strong><span class=\'value\'>');
  var versionList82 = opt_data.data.versions;
  var versionListLen82 = versionList82.length;
  if (versionListLen82 > 0) {
    for (var versionIndex82 = 0; versionIndex82 < versionListLen82; versionIndex82++) {
      var versionData82 = versionList82[versionIndex82];
      bamboo.deployments.itemLink({item: versionData82}, output);
      output.append((! (versionIndex82 == versionListLen82 - 1)) ? ', ' : '');
    }
  } else {
    output.append(soy.$$escapeHtml("No related releases found"));
  }
  output.append('</span></div></li></ul>');
  bamboo.deployments.environmentsTable({environments: opt_data.data.environments}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.environmentsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Issue availability across environments"), '</h3>');
  if (opt_data.environments.length > 0) {
    output.append('<table width=\'100%\' class=\'aui\'><colgroup><col width=\'45%\'><col width=\'30%\'><col width=\'25%\'></colgroup><thead><tr><th>', soy.$$escapeHtml("Environment"), '</th><th>', soy.$$escapeHtml("Issue availability"), '</th><th>', soy.$$escapeHtml("Current release"), '</th></tr></thead><tbody>');
    var environmentList107 = opt_data.environments;
    var environmentListLen107 = environmentList107.length;
    for (var environmentIndex107 = 0; environmentIndex107 < environmentListLen107; environmentIndex107++) {
      var environmentData107 = environmentList107[environmentIndex107];
      output.append('<tr><td>');
      bamboo.deployments.itemLink({item: environmentData107}, output);
      output.append((! environmentData107.statusOk) ? ' <span class="aui-icon aui-icon-error">Error</span>' : '', '</td><td>');
      bamboo.deployments.issueAvailabilityLozenge({issueStatus: environmentData107.issueStatus}, output);
      output.append('</td><td>');
      if (environmentData107.version) {
        bamboo.deployments.itemLink({item: environmentData107.version}, output);
      } else {
        output.append('<em>', soy.$$escapeHtml("Never deployed"), '</em>');
      }
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<p>', soy.$$escapeHtml("No environments defined"), '</p>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueAvailabilityLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.issueStatus == 'AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-success">' + soy.$$escapeHtml("deployed") + '</span>' : (opt_data.issueStatus == 'PARTIALLY_AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-current">' + soy.$$escapeHtml("partly deployed") + '</span>' : '<span class="aui-lozenge">' + soy.$$escapeHtml("not deployed") + '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.itemLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.item.url) ? '<a href="' + opt_data.item.url + '">' + soy.$$escapeHtml(opt_data.item.name) + '</a>' : soy.$$escapeHtml(opt_data.item.name));
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:hipchat-user-link-support', location = 'user/hipchat-user-link.js' */
AJS.toInit(function(e){var b={removeLink:AJS.contextPath()+"/rest/hipchat/integration/latest/oauth2"};var c="com.atlassian.plugins.base-hipchat-integration-plugin";var k=WRM.data instanceof Function?WRM.data:WRM.data.claim;var i=k(c+":hipchat-user-link-support.user-link-context");function a(){var l=window.location;var m=AJS.contextPath();var o=l.pathname;if(o.indexOf(m)===0){o=o.substr(m.length)}var n=l.search;if(n){n=n.substr(1)}return{path:o,query:n}}function g(l){window.location.assign(l)}function f(m){if(m){var l=m.attr("href");if(l!==undefined&&l.length>1&&l.indexOf("#")===0){return l.substr(1)}}return""}var j=function(){var l=e("<div></div>");l.css({position:"fixed",left:"50%",top:"50%"});e("body").append(l);l.spin("large")};var d=function(m){var n=a();var l={url:i.beginOauth,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({redirect:n.path,redirectQuery:n.query,redirectFragment:m&&m.target&&f(e(m.target))})};e.ajax(l).done(g);m&&m.preventDefault&&m.preventDefault();j()};e(document).on("click",".hipchat-user-link",d);var h=function(m){var l={url:b.removeLink,type:"DELETE",contentType:"application/json"};e.ajax(l).always(function(){window.location.reload()});m&&m.preventDefault&&m.preventDefault();j()};e(document).delegate(".hipchat-user-unlink","click",h);window.HipChat=window.HipChat||{};window.HipChat.UserLink=window.HipChat.UserLink||{};window.HipChat.UserLink.context=i;window.HipChat.UserLink.linkUser=d;window.HipChat.UserLink.unlinkUser=h});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:hipchat-links-support', location = 'links/hipchat-links.js' */
(function(d){var f="HIPCHAT_NATIVE_LINK_ENABLED";function c(){return AJS.Cookie.read(f)==="true"}function e(h){var i=document.createElement("a");i.href=h;return i.hostname}function g(h,i){return h+(b(h,"/")?"":"/")+i}function b(i,h){return i.indexOf(h,i.length-h.length)!==-1}function a(){var h=c()?"inapp":"web";var j=navigator.platform.toUpperCase().indexOf("MAC")>=0?"native.enabled":"native.disabled";var i="notifications.hipchat.link.clicked."+h+"."+j;AJS.trigger("analyticsEvent",{name:i})}d(document).on("click",".hipchat-room-link-url",function(j){j.preventDefault();var k=d(j.target);var h=k.data("api-url");var i=k.data("room-id");if(c()){window.location="hipchat://"+e(h)+"/room/"+i}else{window.open(g(h,"chat/room/"+i),"hipchat")}a()});d(document).on("click",".hipchat-user-link-url",function(j){j.preventDefault();var k=d(j.target);var h=k.data("api-url");var i=k.data("user-id");if(c()){window.location="hipchat://"+e(h)+"/user/"+i}else{window.open(g(h,"chat/user/"+i),"hipchat")}a()})})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/almond-noconflict-pre.js' */
window.__require=window.require;window.__requirejs=window.requirejs;window.__define=window.define;;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/almond.js' */
var requirejs,require,define;(function(e){var h,a,k,l,d={},c={},r={},o={},j=Object.prototype.hasOwnProperty,i=[].slice;function s(t,u){return j.call(t,u)}function m(w,u){var E,A,y,B,x,G,H,D,C,z,F=u&&u.split("/"),v=r.map,t=(v&&v["*"])||{};if(w&&w.charAt(0)==="."){if(u){F=F.slice(0,F.length-1);w=F.concat(w.split("/"));for(D=0;D<w.length;D+=1){z=w[D];if(z==="."){w.splice(D,1);D-=1}else{if(z===".."){if(D===1&&(w[2]===".."||w[0]==="..")){break}else{if(D>0){w.splice(D-1,2);D-=2}}}}}w=w.join("/")}else{if(w.indexOf("./")===0){w=w.substring(2)}}}if((F||t)&&v){E=w.split("/");for(D=E.length;D>0;D-=1){A=E.slice(0,D).join("/");if(F){for(C=F.length;C>0;C-=1){y=v[F.slice(0,C).join("/")];if(y){y=y[A];if(y){B=y;x=D;break}}}}if(B){break}if(!G&&t&&t[A]){G=t[A];H=D}}if(!B&&G){B=G;x=H}if(B){E.splice(0,x,B);w=E.join("/")}}return w}function q(t,u){return function(){return a.apply(e,i.call(arguments,0).concat([t,u]))}}function n(t){return function(u){return m(u,t)}}function f(t){return function(u){d[t]=u}}function g(u){if(s(c,u)){var t=c[u];delete c[u];o[u]=true;h.apply(e,t)}if(!s(d,u)&&!s(o,u)){throw new Error("No "+u)}return d[u]}function p(u){var v,t=u?u.indexOf("!"):-1;if(t>-1){v=u.substring(0,t);u=u.substring(t+1,u.length)}return[v,u]}k=function(u,t){var v,x=p(u),w=x[0];u=x[1];if(w){w=m(w,t);v=g(w)}if(w){if(v&&v.normalize){u=v.normalize(u,n(t))}else{u=m(u,t)}}else{u=m(u,t);x=p(u);w=x[0];u=x[1];if(w){v=g(w)}}return{f:w?w+"!"+u:u,n:u,pr:w,p:v}};function b(t){return function(){return(r&&r.config&&r.config[t])||{}}}l={require:function(t){return q(t)},exports:function(t){var u=d[t];if(typeof u!=="undefined"){return u}else{return(d[t]={})}},module:function(t){return{id:t,uri:"",exports:d[t],config:b(t)}}};h=function(u,D,C,B){var w,A,x,t,v,y=[],z;B=B||u;if(typeof C==="function"){D=!D.length&&C.length?["require","exports","module"]:D;for(v=0;v<D.length;v+=1){t=k(D[v],B);A=t.f;if(A==="require"){y[v]=l.require(u)}else{if(A==="exports"){y[v]=l.exports(u);z=true}else{if(A==="module"){w=y[v]=l.module(u)}else{if(s(d,A)||s(c,A)||s(o,A)){y[v]=g(A)}else{if(t.p){t.p.load(t.n,q(B,true),f(A),{});y[v]=d[A]}else{throw new Error(u+" missing "+A)}}}}}}x=C.apply(d[u],y);if(u){if(w&&w.exports!==e&&w.exports!==d[u]){d[u]=w.exports}else{if(x!==e||!z){d[u]=x}}}}else{if(u){d[u]=C}}};requirejs=require=a=function(w,x,t,u,v){if(typeof w==="string"){if(l[w]){return l[w](x)}return g(k(w,x).f)}else{if(!w.splice){r=w;if(x.splice){w=x;x=t;t=null}else{w=e}}}x=x||function(){};if(typeof t==="function"){t=u;u=v}if(u){h(e,w,x,t)}else{setTimeout(function(){h(e,w,x,t)},4)}return a};a.config=function(t){r=t;if(r.deps){a(r.deps,r.callback)}return a};define=function(t,u,v){if(!u.splice){v=u;u=[]}if(!s(d,t)&&!s(c,t)){c[t]=[t,u,v]}}}());;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/almond-noconflict-post.js' */
if(window.__require){window.require=window.__require;window.requirejs=window.__requirejs;window.define=window.__define}else{delete window.define.amd}try{delete window.__require}catch(e){window.__require=undefined}try{delete window.__requirejs}catch(e){window.__requirejs=undefined}try{delete window.__define}catch(e){window.__define=undefined};;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/ajs-amd.js' */
define("ajs",function(){return AJS});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/backbone-amd.js' */
define("backbone",function(){return Backbone});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/jquery-amd.js' */
define("jquery",function(){return AJS.$});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/underscore-amd.js' */
define("underscore",function(){return _});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:amd', location = 'lib/amd/wrm-amd.js' */
define("wrm",function(){if(WRM.data instanceof Function){WRM.data.claim=WRM.data}return WRM});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:configure-integration-data', location = 'admin/configure-integration-data.js' */
define("hipchat/admin/configure-integration-data",["jquery"],function(f){var e="com.atlassian.plugins.base-hipchat-integration-plugin";var d="configure-integration-data";var c="configure-integration";var a=WRM.data instanceof Function?WRM.data:WRM.data.claim;var b=a(e+":"+d+"."+c);return b});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:connection-status-resources', location = 'feature/connectionstatus/connectionstatus.soy' */
// This file was automatically generated from connectionstatus.soy.
// Please don't edit this file by hand.

if (typeof HipChat == 'undefined') { var HipChat = {}; }
if (typeof HipChat.Templates == 'undefined') { HipChat.Templates = {}; }
if (typeof HipChat.Templates.Configuration == 'undefined') { HipChat.Templates.Configuration = {}; }
if (typeof HipChat.Templates.Configuration.ConnectionStatus == 'undefined') { HipChat.Templates.Configuration.ConnectionStatus = {}; }


HipChat.Templates.Configuration.ConnectionStatus.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h6 class="hipchat-connection-status-container">', (opt_data.label) ? soy.$$escapeHtml(opt_data.label) : soy.$$escapeHtml("Connection status"), '<span class="hipchat-connection-status"></span></h6>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.ConnectionStatus.lozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', ' class="aui-lozenge', soy.$$escapeHtml(opt_data.type ? ' aui-lozenge-' + opt_data.type : ''), soy.$$escapeHtml(opt_data.isSubtle ? ' aui-lozenge-subtle' : ''), '">', (opt_data.maxLength) ? soy.$$truncate(soy.$$escapeHtml(opt_data.text), opt_data.maxLength, true) : soy.$$escapeHtml(opt_data.text), '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), '>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.ConnectionStatus.connectedStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.ConnectionStatus.lozenge({text: "Connected", type: 'success', isSubtle: true, extraClasses: opt_data.extraClasses}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.ConnectionStatus.partialConnectivityStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.ConnectionStatus.lozenge({text: "Limited", type: 'current', isSubtle: true, extraClasses: opt_data.extraClasses}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.ConnectionStatus.unknownStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.ConnectionStatus.lozenge({text: "Unknown", type: '', isSubtle: true, extraClasses: opt_data.extraClasses}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.ConnectionStatus.notConnectedStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.ConnectionStatus.lozenge({text: "Not connected", type: 'error', isSubtle: true, extraClasses: opt_data.extraClasses}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.ConnectionStatus.connectivityTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-connection-status-tooltip"><h6>', soy.$$escapeHtml(opt_data.title), '</h6><p>', opt_data.description, '</p>', (opt_data.link) ? '<p><a href="' + soy.$$escapeHtml(opt_data.link.href) + '">' + soy.$$escapeHtml(opt_data.link.text) + '</a></p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:connection-status-resources', location = 'feature/connectionstatus/connectionstatus.js' */
require(["jquery"],function(f){var c={CONNECTED:"connectedStatus",PARTIAL_CONNECTIVITY:"partialConnectivityStatus",NOT_CONNECTED:"notConnectedStatus",UNKNOWN:"unknownStatus"};var h={CONNECTED:{status:HipChat.Templates.Configuration.ConnectionStatus.connectedStatus},PARTIALLY_CONNECTED:{status:HipChat.Templates.Configuration.ConnectionStatus.partialConnectivityStatus,toolTipTitle:"Connectivity issues",toolTipDescription:"HipChat cannot connect to your JIRA server - it may be behind a firewall. \u003cbr\u003e You can still receive messages from JIRA in HipChat, but some functionality (such as Issue Preview) may not work."},NO_CONNECTION:{status:HipChat.Templates.Configuration.ConnectionStatus.notConnectedStatus,toolTipTitle:"Connectivity issues",toolTipDescription:"Could not connect to the HipChat server. Integration features will be unavailable until the connection is restored."},UNKNOWN:{status:HipChat.Templates.Configuration.ConnectionStatus.unknownStatus,toolTipTitle:"\u00af\\_(\u30c4)_/\u00af",toolTipDescription:"We cannot determine the connection status. You\'re probably using an old version of HipChat."}};function e(j){var i=h[j];if(i===undefined){i=c.UNKNOWN}return i}function d(j){var i=e(j);return i.status({extraClasses:i.toolTipDescription!==undefined?"has-tooltip":""})}function a(){return f.ajax({url:AJS.contextPath()+"/rest/hipchat/integration/1.0/connection-status",cache:false,dataType:"json",type:"GET"})}function g(k,j){var i=e(j);if(i.toolTipDescription!==undefined){AJS.InlineDialog(k,"connection-status-tooltip",function(n,l,o){var m=HipChat.Templates.Configuration.ConnectionStatus.connectivityTooltip({title:i.toolTipTitle,description:i.toolTipDescription,link:i.toolTipLink});n.html(m);o()},{onHover:true,gravity:"w"})}}function b(i){var j=f(".hipchat-connection-status");j.html(d(i));g(j,i)}AJS.toInit(function(j){var i=j(".hipchat-connection-status");if(i.length>0){i.spin();a().done(function(k){b(k)}).fail(function(){b("UNKNOWN")}).always(function(){i.spinStop()})}})});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:integration-steps-resources', location = 'feature/invites/invite-hipchat-enabler.js' */
define("hipchat/invite/enabler",["jquery"],function(f){var h="hipchat-invite-visited";var g=null;var d=false;function e(){if(!g){var k="com.atlassian.plugins.base-hipchat-integration-plugin";var i=WRM.data instanceof Function?WRM.data:WRM.data.claim;g=i(k+":integration-steps-resources.enable-invite")}if(!g.inviteToHipChatEnabled){return}var j=g.isInvitationsToGroupAllowedURI;f.ajax(j,{type:"GET"}).done(function(l){var m=f("#hipchat-invite-button");m.click(c);if(l&&l.free){m.removeClass("hidden");a(m)}else{f("#hipchat-integration-invite-step-normal-text").hide({complete:function(){f("#hipchat-integration-invite-step-unable-text").show()}})}})}function c(){try{AJS.Cookie.save(h,"true")}catch(i){d=true}}function b(){try{var i=AJS.Cookie.read(h);return i}catch(j){d=true}}function a(j){if(AJS.HelpTip&&!b()&&!d){var i=new AJS.HelpTip({id:"hipchat-invite-user-help",title:"Invite users to HipChat",bodyHtml:"If you would like to invite users in the future, click here.",anchor:j});i.show();i.view.popup.addClass("hipchat-invite-user-help")}}return{enableInviteButtonIfFreePlan:e}});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:integration-steps-resources', location = 'feature/integrationsteps/integrationsteps.js' */
require(["hipchat/invite/enabler"],function(a){AJS.toInit(function(c){var d=c(".hipchat-integration-steps");d.on("mapping-added.integration-steps",function(){d.addClass("complete");a.enableInviteButtonIfFreePlan()});var b=c("#inviteButtonWaitingForMapping").val();if(b==="false"){a.enableInviteButtonIfFreePlan()}})});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:invites-soy-resources', location = 'feature/invites/invite-hipchat-client.soy' */
// This file was automatically generated from invite-hipchat-client.soy.
// Please don't edit this file by hand.

if (typeof HipChat == 'undefined') { var HipChat = {}; }
if (typeof HipChat.Templates == 'undefined') { HipChat.Templates = {}; }
if (typeof HipChat.Templates.Configuration == 'undefined') { HipChat.Templates.Configuration = {}; }


HipChat.Templates.Configuration.inviteeList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="hipchat-invitee-list"></ul>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.invitee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var userUrl__soy5 = new soy.StringBuilder();
  HipChat.Templates.Invite.Support.userLinkUrl(opt_data, userUrl__soy5);
  userUrl__soy5 = userUrl__soy5.toString();
  output.append('<li class="hipchat-invitee" data-username="', soy.$$escapeHtml(opt_data.username), '"><img class="hipchat-invitee-avatar" src="', soy.$$escapeHtml(opt_data.avatarUrl), '"><div class="lines"><div class="line hipchat-invitee-name-container" title="', soy.$$escapeHtml(opt_data.fullname), '"><a href="', soy.$$escapeHtml(userUrl__soy5), '" class="hipchat-invitee-name invitee-line-1" target="_blank">', soy.$$escapeHtml(opt_data.fullname), '</a></div><div class="line"><span data-invite-processing="running" class="aui-lozenge aui-lozenge-current aui-lozenge-subtle hidden">', soy.$$escapeHtml("inviting..."), '</span>', (opt_data.email) ? '<div class="email-container" title="' + soy.$$escapeHtml(opt_data.email) + '"><span class="email">' + soy.$$escapeHtml(opt_data.emailDomain) + '</span></div>' : '<span>&nbsp;</span>', '<span class="aui-lozenge aui-lozenge-current aui-lozenge-subtle" style="display:none"></span><span class="aui-lozenge aui-lozenge-success aui-lozenge-subtle" style="display:none"></span></div></div><div class="icon-holder"><button class="remove-invite-button aui-button aui-button-link">');
  aui.icons.icon({useIconFont: true, icon: 'remove'}, output);
  output.append('</button></div><div class="status-icon-holder"><span class="aui-icon aui-icon-small aui-iconfont-approve success"> </span><span class="aui-icon aui-icon-small aui-iconfont-error failure"> </span></div></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:resources', location = 'admin/configure-hipchat.js' */
require(["hipchat/admin/configure-integration-data"],function(a){AJS.toInit(function(g){var d=g("#hipchat-integration-configuration").val();var k=window.localStorage;if(d){var j={self:g("#hipchat-route-config").val(),serverPing:g("#hipchat-route-check-server-connectivity").val(),clientPing:g("#hipchat-route-check-client-connectivity").val(),beginInstall:g("#hipchat-route-begin-install").val(),completeInstall:g("#hipchat-route-complete-install").val(),installableUrl:g("#hipchat-route-installable-url").val(),uninstall:g("#hipchat-route-uninstall").val(),redirectUrl:g("#hipchat-route-redirectUrl").val()};var e={screenshotResource:g("#hipchat-server-resource-screenshot").val(),screenshotResource2x:g("#hipchat-server-resource-screenshot-2x").val(),uninstalling:g("#hipchat-server-resource-uninstalling").val()};var l=HipChat.Templates.Configuration;var b=g("#hipchat-configuration-panel");if(a.link){var i=a.link.id}var h=(function(){var m;return{installing:function(){g("#hipchat-installing .hipchat-install-message").spin("large")},error:function(n){b.html(l.error({msg:n}))},uninstallError:function(n){if(n.status==401){b.html(l.uninstallPermissionError())}else{b.html(l.uninstallConnectionError())}},confirmUninstall:function(){var n=g.Deferred();if(!m){m=new AJS.Dialog(600,300,"hipchat-remove-link-dialog");m.addHeader("Remove integration","remove-warning");m.addPanel("Message Panel",l.removeLinkMessage());m.addButton("Remove integration",function(){m.hide();h.uninstall();n.resolve()});m.addCancel("Cancel",function(){m.hide();n.reject()})}m.show();return n.promise()},uninstall:function(){b.html(l.uninstalling({uninstallingImage:e.uninstalling}));g("#hipchat-uninstalling .hipchat-install-message").spin("large")},reinstallationSucceeded:function(){try{var n=require("aui/flag");n({type:"success",title:"HipChat Integration updated",persistent:false,body:"Your HipChat Integration has been successfully updated to the latest version, enjoy the new features."})}catch(o){}}}})();var f={serverPing:function(){return g.ajax(j.serverPing,{type:"GET"})},serverPingToUrl:function(m){var n=(j.serverPing.indexOf("?")<0)?"?":"&";return g.ajax(j.serverPing+n+"url="+encodeURIComponent(m),{type:"GET"})},beginInstall:function(n,m){return g.ajax(j.beginInstall,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({installableUrl:n,reinstall:m})})},completeInstall:function(m){return g.ajax(j.completeInstall,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({installableUrl:m})})},remove:function(m){return g.ajax({url:j.uninstall+"/"+m,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({})})},reinstall:function(m){return g.ajax({url:j.uninstall+"/"+m,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({reinstall:true})})},removeDefault:function(){return g.ajax(j.uninstall,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({})})}};var c={initialize:function(m){switch(m){case"installing":c.installing();break;case"installed":c.installed(i);break;case"uninstalling":c.uninstalling();break;case"reinstall":c.reinstalling();break;case"configure":default:c.configure()}},redirect:function(m){window.location.replace(m)},navigate:function(m){window.location.assign(m)},configure:function(){f.serverPing().done(function(){g("#hipchat-install").removeAttr("disabled")}).fail(function(){g("#hipchat-server-failure").removeClass("hidden")}).always(function(){g("#hipchat-loading").hide()});g("#hipchat-install").click(function(n){n.preventDefault();if(g(this).attr("aria-disabled")){return}g(this).attr("aria-disabled","true");AJS.trigger("analyticsEvent",{name:"notifications.hipchat.server.registration.started",data:{}});f.beginInstall(undefined,false).done(c.navigate)});g("#enable-btf-install").click(function(n){n.preventDefault();window.onbeforeunload=null;m()});AJS.trigger("analyticsEvent",{name:"notifications.hipchat.server.discovered",data:{}});function m(){g(".hipchat-install-form").toggleClass("hipchat-btf");g("#btf-url").focus();g("#btf-install").click(function(o){g("#btf-error").hide();o.preventDefault();var n=g("#btf-url").val();f.serverPingToUrl(n).done(function(){f.beginInstall(n,false).done(c.navigate)}).fail(function(){g("#btf-error").show()})})}g("#btf-install-cancel").click(function(n){n.preventDefault();g(".hipchat-install-form").toggleClass("hipchat-btf")})},installing:function(){h.installing();f.completeInstall(j.installableUrl).done(function(m){c.redirect(j.self)}).error(h.error)},installed:function(){g("#hipchat-uninstall").click(function(m){m.preventDefault();if(g(this).attr("aria-disabled")){return}h.confirmUninstall().done(function(){f.remove(i).done(c.redirect).error(h.uninstallError)})});g(".hipchat-reinstall").click(function(){if(g(this).attr("aria-disabled")){return}var m=g(this);m.attr("aria-disabled",true);m.find(".aui-icon-wait").css("display","inline-block");f.reinstall(i).done(c.redirect).error(h.uninstallError)});if(k.getItem("hipchat-reinstalling")){h.reinstallationSucceeded();k.removeItem("hipchat-reinstalling")}},uninstalling:function(){f.removeDefault().done(function(){c.redirect(j.redirectUrl)}).error(h.uninstallError)},reinstalling:function(){function o(r){var u=window.location.search.substring(1);var t=u.split("&");for(var s=0;s<t.length;s++){var v=t[s].split("=");if(v[0]==r){if(v.length>1){return v[1]}else{return null}}}}var q=o("installable_url");if(q===undefined){console.log("ERROR: the 'installable_url' parameter was missing from the request URL:'"+window.location.search+"'")}else{var n=decodeURIComponent(q);var m=document.createElement("a");m.href=n;var p=m.protocol+"//"+m.host;f.serverPingToUrl(p).done(function(){k.setItem("hipchat-reinstalling",true);f.beginInstall(p,true).done(c.navigate)}).fail(function(){g("#btf-error").show()})}}};c.initialize(d)}})});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:resources', location = 'admin/configure-hipchat.soy' */
// This file was automatically generated from configure-hipchat.soy.
// Please don't edit this file by hand.

if (typeof HipChat == 'undefined') { var HipChat = {}; }
if (typeof HipChat.Templates == 'undefined') { HipChat.Templates = {}; }
if (typeof HipChat.Templates.Configuration == 'undefined') { HipChat.Templates.Configuration = {}; }


HipChat.Templates.Configuration.installing = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.connected({id: 'hipchat-installing', installHeading: "Integrating with HipChat", installImage: opt_data.installingImage, showRemove: false}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.uninstalling = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.connected({id: 'hipchat-uninstalling', installHeading: "Removing HipChat Integration", installImage: opt_data.uninstallingImage, showRemove: false}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.connected = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="', soy.$$escapeHtml(opt_data.id), '">');
  if (opt_data.showRemove) {
    HipChat.Templates.Configuration.uninstallButton(null, output);
  }
  output.append((opt_data.installImage) ? '<img src="' + soy.$$escapeHtml(opt_data.installImage) + '" />' : '', (opt_data.installHeading) ? '<h5>' + soy.$$escapeHtml(opt_data.installHeading) + '</h5>' : '', '<hr/><div class="hipchat-install-message">', (opt_data.installMessageHtml) ? '<p>' + opt_data.installMessageHtml + '</p>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.message({type: 'error', title: "Error encountered creating your hipchat link", content: soy.$$escapeHtml("Something went wrong integrating JIRA and HipChat. We probably had trouble connecting to the HipChat server. Check that the connection between your server and HipChat is working correctly and try again.") + '<p>' + soy.$$escapeHtml("Try uninstalling the existing integration from HipChat before trying again.") + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.uninstallConnectionError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.message({type: 'error', title: "Error encountered removing your hipchat link", content: soy.$$escapeHtml("Something went wrong removing the integration in HipChat. We probably had trouble connecting to the HipChat server. You may need to remove the integration from HipChat\'s admin page. The link has been removed from JIRA.")}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.uninstallPermissionError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.message({type: 'error', title: "Error encountered removing your hipchat link", content: soy.$$escapeHtml("You do not have permission to remove this integration, please contact your site admin if you wish to remove the HipChat integration.")}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.refreshToken = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.message({type: 'error', title: 'Setting up your HipChat link', content: soy.$$escapeHtml("Error encountered creating your hipchat link")}, output);
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.message = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), ' ', (opt_data.altClass) ? soy.$$escapeHtml(opt_data.altClass) : '', '"><p class="title"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type), '"></span><strong>', soy.$$escapeHtml(opt_data.title), '</strong></p>', (opt_data.content) ? '<p>' + opt_data.content + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.removeLinkMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'remove-link-message\'>', "\u003cp>Are you sure you want to completely remove your HipChat integration?\u003c\/p>\u003cp>The JIRA plugin will not be removed from HipChat.\u003c\/p>", '</div>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.installButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-install-form"><button class="aui-button aui-button-primary" type="submit" id="hipchat-install" disabled="disabled">', soy.$$escapeHtml("Connect HipChat"), '</button><div id="hipchat-loading"><span class="aui-icon aui-icon-wait"></span> ', soy.$$escapeHtml("Checking your server can see HipChat"), '</div><div id="hipchat-server-failure" class="hidden"><p><span class="aui-icon aui-icon-small aui-iconfont-warning hipchat-failure-marker"></span> ', soy.$$escapeHtml("Unable to reach HipChat"), '</p><p class="details">', soy.$$escapeHtml("If JIRA does not have access to the internet you won\'t be able to integrate with HipChat."), '</p></div><div><button class="cancel aui-link aui-button aui-button-link" id="enable-btf-install">', soy.$$escapeHtml("Or, if you\x27re using HipChat Server, click here."), '</button>');
  HipChat.Templates.Configuration.btfInstall(null, output);
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.btfInstall = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui top-label" id="hipchat-btf-install"><fieldset class="top-label"><div class="field-group top-label"><label for="hipchat-btf-url" style="text-align:center">', soy.$$escapeHtml("First things first, let us know where we can find your HipChat Server:"), '</label><input class="text long-field" type="text" id="btf-url" name="btf-url" data-aui-notification-field="" placeholder="http://www.hipchat.com"></input><div class="error" id="btf-error">', soy.$$escapeHtml("We couldn\x27t reach your server"), '</div></div></fieldset><div class="buttons-container"><button class="aui-button aui-button-primary" type="submit" id="btf-install">', soy.$$escapeHtml("Connect HipChat"), '</button><a class="cancel" href="#" id="btf-install-cancel">Cancel</a></div></form>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.uninstallButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-subtle" id="hipchat-uninstall"><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure</span> ', soy.$$escapeHtml("Remove integration"), '</button>');
  return opt_sb ? '' : output.toString();
};


HipChat.Templates.Configuration.inviteButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="hidden" id="inviteButtonWaitingForMapping" value="', soy.$$escapeHtml(opt_data.inviteButtonWaitingForMapping), '"/><a class="aui-button aui-button-subtle hidden" id="hipchat-invite-button" href="', soy.$$escapeHtml(opt_data.adminInviteUrl), '"><span class="aui-icon aui-icon-small aui-iconfont-space-personal">Invite</span> ', soy.$$escapeHtml("Invite users to HipChat"), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.auiplugin:aui-select2', location = 'js-vendor/jquery/plugins/jquery.select2.js' */
(function(A){if(typeof A.fn.each2=="undefined"){A.extend(A.fn,{each2:function(E){var C=A([0]),D=-1,B=this.length;while(++D<B&&(C.context=C[0]=this[D])&&E.call(C[0],D,C)!==false){}return this}})}})(jQuery);(function(d,M){if(window.Select2!==M){return }var k,n,X,C,A,P,O={x:0,y:0},V,W,k={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(o){o=o.which?o.which:o;switch(o){case k.LEFT:case k.RIGHT:case k.UP:case k.DOWN:return true}return false},isControl:function(p){var o=p.which;switch(o){case k.SHIFT:case k.CTRL:case k.ALT:return true}if(p.metaKey){return true}return false},isFunctionKey:function(o){o=o.which?o.which:o;return o>=112&&o<=123}},b="<div class='select2-measure-scrollbar'></div>",D={"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z"};V=d(document);A=(function(){var o=1;return function(){return o++}}());function E(r){var p,q,o,s;if(!r||r.length<1){return r}p="";for(q=0,o=r.length;q<o;q++){s=r.charAt(q);p+=D[s]||s}return p}function Q(q,r){var p=0,o=r.length;for(;p<o;p=p+1){if(T(q,r[p])){return p}}return -1}function m(){var o=d(b);o.appendTo("body");var p={width:o.width()-o[0].clientWidth,height:o.height()-o[0].clientHeight};o.remove();return p}function T(p,o){if(p===o){return true}if(p===M||o===M){return false}if(p===null||o===null){return false}if(p.constructor===String){return p+""===o+""}if(o.constructor===String){return o+""===p+""}return false}function I(p,r){var s,q,o;if(p===null||p.length<1){return[]}s=p.split(r);for(q=0,o=s.length;q<o;q=q+1){s[q]=d.trim(s[q])}return s}function H(o){return o.outerWidth(false)-o.width()}function f(p){var o="keyup-change-value";p.on("keydown",function(){if(d.data(p,o)===M){d.data(p,o,p.val())}});p.on("keyup",function(){var q=d.data(p,o);if(q!==M&&p.val()!==q){d.removeData(p,o);p.trigger("keyup-change")}})}V.on("mousemove",function(o){O.x=o.pageX;O.y=o.pageY});function j(o){o.on("mousemove",function(q){var p=O;if(p===M||p.x!==q.pageX||p.y!==q.pageY){d(q.target).trigger("mousemove-filtered",q)}})}function K(r,p,o){o=o||M;var q;return function(){var s=arguments;window.clearTimeout(q);q=window.setTimeout(function(){p.apply(o,s)},r)}}function S(q){var o=false,p;return function(){if(o===false){p=q();o=true}return p}}function L(o,q){var p=K(o,function(r){q.trigger("scroll-debounced",r)});q.on("scroll",function(r){if(Q(r.target,q.get())>=0){p(r)}})}function i(o){if(o[0]===document.activeElement){return }window.setTimeout(function(){var q=o[0],r=o.val().length,p;o.focus();if(o.is(":visible")&&q===document.activeElement){if(q.setSelectionRange){q.setSelectionRange(r,r)}else{if(q.createTextRange){p=q.createTextRange();p.collapse(false);p.select()}}}},0)}function F(o){o=d(o)[0];var r=0;var p=0;if("selectionStart" in o){r=o.selectionStart;p=o.selectionEnd-r}else{if("selection" in document){o.focus();var q=document.selection.createRange();p=document.selection.createRange().text.length;q.moveStart("character",-o.value.length);r=q.text.length-p}}return{offset:r,length:p}}function a(o){o.preventDefault();o.stopPropagation()}function B(o){o.preventDefault();o.stopImmediatePropagation()}function N(p){if(!P){var o=p[0].currentStyle||window.getComputedStyle(p[0],null);P=d(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:o.fontSize,fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontWeight:o.fontWeight,letterSpacing:o.letterSpacing,textTransform:o.textTransform,whiteSpace:"nowrap"});P.attr("class","select2-sizer");d("body").append(P)}P.text(p.val());return P.width()}function J(p,t,o){var r,s=[],q;r=p.attr("class");if(r){r=""+r;d(r.split(" ")).each2(function(){if(this.indexOf("select2-")===0){s.push(this)}})}r=t.attr("class");if(r){r=""+r;d(r.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){q=o(this);if(q){s.push(q)}}})}p.attr("class",s.join(" "))}function U(t,s,q,o){var r=E(t.toUpperCase()).indexOf(E(s.toUpperCase())),p=s.length;if(r<0){q.push(o(t));return }q.push(o(t.substring(0,r)));q.push("<span class='select2-match'>");q.push(o(t.substring(r,r+p)));q.push("</span>");q.push(o(t.substring(r+p,t.length)))}function g(o){var p={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(o).replace(/[&<>"'\/\\]/g,function(q){return p[q]})}function e(p){var s,q=null,t=p.quietMillis||100,r=p.url,o=this;return function(u){window.clearTimeout(s);s=window.setTimeout(function(){var x=p.data,w=r,z=p.transport||d.fn.select2.ajaxDefaults.transport,v={type:p.type||"GET",cache:p.cache||false,jsonpCallback:p.jsonpCallback||M,dataType:p.dataType||"json"},y=d.extend({},d.fn.select2.ajaxDefaults.params,v);x=x?x.call(o,u.term,u.page,u.context):null;w=(typeof w==="function")?w.call(o,u.term,u.page,u.context):w;if(q){q.abort()}if(p.params){if(d.isFunction(p.params)){d.extend(y,p.params.call(o))}else{d.extend(y,p.params)}}d.extend(y,{url:w,dataType:p.dataType,data:x,success:function(AB){var AA=p.results(AB,u.page);u.callback(AA)}});q=z.call(o,y)},t)}}function h(p){var s=p,r,q,t=function(u){return""+u.text};if(d.isArray(s)){q=s;s={results:q}}if(d.isFunction(s)===false){q=s;s=function(){return q}}var o=s();if(o.text){t=o.text;if(!d.isFunction(t)){r=o.text;t=function(u){return u[r]}}}return function(w){var v=w.term,u={results:[]},x;if(v===""){w.callback(s());return }x=function(z,AB){var AA,y;z=z[0];if(z.children){AA={};for(y in z){if(z.hasOwnProperty(y)){AA[y]=z[y]}}AA.children=[];d(z.children).each2(function(AC,AD){x(AD,AA.children)});if(AA.children.length||w.matcher(v,t(AA),z)){AB.push(AA)}}else{if(w.matcher(v,t(z),z)){AB.push(z)}}};d(s().results).each2(function(z,y){x(y,u.results)});w.callback(u)}}function Z(p){var o=d.isFunction(p);return function(s){var r=s.term,q={results:[]};d(o?p():p).each(function(){var t=this.text!==M,u=t?this.text:this;if(r===""||s.matcher(r,u)){q.results.push(t?this:{id:this,text:this})}});s.callback(q)}}function Y(o,p){if(d.isFunction(o)){return true}if(!o){return false}throw new Error(p+" must be a function or a falsy value")}function c(o){return d.isFunction(o)?o():o}function R(o){var p=0;d.each(o,function(q,r){if(r.children){p+=R(r.children)}else{p++}});return p}function G(w,x,u,o){var p=w,y=false,r,v,s,q,t;if(!o.createSearchChoice||!o.tokenSeparators||o.tokenSeparators.length<1){return M}while(true){v=-1;for(s=0,q=o.tokenSeparators.length;s<q;s++){t=o.tokenSeparators[s];v=w.indexOf(t);if(v>=0){break}}if(v<0){break}r=w.substring(0,v);w=w.substring(v+t.length);if(r.length>0){r=o.createSearchChoice.call(this,r,x);if(r!==M&&r!==null&&o.id(r)!==M&&o.id(r)!==null){y=false;for(s=0,q=x.length;s<q;s++){if(T(o.id(r),o.id(x[s]))){y=true;break}}if(!y){u(r)}}}}if(p!==w){return w}}function l(o,p){var q=function(){};q.prototype=new o;q.prototype.constructor=q;q.prototype.parent=o.prototype;q.prototype=d.extend(q.prototype,p);return q}n=l(Object,{bind:function(p){var o=this;return function(){p.apply(o,arguments)}},init:function(s){var q,p,t=".select2-results";this.opts=s=this.prepareOpts(s);this.id=s.id;if(s.element.data("select2")!==M&&s.element.data("select2")!==null){s.element.data("select2").destroy()}this.container=this.createContainer();this.containerId="s2id_"+(s.element.attr("id")||"autogen"+A());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=S(function(){return s.element.closest("body")});J(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.attr("style",s.element.attr("style"));this.container.css(c(s.containerCss));this.container.addClass(c(s.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",a);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");J(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(c(s.dropdownCssClass));this.dropdown.data("select2",this);this.dropdown.on("click",a);this.results=q=this.container.find(t);this.search=p=this.container.find("input.select2-input");this.queryCount=0;this.resultsPage=0;this.context=null;this.initContainer();this.container.on("click",a);j(this.results);this.dropdown.on("mousemove-filtered touchstart touchmove touchend",t,this.bind(this.highlightUnderEvent));L(80,this.results);this.dropdown.on("scroll-debounced",t,this.bind(this.loadMoreIfNeeded));d(this.container).on("change",".select2-input",function(u){u.stopPropagation()});d(this.dropdown).on("change",".select2-input",function(u){u.stopPropagation()});if(d.fn.mousewheel){q.mousewheel(function(x,y,v,u){var w=q.scrollTop();if(u>0&&w-u<=0){q.scrollTop(0);a(x)}else{if(u<0&&q.get(0).scrollHeight-q.scrollTop()+u<=q.height()){q.scrollTop(q.get(0).scrollHeight-q.height());a(x)}}})}f(p);p.on("keyup-change input paste",this.bind(this.updateResults));p.on("focus",function(){p.addClass("select2-focused")});p.on("blur",function(){p.removeClass("select2-focused")});this.dropdown.on("mouseup",t,this.bind(function(u){if(d(u.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(u);this.selectHighlighted(u)}}));this.dropdown.on("click mouseup mousedown",function(u){u.stopPropagation()});if(d.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(s.maximumInputLength!==null){this.search.attr("maxlength",s.maximumInputLength)}var r=s.element.prop("disabled");if(r===M){r=false}this.enable(!r);var o=s.element.prop("readonly");if(o===M){o=false}this.readonly(o);W=W||m();this.autofocus=s.element.prop("autofocus");s.element.prop("autofocus",false);if(this.autofocus){this.focus()}this.nextSearchTerm=M},destroy:function(){var p=this.opts.element,o=p.data("select2");this.close();if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(o!==M){o.container.remove();o.dropdown.remove();p.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||false);if(this.elementTabIndex){p.attr({tabindex:this.elementTabIndex})}else{p.removeAttr("tabindex")}p.show()}},optionToData:function(o){if(o.is("option")){return{id:o.prop("value"),text:o.text(),element:o.get(),css:o.attr("class"),disabled:o.prop("disabled"),locked:T(o.attr("locked"),"locked")||T(o.data("locked"),true)}}else{if(o.is("optgroup")){return{text:o.attr("label"),children:[],element:o.get(),css:o.attr("class")}}}},prepareOpts:function(t){var r,p,o,s,q=this;r=t.element;if(r.get(0).tagName.toLowerCase()==="select"){this.select=p=t.element}if(p){d.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in t){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}t=d.extend({},{populateResults:function(u,v,x){var w,y=this.opts.id;w=function(AF,z,AE){var AG,AB,AL,AI,AC,AK,AA,AJ,AH,AD;AF=t.sortResults(AF,z,x);for(AG=0,AB=AF.length;AG<AB;AG=AG+1){AL=AF[AG];AC=(AL.disabled===true);AI=(!AC)&&(y(AL)!==M);AK=AL.children&&AL.children.length>0;AA=d("<li></li>");AA.addClass("select2-results-dept-"+AE);AA.addClass("select2-result");AA.addClass(AI?"select2-result-selectable":"select2-result-unselectable");if(AC){AA.addClass("select2-disabled")}if(AK){AA.addClass("select2-result-with-children")}AA.addClass(q.opts.formatResultCssClass(AL));AJ=d(document.createElement("div"));AJ.addClass("select2-result-label");AD=t.formatResult(AL,AJ,x,q.opts.escapeMarkup);if(AD!==M){AJ.html(AD)}AA.append(AJ);if(AK){AH=d("<ul></ul>");AH.addClass("select2-result-sub");w(AL.children,AH,AE+1);AA.append(AH)}AA.data("select2-data",AL);z.append(AA)}};w(v,u,0)}},d.fn.select2.defaults,t);if(typeof (t.id)!=="function"){o=t.id;t.id=function(u){return u[o]}}if(d.isArray(t.element.data("select2Tags"))){if("tags" in t){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+t.element.attr("id")}t.tags=t.element.data("select2Tags")}if(p){t.query=this.bind(function(y){var x={results:[],more:false},w=y.term,v,u,z;z=function(AA,AC){var AB;if(AA.is("option")){if(y.matcher(w,AA.text(),AA)){AC.push(q.optionToData(AA))}}else{if(AA.is("optgroup")){AB=q.optionToData(AA);AA.children().each2(function(AD,AE){z(AE,AB.children)});if(AB.children.length>0){AC.push(AB)}}}};v=r.children();if(this.getPlaceholder()!==M&&v.length>0){u=this.getPlaceholderOption();if(u){v=v.not(u)}}v.each2(function(AA,AB){z(AB,x.results)});y.callback(x)});t.id=function(u){return u.id};t.formatResultCssClass=function(u){return u.css}}else{if(!("query" in t)){if("ajax" in t){s=t.element.data("ajax-url");if(s&&s.length>0){t.ajax.url=s}t.query=e.call(t.element,t.ajax)}else{if("data" in t){t.query=h(t.data)}else{if("tags" in t){t.query=Z(t.tags);if(t.createSearchChoice===M){t.createSearchChoice=function(u){return{id:d.trim(u),text:d.trim(u)}}}if(t.initSelection===M){t.initSelection=function(u,w){var v=[];d(I(u.val(),t.separator)).each(function(){var y={id:this,text:this},x=t.tags;if(d.isFunction(x)){x=x()}d(x).each(function(){if(T(this.id,y.id)){y=this;return false}});v.push(y)});w(v)}}}}}}}if(typeof (t.query)!=="function"){throw"query function not defined for Select2 "+t.element.attr("id")}return t},monitorSource:function(){var p=this.opts.element,q,o;p.on("change.select2",this.bind(function(r){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));q=this.bind(function(){var s=p.prop("disabled");if(s===M){s=false}this.enable(!s);var r=p.prop("readonly");if(r===M){r=false}this.readonly(r);J(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(c(this.opts.containerCssClass));J(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(c(this.opts.dropdownCssClass))});p.on("propertychange.select2",q);if(this.mutationCallback===M){this.mutationCallback=function(r){r.forEach(q)}}o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(o!==M){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new o(this.mutationCallback);this.propertyObserver.observe(p.get(0),{attributes:true,subtree:false})}},triggerSelect:function(p){var o=d.Event("select2-selecting",{val:this.id(p),object:p});this.opts.element.trigger(o);return !o.isDefaultPrevented()},triggerChange:function(o){o=o||{};o=d.extend({},o,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(o);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},isInterfaceEnabled:function(){return this.enabledInterface===true},enableInterface:function(){var o=this._enabled&&!this._readonly,p=!o;if(o===this.enabledInterface){return false}this.container.toggleClass("select2-container-disabled",p);this.close();this.enabledInterface=o;return true},enable:function(o){if(o===M){o=true}if(this._enabled===o){return }this._enabled=o;this.opts.element.prop("disabled",!o);this.enableInterface()},disable:function(){this.enable(false)},readonly:function(o){if(o===M){o=false}if(this._readonly===o){return false}this._readonly=o;this.opts.element.prop("readonly",o);this.enableInterface();return true},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var q=this.dropdown,t=this.container.offset(),AC=this.container.outerHeight(false),AD=this.container.outerWidth(false),y=q.outerHeight(false),AA=d(window),AH=AA.width(),w=AA.height(),p=AA.scrollLeft()+AH,AG=AA.scrollTop()+w,r=t.top+AC,AE=t.left,o=r+y<=AG,v=(t.top-y)>=this.body().scrollTop(),z=q.outerWidth(false),AJ=AE+z<=p,AI=q.hasClass("select2-drop-above"),u,AF,s,x,AB;if(AI){AF=true;if(!v&&o){s=true;AF=false}}else{AF=false;if(!o&&v){s=true;AF=true}}if(s){q.hide();t=this.container.offset();AC=this.container.outerHeight(false);AD=this.container.outerWidth(false);y=q.outerHeight(false);p=AA.scrollLeft()+AH;AG=AA.scrollTop()+w;r=t.top+AC;AE=t.left;z=q.outerWidth(false);AJ=AE+z<=p;q.show()}if(this.opts.dropdownAutoWidth){AB=d(".select2-results",q)[0];q.addClass("select2-drop-auto-width");q.css("width","");z=q.outerWidth(false)+(AB.scrollHeight===AB.clientHeight?0:W.width);z>AD?AD=z:z=AD;AJ=AE+z<=p}else{this.container.removeClass("select2-drop-auto-width")}if(this.body().css("position")!=="static"){u=this.body().offset();r-=u.top;AE-=u.left}if(!AJ){AE=t.left+AD-z}x={left:AE,width:AD};if(AF){x.bottom=w-t.top;x.top="auto";this.container.addClass("select2-drop-above");q.addClass("select2-drop-above")}else{x.top=r;x.bottom="auto";this.container.removeClass("select2-drop-above");q.removeClass("select2-drop-above")}x=d.extend(x,c(this.opts.dropdownCss));q.css(x)},shouldOpen:function(){var o;if(this.opened()){return false}if(this._enabled===false||this._readonly===true){return false}o=d.Event("select2-opening");this.opts.element.trigger(o);return !o.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}this.opening();return true},opening:function(){var t=this.containerId,o="scroll."+t,r="resize."+t,q="orientationchange."+t,p;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}p=d("#select2-drop-mask");if(p.length==0){p=d(document.createElement("div"));p.attr("id","select2-drop-mask").attr("class","select2-drop-mask");p.hide();p.appendTo(this.body());p.on("mousedown touchstart click",function(v){var w=d("#select2-drop"),u;if(w.length>0){u=w.data("select2");if(u.opts.selectOnBlur){u.selectHighlighted({noFocus:true})}u.close({focus:true});v.preventDefault();v.stopPropagation()}})}if(this.dropdown.prev()[0]!==p[0]){this.dropdown.before(p)}d("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");p.show();this.positionDropdown();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){d(this).on(r+" "+o+" "+q,function(u){s.positionDropdown()})})},close:function(){if(!this.opened()){return }var r=this.containerId,o="scroll."+r,q="resize."+r,p="orientationchange."+r;this.container.parents().add(window).each(function(){d(this).off(o).off(q).off(p)});this.clearDropdownAlignmentPreference();d("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");this.opts.element.trigger(d.Event("select2-close"))},externalSearch:function(o){this.open();this.search.val(o);this.updateResults(false)},clearSearch:function(){},getMaximumSelectionSize:function(){return c(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var r=this.results,q,o,v,u,s,t,p;o=this.highlight();if(o<0){return }if(o==0){r.scrollTop(0);return }q=this.findHighlightableChoices().find(".select2-result-label");v=d(q[o]);u=v.offset().top+v.outerHeight(true);if(o===q.length-1){p=r.find("li.select2-more-results");if(p.length>0){u=p.offset().top+p.outerHeight(true)}}s=r.offset().top+r.outerHeight(true);if(u>s){r.scrollTop(r.scrollTop()+(u-s))}t=v.offset().top-r.offset().top;if(t<0&&v.css("display")!="none"){r.scrollTop(r.scrollTop()+t)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(r){var q=this.findHighlightableChoices(),p=this.highlight();while(p>-1&&p<q.length){p+=r;var o=d(q[p]);if(o.hasClass("select2-result-selectable")&&!o.hasClass("select2-disabled")&&!o.hasClass("select2-selected")){this.highlight(p);break}}},highlight:function(p){var r=this.findHighlightableChoices(),o,q;if(arguments.length===0){return Q(r.filter(".select2-highlighted")[0],r.get())}if(p>=r.length){p=r.length-1}if(p<0){p=0}this.removeHighlight();o=d(r[p]);o.addClass("select2-highlighted");this.ensureHighlightVisible();q=o.data("select2-data");if(q){this.opts.element.trigger({type:"select2-highlight",val:this.id(q),choice:q})}},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(p){var o=d(p.target).closest(".select2-result-selectable");if(o.length>0&&!o.is(".select2-highlighted")){var q=this.findHighlightableChoices();this.highlight(q.index(o))}else{if(o.length==0){this.removeHighlight()}}},loadMoreIfNeeded:function(){var s=this.results,r=s.find("li.select2-more-results"),u,t=this.resultsPage+1,o=this,q=this.search.val(),p=this.context;if(r.length===0){return }u=r.offset().top-s.offset().top-s.height();if(u<=this.opts.loadMorePadding){r.addClass("select2-active");this.opts.query({element:this.opts.element,term:q,page:t,context:p,matcher:this.opts.matcher,callback:this.bind(function(v){if(!o.opened()){return }o.opts.populateResults.call(this,s,v.results,{term:q,page:t,context:p});o.postprocessResults(v,false,false);if(v.more===true){r.detach().appendTo(s).text(o.opts.formatLoadMore(t+1));window.setTimeout(function(){o.loadMoreIfNeeded()},10)}else{r.remove()}o.positionDropdown();o.resultsPage=t;o.context=v.context;this.opts.element.trigger({type:"select2-loaded",items:v})})})}},tokenize:function(){},updateResults:function(w){var AA=this.search,u=this.results,o=this.opts,t,z=this,x,s=AA.val(),q=d.data(this.container,"select2-last-term"),y;if(w!==true&&q&&T(s,q)){return }d.data(this.container,"select2-last-term",s);if(w!==true&&(this.showSearchInput===false||!this.opened())){return }function v(){AA.removeClass("select2-active");z.positionDropdown()}function p(AB){u.html(AB);v()}y=++this.queryCount;var r=this.getMaximumSelectionSize();if(r>=1){t=this.data();if(d.isArray(t)&&t.length>=r&&Y(o.formatSelectionTooBig,"formatSelectionTooBig")){p("<li class='select2-selection-limit'>"+o.formatSelectionTooBig(r)+"</li>");return }}if(AA.val().length<o.minimumInputLength){if(Y(o.formatInputTooShort,"formatInputTooShort")){p("<li class='select2-no-results'>"+o.formatInputTooShort(AA.val(),o.minimumInputLength)+"</li>")}else{p("")}if(w&&this.showSearch){this.showSearch(true)}return }if(o.maximumInputLength&&AA.val().length>o.maximumInputLength){if(Y(o.formatInputTooLong,"formatInputTooLong")){p("<li class='select2-no-results'>"+o.formatInputTooLong(AA.val(),o.maximumInputLength)+"</li>")}else{p("")}return }if(o.formatSearching&&this.findHighlightableChoices().length===0){p("<li class='select2-searching'>"+o.formatSearching()+"</li>")}AA.addClass("select2-active");this.removeHighlight();x=this.tokenize();if(x!=M&&x!=null){AA.val(x)}this.resultsPage=1;o.query({element:o.element,term:AA.val(),page:this.resultsPage,context:null,matcher:o.matcher,callback:this.bind(function(AC){var AB;if(y!=this.queryCount){return }if(!this.opened()){this.search.removeClass("select2-active");return }this.context=(AC.context===M)?null:AC.context;if(this.opts.createSearchChoice&&AA.val()!==""){AB=this.opts.createSearchChoice.call(z,AA.val(),AC.results);if(AB!==M&&AB!==null&&z.id(AB)!==M&&z.id(AB)!==null){if(d(AC.results).filter(function(){return T(z.id(this),z.id(AB))}).length===0){AC.results.unshift(AB)}}}if(AC.results.length===0&&Y(o.formatNoMatches,"formatNoMatches")){p("<li class='select2-no-results'>"+o.formatNoMatches(AA.val())+"</li>");return }u.empty();z.opts.populateResults.call(this,u,AC.results,{term:AA.val(),page:this.resultsPage,context:null});if(AC.more===true&&Y(o.formatLoadMore,"formatLoadMore")){u.append("<li class='select2-more-results'>"+z.opts.escapeMarkup(o.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){z.loadMoreIfNeeded()},10)}this.postprocessResults(AC,w);v();this.opts.element.trigger({type:"select2-loaded",items:AC})})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur){this.selectHighlighted({noFocus:true})}this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){i(this.search)},selectHighlighted:function(p){var o=this.highlight(),q=this.results.find(".select2-highlighted"),r=q.closest(".select2-result").data("select2-data");if(r){this.highlight(o);this.onSelect(r,p)}else{if(p&&p.noFocus){this.close()}}},getPlaceholder:function(){var o;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((o=this.getPlaceholderOption())!==M?o.text():M)},getPlaceholderOption:function(){if(this.select){var o=this.select.children("option").first();if(this.opts.placeholderOption!==M){return(this.opts.placeholderOption==="first"&&o)||(typeof this.opts.placeholderOption==="function"&&this.opts.placeholderOption(this.select))}else{if(o.text()===""&&o.val()===""){return o}}}},initContainerWidth:function(){function p(){var u,s,v,t,r,q;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){u=this.opts.element.attr("style");if(u!==M){s=u.split(";");for(t=0,r=s.length;t<r;t=t+1){q=s[t].replace(/\s/g,"");v=q.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(v!==null&&v.length>=1){return v[1]}}}if(this.opts.width==="resolve"){u=this.opts.element.css("width");if(u.indexOf("%")>0){return u}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(d.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var o=p.call(this);if(o!==null){this.container.css("width",o)}}});X=l(n,{createContainer:function(){var o=d(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return o},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.focusser.prop("disabled",!this.isInterfaceEnabled())}},opening:function(){var q,p,o;if(this.opts.minimumResultsForSearch>=0){this.showSearch(true)}this.parent.opening.apply(this,arguments);if(this.showSearchInput!==false){this.search.val(this.focusser.val())}this.search.focus();q=this.search.get(0);if(q.createTextRange){p=q.createTextRange();p.collapse(false);p.select()}else{if(q.setSelectionRange){o=this.search.val().length;q.setSelectionRange(o,o)}}if(this.search.val()===""){if(this.nextSearchTerm!=M){this.search.val(this.nextSearchTerm);this.search.select()}}this.focusser.prop("disabled",true).val("");this.updateResults(true);this.opts.element.trigger(d.Event("select2-open"))},close:function(o){if(!this.opened()){return }this.parent.close.apply(this,arguments);o=o||{focus:true};this.focusser.removeAttr("disabled");if(o.focus){this.focusser.focus()}},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},destroy:function(){d("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments)},initContainer:function(){var p,o=this.container,q=this.dropdown;if(this.opts.minimumResultsForSearch<0){this.showSearch(false)}else{this.showSearch(true)}this.selection=p=o.find(".select2-choice");this.focusser=o.find(".select2-focusser");this.focusser.attr("id","s2id_autogen"+A());d("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id"));this.focusser.attr("tabindex",this.elementTabIndex);this.search.on("keydown",this.bind(function(r){if(!this.isInterfaceEnabled()){return }if(r.which===k.PAGE_UP||r.which===k.PAGE_DOWN){a(r);return }switch(r.which){case k.UP:case k.DOWN:this.moveHighlight((r.which===k.UP)?-1:1);a(r);return ;case k.ENTER:this.selectHighlighted();a(r);return ;case k.TAB:this.selectHighlighted({noFocus:true});return ;case k.ESC:this.cancel(r);a(r);return }}));this.search.on("blur",this.bind(function(r){if(document.activeElement===this.body().get(0)){window.setTimeout(this.bind(function(){this.search.focus()}),0)}}));this.focusser.on("keydown",this.bind(function(r){if(!this.isInterfaceEnabled()){return }if(r.which===k.TAB||k.isControl(r)||k.isFunctionKey(r)||r.which===k.ESC){return }if(this.opts.openOnEnter===false&&r.which===k.ENTER){a(r);return }if(r.which==k.DOWN||r.which==k.UP||(r.which==k.ENTER&&this.opts.openOnEnter)){if(r.altKey||r.ctrlKey||r.shiftKey||r.metaKey){return }this.open();a(r);return }if(r.which==k.DELETE||r.which==k.BACKSPACE){if(this.opts.allowClear){this.clear()}a(r);return }}));f(this.focusser);this.focusser.on("keyup-change input",this.bind(function(r){if(this.opts.minimumResultsForSearch>=0){r.stopPropagation();if(this.opened()){return }this.open()}}));p.on("mousedown","abbr",this.bind(function(r){if(!this.isInterfaceEnabled()){return }this.clear();B(r);this.close();this.selection.focus()}));p.on("mousedown",this.bind(function(r){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}if(this.opened()){this.close()}else{if(this.isInterfaceEnabled()){this.open()}}a(r)}));q.on("mousedown",this.bind(function(){this.search.focus()}));p.on("focus",this.bind(function(r){a(r)}));this.focusser.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");this.opts.element.trigger(d.Event("select2-blur"))}}));this.search.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.container.addClass("select2-container-active")}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.setPlaceholder()},clear:function(q){var r=this.selection.data("select2-data");if(r){var p=d.Event("select2-clearing");this.opts.element.trigger(p);if(p.isDefaultPrevented()){return }var o=this.getPlaceholderOption();this.opts.element.val(o?o.val():"");this.selection.find(".select2-chosen").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(q!==false){this.opts.element.trigger({type:"select2-removed",val:this.id(r),choice:r});this.triggerChange({removed:r})}}},initSelection:function(){var p;if(this.isPlaceholderOptionSelected()){this.updateSelection(null);this.close();this.setPlaceholder()}else{var o=this;this.opts.initSelection.call(null,this.opts.element,function(q){if(q!==M&&q!==null){o.updateSelection(q);o.close();o.setPlaceholder()}})}},isPlaceholderOptionSelected:function(){var o;if(!this.getPlaceholder()){return false}return((o=this.getPlaceholderOption())!==M&&o.prop("selected"))||(this.opts.element.val()==="")||(this.opts.element.val()===M)||(this.opts.element.val()===null)},prepareOpts:function(){var p=this.parent.prepareOpts.apply(this,arguments),o=this;if(p.element.get(0).tagName.toLowerCase()==="select"){p.initSelection=function(q,s){var r=q.find("option").filter(function(){return this.selected});s(o.optionToData(r))}}else{if("data" in p){p.initSelection=p.initSelection||function(r,t){var s=r.val();var q=null;p.query({matcher:function(u,x,v){var w=T(s,p.id(v));if(w){q=v}return w},callback:!d.isFunction(t)?d.noop:function(){t(q)}})}}}return p},getPlaceholder:function(){if(this.select){if(this.getPlaceholderOption()===M){return M}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var o=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&o!==M){if(this.select&&this.getPlaceholderOption()===M){return }this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(o));this.selection.addClass("select2-default");this.container.removeClass("select2-allowclear")}},postprocessResults:function(t,p,s){var r=0,o=this,u=true;this.findHighlightableChoices().each2(function(v,w){if(T(o.id(w.data("select2-data")),o.opts.element.val())){r=v;return false}});if(s!==false){if(p===true&&r>=0){this.highlight(r)}else{this.highlight(0)}}if(p===true){var q=this.opts.minimumResultsForSearch;if(q>=0){this.showSearch(R(t.results)>=q)}}},showSearch:function(o){if(this.showSearchInput===o){return }this.showSearchInput=o;this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!o);this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!o);d(this.dropdown,this.container).toggleClass("select2-with-searchbox",o)},onSelect:function(q,p){if(!this.triggerSelect(q)){return }var o=this.opts.element.val(),r=this.data();this.opts.element.val(this.id(q));this.updateSelection(q);this.opts.element.trigger({type:"select2-selected",val:this.id(q),choice:q});this.nextSearchTerm=this.opts.nextSearchTerm(q,this.search.val());this.close();if(!p||!p.noFocus){this.focusser.focus()}if(!T(o,this.id(q))){this.triggerChange({added:q,removed:r})}},updateSelection:function(r){var p=this.selection.find(".select2-chosen"),q,o;this.selection.data("select2-data",r);p.empty();if(r!==null){q=this.opts.formatSelection(r,p,this.opts.escapeMarkup)}if(q!==M){p.append(q)}o=this.opts.formatSelectionCssClass(r,p);if(o!==M){p.addClass(o)}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==M){this.container.addClass("select2-allowclear")}},val:function(){var s,p=false,q=null,o=this,r=this.data();if(arguments.length===0){return this.opts.element.val()}s=arguments[0];if(arguments.length>1){p=arguments[1]}if(this.select){this.select.val(s).find("option").filter(function(){return this.selected}).each2(function(t,u){q=o.optionToData(u);return false});this.updateSelection(q);this.setPlaceholder();if(p){this.triggerChange({added:q,removed:r})}}else{if(!s&&s!==0){this.clear(p);return }if(this.opts.initSelection===M){throw new Error("cannot call val() if initSelection() is not defined")}this.opts.element.val(s);this.opts.initSelection(this.opts.element,function(t){o.opts.element.val(!t?"":o.id(t));o.updateSelection(t);o.setPlaceholder();if(p){o.triggerChange({added:t,removed:r})}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(q){var p,o=false;if(arguments.length===0){p=this.selection.data("select2-data");if(p==M){p=null}return p}else{if(arguments.length>1){o=arguments[1]}if(!q){this.clear(o)}else{p=this.data();this.opts.element.val(!q?"":this.id(q));this.updateSelection(q);if(o){this.triggerChange({added:q,removed:p})}}}}});C=l(n,{createContainer:function(){var o=d(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return o},prepareOpts:function(){var p=this.parent.prepareOpts.apply(this,arguments),o=this;if(p.element.get(0).tagName.toLowerCase()==="select"){p.initSelection=function(q,s){var r=[];q.find("option").filter(function(){return this.selected}).each2(function(t,u){r.push(o.optionToData(u))});s(r)}}else{if("data" in p){p.initSelection=p.initSelection||function(q,t){var r=I(q.val(),p.separator);var s=[];p.query({matcher:function(u,x,v){var w=d.grep(r,function(y){return T(y,p.id(v))}).length;if(w){s.push(v)}return w},callback:!d.isFunction(t)?d.noop:function(){var u=[];for(var x=0;x<r.length;x++){var y=r[x];for(var w=0;w<s.length;w++){var v=s[w];if(T(y,p.id(v))){u.push(v);s.splice(w,1);break}}}t(u)}})}}}return p},selectChoice:function(o){var p=this.container.find(".select2-search-choice-focus");if(p.length&&o&&o[0]==p[0]){}else{if(p.length){this.opts.element.trigger("choice-deselected",p)}p.removeClass("select2-search-choice-focus");if(o&&o.length){this.close();o.addClass("select2-search-choice-focus");this.opts.element.trigger("choice-selected",o)}}},destroy:function(){d("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments)},initContainer:function(){var o=".select2-choices",p;this.searchContainer=this.container.find(".select2-search-field");this.selection=p=this.container.find(o);var q=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(r){q.search[0].focus();q.selectChoice(d(this))});this.search.attr("id","s2id_autogen"+A());d("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id"));this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled()){return }if(!this.opened()){this.open()}}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(v){if(!this.isInterfaceEnabled()){return }++this.keydowns;var t=p.find(".select2-search-choice-focus");var u=t.prev(".select2-search-choice:not(.select2-locked)");var s=t.next(".select2-search-choice:not(.select2-locked)");var w=F(this.search);if(t.length&&(v.which==k.LEFT||v.which==k.RIGHT||v.which==k.BACKSPACE||v.which==k.DELETE||v.which==k.ENTER)){var r=t;if(v.which==k.LEFT&&u.length){r=u}else{if(v.which==k.RIGHT){r=s.length?s:null}else{if(v.which===k.BACKSPACE){this.unselect(t.first());this.search.width(10);r=u.length?u:s}else{if(v.which==k.DELETE){this.unselect(t.first());this.search.width(10);r=s.length?s:null}else{if(v.which==k.ENTER){r=null}}}}}this.selectChoice(r);a(v);if(!r||!r.length){this.open()}return }else{if(((v.which===k.BACKSPACE&&this.keydowns==1)||v.which==k.LEFT)&&(w.offset==0&&!w.length)){this.selectChoice(p.find(".select2-search-choice:not(.select2-locked)").last());a(v);return }else{this.selectChoice(null)}}if(this.opened()){switch(v.which){case k.UP:case k.DOWN:this.moveHighlight((v.which===k.UP)?-1:1);a(v);return ;case k.ENTER:this.selectHighlighted();a(v);return ;case k.TAB:this.selectHighlighted({noFocus:true});this.close();return ;case k.ESC:this.cancel(v);a(v);return }}if(v.which===k.TAB||k.isControl(v)||k.isFunctionKey(v)||v.which===k.BACKSPACE||v.which===k.ESC){return }if(v.which===k.ENTER){if(this.opts.openOnEnter===false){return }else{if(v.altKey||v.ctrlKey||v.shiftKey||v.metaKey){return }}}this.open();if(v.which===k.PAGE_UP||v.which===k.PAGE_DOWN){a(v)}if(v.which===k.ENTER){a(v)}}));this.search.on("keyup",this.bind(function(r){this.keydowns=0;this.resizeSearch()}));this.search.on("blur",this.bind(function(r){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.selectChoice(null);if(!this.opened()){this.clearSearch()}r.stopImmediatePropagation();this.opts.element.trigger(d.Event("select2-blur"))}));this.container.on("click",o,this.bind(function(r){if(!this.isInterfaceEnabled()){return }if(d(r.target).closest(".select2-search-choice").length>0){return }this.selectChoice(null);this.clearPlaceholder();if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.open();this.focusSearch();r.preventDefault()}));this.container.on("focus",o,this.bind(function(){if(!this.isInterfaceEnabled()){return }if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.clearSearch()},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.search.prop("disabled",!this.isInterfaceEnabled())}},initSelection:function(){var p;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var o=this;this.opts.initSelection.call(null,this.opts.element,function(q){if(q!==M&&q!==null){o.updateSelection(q);o.close();o.clearSearch()}})}},clearSearch:function(){var p=this.getPlaceholder(),o=this.getMaxSearchWidth();if(p!==M&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(p).addClass("select2-default");this.search.width(o>0?o:this.container.css("width"))}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.updateResults(true);this.search.focus();this.opts.element.trigger(d.Event("select2-open"))},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(r){var q=[],p=[],o=this;d(r).each(function(){if(Q(o.id(this),q)<0){q.push(o.id(this));p.push(this)}});r=p;this.selection.find(".select2-search-choice").remove();d(r).each(function(){o.addSelectedChoice(this)});o.postprocessResults()},tokenize:function(){var o=this.search.val();o=this.opts.tokenizer.call(this,o,this.data(),this.bind(this.onSelect),this.opts);if(o!=null&&o!=M){this.search.val(o);if(o.length>0){this.open()}}},onSelect:function(p,o){if(!this.triggerSelect(p)){return }this.addSelectedChoice(p);this.opts.element.trigger({type:"selected",val:this.id(p),choice:p});if(this.select||!this.opts.closeOnSelect){this.postprocessResults(p,false,this.opts.closeOnSelect===true)}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:p});if(!o||!o.noFocus){this.focusSearch()}},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(s){var u=!s.locked,q=d("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),v=d("<li class='select2-search-choice select2-locked'><div></div></li>");var r=u?q:v,o=this.id(s),p=this.getVal(),t,w;t=this.opts.formatSelection(s,r.find("div"),this.opts.escapeMarkup);if(t!=M){r.find("div").replaceWith("<div>"+t+"</div>")}w=this.opts.formatSelectionCssClass(s,r.find("div"));if(w!=M){r.addClass(w)}if(u){r.find(".select2-search-choice-close").on("mousedown",a).on("click dblclick",this.bind(function(x){if(!this.isInterfaceEnabled()){return }d(x.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(d(x.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();a(x)})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled()){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}r.data("select2-data",s);r.insertBefore(this.searchContainer);p.push(o);this.setVal(p)},unselect:function(q){var s=this.getVal(),r,p;q=q.closest(".select2-search-choice");if(q.length===0){throw"Invalid argument: "+q+". Must be .select2-search-choice"}r=q.data("select2-data");if(!r){return }while((p=Q(this.id(r),s))>=0){s.splice(p,1);this.setVal(s);if(this.select){this.postprocessResults()}}var o=d.Event("select2-removing");o.val=this.id(r);o.choice=r;this.opts.element.trigger(o);if(o.isDefaultPrevented()){return }q.remove();this.opts.element.trigger({type:"select2-removed",val:this.id(r),choice:r});this.triggerChange({removed:r})},postprocessResults:function(s,p,r){var t=this.getVal(),u=this.results.find(".select2-result"),q=this.results.find(".select2-result-with-children"),o=this;u.each2(function(w,v){var x=o.id(v.data("select2-data"));if(Q(x,t)>=0){v.addClass("select2-selected");v.find(".select2-result-selectable").addClass("select2-selected")}});q.each2(function(w,v){if(!v.is(".select2-result-selectable")&&v.find(".select2-result-selectable:not(.select2-selected)").length===0){v.addClass("select2-selected")}});if(this.highlight()==-1&&r!==false){o.highlight(0)}if(!this.opts.createSearchChoice&&!u.filter(".select2-result:not(.select2-selected)").length>0){if(!s||s&&!s.more&&this.results.find(".select2-no-results").length===0){if(Y(o.opts.formatNoMatches,"formatNoMatches")){this.results.append("<li class='select2-no-results'>"+o.opts.formatNoMatches(o.search.val())+"</li>")}}}},getMaxSearchWidth:function(){return this.selection.width()-H(this.search)},resizeSearch:function(){var t,r,q,o,p,s=H(this.search);t=N(this.search)+10;r=this.search.offset().left;q=this.selection.width();o=this.selection.offset().left;p=q-(r-o)-s;if(p<t){p=q-s}if(p<40){p=q-s}if(p<=0){p=t}this.search.width(Math.floor(p))},getVal:function(){var o;if(this.select){o=this.select.val();return o===null?[]:o}else{o=this.opts.element.val();return I(o,this.opts.separator)}},setVal:function(p){var o;if(this.select){this.select.val(p)}else{o=[];d(p).each(function(){if(Q(this,o)<0){o.push(this)}});this.opts.element.val(o.length===0?"":o.join(this.opts.separator))}},buildChangeDetails:function(o,r){var r=r.slice(0),o=o.slice(0);for(var q=0;q<r.length;q++){for(var p=0;p<o.length;p++){if(T(this.opts.id(r[q]),this.opts.id(o[p]))){r.splice(q,1);if(q>0){q--}o.splice(p,1);p--}}}return{added:r,removed:o}},val:function(r,p){var q,o=this;if(arguments.length===0){return this.getVal()}q=this.data();if(!q.length){q=[]}if(!r&&r!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(p){this.triggerChange({added:this.data(),removed:q})}return }this.setVal(r);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(p){this.triggerChange(this.buildChangeDetails(q,this.data()))}}else{if(this.opts.initSelection===M){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(t){var s=d.map(t,o.id);o.setVal(s);o.updateSelection(t);o.clearSearch();if(p){o.triggerChange(o.buildChangeDetails(q,o.data()))}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var p=[],o=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){p.push(o.opts.id(d(this).data("select2-data")))});this.setVal(p);this.triggerChange()},data:function(q,r){var p=this,s,o;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return d(this).data("select2-data")}).get()}else{o=this.data();if(!q){q=[]}s=d.map(q,function(t){return p.opts.id(t)});this.setVal(s);this.updateSelection(q);this.clearSearch();if(r){this.triggerChange(this.buildChangeDetails(o,this.data()))}}}});d.fn.select2=function(){var t=Array.prototype.slice.call(arguments,0),p,s,o,v,x,w=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],q=["val","data"],r={search:"externalSearch"};this.each(function(){if(t.length===0||typeof (t[0])==="object"){p=t.length===0?{}:d.extend({},t[0]);p.element=d(this);if(p.element.get(0).tagName.toLowerCase()==="select"){x=p.element.prop("multiple")}else{x=p.multiple||false;if("tags" in p){p.multiple=x=true}}s=x?new C():new X();s.init(p)}else{if(typeof (t[0])==="string"){if(Q(t[0],w)<0){throw"Unknown method: "+t[0]}v=M;s=d(this).data("select2");if(s===M){return }o=t[0];if(o==="container"){v=s.container}else{if(o==="dropdown"){v=s.dropdown}else{if(r[o]){o=r[o]}v=s[o].apply(s,t.slice(1))}}if(Q(t[0],u)>=0||(Q(t[0],q)&&t.length==1)){return false}}else{throw"Invalid arguments to select2 plugin: "+t}}});return(v===M)?this:v};d.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(p,q,s,o){var r=[];U(p.text,s.term,r,o);return r.join("")},formatSelection:function(q,p,o){return q?o(q.text):M},sortResults:function(p,o,q){return p},formatResultCssClass:function(o){return M},formatSelectionCssClass:function(p,o){return M},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(o,p){var q=p-o.length;return"Please enter "+q+" more character"+(q==1?"":"s")},formatInputTooLong:function(p,o){var q=p.length-o;return"Please delete "+q+" character"+(q==1?"":"s")},formatSelectionTooBig:function(o){return"You can only select "+o+" item"+(o==1?"":"s")},formatLoadMore:function(o){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(o){return o.id},matcher:function(o,p){return E(""+p).toUpperCase().indexOf(E(""+o).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:G,escapeMarkup:g,blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(o){return o},adaptDropdownCssClass:function(o){return null},nextSearchTerm:function(o,p){return M}};d.fn.select2.ajaxDefaults={transport:d.ajax,params:{type:"GET",cache:false,dataType:"json"}};window.Select2={query:{ajax:e,local:h,tags:Z},util:{debounce:K,markMatch:U,escapeMarkup:g,stripDiacritics:E},"class":{"abstract":n,single:X,multi:C}}}(jQuery));;
;/* module-key = 'com.atlassian.auiplugin:aui-select2', location = 'js/aui-select2.js' */
(function(C){var E=C.fn.select2;var D="aui-select2-container";var B="aui-select2-drop aui-dropdown2 aui-style-default";var A="aui-has-avatar";C.fn.auiSelect2=function(I){var H;if(C.isPlainObject(I)){var F=C.extend({},I);var G=F.hasAvatar?" "+A:"";F.containerCssClass=D+G+(F.containerCssClass?" "+F.containerCssClass:"");F.dropdownCssClass=B+G+(F.dropdownCssClass?" "+F.dropdownCssClass:"");H=Array.prototype.slice.call(arguments,1);H.unshift(F)}else{if(!arguments.length){H=[{containerCssClass:D,dropdownCssClass:B}]}else{H=arguments}}return E.apply(this,H)}})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:invites-resources', location = 'feature/invites/invite-hipchat-service.js' */
define("hipchat/invite/service",["hipchat/admin/configure-integration-data","jquery","underscore"],function(o,h,r){var f=24;var p=12;var i=[];var e=h({});var b={};var a={inviteUsersURL:AJS.contextPath()+"/rest/hipchat/integration/latest/users/invite"};function g(){return f}function s(){return i}function k(t){return r.find(i,function(u){if(u.username==t){return u}})}function q(t){var u=k(t.username);if(!r.contains(i,u)){i.push(t);e.trigger("user-added",t);j()}}function c(u){var t=k(u);if(t.isSuggested){AJS.trigger("analyticsEvent",{name:"notifications.hipchat.user.invite.remove.suggested",data:{}})}if(r.contains(i,t)){i=r.filter(i,function(v){return v.username!=u});e.trigger("user-removed",t.username);j()}}function j(){var t=i.length;if(t>=f){h("#invite-users-picker-container").hide();h("#inviation-limit-message").show()}else{h("#inviation-limit-message").hide();h("#invite-users-picker-container").show()}}function l(){i=[];e.off()}function m(){AJS.$("#invite-users-picker-container input[type='text']").prop("disabled",true);AJS.$("#hipchat-invite-form").on("select2-opening",function(v){v.preventDefault()});b.invitationProcessingStartedRenderer.call();var u=r.map(s(),function(v){return v.username});var t=JSON.stringify({"user-names":u});h.ajax({url:a.inviteUsersURL,type:"POST",contentType:"application/json",data:t}).done(function(w){for(var x=0;x<w.resultSet.length;x++){var v=w.resultSet[x];b.resultRenderer(v.userName,v.errorMessage)}b.renderDoneStep.call()}).fail(function(y){var x="Error";var v=AJS.escapeHtml(y.responseText);var w=AJS.escapeHtml(AJS.format("Reason: {1} ({0})",y.status,y.statusText));b.errorRenderer.call(this,x,v,w)}).always(function(){b.invitationProcessingCompletedRenderer.call()})}function d(){var t=h("#admin-configuration-page-uri").val();window.location=t}function n(t,u,x,v,w){b.invitationProcessingStartedRenderer=t;b.invitationProcessingCompletedRenderer=u;b.resultRenderer=x;b.renderDoneStep=v;b.errorRenderer=w;a.findInviteUsersURL=h("#hipchat-find-invite-users-uri").val()+"?max-results="+p;h.ajax(a.findInviteUsersURL,{type:"GET"}).done(function(E){var D=i.length>0;if(D){}else{if(E.users){var C=E.users.length;var A=Math.min(C,p);for(var y=0;y<A;y++){var z=E.users[y];var B={username:z.name,avatarUrl:z.extraSmallPictureURI,fullname:z.displayName,email:z.email,isSuggested:true};q(B)}}}})}return{getMaxInvitationsPerRequest:g,getUsers:s,addUser:q,removeUser:c,clear:l,initialise:n,sendInvitations:m,handleDone:d,events:e}});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:invites-resources', location = 'feature/invites/invite-hipchat.js' */
require(["hipchat/invite/service"],function(a){AJS.toInit(function(i){var e=i("#hipchat-invite-form");var m=HipChat.Templates.Configuration.invitee;var r=e.find(".hipchat-invitee-list");var f=e.find(".send-invites-button");var l=e.find(".cancel");var h=e.find(".done-button");var o=i("#authorize-not-now-link");var p=i("#invite-not-now-link");window.onbeforeunload=null;p.click(function(){AJS.trigger("analyticsEvent",{name:"notifications.hipchat.user.invite.wizard.dropout.invite.notnow",data:{}})});o.click(function(){AJS.trigger("analyticsEvent",{name:"notifications.hipchat.user.invite.wizard.dropout.authorize.notnow",data:{}})});var g=a.getMaxInvitationsPerRequest();i("#invite-explanation-message").html(AJS.format("Inviting your teammates to HipChat creates a HipChat account and sends them an activation email. Note that only {0} invitations can be sent at a time, but you can always return here to invite more users.",g));if(e.length==0){return}e.on("user-picker-user-selected",function(u,t){a.addUser(t)});r.on("click",".remove-invite-button",function(u){u.preventDefault();var t=i(this).closest(".hipchat-invitee");a.removeUser(t.attr("data-username"))});i(".hipchat-invitee-name-container").tipsy({live:true,gravity:"s"});i(".hipchat-invitee .email-container, .hipchat-invitee .aui-lozenge").tipsy({live:true,gravity:"n"});function k(t){var u;if(t&&(u=t.indexOf("@"))&&u>=0){return t.substr(u)}return t}function q(u,t){if(!t.emailDomain){t.emailDomain=k(t.email)}r.append(m(t));f.prop("disabled",false);f.removeAttr("aria-disabled")}function b(u,v){var t=r.find("[data-username='"+v+"']");t.remove();if(!a.getUsers().length){f.prop("disabled",true);f.attr("aria-disabled",true)}}function c(){f.attr("aria-disabled",true);var w=i("[data-invite-processing='idle']");w.addClass("hidden");var v=i("[data-invite-processing='running']");v.removeClass("hidden");var t=i(".email");t.hide();var u=i(".remove-invite-button");u.hide()}function j(){var u=i("[data-invite-processing='running']");u.addClass("hidden");var t=i("[data-invite-processing='idle']");t.removeClass("hidden")}function n(x,w){var v=i("[data-username='"+x+"']");var t=v.find(".aui-lozenge-success");var u=v.find(".aui-lozenge-current");if(w){u.text("Unable to invite");u.show();t.hide();u.tooltip({title:function(){return w}})}else{t.text("sent");t.show();u.hide()}}function d(){f.hide();l.hide();h.show();h.removeAttr("aria-disabled");h.removeAttr("disabled")}function s(v,t,u){var w=i("#invite-banner-messages");w.empty();AJS.messages.error("#invite-banner-messages",{title:v,body:"<p>"+t+"<br/>"+u+"</p>"})}a.events.on("user-added.invite-hipchat",q);a.events.on("user-removed",b);a.initialise(c,j,n,d,s);e.on("submit",function(t){t.preventDefault();a.sendInvitations()});h.click(function(t){t.preventDefault();a.handleDone()})})});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:invites-resources', location = 'feature/invites/user-picker.js' */
define("hipchat/invite/user-picker",["jquery"],function(a){return function(e,d,c){e=a(e);d=a(d);e.auiSelect2({ajax:{url:c.url,dataType:"json",delay:200,data:c.params,results:c.results,cache:true},multiple:true,minimumInputLength:2});e.select2("focus");function b(h){var g=c.choice(h.choice);if(g.always){g.always(function(i){if(!i.isRejected||!i.isRejected()){f(i)}})}else{f(g)}}function f(g){d.trigger("user-picker-user-selected",g);e.select2("val","")}e.on("selected",b)}});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/jira/jira-components-query-amd.js' */
define("hipchat/jira/query-component",function(){return JIRA.Components.Query});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/jira/jira-issues-amd.js' */
define("hipchat/jira/issues/searcher-collection",function(){return JIRA.Issues.SearcherCollection});define("hipchat/jira/issues/query-state-model",function(){return JIRA.Issues.QueryStateModel});define("hipchat/jira/issues/criteria-model",function(){return JIRA.Issues.CriteriaModel});define("hipchat/jira/issues/criteria-view",function(){return JIRA.Issues.CriteriaView});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/hipchat-scopes-provider-amd.js' */
define("hipchat/scopes-provider",function(){return HipChat.ScopesProvider});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:global', location = 'js/base.js' */
define("hipchat/base",["underscore","backbone","exports"],function(b,d,a){if(typeof HipChat==="undefined"||!HipChat){window.HipChat={}}function c(){a.View=d.View;a.Model=d.Model.extend({saveWrapper:function(e){this.trigger("waitingToSave");e.apply(this);this.trigger("saved")},addDebounceSave:function(e){this.save=b.wrap(b.debounce(this.save,e),this.saveWrapper)},traceAjaxRequests:function(j){var i=null;var h=i?"request:"+i:"request";var g=i?"sync:"+i:"sync";var e=i?"error:"+i:"error";var f=this;f.on(h,function(){JIRA.trace("ajax.request.started."+j)},this);f.on(g+" "+e,function(){JIRA.trace("ajax.request.completed."+j)},this)}});a.Collection=d.Collection;a.Events=d.Events}c()});;
;/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:hipchat-installed-scopes', location = 'install/hipchat-scopes-provider.js' */
(function(){function a(){var e="com.atlassian.plugins.base-hipchat-integration-plugin";var d=WRM.data instanceof Function?WRM.data:WRM.data.claim;var b=d(e+":hipchat-installed-scopes.scopes");function c(f){return b[f]!==undefined}return{hasScope:c}}window.HipChat=window.HipChat||{};window.HipChat.ScopesProvider=a()})();;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:widget-roomselector', location = 'js/widget/roomselector/roommapping-service.js' */
define("hipchat/widget/roomselector/roommapping-service",["ajs","jquery","underscore"],function(a,d,b){var c=(function(){var p={};var f=[];var l={};function g(){f=b.map(p,function(t){return{id:t.roomId,text:t.roomName,isPrivate:t.isPrivate}});f=b.sortBy(f,function(t){return t.text.toLocaleLowerCase()});b.each(l,function(t){t.apply(null,[f])})}function k(u){var t=d.Deferred();d.ajax({url:a.contextPath()+"/rest/hipchat/integration/1.0/rooms?roomName="+u,type:"POST",dataType:"json",cache:false}).done(function(v){var w={roomId:v.id,roomName:v.name};r(w);t.resolve(w)}).fail(function(v){t.reject(v)});return t}function r(t){p[t.roomId]=t;g()}function s(t){delete p[t.roomId];g()}function i(t){l[t]=t}function o(t){delete l[t]}function e(t){return p[t]}function n(){return f}var h={createRoom:k,addRoom:r,removeRoom:s,getRoomById:e,getRooms:n,onChange:i,offChange:o};var q=(function(t){var u=d.Deferred();d.ajax({url:a.contextPath()+"/rest/hipchat/integration/1.0/rooms?projectKey="+(b.isString(t)?t:""),dataType:"json",cache:false}).done(function(v){p=b.object(b.map(v,function(w){return[w.id,{roomId:w.id,roomName:w.name,isPrivate:w["private"]}]}));g(p);u.resolve(h)}).fail(function(){u.reject()});return u.promise()});var m={};var j=function(t){if(m[t]===undefined){m[t]=q(t)}return m[t]};j.reset=function(){m={}};return j})();return{roomServicePromise:c}});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:widget-roomselector', location = 'js/widget/roomselector/roomselector-view.js' */
define("hipchat/widget/roomselector/roomselector-view",["jquery","backbone","hipchat/widget/roomselector/roommapping-service","hipchat/scopes-provider"],function(f,i,b,a){var d="private-room";var c="public-room";function h(l){var m={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(l).replace(/[&<>"'\/\\]/g,function(n){return m[n]})}function e(){return f("[name='projectKey']").attr("content")}function g(l,m){var n=b.roomServicePromise(e());return Class.extend({_formatResponse:function(t,q,s){var p=[];if(t.length>0){var r=new AJS.GroupDescriptor({weight:0,label:l?"All rooms":"Public rooms"});_.each(t,function(v){r.addItem(new AJS.ItemDescriptor({value:v.id,label:v.text,html:h(v.text),title:v.text,meta:{roomId:v.id,roomName:v.roomName||v.text,existing:true},styleClass:v.isPrivate?d:c}))});p.push(r)}if(!l){var u=new AJS.GroupDescriptor({weight:1,footerHtml:JIRA.Templates.HipChat.RoomSelector.loginDropdownFooter({hasManageRoomScope:m})});u.addItem(new AJS.ItemDescriptor({label:"filler",html:"filler",highlighted:true}));p.push(u)}else{if(s){var o=new AJS.GroupDescriptor({weight:1,label:"Create room"});o.addItem(new AJS.ItemDescriptor({value:q,label:q,html:h(q)+"<span class='aui-lozenge aui-lozenge-subtle aui-lozenge-complete'>new</span>",title:q,meta:{roomId:q,roomName:q,existing:false},highlighted:true,styleClass:c}));p.push(o)}}return p},execute:function(q){var p=jQuery.Deferred();var o=this;n.done(function(s){var x=s.getRooms();var t=q.toLocaleLowerCase();var v=false;var u=_.filter(x,function(y){var z=y.text.toLocaleLowerCase();if(z===t){v=true}return z.indexOf(t)>=0});var w=m&&(!v&&t.length>0);var r=o._formatResponse(u,q,w);JIRA.trace("ajax.request.completed.RoomSelector");p.resolve(r,q)}).fail(function(){var r=new AJS.GroupDescriptor({weight:1,footerHtml:JIRA.Templates.HipChat.RoomSelector.errorDropdownFooter({})});r.addItem(new AJS.ItemDescriptor({label:"filler",html:"filler",highlighted:true}));p.resolve([r],q)});return p}})}function j(n,l,o){var m=a.hasScope("manage_rooms");return new AJS.SingleSelect({element:n,width:o,suggestionsHandler:g(l,m),submitInputVal:true,matchingStrategy:"(.*)()({0})(.*)"})}var k=i.View.extend({events:{},initialize:function(m){if(!this.$el.length){return}this.roomSelector=j(this.$el,m.loggedIn,m.maxWidth);var l=this;this.roomSelector.model.$element.on("selected",function(o,n){if(n.properties.value!==""){l.roomSelector.$field.addClass(n.properties.styleClass);l.trigger("change")}else{l.roomSelector.$field.removeClass(c).removeClass(d);l.trigger("clear")}});this.roomSelector.model.$element.on("unselect",function(n){l.trigger("clear")})},getSelectedRoom:function(){var m=this.roomSelector.getSelectedDescriptor();var l=JSON.parse(m.properties.meta);return{id:l.roomId,roomName:l.roomName,existing:l.existing}},clearSelectedRoom:function(){this.roomSelector.clear();this.roomSelector._deactivate()}});return k});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:widget-roomselector', location = 'soy/widget/roomselector/roomselector-client.soy' */
// This file was automatically generated from roomselector-client.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.RoomSelector == 'undefined') { JIRA.Templates.HipChat.RoomSelector = {}; }


JIRA.Templates.HipChat.RoomSelector.loginDropdownFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-login-dropdown-footer"><h6>', soy.$$escapeHtml("Rooms"), '</h6><p>', (opt_data.hasManageRoomScope) ? "\x3ca href\x3d\x22#\x22 class\x3d\x22hipchat-user-link\x22\x3eConfirm access to your HipChat account\x3c/a\x3e, to view private rooms and create new rooms." : "\x3ca href\x3d\x22#\x22 class\x3d\x22hipchat-user-link\x22\x3eConfirm access to your HipChat account\x3ca/\x3e, to view private rooms.", '</p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.RoomSelector.errorDropdownFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-login-dropdown-footer error"><h6>', soy.$$escapeHtml("Error"), '</h6><p>', soy.$$escapeHtml("Failed to load the list of rooms from HipChat."), '</p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'soy/invites/hipchat-invite-jira-support.soy' */
// This file was automatically generated from hipchat-invite-jira-support.soy.
// Please don't edit this file by hand.

if (typeof HipChat == 'undefined') { var HipChat = {}; }
if (typeof HipChat.Templates == 'undefined') { HipChat.Templates = {}; }
if (typeof HipChat.Templates.Invite == 'undefined') { HipChat.Templates.Invite = {}; }
if (typeof HipChat.Templates.Invite.Support == 'undefined') { HipChat.Templates.Invite.Support = {}; }


HipChat.Templates.Invite.Support.userLinkUrl = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml(""), '/secure/ViewProfile.jspa?name=', soy.$$escapeHtml(opt_data.username));
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'soy/issuepanel/issuepanel.soy' */
// This file was automatically generated from issuepanel.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.Project == 'undefined') { JIRA.Templates.HipChat.Project = {}; }
if (typeof JIRA.Templates.HipChat.Project.IssuePanel == 'undefined') { JIRA.Templates.HipChat.Project.IssuePanel = {}; }


JIRA.Templates.HipChat.Project.IssuePanel.hipChatPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-issue-panel" data-issue-key="', soy.$$escapeHtml(opt_data.issueKey), '">');
  if (! opt_data.hipChatConfigured) {
    JIRA.Templates.HipChat.Project.IssuePanel.hipChatNotConfigured(opt_data, output);
  } else if (opt_data.jirauser && ! opt_data.hipChatUserName) {
    output.append("\x3ca href\x3d\x22#\x22 class\x3d\x22hipchat-user-link\x22\x3eConfirm access to your HipChat account\x3c/a\x3e for more information.", '<p>');
  } else if (opt_data.privateRoom && opt_data.hipChatUserName && ! opt_data.personalToken) {
    output.append("\x3ca href\x3d\x22#\x22 class\x3d\x22hipchat-user-link\x22\x3eConfirm access to your HipChat account\x3c/a\x3e for more information.", '<p>');
  } else {
    output.append('<div id="hipchat-issue-panel-rooms-container" data-logged-in="', soy.$$escapeHtml(opt_data.personalToken), '" data-can-create-room="', soy.$$escapeHtml(opt_data.canCreateRoom), '" data-can-assign-room="', soy.$$escapeHtml(opt_data.canAssignRoom), '" data-hipchat-configured="', soy.$$escapeHtml(opt_data.hipChatConfigured), '"', (opt_data.hipChatUserName) ? 'data-hipchat-username="' + soy.$$escapeHtml(opt_data.hipChatUserName) + '"' : '', (opt_data.dedicatedRoom) ? 'data-dedicated-room-id="' + soy.$$escapeHtml(opt_data.dedicatedRoom.roomId) + '"' : '', '><ul class="item-details">');
    if (opt_data.privateRoom && opt_data.hipChatUserName && opt_data.personalToken && ! opt_data.userCanAccessPrivateRoom) {
      output.append(soy.$$escapeHtml("The dedicated room for this issue is private."), '<p>');
    } else {
      JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomSection({issueKey: opt_data.issueKey, dedicatedRoom: opt_data.dedicatedRoom, loggedIn: opt_data.personalToken, canCreateRoom: opt_data.canCreateRoom, canAssignRoom: opt_data.canAssignRoom, isAdmin: opt_data.isAdmin}, output);
    }
    if (opt_data.connectionStatus == 'CONNECTED') {
      JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomSection(null, output);
    }
    output.append('</ul></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.hipChatNotConfigured = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="hipchat-issue-panel-rooms-container" data-project-key="', soy.$$escapeHtml(opt_data.projectKey), '">');
  var configureUrl__soy62 = new soy.StringBuilder((opt_data.isAdmin) ? soy.$$escapeHtml("" + '/plugins/servlet/hipchat/configure?source=issue-panel') : (opt_data.isProjectAdmin) ? soy.$$escapeHtml("" + '/secure/ConfigureHipChat.jspa?source=issue-panel&projectKey=' + opt_data.projectKey) : '');
  configureUrl__soy62 = configureUrl__soy62.toString();
  output.append('<p>', AJS.format("Do you want to discuss this issue? Connect to HipChat.",configureUrl__soy62), '</p><p>');
  aui.buttons.button({id: 'hipchat-issue-panel-configure-button', text: "Connect", extraAttributes: 'data-configure-url="' + configureUrl__soy62 + '"'}, output);
  output.append('<a id="hipchat-issue-panel-hide" href="#">', soy.$$escapeHtml("Dismiss"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li id="hipchat-dedicated-room-section"><div class="hipchat-settings-button"><span class="aui-icon aui-icon-small aui-iconfont-configure hidden" id="hipchat-panel-settings"></span></div><dl><dt class="dedicated-room-label">', soy.$$escapeHtml("Dedicated room:"), '</dt><dd class="hipchat-dedicated-room-content">');
  if (opt_data.dedicatedRoom) {
    JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomDetails(opt_data, output);
  } else {
    JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomForm(opt_data, output);
  }
  output.append('</dd></dl><div id="hipchat-dedicated-room-footer"><div id="hipchat-dedicated-room-errors" class="errors"/><div id="dedicated-room-message-bar" /></div></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.selectRoomDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1>', soy.$$escapeHtml("Choose a room"), '</h1>');
  if (opt_data.hipChatUserName) {
    output.append('<div class="dialog-panel-body"><form class="hipchat-room-select-form aui"><div class="dialog-panel-body-header aui-item">', soy.$$escapeHtml("Discuss this issue and be notified of any changes in a room of your choice."), '</div><div class="field-group"><div id="hipchat-dedicated-room-select-container" class="hipchat-room-selector-container" ', (opt_data.hipChatUserName) ? 'data-hipchat-username="' + soy.$$escapeHtml(opt_data.hipChatUserName) + '"' : '', '><select id="hipchat-dedicated-room-select" class="hidden hipchat-room-selector"><option value="" disabled selected>', soy.$$escapeHtml("Select HipChat room"), '</option></select></div></div><div class="dialog-errors"></div></form></div><div class="buttons-container form-footer">');
    JIRA.Templates.HipChat.Project.IssuePanel.selectRoomDialogButtons(null, output);
    output.append('</div>');
  } else {
    output.append('<div class="dialog-panel-body"><p>', "\x3ca class\x3d\x22hipchat-user-link\x22 href\x3d\x22#choose-room\x22\x3eConfirm access to your HipChat account\x3c/a\x3e to choose a dedicated room for this issue.", '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.selectRoomDialogButtons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons"><button class="aui-button submit" id="hipchat-select-dedicated-room-dialog-submit">', soy.$$escapeHtml("Select"), '</button><button class="aui-button aui-button-link cancel" id="hipchat-select-dedicated-room-dialog-close">', soy.$$escapeHtml("Cancel"), '</button></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li id="hipchat-mentioned-rooms-section"><dl><dt class="mentions-label">', soy.$$escapeHtml("Other rooms:"), '</dt><dd class="hipchat-mentioned-rooms-content"><span class="aui-icon aui-icon-wait"></span></dd></dl></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.loginMentionsDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-mentions-dialog-login"><h6>', soy.$$escapeHtml("HipChat discussions"), '</h6><p>', "\x3ca href\x3d\x22#open-issue-mentions\x22 class\x3d\x22hipchat-user-link\x22\x3eConfirm access to your HipChat account\x3c/a\x3e to see issue mention details", '</p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1>', soy.$$escapeHtml("HipChat discussions"), '</h1><div class="hipchat-mentions-dialog-content">');
  var param141 = new soy.StringBuilder('<ul>');
  var errorList143 = opt_data.errors;
  var errorListLen143 = errorList143.length;
  for (var errorIndex143 = 0; errorIndex143 < errorListLen143; errorIndex143++) {
    var errorData143 = errorList143[errorIndex143];
    param141.append('<li>', soy.$$escapeHtml(errorData143), '</li>');
  }
  param141.append('</ul>');
  aui.message.error({titleContent: "Failed to get issue mention details", content: param141.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1>', soy.$$escapeHtml("HipChat discussions"), '</h1><div class="hipchat-mentions-dialog-content">');
  var roomsMentionsLength__soy155 = opt_data.mentionRooms.length;
  var roomsNotAvailable__soy156 = opt_data.totalRooms - roomsMentionsLength__soy155;
  output.append('<h4>', soy.$$escapeHtml(AJS.format("{0} {0,choice,0#mentions|1#mention|1\x3cmentions} in {1} {1,choice,0#rooms|1#room|1\x3crooms}",opt_data.issueMentions.length,roomsMentionsLength__soy155)), '</h4>', (roomsNotAvailable__soy156 > 0) ? '<h7>' + soy.$$escapeHtml(AJS.format("There are mentions in {0} private room(s) you do not have access to.",roomsNotAvailable__soy156)) + '</h7>' : '', '<table class="aui"><thead><tr><th id="hipchat-mentioned-author">', soy.$$escapeHtml("Author"), '</th><th id="hipchat-mentioned-room">', soy.$$escapeHtml("Room"), '</th><th id="hipchat-mentioned-message">', soy.$$escapeHtml("Message"), '</th><th id="hipchat-mentioned-date">', soy.$$escapeHtml("Date"), '</th></tr></thead><tbody>');
  var mentionList174 = opt_data.issueMentions;
  var mentionListLen174 = mentionList174.length;
  for (var mentionIndex174 = 0; mentionIndex174 < mentionListLen174; mentionIndex174++) {
    var mentionData174 = mentionList174[mentionIndex174];
    var mentionMessage__soy175 = mentionData174.message;
    var mentionRoom__soy176 = mentionData174.room;
    var mentionUser__soy177 = mentionData174.user;
    output.append('<tr><td headers="hipchat-mentioned-author"><a href="#" class="hipchat-user-link-url" data-user-id="', soy.$$escapeHtml(mentionUser__soy177.id), '" data-api-url="', soy.$$escapeHtml(opt_data.apiUrl), '">', soy.$$truncate(soy.$$escapeHtml(mentionUser__soy177.name), 50, true), '</a></td><td headers="hipchat-mentioned-room"><a href="#" class="hipchat-dedicated-room-name public-room hipchat-room-link-url" data-api-url="', soy.$$escapeHtml(opt_data.apiUrl), '" data-room-id="', soy.$$escapeHtml(mentionRoom__soy176.id), '">', soy.$$truncate(soy.$$escapeHtml(mentionRoom__soy176.name), 50, true), '</a></td><td headers="hipchat-mentioned-message" title="', soy.$$escapeHtml(mentionMessage__soy175.text), '">', soy.$$truncate(soy.$$escapeHtml(mentionMessage__soy175.text), 100, true), '</td><td headers="hipchat-mentioned-date"><time class="livestamp date user-tz" data-datetime-format="fullAge" datetime="', soy.$$escapeHtml(mentionData174.localizedMessageDate), '">$', soy.$$escapeHtml(mentionData174.localizedMessageDate), '</time></td></tr>');
  }
  output.append('</tbody></table></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.inviteContributorsDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h1>', soy.$$escapeHtml("Invite users to room"), '</h1>');
  if (opt_data.hipChatUserName) {
    if (opt_data.dedicatedRoom) {
      output.append('<div class="dialog-panel-body"><form id="hipchat-invite-contributors-form" class="hipchat-invite-contributors-form aui" data-dedicated-room-id="', soy.$$escapeHtml(opt_data.dedicatedRoom.roomId), '"><div class="dialog-panel-body-header aui-item">');
      JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomDetails({loggedIn: opt_data.hipChatUserName, dedicatedRoom: opt_data.dedicatedRoom, hideUnlink: true, justLinked: false}, output);
      output.append('</div><div id="dedicated-room-invite-users-picker-container" class="field-group dedicated-room-invite-user-field"><label for="dedicated-room-invite-user">', soy.$$escapeHtml("Search for collaborators"), '</label><input type="hidden" name="dedicated-room-invite-user" id="dedicated-room-invite-user" placeholder="', soy.$$escapeHtml("Search for collaborators"), '"/><div class="user-picker-errors"></div></div>');
      HipChat.Templates.Configuration.inviteeList(null, output);
      output.append('<div class="dialog-errors"></div></form></div><div class="buttons-container form-footer">');
      JIRA.Templates.HipChat.Project.IssuePanel.inviteContributorsDialogButtons(null, output);
      output.append('</div>');
    } else {
      output.append('<div class="dialog-panel-body"><p>', soy.$$escapeHtml("Couldn\x27t find the dedicated room for this issue."), '</p></div>');
    }
  } else {
    output.append('<div class="dialog-panel-body"><p>', "You cannot invite people without granting JIRA access to your HipChat account.", '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.inviteContributorsDialogButtons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons"><button class="aui-button submit" id="hipchat-invite-contributors-dialog-submit">', soy.$$escapeHtml("Invite"), '</button><button class="aui-button aui-button-link cancel" id="hipchat-invite-contributors-dialog-close">', soy.$$escapeHtml("Close"), '</button></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'soy/issuepanel/issuepanel-client.soy' */
// This file was automatically generated from issuepanel-client.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.Project == 'undefined') { JIRA.Templates.HipChat.Project = {}; }
if (typeof JIRA.Templates.HipChat.Project.IssuePanel == 'undefined') { JIRA.Templates.HipChat.Project.IssuePanel = {}; }


JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomsDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var noOfMentionRooms__soy3 = opt_data.mentionedRooms.length;
  output.append((noOfMentionRooms__soy3 > 0) ? '<a id="hipchat-issue-mentions-list" href="' + soy.$$escapeHtml("" + '/secure/HipChatMentionedRooms.jspa?issueKey=' + opt_data.issueKey) + '"' + ((opt_data.userLoggedIntoHipChat) ? 'class="trigger-dialog-large">' : 'class="trigger-dialog">') : '<span>', soy.$$escapeHtml(AJS.format("Issue mentioned in {0} {0,choice,0#rooms|1#room|1\x3crooms}",noOfMentionRooms__soy3)), (noOfMentionRooms__soy3 > 0) ? '</a>' : '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomDetails = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-dedicated-room"><div class="hipchat-dedicated-room-icon ', (opt_data.justLinked) ? 'success' : '', '"><span class="aui-icon aui-icon-small aui-iconfont-approve"> </span>', (opt_data.dedicatedRoom.privateRoom) ? '<span class="aui-icon private-room"> </span>' : '<span class="aui-icon public-room"> </span>', '</div><a href="#" class="hipchat-dedicated-room-name public-room hipchat-room-link-url" data-api-url="', soy.$$escapeHtml(opt_data.dedicatedRoom.apiUrl), '" data-room-id="', soy.$$escapeHtml(opt_data.dedicatedRoom.roomId), '" data-issue-id="', soy.$$escapeHtml(opt_data.dedicatedRoom.issueId), '" data-room="', soy.$$escapeHtml(opt_data.dedicatedRoom.roomId), '">', soy.$$escapeHtml(opt_data.dedicatedRoom.name), '</a>', (opt_data.loggedIn && ! opt_data.hideUnlink) ? '<a class="trash-dedicated-room" href="#" title="' + soy.$$escapeHtml("Unlink room") + '"><span class="aui-icon aui-icon-small aui-iconfont-remove-label">Delete</span></a>' : '', '<div class="hc-button-spinner"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-no-dedicated-room">');
  if (opt_data.canAssignRoom) {
    output.append('<div id="hipchat-dedicated-room-buttons" class="buttons-container">');
    if (opt_data.canCreateRoom || opt_data.isAdmin) {
      aui.buttons.button({text: "Create a room", extraClasses: 'hipchat-create-dedicated-room hipchat-issue-panel-button'}, output);
    }
    output.append('<a id="hipchat-select-dedicated-room" href="', soy.$$escapeHtml("" + '/secure/HipChatSelectRoom.jspa?issueKey=' + opt_data.issueKey), '" class="hipchat-issue-panel-button hipchat-select-dedicated-room trigger-dialog-select-room">', soy.$$escapeHtml("Choose a room"), '</a><div class="hc-button-spinner"></div></div>');
  } else {
    output.append('<div>', soy.$$escapeHtml("None"), '</div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.notLoggedInMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-help aui-help-text hipchat-dedicated-room-not-logged-in"><div class="aui-help-content"><p>', "\x3ca class\x3d\x22hipchat-user-link\x22 href\x3d\x22#create-dedicated-room\x22\x3eConfirm access to your HipChat account\x3c/a\x3e to create a dedicated room for this issue.", '</p></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.cantCreateRoomMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-help aui-help-text hipchat-dedicated-room-not-logged-in"><div class="aui-help-content"><p>', AJS.format("HipChat integration \x3ca href\x3d\x22{0}\x22\x3ehas to be reinstalled\x3c/a\x3e in order to create dedicated rooms.","" + '/plugins/servlet/hipchat/configure'), '</p></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.invitee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  HipChat.Templates.Configuration.invitee({username: opt_data.user.userKey, avatarUrl: opt_data.user.avatarUrl, fullname: opt_data.user.displayName, email: opt_data.user.emailAddress, emailDomain: opt_data.user.emailDomain}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/invitecontributors.js' */
define("hipchat/feature/issuepanel/invitecontributors",["jquery","backbone"],function(b,c){var a=c.Model.extend({defaults:{hipChatUsersMap:{},appUsersMap:{}},initialize:function(){this.attributes.hipChatUsersMap={};this.attributes.appUsersMap={}},url:function(){return AJS.contextPath()+"/rest/hipchat/integrations/1.0/invite/issue/"+this.attributes.issueKey},destroy:function(){var d={data:JSON.stringify(this.toJSON()),contentType:"application/json"};return c.Model.prototype.destroy.call(this,d)}});return a});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/invitecontributors-view.js' */
define("hipchat/feature/issuepanel/invitecontributors-view",["jquery","backbone","hipchat/base","hipchat/feature/issuepanel/invitecontributors","hipchat/invite/user-picker"],function(e,f,c,d,a){var b=c.View.extend({events:{},initialize:function(g){this.loggedIn=g.loggedIn;this.canCreateRoom=g.canCreateRoom;this.canAssignRoom=g.canAssignRoom;this.isAdmin=g.isAdmin;this.hipChatUserName=g.hipChatUserName;this.issueKey=g.issueKey},close:function(){this.unbind()},openInviteDialog:function(i){var h=this;var g=h.issueKey;if(!h.dialog){h.dialog=new JIRA.FormDialog({id:"hipchat-invite-contributors-dialog",ajaxOptions:{url:AJS.contextPath()+"/secure/HipChatInviteContributors.jspa?issueKey="+g,data:{decorator:"dialog",inline:"false"}},width:400});h.initInviteContributorsDialog(h.dialog)}h.dialog.show()},initInviteContributorsDialog:function(h){var g=this;g.dialogContentReadyCallback=function(j,i){if(i.options.id==="hipchat-invite-contributors-dialog"){g.initializeDialogUi();g.initializeUserPicker();g.initializeContributorsList();e(document).unbind("dialogContentReady",g.dialogContentReadyCallback)}};e(document).bind("dialogContentReady",{},g.dialogContentReadyCallback)},getEmailDomain:function(g){var h;if(g&&(h=g.indexOf("@"))&&h>=0){return g.substr(h)}return g},setInviteButtonStatus:function(){var g=this;var h=g.model.get("hipChatUsersMap");var i=false;var j=Object.keys(h);j.forEach(function(k){if(!h[k].invitedAlready){i=true}});g.$inviteButton.prop("disabled",!i)},addHipChatUser:function(h){var g=this;var i=g.model.get("hipChatUsersMap");if(h.userKey in i){console.log("User "+h.userKey+" is already in the list, ignoring.");return}if(!h.emailDomain){h.emailDomain=g.getEmailDomain(h.emailAddress)}i[h.userKey]=h;g.$inviteeList.append(g.inviteeTemplate({user:h}));g.setInviteButtonStatus()},removeHipChatUser:function(j){var g=this;var i=g.$inviteeList.find("[data-username='"+j+"']");i.remove();var h=g.model.get("hipChatUsersMap");if(!(j in h)){console.log("User "+j+" is not in the list but it is asked to be removed, WTF?");return}h=_.omit(h,j);g.model.set("hipChatUsersMap",h);g.setInviteButtonStatus()},submitInviteContributorsDialog:function(){var i=this;i.$inviteButton.attr("disabled","disabled");i.$userFieldContainer.prop("disabled","disabled");i.dialog.showFooterLoadingIndicator();var k=e("#hipchat-invite-contributors-dialog").find(".dialog-errors");var h=e.Deferred();k.empty();var j=i.model.get("hipChatUsersMap");var m=Object.keys(j);if(!m.length){console.log("No user to be invited but this method is called, WTF?");return}var l=[];m.forEach(function(n){var o=j[n].mentionName;if(!j[n].invitedAlready&&l.indexOf(o)<0){l.push(o)}});i.model.save({mentionNames:l}).done(function(n){h.resolve();i.dialog.hideFooterLoadingIndicator()}).fail(function(n){console.log("An error occurred while making a server-side call to invite contributors.");h.reject(n)});var g=function(p){var o=i.$form.find(".icon-holder");o.each(function(q){e(this).hide()});var n=i.$form.find(".status-icon-holder");n.show();n.each(function(s){var r=e(this);if(!r.data("already-invited")){if(p){r.data("already-invited",true)}var q=e(this).find(".success");var t=e(this).find(".failure");setTimeout(function(){e(q).css("display",p?"inline-block":"none");e(t).css("display",p?"none":"inline-block")},100*s)}})};h.done(function(o){g(true);var n=i.model.get("hipChatUsersMap");var p=Object.keys(n);p.forEach(function(q){n[q].invitedAlready=true});i.model.set("hipChatUsersMap",n);JIRA.trace("hipchat.invite.contributors.successful")}).fail(function(n){g(false);k.empty();k.append(AJS.format("Failed to invite users: {0}",n.statusText));i.$inviteButton.removeAttr("disabled");i.$userFieldContainer.removeAttr("disabled")}).always(function(){i.dialog.hideFooterLoadingIndicator()})},initializeDialogUi:function(){var g=this;g.$form=e("#hipchat-invite-contributors-dialog").find("form");g.$userFieldContainer=g.$form.find("#dedicated-room-invite-users-picker-container");g.$userField=g.$form.find("#dedicated-room-invite-user");g.$closeButton=e("#hipchat-invite-contributors-dialog-close");g.$inviteButton=e("#hipchat-invite-contributors-dialog-submit");g.$inviteeList=g.$form.find(".hipchat-invitee-list");g.inviteeTemplate=JIRA.Templates.HipChat.Project.IssuePanel.invitee;g.$inviteeList.on("click",".remove-invite-button",function(i){i.preventDefault();var h=e(this).closest(".hipchat-invitee");g.removeHipChatUser(h.attr("data-username"))});g.$form.on("user-picker-user-selected",function(i,h){g.addHipChatUser(h)});g.$inviteButton.on("click",function(h){g.submitInviteContributorsDialog()})},initializeContributorsList:function(){var h=this;var g=AJS.Meta.get("issue-key");h.model=new d({issueKey:g});h.setInviteButtonStatus();var j=e("#hipchat-invite-contributors-dialog").find(".dialog-errors");j.empty();var i=h.$form.find(".hc-button-spinner");i.spin();h.model.fetch({success:function(k){i.spinStop();h.$inviteeList.empty();k.attributes.hipChatUsers.forEach(function(l){h.addHipChatUser(l)})},error:function(k){i.spinStop();j.empty();j.append("Failed to fetch list of issue contributors.")}})},initializeUserPicker:function(){var j=this;function h(l){return{maxResults:10,query:l,showAvatar:true}}function g(n,m){var l=_.reduce(n.users,function(o,p){o.push({id:p.name,text:p.displayName,restObj:p});return o},[]);return{results:l}}function k(m){var l=e.Deferred();var o=e("#dedicated-room-invite-users-picker-container").find(".user-picker-errors");o.empty();var n=j.$form.find(".hc-button-spinner");n.spin();i(m.restObj.key).done(function(p){l.resolve(p)}).always(function(){n.spinStop()}).fail(function(p){o.empty();o.append("Sorry, this user doesn\'t have a HipChat account.");j.$userField.select2("val","");l.reject(p)});return l.promise()}function i(n){var m=AJS.contextPath()+"/rest/hipchat/integrations/1.0/invite/user/"+n;var l=e.Deferred();e.ajax(m,{type:"GET",dataType:"json"}).done(function(o){if(o.hipChatUser){l.resolve(o)}else{l.reject()}}).fail(function(o){l.reject(o)});return l.promise()}a(j.$userField,j.$form,{url:AJS.contextPath()+"/rest/api/2/user/picker",params:h,results:g,choice:k})}});return b});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/dedicatedroom.js' */
define("hipchat/feature/issuepanel/dedicatedroom",["jquery","backbone"],function(a,c){var b=c.Model.extend({url:function(){return AJS.contextPath()+"/rest/hipchat/integrations/1.0/dedicatedroom/"},destroy:function(){var d={data:JSON.stringify(this.toJSON()),contentType:"application/json"};this.id=-1;return c.Model.prototype.destroy.call(this,d)}});return b});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/dedicatedroom-view.js' */
define("hipchat/feature/issuepanel/dedicatedroom-view",["jquery","backbone","hipchat/base","hipchat/feature/issuepanel/dedicatedroom","hipchat/widget/roomselector/roommapping-service","hipchat/widget/roomselector/roomselector-view","hipchat/feature/issuepanel/invitecontributors","hipchat/feature/issuepanel/invitecontributors-view"],function(d,f,i,e,b,h,a,c){var g=i.View.extend({events:{"click .hipchat-create-dedicated-room":"createDedicatedRoom","click a.trigger-dialog-select-room":"openSelectRoomDialog","click .trash-dedicated-room":"unassignDedicatedRoom"},initialize:function(j){this.loggedIn=j.loggedIn;this.canCreateRoom=j.canCreateRoom;this.canAssignRoom=j.canAssignRoom;this.isAdmin=j.isAdmin;this.hipChatUserName=j.hipChatUserName;this.issueKey=j.issueKey},initInviteContributorsView:function(j){var l={issueKey:j};var m=new a(l);var k=_.extend(this.options,{model:m});this.inviteContributorsView=new c(k)},close:function(){if(this.inviteContributorsView){this.inviteContributorsView.close()}if(this.dialogContentReadycallback){d(document).unbind("dialogContentReady",this.dialogContentReadycallback)}this.unbind()},createDedicatedRoom:function(m){var k=this.$(".hipchat-create-dedicated-room");var j=this;if(j.loggedIn&&j.canCreateRoom){k.attr("disabled","disabled");j.createOrAssignDedicatedRoom().done(function(n){JIRA.trace("hipchat.dedicated.room.created");if(!n.privateRoom){j.inviteContributorsView.openInviteDialog(n.roomId)}}).always(function(){k.removeAttr("disabled")})}else{if(!j.loggedIn||!j.canCreateRoom){var l=AJS.InlineDialog(k,"create-dedicated-room-not-logged-in-dialog",function(p,n,q){var o;if(!j.canCreateRoom&&j.isAdmin){o=JIRA.Templates.HipChat.Project.IssuePanel.cantCreateRoomMessage({})}else{o=JIRA.Templates.HipChat.Project.IssuePanel.notLoggedInMessage({})}p.html(o);q()},{noBind:true,hideDelay:null});l.show(m,k)}}},createOrAssignDedicatedRoom:function(n){var l=this;var k=l.issueKey;var j=d.Deferred();var o=l.$("#hipchat-dedicated-room-errors");l.clearError(o);var m=l.$(".hc-button-spinner");m.spin();l.model.save({issue_key:k,room_id:n}).done(function(p){var q=JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomDetails({loggedIn:l.loggedIn,dedicatedRoom:p,created:true});l.$(".hipchat-dedicated-room-content").hide().html(q).fadeIn({complete:function(){setTimeout(function(){l.$(".hipchat-dedicated-room-icon").removeClass("success")},1500)}});var r=d("#hipchat-issue-panel-rooms-container");r.data("dedicated-room-id",p.roomId);JIRA.trace("hipchat.dedicated.room.created");l.initInviteContributorsView(l.issueKey);j.resolve(p)}).fail(function(p){l.displayError(o,n===undefined?"Failed to create a dedicated room":"Failed to assign a dedicated room",p);j.reject(p)}).always(function(){m.spinStop();var p=d(".hipchat-create-dedicated-room");p.removeAttr("disabled")});return j},openSelectRoomDialog:function(k){k.preventDefault();var j=k.currentTarget;if(this.dialog===undefined){this.dialog=new JIRA.FormDialog({id:j.id+"-dialog",ajaxOptions:{url:j.href,data:{decorator:"dialog",inline:"false"}},width:400});this.initSelectRoomDialog(this.dialog)}this.dialog.show()},initSelectRoomDialog:function(k){var j=this;j.dialogContentReadycallback=function(q,o){if(o.options.id==="hipchat-select-dedicated-room-dialog"){var n=b.roomServicePromise();if(!j.loggedIn){return}var r=new h({el:d("#hipchat-dedicated-room-select"),loggedIn:j.loggedIn,maxWidth:"480px"});var l={roomSelector:r,clearSelectedRoom:function(){this.roomSelector.clearSelectedRoom();this.disableSubmitButton()},enableSubmitButton:function(){var s=this.roomSelector.getSelectedRoom();if(s&&s.id!==""){d("#hipchat-select-dedicated-room-dialog-submit").removeAttr("aria-disabled").removeAttr("disabled")}},disableSubmitButton:function(){d("#hipchat-select-dedicated-room-dialog-submit").attr({"aria-disabled":"true",disabled:""})},roomSelected:function(){return d("#hipchat-select-dedicated-room-dialog-submit").attr("disabled")===undefined},init:function(){this.roomSelector.on("change",this.enableSubmitButton,this);this.roomSelector.on("clear",this.disableSubmitButton,this)}};l.init();var p=function(){k.showFooterLoadingIndicator();var s=d.Deferred();var u=r.getSelectedRoom();if(!u.existing){var t=b.roomServicePromise();t.done(function(v){s=v.createRoom(u.roomName)}).fail(function(v){s.reject(v)})}else{s.resolve(u)}s.done(function(w){d("#hipchat-select-dedicated-room-dialog-close").click();var v=w.id||w.roomId;j.createOrAssignDedicatedRoom(v).done(function(x){JIRA.trace("hipchat.dedicated.room.selected");if(!x.privateRoom){j.inviteContributorsView.openInviteDialog(x.roomId)}})}).fail(function(v){j.displayError(d("#hipchat-select-dedicated-room-dialog").find(".errors"),"Failed to assign a dedicated room",v)}).always(function(){k.hideFooterLoadingIndicator()})};var m=d("#hipchat-select-dedicated-room-dialog").find("form");m.on("before-submit",function(s){s.preventDefault();if(l.roomSelected()){p()}});n.done(function(s){l.disableSubmitButton()}).fail(function(){l.disableSubmitButton()});d("#hipchat-select-dedicated-room-dialog-submit").on("click",p)}};d(document).bind("dialogContentReady",{},j.dialogContentReadycallback)},clearError:function(j){j.hide();j.empty()},displayError:function(k,m,j){k.show();k.empty();var l;if(j.status===503){l="Unable to connect to HipChat."}else{l=m}k.append(l)},unassignDedicatedRoom:function(n){n.preventDefault();var k=this;var j=d.Deferred();var m=k.$("#hipchat-dedicated-room-errors");k.clearError(m);var l=k.$(".hc-button-spinner");l.spin();k.$(".trash-dedicated-room").hide();k.model.destroy().always(function(){l.spinStop();var o=k.$(".trash-dedicated-room");o.data("hide-for-progress",false)}).done(function(){k.model=new e({});var o=JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoomForm({canAssignRoom:k.canAssignRoom,canCreateRoom:k.canCreateRoom,isAdmin:k.isAdmin,issueKey:k.issueKey});k.$(".hipchat-dedicated-room-content").html(o);AJS.messages.success("#dedicated-room-message-bar",{title:"Success",body:"The HipChat room will no longer receive notifications about this issue.",fadeout:true});JIRA.trace("hipchat.dedicated.room.deleted");j.resolve()}).fail(function(o){k.displayError(m,"Failed to un-assign a dedicated room",o);j.reject(o)});return j}});return g});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/issuemention.js' */
define("hipchat/feature/issuepanel/issuemention",["jquery","backbone"],function(b,c){var a=c.Model.extend({initialize:function(d){},url:function(){return AJS.contextPath()+"/rest/hipchat/integrations/1.0/issue-mentions/"+this.get("issue_key")+"/rooms"},parse:function(d){this.set("issueMentionRooms",d)}});return a});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/issuemention-view.js' */
define("hipchat/feature/issuepanel/issuemention-view",["jquery","backbone","hipchat/base"],function(c,d,b){var a=b.View.extend({events:{"click a.trigger-dialog-large":"openMentionDialog"},initialize:function(e){this.loggedIn=e.loggedIn;this.canCreateRoom=e.canCreateRoom;this.isAdmin=e.isAdmin;this.issueKey=e.issueKey;this.hipChatUserName=e.hipChatUserName;this.hipChatConfigured=e.hipChatConfigured;this.model.on("sync",this.updateMentionCount,this);this.model.on("sync",this.ready,this);this.model.on("error",this.displayError,this);if(this.hipChatConfigured){this.model.fetch()}},close:function(){this.unbind()},openMentionDialog:function(g){g.preventDefault();var f=g.currentTarget;if(this.dialog===undefined){this.dialog=new JIRA.FormDialog({id:f.id+"-dialog",ajaxOptions:{url:f.href,data:{decorator:"dialog",inline:"false"}},width:900})}this.dialog.show()},updateMentionCount:function(){var e=JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomsDescription({mentionedRooms:this.model.get("issueMentionRooms"),issueKey:this.issueKey,userLoggedIntoHipChat:this.loggedIn});this.$(".hipchat-mentioned-rooms-content").html(e);JIRA.trace("hipchat.mentioned.rooms.fetched")},ready:function(){this.trigger("ready")},displayError:function(f,h,e){var g=this.$(".hipchat-mentioned-rooms-content");g.empty();g.append("<span class='errors'>"+"Failed to get issue room mention information"+"</span>")}});return a});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/issuepanel-view.js' */
define("hipchat/feature/issuepanel/issuepanel-view",["jquery","backbone","hipchat/base","hipchat/feature/issuepanel/dedicatedroom","hipchat/feature/issuepanel/dedicatedroom-view","hipchat/feature/issuepanel/issuemention","hipchat/feature/issuepanel/issuemention-view"],function(a,h,k,c,i,d,j){var f="hipchat.inapp.links.first.clicked";var e="hipchat.inapp.links";var b=1;var g=k.View.extend({events:{"click #hipchat-issue-panel-configure-button":"configure","click #hipchat-issue-panel-hide":"dismissPanel"},initialize:function(l){this.initDedicatedView();this.initIssueMentionView();this.initPanelSettings()},initDedicatedView:function(){var n=this.getIssuePanelDetails();var o={};if(n.dedicatedRoomId){o={issue_key:n.issueKey,room_id:n.dedicatedRoomId}}var m=new c(o);var l=_.extend(n,{el:this.$("#hipchat-dedicated-room-section"),model:m});this.dedicatedRoomView=new i(l)},initIssueMentionView:function(){var m=this.getIssuePanelDetails();var l=_.extend({el:this.$("#hipchat-mentioned-rooms-section"),model:new d({issue_key:m.issueKey})},m);this.issueMentionView=new j(l);this.issueMentionView.on("ready",this.ready,this)},close:function(){this.dedicatedRoomView.close();this.issueMentionView.close()},ready:function(){this.trigger("ready")},getIssuePanelDetails:function(){var m=this.$el;var r=m.data("logged-in");var p=m.data("can-create-room");var l=m.data("can-assign-room");var s=AJS.Meta.get("is-admin");var n=m.data("hipchat-username");var q=m.data("dedicated-room-id");var t=m.data("hipchat-configured");var o=AJS.Meta.get("issue-key");return{loggedIn:r,canCreateRoom:p,canAssignRoom:l,isAdmin:s,hipChatUserName:n,dedicatedRoomId:q,hipChatConfigured:t,issueKey:o}},dismissPanel:function(o){o.preventDefault();var n=this.$el;var l=n.data("project-key");var m=this;a.ajax({type:"POST",url:AJS.contextPath()+"/rest/hipchat/integrations/1.0/issuepanel/hide?projectKey="+l,dataType:"json",cache:false}).done(function(){m.close();a("#hipchat-viewissue-panel").remove()}).fail(function(){})},configure:function(m){var l=a(m.currentTarget);window.location=l.data("configure-url")},initPanelSettings:function(){if(navigator.platform.toUpperCase().indexOf("MAC")>=0&&AJS.Meta.get("issue-key")!==undefined){var r=a("#hipchat-panel-settings");if(r===undefined){return}r.removeClass("hidden");r.click(function(s){s.preventDefault();l(a(s.target),false)});a(document).on("click","#hipchat-inapp-links",function(t){var s=a(t.target).is(":checked");AJS.Cookie.save("HIPCHAT_NATIVE_LINK_ENABLED",s);var u="hipchat.issuepanel.native.link."+(s?"enabled":"disabled");AJS.trigger("analyticsEvent",{name:u})});a(document).on("click",".hipchat-room-link-url",function(s){o()});a(document).on("click",".hipchat-user-link-url",function(s){o()});m(r)}var q;function l(s,u){if(!q){AJS.$("#inline-dialog-hipchat-link-dialog").remove();q=AJS.InlineDialog(s,"hipchat-link-dialog",function(w,v,y){var x={isAppLinkEnable:AJS.Cookie.read("HIPCHAT_NATIVE_LINK_ENABLED")==="true"};w.html(JIRA.Templates.HipChat.Config.LinkSettings.enableInAppLinksForHipChat(x));y();return false},{hideDelay:null})}q.show();var t=AJS.contextPath()+"/rest/api/2/mypreferences?key=";a.ajax({url:t+e,contentType:"application/json",cache:false,type:"PUT",data:"true"});if(u){AJS.trigger("analyticsEvent",{name:"hipchat.issuepanel.native.link.discovery"})}p(e,true)}function o(){var s=n(f);if(s==="undefined"||s==="false"){p(f,true);var t=AJS.contextPath()+"/rest/api/2/mypreferences?key="+f;a.ajax({url:t,contentType:"application/json",cache:false,type:"PUT",data:"true"})}}function p(s,t){var v=AJS.Meta.get("remote-user");var u=s+"."+v;AJS.Cookie.save(u,t,b)}function n(s){var u=AJS.Meta.get("remote-user");var t=s+"."+u;return AJS.Cookie.read(t)}function m(u){var t=AJS.contextPath()+"/rest/api/2/mypreferences?key=";var s=n(f);if(s==="true"){if(n(e)==="true"){return}a.ajax({url:t+e,dataType:"json",cache:false}).fail(function(v){if(v.status==404){l(u,true)}}).success(function(v){p(e,true)})}else{if(s===undefined){a.ajax({url:t+f,dataType:"json",cache:false}).success(function(v){p(f,true);m(u)}).fail(function(v){p(f,false)})}}}}});return g});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/issuepanel-init.js' */
(function(d,f,h){function e(){var j=window.location.hash;if(j==="#choose-room"){d("#hipchat-select-dedicated-room").click();b()}else{if(j==="#create-dedicated-room"){d(".hipchat-create-dedicated-room").click();b()}else{if(j==="#open-issue-mentions"){d("#hipchat-issue-mentions-list").click();b()}}}}function b(){window.location.hash=""}function a(){return new h({el:d("#hipchat-issue-panel-rooms-container")})}var g=null;function i(){c();JIRA.bind(JIRA.Events.ISSUE_REFRESHED,function(){if(g!==null){g.close()}c()})}function c(){if(!_.isUndefined(f.Meta.get("issue-key"))){var k=f.$("#hipchat-issue-panel");var l=f.$("#hipchat-issue-panel-spinner");var j=f.$("#hipchat-issue-panel-errors");l.spin();return f.$.ajax({url:f.contextPath()+"/rest/hipchat/integrations/1.0/issuepanel/data/"+f.Meta.get("issue-key"),cache:false,dataType:"json",type:"GET"}).done(function(n){var m=JIRA.Templates.HipChat.Project.IssuePanel.hipChatPanel(n);k.html(m);g=a();g.on("ready",e)}).fail(function(m,n){j.append("Error getting HipChat data from JIRA")}).always(function(){l.spinStop()})}}d(function(){i()})})(AJS.$,require("ajs"),require("hipchat/feature/issuepanel/issuepanel-view"));;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'soy/configure/hipchat-link-dialog.soy' */
// This file was automatically generated from hipchat-link-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.Config == 'undefined') { JIRA.Templates.HipChat.Config = {}; }
if (typeof JIRA.Templates.HipChat.Config.LinkSettings == 'undefined') { JIRA.Templates.HipChat.Config.LinkSettings = {}; }


JIRA.Templates.HipChat.Config.LinkSettings.enableInAppLinksForHipChat = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-settings-panel"><h6>', soy.$$escapeHtml("Use the HipChat App"), '</h6><p>', soy.$$escapeHtml("Would you rather open links in the HipChat application instead of your browser?"), '</p><p></p><input type="checkbox" class="matcher-type" id="hipchat-inapp-links" autocomplete="off" ', (opt_data.isAppLinkEnable) ? ' checked' : '', '/><label for="hipchat-inapp-links">', soy.$$escapeHtml("Open in the HipChat App"), '</label><p>', "Don\x27t have the app?  \x3ca href\x3d\x22http://hipchat.com/downloads\x22 target\x3d\x22_blank\x22\x3eGet it\x3c/a\x3e!", '</p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:curl', location = 'js/wrm/curl-config.js' */
(function(){if(!window.WRM){window.WRM={}}window.curl={apiContext:WRM,defineContext:WRM}}());;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:curl', location = 'js/wrm/lib/curl-0.7.3.js' */
(function(a){var P="0.7.3",u="curl",p="define",G,v,g,d=a.document,l=d&&(d.head||d.getElementsByTagName("head")[0]),V=l&&l.getElementsByTagName("base")[0]||null,i={},N={},c={},A="addEventListener" in a?{}:{loaded:1,complete:1},m={},b=m.toString,y,k={},f={},h=false,O,t=/\?|\.js\b/,e=/^\/|^[^:]+:\/\//,L=/(\.)(\.?)(?:$|\/([^\.\/]+.*)?)/g,E=/\/\*[\s\S]*?\*\/|(?:[^\\])\/\/.*?[\n\r]/g,C=/require\s*\(\s*["']([^"']+)["']\s*\)|(?:[^\\]?)(["'])/g,M,x;function Q(){}function D(X,W){return b.call(X).indexOf("[object "+W)==0}function B(X){var W;X.path=J(X.path||X.location||"");W=X.main||"./main";if(!n(W)){W="./"+W}X.main=s(W,X.name+"/");X.config=X.config;return X}function n(W){return W.charAt(0)=="."}function j(W){return e.test(W)}function o(X,W){return J(X)+"/"+W}function J(W){return W&&W.charAt(W.length-1)=="/"?W.substr(0,W.length-1):W}function s(ab,X){var ac,W,Z,Y,aa;ac=1;W=ab;if(n(W)){Y=true;W=W.replace(L,function(ad,ae,af,ag){if(af){ac++}return ag||""})}if(Y){Z=X.split("/");aa=Z.length-ac;if(aa<0){return ab}Z.splice(aa,ac);return Z.concat(W||[]).join("/")}else{return W}}function S(X){var W=X.indexOf("!");return{resourceId:X.substr(W+1),pluginId:W>=0&&X.substr(0,W)}}function U(){}function z(X,W){U.prototype=X||m;var Z=new U();U.prototype=m;for(var Y in W){Z[Y]=W[Y]}return Z}function F(){var X,aa,W;X=this;aa=[];function ab(ac,ad,ae){aa.push([ac,ad,ae])}function Y(ag,ad){var af,ac,ae=0;while((af=aa[ae++])){ac=af[ag];if(ac){ac(ad)}}}W=function Z(ad,ac){ab=ad?function(ae,af){ae&&ae(ac)}:function(ae,af){af&&af(ac)};W=Q;Y(ad?0:1,ac);Y=Q;aa=y};this.then=function(ac,ad,ae){ab(ac,ad,ae);return X};this.resolve=function(ac){X.resolved=ac;W(true,ac)};this.reject=function(ac){X.rejected=ac;W(false,ac)};this.progress=function(ac){Y(2,ac)}}function r(W){return W instanceof F}function H(W,Z,X,Y){if(r(W)){return W.then(Z,X,Y)}else{return Z(W)}}function q(Y,X,Z){var W;return function(){if(--Y>=0&&X){W=X.apply(y,arguments)}if(Y==0&&Z){Z(W)}return W}}x={toAbsId:function(ab,aa,W){var Y,X,Z;Y=s(ab,aa);if(n(Y)){return Y}Z=S(Y);X=Z.pluginId;Y=X||Z.resourceId;if(Y in W.pathMap){Y=W.pathMap[Y].main||Y}if(X){if(X.indexOf("/")<0&&!(X in W.pathMap)){Y=o(W.pluginPath,X)}Y=Y+"!"+Z.resourceId}return Y},createContext:function(W,X,ab,aa){var Z;Z=new F();Z.id=X||"";Z.isPreload=aa;Z.depNames=ab;Z.config=W;function ad(ae){return x.toAbsId(ae,Z.id,W)}function ac(ae){return x.resolvePathInfo(ad(ae),W).url}function Y(ag,ak,af){var ae,aj,ai,ah;ae=ak&&function(){ak.apply(y,arguments[0])};if(D(ag,"String")){if(ae){throw new Error("require(id, callback) not allowed")}aj=ad(ag);ai=k[aj];if(!(aj in k)){throw new Error("Module not resolved: "+aj)}ah=r(ai)&&ai.exports;return ah||ai}else{H(x.getDeps(x.createContext(W,Z.id,ag,aa)),ae,af)}}Z.require=Y;Y.toUrl=ac;Z.toAbsId=ad;return Z},createResourceDef:function(W,ad,ab){var aa,X,Z;aa=x.createContext(W,ad,y,ab);X=aa.resolve;Z=q(1,function(af){aa.deps=af;try{return x.executeDefFunc(aa)}catch(ae){aa.reject(ae)}});aa.resolve=function Y(ae){H(ab||h,function(){X((k[aa.id]=f[aa.url]=Z(ae)))})};aa.exportsReady=function ac(ae){H(ab||h,function(){if(aa.exports){Z(ae);aa.progress(N)}})};return aa},createPluginDef:function(W,aa,Z,Y){var X;X=x.createContext(W,Z,y,Y);return X},getCjsRequire:function(W){return W.require},getCjsExports:function(W){return W.exports||(W.exports={})},getCjsModule:function(X){var W=X.module;if(!W){W=X.module={id:X.id,uri:x.getDefUrl(X),exports:x.getCjsExports(X),config:function(){return X.config}};W.exports=W.exports}return W},getDefUrl:function(W){return W.url||(W.url=x.checkToAddJsExt(W.require.toUrl(W.id),W.config))},setApi:function(W){var Y,Z,X,aa,ab,ac;Y=u;Z=p;X=aa=a;ab=" already exists";if(W){ac=W.overwriteApi||W.overwriteApi;Y=W.apiName||W.apiName||Y;X=W.apiContext||W.apiContext||X;Z=W.defineName||W.defineName||Z;aa=W.defineContext||W.defineContext||aa;if(v&&D(v,"Function")){a[u]=v}v=null;if(g&&D(g,"Function")){a[p]=g}g=null;if(!ac){if(X[Y]&&X[Y]!=K){throw new Error(Y+ab)}if(aa[Z]&&aa[Z]!=I){throw new Error(Z+ab)}}}X[Y]=K;aa[Z]=I},config:function(aa){var ab,Z,W,X;if("baseUrl" in aa){aa.baseUrl=aa.baseUrl}if("main" in aa){aa.main=aa.main}if("preloads" in aa){aa.preloads=aa.preloads}if("pluginPath" in aa){aa.pluginPath=aa.pluginPath}if("dontAddFileExt" in aa||aa.dontAddFileExt){aa.dontAddFileExt=new RegExp(aa.dontAddFileExt||aa.dontAddFileExt)}ab=G;Z=z(ab,aa);Z.pathMap=z(ab.pathMap);W=aa.plugins||{};Z.plugins=z(ab.plugins);Z.paths=z(ab.paths,aa.paths);Z.packages=z(ab.packages,aa.packages);Z.pathList=[];function ac(af,am){var ah,aj,al,ak,an,ai;for(var ag in af){al=af[ag];if(D(al,"String")){al={path:af[ag]}}al.name=al.name||ag;an=Z;ak=S(J(al.name));ah=ak.resourceId;aj=ak.pluginId;if(aj){an=W[aj];if(!an){an=W[aj]=z(Z);an.pathMap=z(Z.pathMap);an.pathList=[]}delete af[ag]}if(am){ai=B(al);if(ai.config){ai.config=z(Z,ai.config)}}else{ai={path:J(al.path)}}ai.specificity=ah.split("/").length;if(ah){an.pathMap[ah]=ai;an.pathList.push(ah)}else{an.baseUrl=x.resolveUrl(al.path,Z)}}}function ad(af){var ag=af.pathMap;af.pathRx=new RegExp("^("+af.pathList.sort(function(ai,ah){return ag[ah].specificity-ag[ai].specificity}).join("|").replace(/\/|\./g,"\\$&")+")(?=\\/|$)");delete af.pathList}ac(aa.packages,true);ac(aa.paths,false);for(X in W){var Y=x.toAbsId(X+"!","",Z);Z.plugins[Y.substr(0,Y.length-1)]=W[X]}W=Z.plugins;for(X in W){W[X]=z(Z,W[X]);var ae=W[X].pathList;if(ae){W[X].pathList=ae.concat(Z.pathList);ad(W[X])}}for(X in ab.pathMap){if(!Z.pathMap.hasOwnProperty(X)){Z.pathList.push(X)}}ad(Z);return Z},checkPreloads:function(W){var X;X=W&&W.preloads;if(X&&X.length>0){H(h,function(){h=x.getDeps(x.createContext(G,y,X,true))})}},resolvePathInfo:function(Z,X){var Y,ab,aa,W;Y=X.pathMap;if(!j(Z)){aa=Z.replace(X.pathRx,function(ac){ab=Y[ac]||{};W=ab.config;return ab.path||""})}else{aa=Z}return{config:W||G,url:x.resolveUrl(aa,X)}},resolveUrl:function(Y,W){var X=W.baseUrl;return X&&!j(Y)?o(X,Y):Y},checkToAddJsExt:function(X,W){return X+((W||G).dontAddFileExt.test(X)?"":".js")},loadScript:function(Z,ab,X){var Y=d.createElement("script");function aa(ac){ac=ac||a.event;if(ac.type=="load"||A[Y.readyState]){delete c[Z.id];Y.onload=Y.onreadystatechange=Y.onerror="";ab()}}function W(ac){X(new Error("Syntax or http error: "+Z.url))}Y.onload=Y.onreadystatechange=aa;Y.onerror=W;Y.type=Z.mimetype||"text/javascript";Y.charset="utf-8";Y.async=!Z.order;Y.src=Z.url;c[Z.id]=Y;l.insertBefore(Y,V);return Y},extractCjsDeps:function(X){var Y,W=[],Z;Y=typeof X=="string"?X:X.toSource?X.toSource():X.toString();Y.replace(E,"").replace(C,function(aa,ac,ab){if(ab){Z=Z==ab?y:Z}else{if(!Z){W.push(ac)}}return""});return W},fixArgs:function(X){var ac,aa,Y,ab,W,Z;W=X.length;Y=X[W-1];ab=D(Y,"Function")?Y.length:-1;if(W==2){if(D(X[0],"Array")){aa=X[0]}else{ac=X[0]}}else{if(W==3){ac=X[0];aa=X[1]}}if(!aa&&ab>0){Z=true;aa=["require","exports","module"].slice(0,ab).concat(x.extractCjsDeps(Y))}return{id:ac,deps:aa||[],res:ab>=0?Y:function(){return Y},cjs:Z}},executeDefFunc:function(Y){var X,W;W=Y.cjs?Y.exports:y;X=Y.res.apply(W,Y.deps);if(X===y&&Y.exports){X=Y.module?(Y.exports=Y.module.exports):Y.exports}return X},defineResource:function(X,W){X.res=W.res;X.cjs=W.cjs;X.depNames=W.deps;x.getDeps(X)},getDeps:function(X){var ab,af,ai,ad,ag,aa,W,aj,ah;ai=[];af=X.depNames;ad=af.length;if(af.length==0){Y()}function ae(am,ak,al){ai[ak]=am;if(al){aj(am,ak)}}aj=q(ad,ae,ac);ah=q(ad,ae,Y);for(ab=0;ab<ad;ab++){W=af[ab];if(W in M){ah(M[W](X),ab,true);if(X.exports){X.progress(i)}}else{if(!W){ah(y,ab,true)}else{Z(W,ab)}}}return X;function Z(am,al){var an,ak,ap,ao;an=q(1,function(aq){ak(aq);ah(aq,al)});ak=q(1,function(aq){aj(aq,al)});ap=x.fetchDep(am,X);ao=r(ap)&&ap.exports;if(ao){ak(ao)}H(ap,an,X.reject,X.exports&&function(aq){if(ap.exports){if(aq==i){ak(ap.exports)}else{if(aq==N){an(ap.exports)}}}})}function Y(){X.resolve(ai)}function ac(){X.exportsReady&&X.exportsReady(ai)}},fetchResDef:function(W){x.getDefUrl(W);x.loadScript(W,function(){var X=O;O=y;if(W.useNet!==false){if(!X||X.ex){W.reject(new Error(((X&&X.ex)||"define() missing or duplicated: "+W.url)))}else{x.defineResource(W,X)}}},W.reject);return W},fetchDep:function(ai,X){var W,Z,ae,ab,ah,ad,aa,aj,af,Y,ac,ag;W=X.toAbsId;Z=X.isPreload;ae=X.config||G;ab=S(W(ai));aj=ab.resourceId;ah=ab.pluginId||aj;af=x.resolvePathInfo(ah,ae);if(ab.pluginId){ad=ah}else{ad=af.config.moduleLoader||af.config.moduleLoader;if(ad){aj=ah;ah=ad;af=x.resolvePathInfo(ad,ae)}}if(ah in k){Y=k[ah]}else{if(af.url in f){Y=k[ah]=f[af.url]}else{Y=x.createResourceDef(af.config,ah,Z);Y.url=x.checkToAddJsExt(af.url,af.config);k[ah]=f[af.url]=Y;x.fetchResDef(Y)}}if(ah==ad){ac=new F();ag=ae.plugins[ad]||ae;H(Y,function(am){var ao,ak,an;an=am.dynamic;if("normalize" in am){aj=am.normalize(aj,W,Y.config)||""}else{aj=W(aj)}ak=ad+"!"+aj;ao=k[ak];if(!(ak in k)){ao=x.createPluginDef(ag,ak,aj,Z);if(!an){k[ak]=ao}var al=function(ap){ao.resolve(ap);if(!an){k[ak]=ap}};al.resolve=al;al.reject=al.error=ao.reject;am.load(aj,ao.require,al,ag)}if(ac!=ao){H(ao,ac.resolve,ac.reject,ac.progress)}},ac.reject)}return ac||Y},getCurrentDefName:function(){var W;if(!D(a.opera,"Opera")){for(var X in c){if(c[X].readyState=="interactive"){W=X;break}}}return W}};M={require:x.getCjsRequire,exports:x.getCjsExports,module:x.getCjsModule};function K(){var X=[].slice.call(arguments),W;if(D(X[0],"Object")){W=X.shift();R(W)}return new w(X[0],X[1],X[2])}function R(W){if(W){x.setApi(W);G=x.config(W);x.checkPreloads(W);if("main" in W){setTimeout(function(){var X;X=x.createContext(G,y,[].concat(W.main));x.getDeps(X)},0)}}}function w(Y,ab,X,aa){var Z,W;W=x.createContext(G,y,[].concat(Y));this["then"]=Z=function(ac,ad){H(W,function(ae){if(ac){ac.apply(y,ae)}},function(ae){if(ad){ad(ae)}else{throw ae}});return this};this["next"]=function(ae,ac,ad){return new w(ae,ac,ad,W)};this["config"]=R;if(ab||X){Z(ab,X)}H(aa,function(){x.getDeps(W)})}K.version=P;K.config=R;function T(W){var Z,X,Y;Z=W.id;if(Z==y){if(O!==y){O={ex:"Multiple anonymous defines in url"}}else{if(!(Z=x.getCurrentDefName())){O=W}}}if(Z!=y){X=k[Z];if(!(Z in k)){Y=x.resolvePathInfo(Z,G);X=x.createResourceDef(Y.config,Z);k[Z]=X}if(!r(X)){throw new Error("duplicate define: "+Z)}X.useNet=false;x.defineResource(X,W)}}function I(){var W=x.fixArgs(arguments);T(W)}I.amd={plugins:true,jQuery:true,curl:P};G={baseUrl:"",pluginPath:"curl/plugin",dontAddFileExt:t,paths:{},packages:{},plugins:{},pathMap:{},pathRx:/$^/};v=a[u];g=a[p];if(!v||D(v,"Function")){x.setApi()}else{a[u]=y;R(v)}k[u]=K;k["curl/_privileged"]={core:x,cache:k,config:function(){return G},_define:T,_curl:K,Promise:F}}(this.window||(typeof global!="undefined"&&global)||this));;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:curl', location = 'js/wrm/lib/curl-css-0.7.3.js' */
(function(B){var z="createElement",s="parentNode",f=B.setTimeout,H=B.document,k,x=H&&H.createStyleSheet&&!(H.documentMode>=10),v=[],u=[],C=[],i=12,F,g="HTTP or network error.",l={};if(H){k=H.head||H.getElementsByTagName("head")[0];if(x){F=c}else{F=t}}function q(J,I){l[J]=l[J]||I}function y(){var I;I=H[z]("link");I.rel="stylesheet";I.type="text/css";return I}function r(J,I){J.onload=function(){q("load",true);I()}}function n(J,I){J.onerror=function(){q("error",true);I()}}function c(K,I,M){var L;C.push({url:K,cb:I,eb:function J(){M(new Error(g))}});L=h();if(L){m(L)}}function m(K){var J,I;J=C.shift();I=K.styleSheet;if(J){K.onload=function(){J.cb(J.ss);m(K)};K.onerror=function(){J.eb();m(K)};J.ss=I.imports[I.addImport(J.url)]}else{e(K);G(K)}}function G(I){u.push(I)}function h(){var I;I=u.shift();if(!I&&v.length<i){I=H.createElement("style");v.push(I);k.appendChild(I)}return I}function b(L){var K,J,M;if(!L.href||!o()){return false}K=false;try{J=L.sheet;if(J){M=J.cssRules;K=M===null;if(!K&&M){J.insertRule("-curl-css-test {}",0);J.deleteRule(0);K=true}}}catch(I){K=Object.prototype.toString.call(window.opera)!="[object Opera]"&&/security|denied/i.test(I.message)}return K}function e(I){I.onload=I.onerror=j}function w(I){return I.onload==j||!I.onload}function E(J,K,I){if(l.load){return}if(b(J)){I(J.sheet)}else{if(!w(J)){f(function(){E(J,K,I)},K)}}}function A(J,K,I){if(l.error){return}}function p(J,L,I){function K(){if(w(J)){return}e(J);d(function(){I(J.sheet)})}r(J,K);E(J,L,K)}function D(K,L,I){function J(){if(w(K)){return}e(K);I(new Error(g))}n(K,J);A(K,L,J)}function t(J,I,K,M){var L;L=y();p(L,M,I);D(L,M,K);L.href=J;k.appendChild(L)}function d(I){function J(){if(o()){I()}else{f(J,10)}}J()}function o(){return !H.readyState||H.readyState=="complete"}function a(I,J){return I.lastIndexOf(".")<=I.lastIndexOf("/")?I+"."+J:I}function j(){}WRM.define("curl/plugin/css",{normalize:function(N,J){var L,M;if(!N){return N}L=[N];M=[];for(var K=0,I=L.length;K<I;K++){M.push(J(L[K]))}return M.join(",")},load:function(R,L,U,K){var Q,J,V,S,M,O;Q=[];J=[R||""];V=K.cssWatchPeriod||50;S=K.cssNoWait;M=J.length;function N(W){if(J.length>1){Q.push(W)}if(--M==0){U(J.length==1?W:Q)}}function P(X){var W;W=U.reject||function(Y){throw Y};W(X)}for(O=0;O<J.length;O++){R=J[O];var I,T;I=a(L.toUrl(R),"css");if(S){T=y();T.href=I;k.appendChild(T);N(T.sheet||T.styleSheet)}else{F(I,N,P,V)}}},"plugin-builder":"./builder/css",pluginBuilder:"./builder/css"})})(this);;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:curl', location = 'js/wrm/lib/curl-js-0.7.3.js' */
(function(b,c,a){WRM.define("curl/plugin/js",["curl/_privileged"],function(m){var f={},j=[],h=c&&c.createElement("script").async==true,l,k,g;l=m.Promise;function i(n,o){return n.lastIndexOf(".")<=n.lastIndexOf("/")?n+"."+o:n}function e(o,u,q){var v,s,p;v=new Date().valueOf()+(o.timeoutMsec||300000);function n(){s=true;if(o.exports){o.resolved=a(o.exports)}if(!o.exports||o.resolved){u(p)}else{q()}}function r(w){s=true;q(w)}function t(){if(!s){if(v<new Date()){q()}else{setTimeout(t,10)}}}if(q&&o.exports){setTimeout(t,10)}p=m.core.loadScript(o,n,r)}function d(n,o){e(n,function(){var p=j.shift();k=j.length>0;if(p){d.apply(null,p)}o.resolve(n.resolved||true)},function(p){o.reject(p)})}return{dynamic:true,normalize:function(q,p,o){var n=q.indexOf("!");return n>=0?p(q.substr(0,n))+q.substr(n):p(q)},load:function(o,r,w,q){var s,t,u,v,n,p,y;s=o.indexOf("!order")>0;t=o.indexOf("!exports=");u=t>0&&o.substr(t+9);v="prefetch" in q?q.prefetch:true;o=s||t>0?o.substr(0,o.indexOf("!")):o;n=i(r.toUrl(o),"js");function x(z){(w.error||function(A){throw A})(z)}if(n in f){if(f[n] instanceof l){f[n].then(w,x)}else{w(f[n])}}else{p={name:o,url:n,order:s,exports:u,timeoutMsec:q.timeout};f[n]=y=new l();y.then(function(z){f[n]=z;w(z)},x);if(s&&!h&&k){j.push([p,y]);if(v){p.mimetype="text/cache";e(p,function(z){z&&z.parentNode.removeChild(z)},function(){});p.mimetype=""}}else{k=k||s;d(p,y)}}}}})}(this,this.document,function(){try{return eval(arguments[0])}catch(ex){return}}));;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/jquery.js' */
WRM.define("wrm/jquery",function(){return AJS.$});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/underscore.js' */
WRM.define("wrm/_",function(){var a={filter:function(f,d){var b=[];for(var c=0;c<f.length;++c){var e=f[c];if(d(e)){b.push(e)}}return b},map:function(d,c){var e=[];for(var b=0;b<d.length;++b){e.push(c(d[b]))}return e},each:function(d,c){if(d.length===+d.length){for(var b=0;b<d.length;++b){c(d[b])}}else{for(var e in d){if(d.hasOwnProperty(e)){c(d[e],e)}}}},bind:function(c,b){return function(){c.apply(b,Array.prototype.slice.call(arguments))}},isArray:function(b){return Object.prototype.toString.call(b)=="[object Array]"},isUndefined:function(b){return b===void 0},isNull:function(b){return b===null}};return a});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/builder.js' */
WRM.define("wrm/builder",function(){var a=function(d){var b="(?:$|\\?.*)";var c="^"+d;this.patterns={js:{superBatch:new RegExp(c+"/superbatch/js/batch.js"+b),contextBatch:new RegExp(c+"/contextbatch/js/(.*?)/batch.js"+b),resourceBatch:new RegExp(c+"/batch/(.*?)/(.*).js"+b),noBatch:new RegExp(c+"/resources/(.*?)/(.*).js"+b)},css:{superBatch:new RegExp(c+"/superbatch/css/batch.css"+b),contextBatch:new RegExp(c+"/contextbatch/css/(.*?)/batch.css"+b),resourceBatch:new RegExp(c+"/batch/(.*?)/(.*).css"+b),noBatch:new RegExp(c+"/resources/(.*?)/(.*).css"+b)}}};a.prototype={initialize:function(c){var g,b=c.getElementsByTagName("script"),e=c.getElementsByTagName("link"),f={superBatch:false,modules:[],contexts:[]};for(g=0;g<b.length;++g){var d=b[g];if(d.getAttribute("src")){this._inspectMatches(d.getAttribute("src"),this.patterns.js,f)}}for(g=0;g<e.length;++g){var h=e[g];if(h.getAttribute("href")){this._inspectMatches(h.getAttribute("href"),this.patterns.css,f)}}return f},getModulesAndContextsFromScriptUrl:function(c){var b={superBatch:false,modules:[],contexts:[]};this._inspectMatches(c,this.patterns.js,b);return b},_inspectMatches:function(d,f,c){var b;b=d.match(f.superBatch);if(b){c.superBatch=true;return}b=d.match(f.contextBatch);if(b){var g=b[1].split(",");for(var e=0;e<g.length;++e){this._addToLoadedList(c.contexts,g[e])}return}b=d.match(f.resourceBatch);if(b){this._addToLoadedList(c.modules,b[1]);return}b=d.match(f.noBatch);if(b){this._addToLoadedList(c.modules,b[1]);return}},_addToLoadedList:function(d,c){for(var b=0;b<d.length;++b){if(d[b]===c){return}}d.push(c)}};return a});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/ie-only-filter.js' */
WRM.define("wrm/ie-only-filter",["wrm/jquery","wrm/_"],function(c,a){function b(d){var e=c.browser.msie;return a.filter(d,function(f){return f.ieOnly?e:true})}return b});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/conditional-comment-filter.js' */
WRM.define("wrm/conditional-comment-filter",["wrm/jquery","wrm/_"],function(c,a){function b(e){var f=c.browser.msie;var d=c.browser.version;return a.filter(e,function(h){var g=h.conditionalComment;if(!g){return true}if(!f||d>9){return false}g=g.toLowerCase();switch(g){case"ie":return true;case"lt ie 9":return d<9;case"lte ie 9":return d<=9;case"ie 9":return d==9;case"gt ie 9":return d>9;case"gte ie 9":return d>=9;case"lt ie 8":return d<8;case"lte ie 8":return d<=8;case"ie 8":return d==8;case"gt ie 8":return d>8;case"gte ie 8":return d>=8;default:AJS.log("Cannot parse conditional comment "+g);return false}})}return b});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/resource-base-url-pattern.js' */
WRM.define("wrm/resource-base-url-pattern",function(){return WRM.data.claim("com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern")});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/require-handler.js' */
WRM.define("wrm/require-handler",["wrm/jquery","wrm/_","wrm/builder","wrm/conditional-comment-filter","wrm/ie-only-filter","wrm/resource-base-url-pattern"],function(e,h,i,g,a,c){var f=/^wr!(.*)$/,d=/^wrc!(.*)$/;var b=function(){this._requireCache={}};b.prototype={require:function(k,j){if(!h.isArray(k)){k=[k]}if(!this._requireCache.hasOwnProperty(k)){this._requireCache[k]=this._resolveAsync(k)}var l=this._requireCache[k];if(j){l.done(function(){j.apply(this,arguments)})}return l},_resolveAsync:function(l){var j=e.Deferred();var k=this;this._getScriptsForResources(l).done(function(p){if(p.unparsedData){window.WRM._unparsedData||(window.WRM._unparsedData={});h.each(p.unparsedData,function(u,t){window.WRM._unparsedData[t]=u})}var q=[];var s=[];var m=k._filter(p.resources);for(var o=0;o<m.length;++o){var r=m[o];var n=r.url;if(r.resourceType==="JAVASCRIPT"){if(!k._isJSInInitLoad(n)){q.push("js!"+n+"!order")}}else{if(r.resourceType==="CSS"){if(!k._isCSSInInitLoad(n)){if(r.media&&"all"!==r.media){s.push(r)}else{q.push("css!"+n)}}}else{AJS.log("Unknown resource type required: "+n)}}}AJS.log("Downloading resources:\n"+q.join("\n"));WRM.curl(q,function(){h.each(s,function(u){k._loadCssImmediate(u)});var t=h.map(l,function(){return window});j.resolveWith(k,t)},function(){j.rejectWith(k,arguments)})});return j.promise()},_loadCssImmediate:function(k){AJS.log("WARN: asynchronously loading a CSS resource containing a media query: "+k.url);var j='<link rel="stylesheet" type="text/css" href="'+k.url+'" media="'+k.media+'" />';e(j).appendTo("head")},_getScriptsForResources:function(k){if(!this._builder){this._builder=new i(c);this._initLoadResources=this._builder.initialize(document)}var j=[];var l=[];h.each(k,function(n){var m;if(m=n.match(f)){j.push(m[1])}else{if(m=n.match(d)){l.push(m[1])}}});return e.ajax({url:AJS.contextPath()+"/rest/webResources/1.0/resources",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify({r:j,c:l,xc:this._initLoadResources.contexts,xr:this._initLoadResources.modules})})},_isJSInInitLoad:function(j){return e("script[src='"+j+"']").length>0},_isCSSInInitLoad:function(j){return e("link[href='"+j+"']").length>0},_filter:function(k){if(!this._filters){this._filters=[g,a]}var j=k;h.each(this._filters,function(l){j=l(j)});return j}};return b});;
;/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager', location = 'js/wrm/index.js' */
WRM.curl(["wrm/require-handler"],function(b){var a;WRM.require=function(d,c){if(!a){a=new b()}return a.require(d,c)}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-loader', location = 'js/require.js' */
AJS.namespace("JIRA.WorkflowDesigner");JIRA.WorkflowDesigner.require=function(A){return WRM.require(["wrc!com.atlassian.jira.plugins.jira-workflow-designer.workflow-designer"],function(){A&&A(JIRA.WorkflowDesigner.Application)})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/views/dialogs/Dialog.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Dialog");JIRA.WorkflowDesigner.Dialog=JIRA.FormDialog.extend({init:function(A){_.bindAll(this,"_sizeAndPositionDialog");A=_.defaults({},A,{content:this.createDialogContent,isDraft:false,onContentRefresh:this._showWorkflowDesigner,widthClass:"large"});this.options=A;this.sizeAndPositionDialog=_.throttle(this._sizeAndPositionDialog,100);this._super(A);this.onContentReady(this._addLabelHint)},createDialogContent:function(A){A(JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog({title:_.result(this.options,"workflowId")}))},show:function(){this._super.apply(this,arguments);jQuery(window).on("resize",this.sizeAndPositionDialog)},hide:function(){this._designer&&this._designer.destroy();this._super.apply(this,arguments);jQuery(window).off("resize",this.sizeAndPositionDialog)},_sizeAndPositionDialog:function(){var A,B;if(JIRA.Dialog.current===this){B=JIRA.WorkflowDesigner.DialogSizeCalculator.calculateDialogSize(this);this.options.width=B.width;A=this.$popup.find(".form-body");A.css({height:B.height,maxHeight:""});this._positionInCenter()}},_showWorkflowDesigner:function(){var A=this;this._sizeAndPositionDialog();JIRA.WorkflowDesigner.require(function(B){if(A.isCurrent()){A._designer=new B({actions:false,element:A.get$popup().find(".form-body"),immutable:true,draft:_.result(A.options,"isDraft"),layoutData:_.result(A.options,"layoutData"),workflowId:_.result(A.options,"workflowId"),currentStepId:_.result(A.options,"currentStepId")})}})},_addLabelHint:function(){this.getButtonsContainer().prepend(JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint())}})}());;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/util/DialogSizeCalculator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.DialogSizeCalculator");JIRA.WorkflowDesigner.DialogSizeCalculator={DISTANCE_FROM_EDGE:100,calculateDialogSize:function(B,A){this.dialog=B;A=_.defaults(A||{},{windowHeight:this._getWindowHeight(),windowWidth:this._getWindowWidth(),dialogHeaderHeight:this._getDialogHeaderHeight(),dialogFooterHeight:this._getDialogFooterHeight()});return{height:this._calculateDialogHeight(A.windowHeight,A.dialogHeaderHeight,A.dialogFooterHeight),width:this._calculateDialogWidth(A.windowWidth)}},_calculateDialogHeight:function(C,A,B){return C-A-B-(this.DISTANCE_FROM_EDGE*2)},_calculateDialogWidth:function(A){return A-(this.DISTANCE_FROM_EDGE*2)},_getWindowHeight:function(){return jQuery(window).height()},_getWindowWidth:function(){return jQuery(window).width()},_getDialogHeaderHeight:function(){return this.dialog.$popupHeading.outerHeight()},_getDialogFooterHeight:function(){return this.dialog.$buttonContainer.outerHeight()}}}());;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'soy/Dialog.soy' */
// This file was automatically generated from Dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.Dialog == 'undefined') { JIRA.WorkflowDesigner.Templates.Dialog = {}; }


JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2><div class="form-body"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons-container-left"><small>', soy.$$escapeHtml("Mouse over objects to see transition names."), '</small></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-browser-is-supported', location = 'js/browserIsSupported.js' */
AJS.namespace("JIRA.WorkflowDesigner");JIRA.WorkflowDesigner.browserIsSupported=function(){return !(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)<9)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'js/views/ViewIssue.js' */
(function(){var F;var D;var E;var C;function B(H,G){var I=parseUri(H).queryKey[G];return decodeURIComponent(I.replace(/\+/g,"%20"))}function A(){var G;if(D){return jQuery.Deferred().resolve(D).promise()}else{G=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(C);G.done(function(I,H){D=H});return G}}AJS.namespace("JIRA.WorkflowDesigner.ViewIssue");JIRA.WorkflowDesigner.ViewIssue={replaceViewWorkflowLink:function(G){var H=JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink,J,I;G=jQuery(G);J=G.find(".issueaction-viewworkflow:not(.new-workflow-designer)");I=J.attr("href");if(J.length){F=parseInt(B(I,"stepId"),10);D=null;J.replaceWith(H({href:I}));C=B(I,"workflowName")}}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(H,G){if(JIRA.WorkflowDesigner.browserIsSupported()){JIRA.WorkflowDesigner.ViewIssue.replaceViewWorkflowLink(G)}});E=new JIRA.WorkflowDesigner.Dialog({content:function(H){var G=this;JIRA.WorkflowDesigner.require().pipe(A).done(function(){G.createDialogContent(H)}).fail(function(I){I=I||"The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.";JIRA.WorkflowDesigner.Messages.showErrorMessage(I);E.hide(true)})},id:"view-workflow-dialog",trigger:".issueaction-viewworkflow.new-workflow-designer",workflowId:function(){return C},currentStepId:function(){return F},layoutData:function(){return JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D)}})}());;
;/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'soy/ViewIssue.soy' */
// This file was automatically generated from ViewIssue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.ViewIssue == 'undefined') { JIRA.WorkflowDesigner.Templates.ViewIssue = {}; }


JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issueaction-viewworkflow new-workflow-designer" href="', soy.$$escapeHtml(opt_data.href), '">', soy.$$escapeHtml("View Workflow"), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(typeof packet==="object"&&typeof packet.data==="string"){process(gadgets.json.parse(packet.data))}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"unknown origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-container-resources', location = 'js/gadgets-container.js' */
gadgets.Container=function(){this.parentUrl_="http://"+document.location.host;this.country_="ALL";this.language_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};gadgets.Container.inherits(gadgets.Extensible);gadgets.Container.prototype.userPrefStore=new gadgets.DefaultUserPrefStore();gadgets.Container.prototype.gadgetService=new gadgets.GadgetService();gadgets.Container.prototype.layoutManager=new gadgets.StaticLayoutManager();gadgets.Container.prototype.setParentUrl=function(url){this.parentUrl_=url};gadgets.Container.prototype.setCountry=function(country){this.country_=country};gadgets.Container.prototype.setNoCache=function(nocache){this.nocache_=nocache};gadgets.Container.prototype.setLanguage=function(language){this.language_=language};gadgets.Container.prototype.setView=function(view){this.view_=view};gadgets.Container.prototype.setMaxHeight=function(maxheight){this.maxheight_=maxheight};gadgets.Container.prototype.getGadgetKey_=function(instanceId){return"gadget_"+instanceId};gadgets.IfrContainer=function(){gadgets.Container.call(this)};gadgets.IfrContainer.inherits(gadgets.Container);gadgets.IfrContainer.prototype.gadgetService=new gadgets.IfrGadgetService();gadgets.IfrContainer.prototype.setParentUrl=function(url){if(!url.match(/^http[s]?:\/\//)){url=document.location.href.match(/^[^?#]+\//)[0]+url}this.parentUrl_=url};gadgets.container=new gadgets.IfrContainer();;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-standalone-resources', location = 'js/gadgets-standalone.js' */
new gadgets.IfrGadgetService();gadgets.IfrGadgetService.prototype.setTitle=function(title){};;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/urls.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-advertising.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-installer.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-advertising.soy' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-installer.soy' */
;
;/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/singleUserPicker.soy' */
// This file was automatically generated from singleUserPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.single = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.field.id), '" name="', soy.$$escapeHtml(opt_data.field.name), '" class="single-user-picker js-', (opt_data.type) ? soy.$$escapeHtml(opt_data.type) : 'default-user-picker', '"', (opt_data.inputText) ? ' data-input-text="' + soy.$$escapeHtml(opt_data.inputText) + '"' : '', (opt_data.editValue) ? ' data-edit-value="' + soy.$$escapeHtml(opt_data.editValue) + '"' : '', (opt_data.showDropdownButton) ? ' data-show-dropdown-button="true"' : '', (opt_data.userType) ? ' data-user-type="' + soy.$$escapeHtml(opt_data.userType) + '"' : '', (opt_data.containerClass) ? ' data-container-class="' + soy.$$escapeHtml(opt_data.containerClass) + '"' : '', '>');
  var optionList38 = opt_data.options;
  var optionListLen38 = optionList38.length;
  for (var optionIndex38 = 0; optionIndex38 < optionListLen38; optionIndex38++) {
    var optionData38 = optionList38[optionIndex38];
    if (optionData38.optionGroup) {
      output.append('<optgroup id="', soy.$$escapeHtml(opt_data.field.id), '-group-', soy.$$escapeHtml(optionData38.id), '" label="', soy.$$escapeHtml(optionData38.display), '"', (optionData38.footer) ? ' data-footer-text="' + soy.$$escapeHtml(optionData38.footer) + '"' : '', (optionData38.weight != -1) ? ' data-weight="' + soy.$$escapeHtml(optionData38.weight) + '"' : '', '>');
      var groupOptionList59 = optionData38.groupOptions;
      var groupOptionListLen59 = groupOptionList59.length;
      for (var groupOptionIndex59 = 0; groupOptionIndex59 < groupOptionListLen59; groupOptionIndex59++) {
        var groupOptionData59 = groupOptionList59[groupOptionIndex59];
        JIRA.Templates.Fields.Pickers.User.option(groupOptionData59, output);
      }
      output.append('</optgroup>');
    } else {
      JIRA.Templates.Fields.Pickers.User.option(optionData38, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.Pickers.User.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.loggedInUser) ? 'class="current-user" ' : '', (opt_data.selected) ? 'selected="selected" ' : '', 'value="', soy.$$escapeHtml(opt_data.optionName), '" data-field-text="', soy.$$escapeHtml(opt_data.displayName), '" data-field-label="', soy.$$escapeHtml(opt_data.displayName), (opt_data.emailAddress) ? ' - ' + soy.$$escapeHtml(opt_data.emailAddress) : '', (opt_data.optionName && opt_data.optionName != '-1') ? ' (' + soy.$$escapeHtml(opt_data.optionName) + ')' : '', '" data-icon="', soy.$$escapeHtml(opt_data.avatarURL), '" >', soy.$$escapeHtml(opt_data.displayName), '</option>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/assigneeField.soy' */
// This file was automatically generated from assigneeField.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Fields.Pickers.User.single(soy.$$augmentData(opt_data, {options: opt_data.assigneeOptions.options, showDropdownButton: true, userType: 'assignee', type: 'assignee-picker', containerClass: 'long-field'}), output);
  output.append((opt_data.isLoggedInUserAssignable) ? '<a href="#' + soy.$$escapeHtml(opt_data.field.id) + '" id="assign-to-me-trigger">' + soy.$$escapeHtml("Assign to me") + '</a>' : '', '<fieldset class="hidden parameters"><input type="hidden" title="projectKeys" value="', soy.$$escapeHtml(opt_data.projectKeys), '"/>', (opt_data.issueKey) ? '<input type="hidden" title="assigneeEditIssueKey" value="' + soy.$$escapeHtml(opt_data.issueKey) + '"/>' : '', (opt_data.actionDescriptorId) ? '<input type="hidden" title="actionDescriptorId" value="' + soy.$$escapeHtml(opt_data.actionDescriptorId) + '"/>' : '', '</fieldset>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/lib/jquery.dotdotdot-1.5.7.js' */
(function(i){if(i.fn.dotdotdot){return}i.fn.dotdotdot=function(v){if(this.length==0){if(!v||v.debug!==false){b(true,'No element found for "'+this.selector+'".')}return this}if(this.length>1){return this.each(function(){i(this).dotdotdot(v)})}var r=this;if(r.data("dotdotdot")){r.trigger("destroy.dot")}r.bind_events=function(){r.bind("update.dot",function(y,A){y.preventDefault();y.stopPropagation();t.maxHeight=(typeof t.height=="number")?t.height:o(r);t.maxHeight+=t.tolerance;if(typeof A!="undefined"){if(typeof A=="string"||A instanceof HTMLElement){A=i("<div />").append(A).contents()}if(A instanceof i){w=A}}s=r.wrapInner('<div class="dotdotdot" />').children();s.empty().append(w.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var z=false,x=false;if(q.afterElement){z=q.afterElement.clone(true);q.afterElement.remove()}if(k(s,t)){if(t.wrap=="children"){x=d(s,t,z)}else{x=m(s,r,s,t,z)}}s.replaceWith(s.contents());s=null;if(i.isFunction(t.callback)){t.callback.call(r[0],x,w)}q.isTruncated=x;return x}).bind("isTruncated.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],q.isTruncated)}return q.isTruncated}).bind("originalContent.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],w)}return w}).bind("destroy.dot",function(x){x.preventDefault();x.stopPropagation();r.unwatch().unbind_events().empty().append(w).data("dotdotdot",false)});return r};r.unbind_events=function(){r.unbind(".dot");return r};r.watch=function(){r.unwatch();if(t.watch=="window"){var z=i(window),y=z.width(),x=z.height();z.bind("resize.dot"+q.dotId,function(){if(y!=z.width()||x!=z.height()||!t.windowResizeFix){y=z.width();x=z.height();if(p){clearInterval(p)}p=setTimeout(function(){r.trigger("update.dot")},10)}})}else{u=j(r);p=setInterval(function(){var A=j(r);if(u.width!=A.width||u.height!=A.height){r.trigger("update.dot");u=j(r)}},100)}return r};r.unwatch=function(){i(window).unbind("resize.dot"+q.dotId);if(p){clearInterval(p)}return r};var w=r.contents(),t=i.extend(true,{},i.fn.dotdotdot.defaults,v),q={},u={},p=null,s=null;q.afterElement=c(t.after,r);q.isTruncated=false;q.dotId=l++;r.data("dotdotdot",true).bind_events().trigger("update.dot");if(t.watch){r.watch()}return r};i.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var l=1;function d(s,w,v){var u=s.children(),p=false;s.empty();for(var r=0,q=u.length;r<q;r++){var t=u.eq(r);s.append(t);if(v){s.append(v)}if(k(s,w)){t.remove();p=true;break}else{if(v){v.remove()}}}return p}function m(s,r,A,t,q){var w=s.contents(),x=false;s.empty();var z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var y=0,u=w.length;y<u;y++){if(x){break}var v=w[y],p=i(v);if(typeof v=="undefined"){continue}s.append(p);if(q){s[(s.is(z))?"after":"append"](q)}if(v.nodeType==3){if(k(A,t)){x=e(p,r,A,t,q)}}else{x=m(p,r,A,t,q)}if(!x){if(q){q.remove()}}}return x}function e(q,r,p,w,s){var D=false,A=q[0];if(typeof A=="undefined"){return false}var E=(w.wrap=="letter")?"":" ",t=h(A).split(E),F=-1,v=-1,G=0,y=t.length-1;while(G<=y){var x=Math.floor((G+y)/2);if(x==v){break}v=x;a(A,t.slice(0,v+1).join(E)+w.ellipsis);if(!k(p,w)){F=v;G=v}else{y=v}}if(F!=-1&&!(t.length==1&&t[0].length==0)){var u=f(t.slice(0,F+1).join(E),w);D=true;a(A,u)}else{var z=q.parent();q.remove();var C=(s)?s.length:0;if(z.contents().size()>C){var B=z.contents().eq(-1-C);D=e(B,r,p,w,s)}else{var A=z.prev().contents().eq(-1)[0];if(typeof A!="undefined"){var u=f(h(A),w);a(A,u);z.remove();D=true}}}return D}function k(q,p){return q.innerHeight()>p.maxHeight}function f(p,q){while(i.inArray(p.slice(-1),q.lastCharacter.remove)>-1){p=p.slice(0,-1)}if(i.inArray(p.slice(-1),q.lastCharacter.noEllipsis)<0){p+=q.ellipsis}return p}function j(p){return{width:p.innerWidth(),height:p.innerHeight()}}function a(q,p){if(q.innerText){q.innerText=p}else{if(q.nodeValue){q.nodeValue=p}else{if(q.textContent){q.textContent=p}}}}function h(p){if(p.innerText){return p.innerText}else{if(p.nodeValue){return p.nodeValue}else{if(p.textContent){return p.textContent}else{return""}}}}function c(p,q){if(typeof p=="undefined"){return false}if(!p){return false}if(typeof p=="string"){p=i(p,q);return(p.length)?p:false}if(typeof p=="object"){return(typeof p.jquery=="undefined")?false:p}return false}function o(s){var t=s.innerHeight(),r=["paddingTop","paddingBottom"];for(var u=0,q=r.length;u<q;u++){var p=parseInt(s.css(r[u]),10);if(isNaN(p)){p=0}t-=p}return t}function b(q,p){if(!q){return false}if(typeof p=="string"){p="dotdotdot: "+p}else{p=["dotdotdot:",p]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(p)}}return false}var n=i.fn.html;i.fn.html=function(p){if(typeof p!="undefined"){if(this.data("dotdotdot")){if(typeof p!="function"){return this.trigger("update",[p])}}return n.call(this,p)}return n.call(this)};var g=i.fn.text;i.fn.text=function(q){if(typeof q!="undefined"){if(this.data("dotdotdot")){var p=i("<div />");p.text(q);q=p.html();p.remove();return this.trigger("update",[q])}return g.call(this,q)}return g.call(this)}})(jQuery);;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogController.js' */
JPT={};(function(){JPT.DialogControllerImpl=Class.extend({WELCOME_REST_URL:AJS.contextPath()+"/rest/welcome/1.0/show/welcome",initialize:function(){_.bindAll(this,"handleProjectTemplateTriggered","openWithSelectedProjectTemplate","hideDialogFromNewUser");if(AJS.Meta.getBoolean("show-welcome-screen")){this.handleProjectTemplateTriggered()}},handleProjectTemplateTriggered:function(){this.openWithSelectedProjectTemplate()},openWithSelectedProjectTemplate:function(b){if(b&&this.dialog){this.dialog.remove()}var a=JPT.SelectProjectTemplateController.loadProjectTemplatesData();a.fail(_.bind(function(c){if(c.status===401&&c.responseText.toLowerCase().indexOf("requires websudo")>=0){this._enableWebSudo()}else{this._handleUnknownErrorOfPTRetrieval()}},this));a.done(_.bind(function(c){this.dialog=JPT.DialogView.draw();this.$dialogElement=this.dialog.popup.element;var d;if(!_.isUndefined(JPT.ConfigModel)&&!_.isUndefined(JPT.ConfigModel.selectedTemplate)){d=JPT.ConfigModel.selectedTemplate}JPT.ConfigModel=c;JPT.ConfigModel.selectedTemplate=d;JPT.SelectProjectTemplateController.init(c.projectTemplates,b)},this))},addPage:function(c){var b=this.dialog.addPage(c.name).page[this.dialog.curpage];this.dialog.addHeader(c.title,"add-project-dialog-header");this.dialog.addPanel(c.panelName,"","pt-content");if(c.backButton){this._addBackButton(b)}this.dialog.addButton(c.submitButtonText,c.submitButtonCallback,c.submitButtonClass+" pt-submit-button");var a=this.$dialogElement.find("."+c.submitButtonClass);a.removeClass("button-panel-button").addClass("aui-button aui-button-primary");a.focus();this.dialog.addCancel("Cancel",_.bind(function(d){this.hideDialogFromNewUser("dismissed");this.dialog.remove()},this));return b},_addBackButton:function(b){this.dialog.addButton("Back",_.bind(function(){var c=JPT.DialogView.get$PTContent();c.css("background-image","none");this.dialog.prevPage();b.remove();this.dialog.page.pop()},this),"add-project-back-button");var a=this.$dialogElement.find(".add-project-back-button");a.removeClass("button-panel-button").addClass("aui-button")},_enableWebSudo:function(){JIRA.SmartAjax.showWebSudoDialog({success:_.bind(function(a){this.handleProjectTemplateTriggered();a()},this)})},_handleUnknownErrorOfPTRetrieval:function(){JPT.DialogView.draw();JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA")},hideDialogFromNewUser:function(a){if(AJS.Meta.getBoolean("show-welcome-screen")){AJS.$.ajax({url:this.WELCOME_REST_URL+"/"+a,type:"DELETE",success:function(){if(AJS.isDevMode&&AJS.isDevMode()){AJS.log("don't show project template dialog anymore")}}})}}});JPT.DialogController=new JPT.DialogControllerImpl()})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogView.js' */
(function(){JPT.DialogViewImpl=Backbone.View.extend({events:{"click   .add-project-trigger":"_onClickAddProject","click   #add-project-dialog .import-project-trigger":"_onClickImportProject","keydown #add-project-dialog .pt-templates-list":"_onKeydownInTemplatesList"},draw:function(){var b=new AJS.Dialog({width:840,height:400,id:"add-project-dialog",closeOnOutsideClick:false,keypressListener:_.bind(this._onKeyPressed,this)});var c=b.popup.element;b.addPage("project-templates-page");b.addHeader("Select Project Type","add-project-dialog-header");b.addPanel("ProjectTemplatesListPanel",JIRA.Templates.ProjectTemplates.loadingTemplatesList(),"pt-content");this._dialog=b;this._$dialogElement=c;b.show();return b},remove:function(){this._dialog&&this._dialog.remove()},showErrorMessage:function(b){this._dialog.getPanel(1,0).html(JIRA.Templates.errorMsg({closable:false,msg:b}))},get$PTContent:function a(){return JPT.DialogController.$dialogElement.find(".pt-content")},_onKeyPressed:function(c){var b=27;if(this._dialog){if(c.keyCode===b){JPT.DialogController.hideDialogFromNewUser("dismissed");this._dialog.remove();return false}}return true},_onKeydownInTemplatesList:function(c){var b=13;if(this._dialog){if(c.keyCode===b){this._$dialogElement.find(".pt-submit-button:visible").click();return false}}return true},_onClickAddProject:function(b){b.preventDefault();JPT.DialogController.handleProjectTemplateTriggered()},_onClickImportProject:function(b){JPT.DialogController.hideDialogFromNewUser("importproject")}});JPT.DialogView=new JPT.DialogViewImpl({el:AJS.$(document)})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateController.js' */
JPT.SelectProjectTemplateController={};JPT.SelectProjectTemplateController.init=function init(b,a){JPT.DialogController.dialog.hide();JPT.SelectProjectTemplateView.draw(b);if(a){var c=_.find(b,function(d){return d.itemModuleCompleteKey===a});if(!_.isUndefined(c)){JPT.SelectProjectTemplateController.openAddProjectPage(c)}else{JPT.DialogView.showErrorMessage("Unable to find the template you were redirected to.");JPT.SelectProjectTemplateView.disableNextButton()}}JPT.DialogController.dialog.show();JPT.DialogController.dialog.updateHeight();JPT.SelectProjectTemplateView.truncateTemplateDescriptions()};JPT.SelectProjectTemplateController.loadProjectTemplatesData=function loadProjectTemplatesData(){return AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"GET",timeout:5000})};JPT.SelectProjectTemplateController.dialogSubmitted=function dialogSubmitted(){var a=JPT.SelectProjectTemplateView.getSelectedTemplateData();JPT.DialogController.hideDialogFromNewUser("templateselected");JPT.SelectProjectTemplateController.raiseAtlassianEvent(a.itemModuleCompleteKey);if(!_.isUndefined(a.infoSoyPath)){JPT.TemplateInfoController=new JPT.TemplateInfoControllerImpl();JPT.TemplateInfoController.initTemplateInfo(a)}else{JPT.SelectProjectTemplateController.openAddProjectPage(a)}};JPT.SelectProjectTemplateController.openAddProjectPage=function openAddProjectPage(a){if(!a){JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA");return}if(a.createProject){JPT.AddProjectController.initProjectTemplate(a)}else{JPT.DialogController.dialog.addPage("blank-template-page");AJS.$("body").trigger(a.itemModuleCompleteKey,JPT.DialogController.dialog)}};JPT.SelectProjectTemplateController.raiseAtlassianEvent=function raiseAtlassianEvent(a){JPT.ConfigModel.selectedTemplate=a;if(AJS.EventQueue){AJS.EventQueue.push({name:"projecttemplates.templateselected",properties:{selectedTemplate:a}})}};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateView.js' */
JPT.SelectProjectTemplateView={};JPT.SelectProjectTemplateView.ROW_LENGTH=2;JPT.SelectProjectTemplateView.draw=function draw(b){this.page=JPT.DialogController.addPage({name:"project-templates-page",title:"Select Project Type",panelName:"ProjectTemplatesListPanel",backButton:false,submitButtonText:"Next",submitButtonCallback:JPT.SelectProjectTemplateController.dialogSubmitted,submitButtonClass:"create-project-dialog-create-button"});JPT.DialogController.dialog.getPanel(this.page.id,0).html(JIRA.Templates.ProjectTemplates.renderList({projectTemplates:b}));if(JPT.ConfigModel.projectCount>=2){AJS.$(JIRA.Templates.ProjectTemplates.addWorkflowsLink({baseUrl:contextPath})).appendTo(JPT.DialogController.$dialogElement.find(".dialog-title"))}var c=JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button");JPT.DialogController.$dialogElement.find(".template").click(function(){var d=AJS.$(this);d.addClass("selected").siblings().removeClass("selected")}).dblclick(function(d){c.click()}).focus(function(){AJS.$(this).click()});var a=JPT.SelectProjectTemplateView.get$TemplatesContainer();AJS.$(JIRA.Templates.ProjectTemplates.importProjectLink({baseUrl:contextPath})).prependTo(JPT.DialogController.$dialogElement.find(".dialog-button-panel"));JPT.SelectProjectTemplateView.bindKeyboardEvents(a);if(b.length==0){c.attr("disabled","disabled")}JPT.SelectProjectTemplateView.focusOnFirstTemplate(a)};JPT.SelectProjectTemplateView.get$TemplatesContainer=function getTemplatesContainer(){return JPT.DialogController.$dialogElement.find(".templates")};JPT.SelectProjectTemplateView.focusOnFirstTemplate=function focusOnFirstTemplate(a){JPT.DialogController.$dialogElement.find(".template:first-child").click();setTimeout(function(){a.focus()},0)};JPT.SelectProjectTemplateView.getSelectedTemplateData=function getSelectedTemplateData(){var a=JPT.DialogController.$dialogElement.find(".template.selected");return a.data()};JPT.SelectProjectTemplateView.getMoveDeltaForKey=function(a){switch(a){case 37:return -1;case 39:return +1;case 38:return -JPT.SelectProjectTemplateView.ROW_LENGTH;case 40:return +JPT.SelectProjectTemplateView.ROW_LENGTH}return 0};JPT.SelectProjectTemplateView.bindKeyboardEvents=function(a){a.bind("keydown",function(b){var c=JPT.SelectProjectTemplateView.getMoveDeltaForKey(b.which);if(c){JPT.SelectProjectTemplateView.moveSelection(a,c);return AJS.stopEvent(b)}})};JPT.SelectProjectTemplateView.moveSelection=function(c,f){var b=c.find(".template");var e=b.filter(".selected");var d=b.index(e)+f;if(d<b.length&&d>=0){var a=b.eq(d);a.click().focus();JPT.SelectProjectTemplateView.scrollToSelectedElement(a)}};JPT.SelectProjectTemplateView.scrollToSelectedElement=function scrollToSelectedElement(c){var f=AJS.$(".dialog-panel-body.pt-content");var a=f.offset().top;var b=c.offset().top;var e=b+c.height();var d=a+f.height();if(b<a){f.scrollTop(f.scrollTop()-(a-b))}else{if(e>(a+f.height())){f.scrollTop(f.scrollTop()+e-d)}}};JPT.SelectProjectTemplateView.get$NextButton=function getNextButton(){return JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button")};JPT.SelectProjectTemplateView.disableNextButton=function disableNextButton(){JPT.SelectProjectTemplateView.get$NextButton().attr("disabled","disabled")};JPT.SelectProjectTemplateView.truncateTemplateDescriptions=function truncateTemplateDescriptions(){var a=AJS.Meta.get("user-locale");var b="word";if(a==="ja_JP"){b="letter"}JPT.DialogController.$dialogElement.find(".template-description").each(function(){AJS.$(this).dotdotdot({wrap:b,lastCharacter:{remove:[" ",",",";",".","!","?","。"],noEllipsis:[]}})})};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/ProjectTemplatesList.soy' */
// This file was automatically generated from ProjectTemplatesList.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.renderList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.projectTemplates.length == 0) {
    JIRA.Templates.errorMsg({closeable: false, msg: "No project templates could be found."}, output);
  } else {
    output.append('<div class="pt-templates-list">');
    JIRA.Templates.ProjectTemplates.renderItems(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.renderItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="templates" tabindex="100">');
  var templateList15 = opt_data.projectTemplates;
  var templateListLen15 = templateList15.length;
  for (var templateIndex15 = 0; templateIndex15 < templateListLen15; templateIndex15++) {
    var templateData15 = templateList15[templateIndex15];
    output.append('<li class="template"', (templateData15.itemModuleCompleteKey) ? 'data-item-module-complete-key="' + soy.$$escapeHtml(templateData15.itemModuleCompleteKey) + '"' : '', (templateData15.projectTemplateModuleCompleteKey) ? 'data-project-template-module-complete-key="' + soy.$$escapeHtml(templateData15.projectTemplateModuleCompleteKey) + '"' : '', (templateData15.createProject) ? 'data-create-project="' + soy.$$escapeHtml(templateData15.createProject) + '"' : '', (templateData15.backgroundIconUrl) ? 'data-background-icon-url="' + soy.$$escapeHtml(templateData15.backgroundIconUrl) + '"' : '', (templateData15.name) ? 'data-name="' + soy.$$escapeHtml(templateData15.name) + '"' : '', (templateData15.description) ? 'data-description="' + soy.$$escapeHtml(templateData15.description) + '"' : '', (templateData15.longDescriptionContent) ? 'data-long-description-content="' + soy.$$escapeHtml(templateData15.longDescriptionContent) + '"' : '', (templateData15.infoSoyPath) ? 'data-info-soy-path="' + soy.$$escapeHtml(templateData15.infoSoyPath) + '"' : '', '><img class="template-preview" src="', soy.$$escapeHtml(templateData15.iconUrl), '" /><div class="template-meta"><div class="template-name" title="', soy.$$escapeHtml(templateData15.name), '">', soy.$$escapeHtml(templateData15.name), '</div><div class="template-description" title="', soy.$$escapeHtml(templateData15.description), '">', soy.$$escapeHtml(templateData15.description), '</div></div></li>');
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.loadingTemplatesList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="wait-container"><img class="wait-icon" src="', soy.$$escapeHtml(""), '/images/icons/wait.gif"><span class="wait-text">', soy.$$escapeHtml("Loading project templates"), '&hellip;</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.importProjectLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="import-project-trigger button-panel-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/views/ExternalImport1.jspa" tabindex="-1">', soy.$$escapeHtml("Import from external system"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.addWorkflowsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="add-workflow-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/wfshare-import?src=projecttemplates" tabindex="-1">', soy.$$escapeHtml("View Marketplace Workflows"), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoController.js' */
(function(){JPT.TemplateInfoControllerImpl=Class.extend({init:function(a){_.bindAll(this,"initTemplateInfo","next")},initTemplateInfo:function(a){this.projectTemplateData=a;JPT.TemplateInfoView=new JPT.TemplateInfoViewImpl();JPT.TemplateInfoView.draw(a.infoSoyPath,a.name)},next:function(){JPT.SelectProjectTemplateController.openAddProjectPage(this.projectTemplateData)}})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoView.js' */
(function(){JPT.TemplateInfoViewImpl=Backbone.View.extend({initialize:function(a){_.bindAll(this,"draw","onNext")},draw:function(c,b){var d=JPT.DialogController.addPage({name:"template-info",title:b,panelName:"template-info",backButton:true,submitButtonText:"Select",submitButtonCallback:this.onNext,submitButtonClass:"template-info-dialog-create-button"});var a=this._nameToObj(c)();JPT.DialogController.dialog.getPanel(d.id,0).html(a);JPT.DialogController.dialog.gotoPage(d.id)},_nameToObj:function(a){return _.reduce(a.split("."),function(c,b){if(c){return c[b]}},window)},onNext:function(a){JPT.TemplateInfoController.next();return false}})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectController.js' */
(function(){JPT.AddProjectControllerImpl=Class.extend({postProjectCreationCallbacks:[],projectKeyValidationCallbacks:[],projectNamesUpperCased:[],init:function(g){this._window=g.window||window;_.bindAll(this,"projectCreatedHandler","projectValidationFailedHandler","nameTimeout","keyTimeout","submit")},initProjectTemplate:function(g){this.desiredKeyLength=4;this.lastKeyValidated="";this._getExistingProjects();JPT.ProjectKeyGenerator.init(this.desiredKeyLength,JPT.ConfigModel.maxKeyLength);this.webItemData=g;JPT.AddProjectView.prepareDialog(g.name);JPT.AddProjectView.draw({webItemData:this.webItemData,maxKeyLength:JPT.ConfigModel.maxKeyLength,maxNameLength:JPT.ConfigModel.maxNameLength,currentUserName:JPT.ConfigModel.currentUserName,currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl,errors:{}})},_resetProjectLeadValues:function(){JPT.ConfigModel.currentUserDisplayName="";JPT.ConfigModel.currentUserName="";JPT.ConfigModel.currentUserAvatarUrl=""},_hasFullyConfiguredProjectLead:function(){return JPT.AddProjectView.getLeadDisplayName()&&JPT.AddProjectView.getAvatarUrlOfSelectedLead()!=""},submit:function(g){var h=JPT.AddProjectView.getAddProjectForm().serialize();if(JPT.AddProjectView.hasInlineErrors()){return}if(JPT.AddProjectView.enterLoadingState()){if(this._hasFullyConfiguredProjectLead()){JPT.ConfigModel.currentUserDisplayName=JPT.AddProjectView.getLeadDisplayName();JPT.ConfigModel.currentUserName=JPT.ConfigModel.currentUserDisplayName?JPT.AddProjectView.getLeadUserName():"";JPT.ConfigModel.currentUserAvatarUrl=JPT.AddProjectView.getAvatarUrlOfSelectedLead()}else{this._resetProjectLeadValues()}var i=AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"POST",data:h,timeout:50000,headers:{"X-Atlassian-Token":"nocheck"}});i.then(this.projectCreatedHandler,this.projectValidationFailedHandler)}},registerPostProjectCreationCallback:function(g){this.postProjectCreationCallbacks.push(g)},registerProjectKeyValidationCallback:function(g){this.projectKeyValidationCallbacks.push(g)},localStoragePrefix:"jira.projecttemplates.",projectCreatedHandler:function(h){JPT.AddProjectView.avoidDirtyFormWarning();var g=this.localStoragePrefix;var i=["confluenceProject","fisheyeProject","crucibleProject","bambooProject"];_.map(i,function(j){if(h.remoteProjectLinks[j]){localStorage.setItem(g+j,h.remoteProjectLinks[j])}});if(!_.isEmpty(this.postProjectCreationCallbacks)){JPT.DialogController.dialog.addPage("post-project-created-page");_.each(this.postProjectCreationCallbacks,function(j){j(JPT.DialogController.dialog,h.returnUrl,h.projectId,h.projectKey,h.projectName)})}else{this._window.location=contextPath+h.returnUrl}},projectValidationFailedHandler:function(h,j){var i={};if(h.status===400){i=JSON.parse(h.responseText)}else{if(h.status===500&&!_.isUndefined(JSON.parse(h.responseText).message)){var g=JSON.parse(h.responseText);JIRA.Messages.showReloadErrorMsg(g.message);JPT.AddProjectView.avoidDirtyFormWarning();this._window.location=contextPath+g.returnUrl;return}else{if(j==="timeout"){i={errorMessages:["Request timeout when creating project"]}}else{i={errorMessages:[AJS.format("Error creating project, {0}",h.responseText)]}}}}JPT.AddProjectView.draw({webItemData:this.webItemData,errors:i,currentName:JPT.AddProjectView.getName(),currentKey:JPT.AddProjectView.getKey(),currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserName:JPT.ConfigModel.currentUserName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl});JPT.AddProjectView.hideLoadingState()},_updateAndValidateKey:function e(g){JPT.AddProjectView.setKey(g);this._validateKey()},_shouldUpdateKey:function d(){return(JPT.AddProjectView.getKeyEdited()!="true")},autofillKeyIfNeeded:function b(){if(this._shouldUpdateKey()){var g=JPT.ProjectKeyGenerator.generate(JPT.AddProjectView.getName());if(g.length>1){this._updateAndValidateKey(g)}else{JPT.AddProjectView.setKey("")}}},_doesProjectNameExists:function(h){var g;for(g in this.projectNamesUpperCased){if(h.toUpperCase()==this.projectNamesUpperCased[g]){return true}}return false},_validateName:function(){var g=AJS.$.trim(JPT.AddProjectView.getName());if(!g){return}if(g.length<JPT.ConfigModel.minNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name should be at least {0} characters in length.",JPT.ConfigModel.minNameLength));return}if(g.length>JPT.ConfigModel.maxNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name must not exceed {0} characters in length.",JPT.ConfigModel.maxNameLength));return}if(this._doesProjectNameExists(g)){JPT.AddProjectView.showInlineErrorForName("A project with that name already exists.");return}JPT.AddProjectView.hideInlineErrorForName()},_performKeyValidationChecks:function(g){var h=AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+g.toUpperCase(),timeout:5000});h.done(_.bind(function(j){if(j.errors&&j.errors.projectKey){JPT.AddProjectView.showInlineErrorForKey(j.errors.projectKey)}else{var i=false;_.each(this.projectKeyValidationCallbacks,function(l){var k=l(g.toUpperCase());if(k.errors&&k.errors.projectKey){i=true;JPT.AddProjectView.showInlineErrorForKey(k.errors.projectKey)}});if(!i){JPT.AddProjectView.hideInlineErrorForKey()}}},this))},_validateKey:function a(){var g=JPT.AddProjectView.getKey();if(this.lastKeyValidated===g){return}if(g){this.lastKeyValidated=g;this._performKeyValidationChecks(g)}else{JPT.AddProjectView.hideInlineErrorForKey()}},nameTimeout:function c(){this._validateName();this.autofillKeyIfNeeded()},keyTimeout:function f(){JPT.AddProjectView.setKeyEdited();this._validateKey()},_getExistingProjects:function(){if(this.projectNamesUpperCased.length>0){return this.projectNamesUpperCased}var g=AJS.$.ajax({url:contextPath+"/rest/api/latest/project",timeout:5000});g.done(_.bind(function(h){this.projectNamesUpperCased=_.map(h,function(i){return i.name.toUpperCase()})},this))}});JPT.AddProjectController=new JPT.AddProjectControllerImpl({el:AJS.$(document)})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectView.js' */
(function(){JPT.AddProjectViewImpl=Backbone.View.extend({TIMEOUT_MS:100,postDrawCallbacks:[],events:{"submit #add-project-form":"onSubmitForm"},page:undefined,isSubmitting:false,initialize:function(w){_.bindAll(this,"bindHook")},addPostDrawCallback:function(w){this.postDrawCallbacks.push(w)},prepareDialog:function(w){this.page=JPT.DialogController.addPage({name:"add-project",title:w,panelName:"add-project",backButton:true,submitButtonText:"Submit",submitButtonCallback:this.onSubmitForm.bind(this),submitButtonClass:"add-project-dialog-create-button"})},draw:function(C){function B(D){if(!D.errors){D.errors={}}return D}this.isSubmitting=false;JPT.DialogController.dialog.gotoPage(this.page.id);var z={maxNameLength:JPT.ConfigModel.maxNameLength,maxKeyLength:JPT.ConfigModel.maxKeyLength,shouldShowLead:JPT.ConfigModel.shouldShowProjectLead,projectTemplateWebItemKey:JPT.ConfigModel.selectedTemplate||C.webItemData.itemModuleCompleteKey,projectTemplateModuleKey:C.webItemData.projectTemplateModuleCompleteKey,projectTemplateTitle:C.webItemData.name,projectTemplateDescriptionContent:C.webItemData.longDescriptionContent||C.webItemData.description,currentKey:C.currentKey||"",currentName:C.currentName||"",errors:B(C.errors),projectLeadPickerField:{id:"lead",name:"lead"},leadOptions:[{selected:true,displayName:C.currentUserDisplayName,optionName:C.currentUserName,avatarURL:C.currentUserAvatarUrl}]};var x=JIRA.Templates.ProjectTemplates.addProjectForm(z);JPT.DialogController.dialog.getPanel(this.page.id,0).html(x);if(C.webItemData.backgroundIconUrl){var w=JPT.DialogController.$dialogElement.find(".pt-content");w.css("background-image",'url("'+C.webItemData.backgroundIconUrl+'")')}var y=AJS.$("#add-project-form");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[y]);this.nameElement=JPT.DialogController.$dialogElement.find("#name");this.keyElement=JPT.DialogController.$dialogElement.find("#key");this.keyEditedElement=JPT.DialogController.$dialogElement.find("#keyEdited");this.leadDisplayElement=JPT.DialogController.$dialogElement.find("#lead-field");this.leadValueElement=JPT.DialogController.$dialogElement.find("#lead");var A=this.keyElement.parent().find(".aui-icon-help");if(A.length){new AJS.InlineDialog(A,"project-key-help-popup",function(F,E,D){F.html(JIRA.Templates.ProjectTemplates.keyHelp());D()},{width:330,offsetX:-30})}this.keyElement.attr("style","text-transform: uppercase");this.nameElement.focus(_.bind(function(D){this.bindHook(D,JPT.AddProjectController.nameTimeout)},this));this.nameElement.blur(function(D){JPT.AddProjectView.unbindHook(D)});this.nameElement.focus();this.keyElement.focus(_.bind(function(E){var D=AJS.$(E.target);D.data("lastValue",D.val());this.bindHook(E,JPT.AddProjectController.keyTimeout)},this));this.keyElement.blur(_.bind(function(D){this.unbindHook(D)},this));this.keyElement.blur(function(){JPT.AddProjectController.autofillKeyIfNeeded()});if(!_.isEmpty(this.postDrawCallbacks)){_.each(this.postDrawCallbacks,function(D){D()})}},onSubmitForm:function(w){JPT.AddProjectController.submit();return false},get$SubmitButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-dialog-create-button")},get$BackButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-back-button")},bindHook:function j(z,x){var w=AJS.$(z.target),y;y=_.bind(function(){this.unbindHook(z);x.apply();if(w.is(":visible")){w.data("checkHook",setTimeout(y,this.TIMEOUT_MS))}},this);if(!w.data("checkHook")){w.data("checkHook",setTimeout(y,0))}},unbindHook:function(x){var w=AJS.$(x.target);clearTimeout(w.data("checkHook"));w.removeData("checkHook")},showInlineError:function(x,y){if(this.isSubmitting){return}var w=x.parent().find(".error");if(!w.length){w=AJS.$("<div class='error'></div>");x.parent().append(w)}w.text(y);w.show()},showInlineErrorForName:function v(w){this.showInlineError(this.nameElement,w)},showInlineErrorForKey:function s(w){this.showInlineError(this.keyElement,w)},hideInlineError:function r(w){w.parent().find(".error").hide()},hideInlineErrorForName:function b(){this.hideInlineError(this.nameElement)},hideInlineErrorForKey:function n(){this.hideInlineError(this.keyElement)},setName:function f(w){this.nameElement.val(w)},getName:function m(){return this.nameElement.val()},setKey:function c(w){this.keyElement.val(w)},getKey:function k(){return this.keyElement.val()},getLeadDisplayName:function o(){return this.leadDisplayElement.val()},getLeadUserName:function p(){return this.leadValueElement.val()},getAvatarUrlOfSelectedLead:function l(){var w=JPT.DialogController.$dialogElement.find("#lead-single-select .aui-ss-entity-icon").css("background-image");if(!_.isUndefined(w)){var x=w.match(/^url\((.+)\)$/);return(x&&x[1])?x[1]:""}else{return""}},setKeyEdited:function i(w){this.keyEditedElement.val(w)},getKeyEdited:function t(){return this.keyEditedElement.val()},setKeyEdited:function i(){var w=this.getKey();if(this.keyElement.data("lastValue")!==w){this.keyEditedElement.val((w)?"true":"false")}this.keyElement.data("lastValue",w)},hasNameErrors:function d(){return this.nameElement.parent().find(".error").size()>0},getAddProjectForm:function e(){return AJS.$("#add-project-form")},get$FormFields:function h(){return JPT.DialogController.$dialogElement.find(":input")},enterLoadingState:function g(){$submitButton=this.get$SubmitButton();if(!$submitButton.attr("disabled")){$backButton=this.get$BackButton();$submitButton.attr("disabled","disabled");$backButton.attr("disabled","disabled");$backButton.before(JIRA.Templates.ProjectTemplates.spinner({id:"addproject-loading"}));this.get$FormFields().attr("disabled","disabled");this.isSubmitting=true;return true}else{return false}},hideLoadingState:function q(){JPT.DialogController.$dialogElement.find("#addproject-loading").remove();this.get$SubmitButton().removeAttr("disabled");this.get$BackButton().removeAttr("disabled");this.get$FormFields().removeAttr("disabled")},avoidDirtyFormWarning:function a(){if(jQuery.fn.removeDirtyWarning){this.getAddProjectForm().removeDirtyWarning()}},hasInlineErrors:function u(){return JPT.DialogController.$dialogElement.find(".error:visible").length!=0}});JPT.AddProjectView=new JPT.AddProjectViewImpl({el:AJS.$(document),dialogView:JPT.DialogView})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/AddProject.soy' */
// This file was automatically generated from AddProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.addProjectForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.errorMessages) {
    var errorList5 = opt_data.errors.errorMessages;
    var errorListLen5 = errorList5.length;
    for (var errorIndex5 = 0; errorIndex5 < errorListLen5; errorIndex5++) {
      var errorData5 = errorList5[errorIndex5];
      JIRA.Templates.errorMsg({closeable: false, msg: errorData5}, output);
    }
  }
  output.append('<div class="add-project-wrapper"><div class="add-project-form-wrapper">');
  var param11 = new soy.StringBuilder();
  var param13 = new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.longTextField({id: 'name', name: 'name', isRequired: false, maxLength: opt_data.maxNameLength, labelContent: "Name", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxNameLength), value: opt_data.currentName ? opt_data.currentName : '', errorTexts: opt_data.errors.errors.projectName ? [opt_data.errors.errors.projectName] : []}, param13);
  JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon({id: 'key', name: 'key', isRequired: false, maxLength: opt_data.maxKeyLength, labelContent: "Key", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxKeyLength), helpTitle: "What\x27s a project key?", value: opt_data.currentKey ? opt_data.currentKey : '', errorTexts: opt_data.errors.errors.projectKey ? [opt_data.errors.errors.projectKey] : []}, param13);
  if (opt_data.shouldShowLead) {
    JIRA.Templates.ProjectTemplates.projectLeadField({field: opt_data.projectLeadPickerField, isRequired: false, errorTexts: opt_data.errors.errors.projectLead ? [opt_data.errors.errors.projectLead] : [], options: opt_data.leadOptions}, param13);
  }
  param13.append('<input type="hidden" name="keyEdited" id="keyEdited" value="false"><input type="hidden" name="projectTemplateWebItemKey" value="', soy.$$escapeHtml(opt_data.projectTemplateWebItemKey), '"><input type="hidden" name="projectTemplateModuleKey" value="', soy.$$escapeHtml(opt_data.projectTemplateModuleKey), '"><input type="submit" class="pt-hidden-submit offscreen-left">');
  aui.form.fieldset({legendContent: '', content: param13.toString()}, param11);
  aui.form.form({content: param11.toString(), id: 'add-project-form'}, output);
  output.append('</div>', (opt_data.projectTemplateDescriptionContent) ? '<div class="add-project-description-wrapper"><div class="project-template-title"><h3>' + soy.$$escapeHtml(opt_data.projectTemplateTitle) + '</h3></div><div class="project-template-description">' + opt_data.projectTemplateDescriptionContent + '</div></div>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.projectLeadField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param67 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.field.name + '-field', isRequired: opt_data.isRequired, content: "Project Lead"}, param67);
  JIRA.Templates.Fields.Pickers.User.single({field: opt_data.field, options: opt_data.options, editValue: opt_data.value}, param67);
  aui.form.fieldDescription({message: "Enter the username of the Project Lead."}, param67);
  if (opt_data.errorTexts) {
    var errorList80 = opt_data.errorTexts;
    var errorListLen80 = errorList80.length;
    for (var errorIndex80 = 0; errorIndex80 < errorListLen80; errorIndex80++) {
      var errorData80 = errorList80[errorIndex80];
      aui.form.fieldError({message: errorData80}, param67);
    }
  }
  aui.form.fieldGroup({content: param67.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param86 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param86);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value}, param86);
  param86.append('<a class="help-lnk" title="', soy.$$escapeHtml(opt_data.helpTitle), '" id="', soy.$$escapeHtml(opt_data.id), '-help-icon"><span class="aui-icon aui-icon-help">', soy.$$escapeHtml(opt_data.helpTitle), '</span></a>');
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param86);
  }
  if (opt_data.errorTexts) {
    var errorList110 = opt_data.errorTexts;
    var errorListLen110 = errorList110.length;
    for (var errorIndex110 = 0; errorIndex110 < errorListLen110; errorIndex110++) {
      var errorData110 = errorList110[errorIndex110];
      aui.form.fieldError({message: errorData110}, param86);
    }
  }
  aui.form.fieldGroup({content: param86.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.longTextField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param116 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param116);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value, extraClasses: 'long-field'}, param116);
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param116);
  }
  if (opt_data.errorTexts) {
    var errorList134 = opt_data.errorTexts;
    var errorListLen134 = errorList134.length;
    for (var errorIndex134 = 0; errorIndex134 < errorListLen134; errorIndex134++) {
      var errorData134 = errorList134[errorIndex134];
      aui.form.fieldError({message: errorData134}, param116);
    }
  }
  aui.form.fieldGroup({content: param116.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.spinner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span id=\'', soy.$$escapeHtml(opt_data.id), '\' class=\'icon throbber loading\'/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.formatAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.body), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/ProjectKeyGenerator.js' */
JPT.ProjectKeyGenerator={};JPT.ProjectKeyGenerator.IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];JPT.ProjectKeyGenerator.CHARACTER_MAP={};JPT.ProjectKeyGenerator.CHARACTER_MAP[199]="C";JPT.ProjectKeyGenerator.CHARACTER_MAP[231]="c";JPT.ProjectKeyGenerator.CHARACTER_MAP[252]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[251]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[250]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[249]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[233]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[234]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[235]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[232]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[226]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[228]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[224]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[229]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[225]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[239]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[238]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[236]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[237]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[196]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[197]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[201]="E";JPT.ProjectKeyGenerator.CHARACTER_MAP[230]="ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[198]="Ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[244]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[246]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[242]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[243]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[220]="U";JPT.ProjectKeyGenerator.CHARACTER_MAP[255]="Y";JPT.ProjectKeyGenerator.CHARACTER_MAP[214]="O";JPT.ProjectKeyGenerator.CHARACTER_MAP[241]="n";JPT.ProjectKeyGenerator.CHARACTER_MAP[209]="N";JPT.ProjectKeyGenerator.desiredKeyLength=4;JPT.ProjectKeyGenerator.maxKeyLength=10;JPT.ProjectKeyGenerator.getTotalLength=function getTotalLength(a){return a.join("").length};JPT.ProjectKeyGenerator.removeIgnoredWords=function removeIgnoredWords(a){return _.reject(a,function(b){return AJS.$.inArray(b,JPT.ProjectKeyGenerator.IGNORED_WORDS)!==-1})};JPT.ProjectKeyGenerator.createAcronym=function createAcronym(b){var a="";AJS.$.each(b,function(c,d){a+=d.charAt(0)});return a};JPT.ProjectKeyGenerator.getFirstSyllable=function getFirstSyllable(c){var b=false;var a;for(a=0;a<c.length;a++){if(JPT.ProjectKeyGenerator.isVowelOrY(c[a])){b=true}else{if(b){return c.substring(0,a+1)}}}return c};JPT.ProjectKeyGenerator.isVowelOrY=function isVowelOrY(a){return a&&a.length===1&&a.search("[AEIOUY]")!==-1};JPT.ProjectKeyGenerator.init=function init(b,a){JPT.ProjectKeyGenerator.desiredKeyLength=b;JPT.ProjectKeyGenerator.maxKeyLength=a};JPT.ProjectKeyGenerator.generate=function generate(b){b=AJS.$.trim(b);if(!b){return""}var a=[];for(var d=0,f=b.length;d<f;d++){var e=JPT.ProjectKeyGenerator.CHARACTER_MAP[b.charCodeAt(d)];a.push(e?e:b[d])}b=a.join("");var h=[];AJS.$.each(b.split(/\s+/),function(j,k){if(k){k=k.replace(/[^a-zA-Z]/g,"");k=k.toUpperCase();k.length&&h.push(k)}});if(JPT.ProjectKeyGenerator.desiredKeyLength&&JPT.ProjectKeyGenerator.getTotalLength(h)>JPT.ProjectKeyGenerator.desiredKeyLength){h=JPT.ProjectKeyGenerator.removeIgnoredWords(h)}var c;if(h.length==0){c=""}else{if(h.length==1){var g=h[0];if(JPT.ProjectKeyGenerator.desiredKeyLength&&g.length>JPT.ProjectKeyGenerator.desiredKeyLength){c=JPT.ProjectKeyGenerator.getFirstSyllable(g)}else{c=g}}else{c=JPT.ProjectKeyGenerator.createAcronym(h)}}if(JPT.ProjectKeyGenerator.maxKeyLength&&c.length>JPT.ProjectKeyGenerator.maxKeyLength){c=c.substr(0,JPT.ProjectKeyGenerator.maxKeyLength)}return c};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/RemoteProjectsCreatedMessage.js' */
AJS.$(function(){var b=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");var h=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");var f=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");var d=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");var i;function c(k,j){return JIRA.Templates.ProjectTemplates.formatAnchor({href:k,body:j,title:j})}function a(l,m,k,n){var j=[];j.push("a JIRA project");if(l){j.push(c(l,"a Confluence space"))}if(m){j.push(c(m,"a FishEye repository"))}if(k){j.push(c(k,"a Crucible project"))}if(n){j.push(c(n,"a Bamboo project"))}return j}function g(k,m,j,p){var o="The following entities were created: {0} and {1}.";var l=a(k,m,j,p);var n=l.pop();return(l.length>0)?AJS.format(o,l.join(", "),n):null}function e(j){var k=AJS.$(j).offset();if(k){window.scrollTo(k.left,k.top)}}if(b||h||f||d){i=g(b,h,f,d);if(i){JIRA.Messages.showSuccessMsg(i,{closeable:true})}e("#project-config-webpanel-summary-settings")}});;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/lib/ajaxHooks/xdr.js' */
if(window.XDomainRequest){jQuery.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var a;return{send:function(d,c){function e(f,i,h,g){a.onload=a.onerror=a.ontimeout=jQuery.noop;a=undefined;c(f,i,h,g)}a=new XDomainRequest();a.onload=function(){e(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType)};a.onerror=function(){e(404,"Not Found")};a.onprogress=jQuery.noop;a.ontimeout=function(){e(0,"timeout")};a.timeout=b.xdrTimeout||Number.MAX_VALUE;a.open(b.type,b.url);a.send((b.hasContent&&b.data)||null)},abort:function(){if(a){a.onerror=jQuery.noop;a.abort()}}}}})};;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/project-creation.js' */
ATLAS_PROJECT_CREATE={};(function(x){AJS.EventQueue=AJS.EventQueue||[];var u="jira.project";var G={"confluence.space":30,"bamboo.project":20,"ondemand.svn-repository":10};ATLAS_PROJECT_CREATE.getFilteredRootTypes=function C(L){var N={};for(var M in L.types){if(M!==u){N[M]=L.types[M]}}return N};ATLAS_PROJECT_CREATE.loadRemoteRoots=function p(L){var N=jQuery.Deferred(),O=[],M=[];t(L,function(P){var Q=P.capabilitiesUrl;return AJS.$.ajax(Q+"/aggregate-root",{success:function(R){var S=ATLAS_PROJECT_CREATE.getFilteredRootTypes(R);O=O.concat(_.map(S,function(U,T){return AJS.$.ajax(U.href,{xhrFields:{withCredentials:true},success:function(V){M.push(ATLAS_PROJECT_CREATE.constructFullRootType(V,U.label,T,Q,P.id))},error:function(X,V,W){AJS.log("Got "+W+" from aggregate root type "+U.href)}}).promise()}))},error:function(T,R,S){AJS.log("Got "+S+" from aggregate roots capapbility for "+Q)}}).promise()}).done(function(){o(O).done(function(){N.resolve(M)})});return N.promise()};ATLAS_PROJECT_CREATE.constructFullRootType=function n(L,M,P,O,N){return{keys:L.keys,url:L.links.self,label:M,capabilityKey:P,baseUrl:O,instanceId:N}};ATLAS_PROJECT_CREATE.createLink=function v(M,L){console.log("creating link from "+M.entityType+" to "+M.remoteEntityType);var N=JSON.stringify({local:M.baseUrl+"/aggregate-root/"+M.entityType+"/"+M.entityKey,target:M.remoteInstanceBaseUrl+"/aggregate-root/"+M.remoteEntityType+"/"+M.remoteEntityKey});AJS.$.ajax(M.baseUrl+"/aggregate-root-link",{type:"POST",contentType:"application/json",data:N,timeout:8000,complete:L})};ATLAS_PROJECT_CREATE.linkAllTheThings=function r(O,R,L,T,S){var N=[];x.each(R,function Q(U,V){N.push({baseUrl:V.type.baseUrl,entityType:V.type.capabilityKey,entityKey:V.data.key,remoteInstanceBaseUrl:h()+"/rest/capabilities",remoteEntityType:u,remoteEntityKey:L});N.push({baseUrl:h()+"/rest/capabilities",entityType:u,entityKey:L,remoteInstanceBaseUrl:V.type.baseUrl,remoteEntityType:V.type.capabilityKey,remoteEntityKey:V.data.key});AJS.$.each(R,function W(Y,X){if(X!==V){N.push({baseUrl:V.type.baseUrl,entityType:V.type.capabilityKey,entityKey:V.data.key,remoteInstanceBaseUrl:X.type.baseUrl,remoteEntityType:X.type.capabilityKey,remoteEntityKey:X.data.key})}})});var P=0;function M(Y,U){if(U!=="success"){P++;var V=Y.statusText;try{var X=JSON.parse(Y.responseText);if(X&&X.message){V=X.message}}catch(W){}AJS.messages.error(".li-linking-status",{title:"Could not create links between created projects",body:V});O.updateHeight()}if(N.length>0){ATLAS_PROJECT_CREATE.createLink(N.pop(),M)}else{if(P>0){T.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>")}else{T.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>")}S.prop("disabled",false);S.attr("aria-disabled","false")}}M(null,"success")};var k;function I(O,L,M){var N=L();x.when(O).then(function(P){N.getCurPanel().body.find(".field-group.loading").remove();P.sort(d);if(P.length!==0){var Q=N.getCurPanel().body.find("form");Q.append(project.creation.remoteRootsCheckboxes({rootTypes:P}));if(M){Q.find('input[type="checkbox"]').filter(".remote-root").change(M)}N.updateHeight()}f(N,true)},function(){N.getCurPanel().body.find(".field-group.loading").remove();f(N,true);N.updateHeight()})}var j;function E(L,M){var N=L();j=N.getCurPanel();j.body.find("form").append(project.creation.remoteRootsLoading({}));f(N,false);N.updateHeight();j.page.element.find(".add-project-back-button").click(function(){N.updateHeight()});b(I,L,M)}function B(M){var N=_.filter(j.body.find("input.remote-root.checkbox"),function(O){return O.checked===true});var L=_.map(N,function(O){return O.id});return _.filter(M,function(O){return _.contains(L,"capability_"+O.capabilityKey)})}var F=AJS.$('meta[name="ajs-remote-user"]');if(!F||!F[0]||!F[0].content){console.log("Project create didn't get a user META tag, or it had no content.  Bailing out");return}if(!AJS.DarkFeatures.isEnabled("rotp.project.create")){return}var w=function w(Q,N,P,M,O){var L=function L(R,S){S.prop("disabled",true);S.attr("aria-disabled","true");S.before('<span class="aui-icon aui-icon-wait project-creation-acknowledge-spinner">'+"Loading, please wait"+"</span>");R()};x.when(k).then(function(S){var R=B(S);H(R);if(R.length===0){Q.prevPage();N();return}c(Q,L,N);var T=[];var U=[];t(R,function(V){var W="creation_status_"+V.capabilityKey.replace(".","_")+"_"+V.instanceId;T.push({statusId:W,label:V.label});return AJS.$.ajax(V.url+"/"+M,{type:"PUT",data:JSON.stringify({label:O}),xhrFields:{withCredentials:true},success:function(X){U=U.concat(D(X,V));i(X,W)},error:function(Y,Z,X){l(W,V,Y,X)},contentType:"application/json",dataType:"json"}).promise()}).always(function(){s(Q);console.log("about to begin linking created objects");ATLAS_PROJECT_CREATE.linkAllTheThings(Q,U,M,AJS.$(".post-project-created-page-content"),AJS.$(".project-create-acknowledge-button"))});AJS.$(".post-project-created-page-content").append(project.creation.remoteRootsSuccess({rootTypes:T}))})};var e=function e(M){var L;x.when(k).then(function(P){var O=B(P);_.each(O,function(R){if(R.keys){for(var Q in R.keys){if(R.keys.hasOwnProperty(Q)){if(M.toUpperCase()===Q.toUpperCase()){L=R}}}}})});var N={errors:{}};if(L){N.errors.projectKey=AJS.format("{0} with that key already exists in the remote instance",L.label)}return N};function m(){return window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.host)}function h(){var L=m();return L+AJS.contextPath()}function z(M){var L=document.createElement("a");L.href=M;return{host:L.hostname,port:L.port,protocol:L.protocol.replace(":","")}}function K(M,L){var O=z(M);var N=z(L);return O.protocol==="https"&&N.protocol==="http"}function b(O,M,N){AJS.$.ajax(h()+"/rest/capabilities/awareness",{type:"GET",success:function L(Q){var R=_.partial(K,m());var P=_.chain(Q.applications).map(function(T,S){return _.extend(T,{capabilitiesUrl:S})}).filter(function(S){return R(S.capabilitiesUrl)===false}).value();P.push({id:Q.links.selfInstanceId,capabilitiesUrl:Q.links.collection});k=ATLAS_PROJECT_CREATE.loadRemoteRoots(P);A=Q.links.selfInstanceId;if(typeof O==="function"){O(k,M,N)}},error:function(R,P,Q){console.log("Project create error - error gathering roots from awareness capability");if(M){x(M().getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled","false")}}})}var A;var g=null;function t(N,M){var L=_.map(N,M);return o(L)}function o(M){var L=x.Deferred();var N=0;if(M.length===0){L.resolve()}else{_.each(M,function(O){O.always(function(){N++;if(N===M.length){L.resolve()}})})}return L.promise()}function c(N,L,M){N.addPanel("title","","post-project-created-page-content");N.addHeader("Creating and linking companions for your JIRA project");N.addButton("All done!",function(){L(M,AJS.$(this))},"project-create-acknowledge-button");AJS.$(".project-create-acknowledge-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary").attr("aria-disabled","true").prop("disabled",true)}function D(M,L){var N=[];if(L.capabilityKey==="ondemand.svn-repository"){console.log("got back created SVN repository");N.push({type:{capabilityKey:"fecru.repository",instanceId:g.id,baseUrl:g.capabilitiesUrl},data:{key:M.key}});N.push({type:{capabilityKey:"fecru.project",instanceId:g.id,baseUrl:g.capabilitiesUrl},data:{key:"CR-"+M.key}})}else{console.log("got back created thing "+L.capabilityKey);var O={type:L,data:M};N.push(O)}return N}function i(N,O){var M=AJS.$("."+O);M.empty();M.append('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>");if(N.links.resource){var L=AJS.$("<a target='_blank'></a>");L.text(N.label);L.attr("href",N.links.resource);L.attr("title",N.label);M.closest("li").append(L)}}function l(S,M,R,Q){var O=AJS.$("."+S);O.empty();O.append('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>");var L=Q;if(R&&R.responseText){try{var P=JSON.parse(R.responseText);if(P&&P.message){L=P.message}}catch(N){L=R.responseText}}AJS.messages.error(".li-"+S,{title:AJS.format("Could not create {0}",M.label),body:L})}function s(L){var M=L.getCurrentPanel();if(M.body.find(".aui-message.error").size()!==0){AJS.messages.warning(".project-creation-success",{title:"We were unable to create everything you requested",body:"<p>"+"However, you can create them yourself and manually set up links."+"</p>"});L.updateHeight()}}function H(L){var M=_.map(L,function(O){return O.capabilityKey});var N=(M.length==0)?"none":M.sort().join("_");AJS.EventQueue.push({name:"project.create.aggregateroots.selected",properties:{capabilitykeys:N}})}function f(M,L){x(M.getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled",!L)}function d(M,L){return J(L.capabilityKey)-J(M.capabilityKey)}function J(L){return _.has(G,L)?G[L]:0}JPT.AddProjectController.registerProjectKeyValidationCallback(e);var y=function y(){return JPT.DialogView.dialog||JPT.DialogView._dialog};var a=function a(){if(JPT.AddProjectView.getKey().length>=2){JPT.AddProjectController._performKeyValidationChecks(JPT.AddProjectView.getKey())}};JPT.AddProjectView.addPostDrawCallback(function(){E(y,a)});JPT.AddProjectController.registerPostProjectCreationCallback(function(P,Q,O,M,N){var L=function(){window.location=AJS.contextPath()+Q};w(P,L,O,M,N)});var q=function q(){var N="projectCreation";GH.StartWizardView.registerWizardStepPreRenderCallback(function M(Q){if(Q==N){b();GH.StartWizardView.registerWizardStepOnCreateCallbacks(function P(S,T,R){console.log("creating external entities");S.addPage("post-project-created-page");w(S,T,null,R.project.key,R.project.name)})}});GH.StartWizardView.registerWizardStepPostRenderCallback(function O(R,P){if(R==N){E(function Q(){return P});P.updateHeight()}});GH.StartWizardView.registerWizardStepOnValidateCallback(function L(U,R){if(U==N){var T=R.getCurPanel().body.find("#ghx-wizard-project-projectkey");var Q=e(T.val());if(Q.errors.projectKey){var P=AJS.$("<div class='error project-creation-error'></div>");var S=T.parent();S.find(".project-creation-error").remove();S.append(P);P.text(Q.errors.projectKey);P.show();return false}}return true})};x(function(){AJS.$(".add-project-trigger").live("click",b);if(typeof GH!=="undefined"){if(GH.StartWizardView&&GH.StartWizardView.registerWizardStepPreRenderCallback){q()}}});x(function(){AJS.$(".add-project-trigger").live("click",b)})})(jQuery);;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/templates/project-creation.soy' */
// This file was automatically generated from project-creation.soy.
// Please don't edit this file by hand.

if (typeof project == 'undefined') { var project = {}; }
if (typeof project.creation == 'undefined') { project.creation = {}; }


project.creation.remoteRootsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-group loading"><span class="aui-icon aui-icon-wait"/>', soy.$$escapeHtml("Retrieving additional project types you might want to create"), '</div>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsCheckboxes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group remote-root-checkboxes"><h4>', soy.$$escapeHtml("Create a linked:"), '</h4><div class=\'field-group\'>');
  var rootTypeList10 = opt_data.rootTypes;
  var rootTypeListLen10 = rootTypeList10.length;
  for (var rootTypeIndex10 = 0; rootTypeIndex10 < rootTypeListLen10; rootTypeIndex10++) {
    var rootTypeData10 = rootTypeList10[rootTypeIndex10];
    output.append('<div class="checkbox"><input class="checkbox remote-root" type="checkbox" id="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '" checked="true" data-url="', soy.$$escapeHtml(rootTypeData10.url), '"></input><label for="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '">', soy.$$escapeHtml(rootTypeData10.label), '</label></div>');
  }
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsSuccess = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-creation-success"><ul>');
  var rootTypeList24 = opt_data.rootTypes;
  var rootTypeListLen24 = rootTypeList24.length;
  for (var rootTypeIndex24 = 0; rootTypeIndex24 < rootTypeListLen24; rootTypeIndex24++) {
    var rootTypeData24 = rootTypeList24[rootTypeIndex24];
    output.append('<li class="li-', soy.$$escapeHtml(rootTypeData24.statusId), '"><div class="', soy.$$escapeHtml(rootTypeData24.statusId), ' created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml(rootTypeData24.label), '</div></li>');
  }
  output.append('<li class="li-linking-status"><div class="linking-status created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml("Creating links"), '</div></li></ul></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();;
;/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(b){var m=AJS.$.ajax;var h="atlassian-analytics";var g=typeof AJS.contextPath=="function"?AJS.contextPath():typeof AJS.Confluence!="undefined"?AJS.Confluence.getContextPath():window.contextPath!=null?window.contextPath:"";var l=null;var i=null;var d=null;var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var t=Math.random()*16|0,s=u=="x"?t:(t&3|8);return s.toString(16)});var p=function(){var s="unknown";if(document.body.id=="jira"){s="jira"}else{if(document.body.id=="com-atlassian-confluence"){s="confluence"}}i=h+"."+s;d=i+".lock"};var c=function(){if(store.get(d)){return false}store.set(d,n);return(store.get(d)===n)};var q=function(){store.set(d,null)};var f=function(){var t=[],v,w,s,u;if(AJS.EventQueue.length==0){return}t=store.get(i)||t;for(s=0,u=AJS.EventQueue.length;s<u;++s){w=AJS.EventQueue[s];if(w.name){v={name:w.name,properties:w.properties,time:w.time||0};t.push(v)}}AJS.EventQueue.length=0;store.set(i,t)};var e=function(){var t;if(!c()){return}f();t=store.get(i);if(t&&t.length){store.remove(i);q();if(k(t)){var u=new Date().getTime();for(var s=0;s<t.length;s++){if(t[s].time>0){t[s].timeDelta=t[s].time-u}else{t[s].timeDelta=s-t.length}delete t[s].time}l=m({type:"POST",url:g+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(t),contentType:"application/json",dataType:"json"});l.fail(function(){AJS.EventQueue.concat(t);f()})}}else{q()}};var k=function(u){for(var t=u.length-1;t>=0;t--){var w="";var v=u[t];var s=v.properties;if(typeof v.name==="undefined"){w="you must provide a name for the event."}else{if(typeof s!=="undefined"&&s!==null){if(s.constructor!==Object){w="properties must be an object with key value pairs."}else{a(s)}}}if(w!==""){AJS.log("WARN: Invalid analytics event detected and ignored, "+w+"\nEvent: "+JSON.stringify(v));u.splice(t,1)}}return u.length};var a=function(u){for(var t in u){if(u.hasOwnProperty(t)){var s=u[t];if(typeof s!=="undefined"&&s!==null&&s.toString){u[t]=s.toString()}else{u[t]=""}}}};var j=function(){if(l&&!(l.state()==="resolved"||l.state()==="rejected")){l.abort()}};AJS.EventQueue=AJS.EventQueue||[];var o=Array.prototype.push;AJS.EventQueue.push=function(s){s.time=new Date().getTime();o.call(AJS.EventQueue,s)};AJS.toInit(function(){p();setTimeout(e,500);setInterval(e,5000);r()});b(window).unload(function(){j();f()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(s,t){AJS.log("WARN: 'triggerPrivacyPolicySafeEvent' has been deprecated");AJS.EventQueue.push({name:s,properties:t})}};AJS.bind("analytics",function(s,t){AJS.EventQueue.push({name:t.name,properties:t.data})});AJS.bind("analyticsEvent",function(s,t){AJS.EventQueue.push({name:t.name,properties:t.data})});var r=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var t=AJS.$(":contains(Enable Atlassian analytics)");if(t.size()>0){var s=t[t.size()-2];if(s){s.remove()}}}}}}(AJS.$));;
;/* module-key = 'com.atlassian.analytics.analytics-client:policy-update', location = 'js/policy-update.js' */
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminshortcuts.soy' */
// This file was automatically generated from adminshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.adminshortcuts == 'undefined') { navlinks.templates.adminshortcuts = {}; }


navlinks.templates.adminshortcuts.section = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param5 = new soy.StringBuilder('<ul class="aui-list-truncate">');
  var linkList7 = opt_data.links;
  var linkListLen7 = linkList7.length;
  for (var linkIndex7 = 0; linkIndex7 < linkListLen7; linkIndex7++) {
    var linkData7 = linkList7[linkIndex7];
    param5.append('<li><a href="', soy.$$escapeHtml(linkData7.link), '">', soy.$$escapeHtml(linkData7.label), '</a></li>');
  }
  param5.append('</ul>');
  aui.dropdown2.section({id: 'nl-remote-admin-section', label: "Other applications", content: param5.toString()}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminnavlinks.js' */
var NavLinks=(function(a){a.AdminShortcuts=(function(){var c=function(){return AJS.$.ajax({url:AJS.contextPath()+"/rest/menu/latest/admin",cache:false,dataType:"json"})};var b=function(){AJS.$("#nl-remote-admin-section").on("click","a",function(){NL.trackEvent("remoteAdminItemSelected",NL.getCurrentApplication(),$(this).attr("href"))})};return{render:function(){c().done(function(e){e=_.reject(e,function(f){return f.local===true});if(e.length){var d=navlinks.templates.adminshortcuts.section({links:e});a.ApplicationHeader.Cog.getDropdown().append(d);b()}})}}}());return a}(NavLinks||{}));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts', location = 'adminshortcuts/adminshortcuts-cdn.js' */
AJS.toInit(function(){if(AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("rotp.admin.shortcuts")){NavLinks.AdminShortcuts.render()}});;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.localShortcuts && opt_data.localShortcuts.length > 0) {
    navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}, output);
  }
  if (opt_data.remoteShortcuts != null) {
    if (opt_data.remoteShortcuts.length > 0) {
      output.append('<h2 class="projectshortcuts-heading">Related Links</h2>');
      navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentData(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'}), output);
    }
  } else {
    navlinks.templates.projectshortcuts.dialogLoading(null, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="', soy.$$escapeHtml(opt_data.logoUrl), '"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="project-content-wrapper">', opt_data.contentHtml, '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output.append('<li', (shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '', '>');
    navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35, output);
    output.append('</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.link), '"', (opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '', '>', soy.$$escapeHtml(opt_data.label), '</a>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="projectshortcuts-loading">', (opt_data != null && opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,g){var i,k={},m="key",b="name",j="entity-type";function f(s){var n=e(this),o=n.data(m),q=n.data(b),p=n.data(j);if(typeof o==="undefined"){return}s.preventDefault();i=new AJS.Dialog({width:600,keypressListener:function(u){if(u.which==jQuery.ui.keyCode.ESCAPE){i.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){i.remove()}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:q,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links…"})})).show();c(i);if(!k[o]){k[o]={entity:{title:q},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+o,{entityType:p}).done(t);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+o,{entityType:p}).done(r).fail(function(){var u=i.getCurrentPanel().body.find(".project-content-wrapper");u.find(".projectshortcuts-loading").remove();AJS.messages.error(u,{body:"Could not retrieve remote project shortcuts",closeable:false});c(i)})}else{l(k[o])}function t(u){k[o].localShortcuts=u.shortcuts;l(k[o])}function r(u){k[o].remoteShortcuts=u.shortcuts;l(k[o])}}function h(){return e(".project-shortcut-dialog-trigger img").attr("src")}function l(n){if(n.localShortcuts){i.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:n.entity.title,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(n)}));c(i)}}function a(p){var o=210;if(!p||p.length<=o){return p}var n=o;while(n>0&&p.charAt(n)!=" "){n--}if(n==0){n=o}p=p.substring(0,n);if(p.length>=n){p=p+"..."}return p}function c(n){var q=n.popup.element,p=q.find(".dialog-panel-body"),o=q.find(".dialog-components");p.height("auto");q.height(o.outerHeight()-1);e(".aui-shadow").remove()}function d(n,o){return e.ajax({url:n,cache:false,data:o,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-web-plugin:issue-link-web-link', location = 'js/issuelink-weblink.js' */
(function(){var $hiddenImg=AJS.$("<img>"),$iconUrlInput,$urlInput,faviconUrl,throbberTimeoutId;$hiddenImg.load(function(){$iconUrlInput.val(faviconUrl);$urlInput.css("background-image",'url("'+faviconUrl+'")');clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});$hiddenImg.error(function(){clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});function init(context){$iconUrlInput=AJS.$("#web-link-icon-url",context);$urlInput=AJS.$("#web-link-url",context).bind("change",fetchFavicon);if($iconUrlInput.val()){$urlInput.css("background-image","url("+$iconUrlInput.val()+")")}}function fetchFavicon(){$hiddenImg.attr("src","");$iconUrlInput.val("");$urlInput.css("background-image","");faviconUrl=parseFaviconUrl($urlInput.val());if(!faviconUrl){return }setTimeout(function(){$urlInput.addClass("loading")},0);throbberTimeoutId=setTimeout(function(){$urlInput.removeClass("loading")},3000);$hiddenImg.attr("src",faviconUrl)}function parseFaviconUrl(url){var hostUrl=url.match(/^([^/]*\/\/[^/]+)/)[1];if(!hostUrl){return }return hostUrl+"/favicon.ico"}JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){init(context)})})();;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/IssuePicker.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.AdminHelper");JIRA.AdminHelper.IssuePicker=AJS.SingleSelect.extend({init:function(a){function b(c){if(!c.sections){return[]}var d=[];AJS.$(c.sections).each(function(e,g){var f=new AJS.GroupDescriptor({weight:e,label:g.label});AJS.$(g.issues).each(function(j,h){f.addItem(new AJS.ItemDescriptor({value:h.key,label:h.key+" - "+h.summaryText,html:h.keyHtml+" - "+h.summary,icon:contextPath+h.img}))});d.push(f)});return d}AJS.$.extend(a,{errorMessage:"Please select an issue",ajaxOptions:{url:contextPath+"/rest/api/1.0/issues/picker?currentJQL=project!=null",query:true,formatResponse:b}});this._super(a)}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/common.soy' */
// This file was automatically generated from common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AdminHelper == 'undefined') { JIRA.Templates.AdminHelper = {}; }
if (typeof JIRA.Templates.AdminHelper.Common == 'undefined') { JIRA.Templates.AdminHelper.Common = {}; }


JIRA.Templates.AdminHelper.Common.statusImage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.status == 'green') ? '<span class="icon adminhelper-icon-tick"></span> ' : '<span class="icon adminhelper-icon-cross"></span> ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.warningImage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="icon adminhelper-icon-warning"></span> ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.loadingStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="status-loading" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.statusLineRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="statusRow ', (opt_data.hideFailedStatuses && opt_data.statusLine.status == 'red') ? 'hidden' : '', '" data-status="', soy.$$escapeHtml(opt_data.statusLine.status), '"><td>');
  JIRA.Templates.AdminHelper.Common.statusImage({status: opt_data.statusLine.status}, output);
  output.append('</td><td>');
  var summaryList23 = opt_data.statusLine.summary;
  var summaryListLen23 = summaryList23.length;
  for (var summaryIndex23 = 0; summaryIndex23 < summaryListLen23; summaryIndex23++) {
    var summaryData23 = summaryList23[summaryIndex23];
    output.append('<p>', summaryData23, '</p>');
  }
  output.append('</td><td>');
  if (opt_data.statusLine.details.length == 1) {
    var detailList32 = opt_data.statusLine.details;
    var detailListLen32 = detailList32.length;
    for (var detailIndex32 = 0; detailIndex32 < detailListLen32; detailIndex32++) {
      var detailData32 = detailList32[detailIndex32];
      output.append(detailData32);
    }
  } else {
    var detailList37 = opt_data.statusLine.details;
    var detailListLen37 = detailList37.length;
    for (var detailIndex37 = 0; detailIndex37 < detailListLen37; detailIndex37++) {
      var detailData37 = detailList37[detailIndex37];
      output.append('<p>', detailData37, '</p>');
    }
  }
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/whereismycf-dialog.soy' */
// This file was automatically generated from whereismycf-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.WhereIsMyCf == 'undefined') { JIRA.Templates.Dialogs.WhereIsMyCf = {}; }


JIRA.Templates.Dialogs.WhereIsMyCf.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui ajs-dirty-warning-exempt"><div class="form-body"><div id="whereismycf-suggestions" class="aui-list" /><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find your field"), '</div><div class="field-status-placeholder"></div></div><div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">', soy.$$escapeHtml("Close"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.WhereIsMyCf.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.project), '">', soy.$$escapeHtml(opt_data.project), '</dd></dl><dl><dt>', soy.$$escapeHtml("Issue type"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.issueType), '">', soy.$$escapeHtml(opt_data.issueType), '</dd></dl><dl><dt>', soy.$$escapeHtml("Screen"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.operation), '">', soy.$$escapeHtml(opt_data.operation), '</dd></dl><dl><dt>', soy.$$escapeHtml("Field"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.fieldName), '">', soy.$$escapeHtml(opt_data.fieldName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  output.append((opt_data.status == 'green') ? soy.$$escapeHtml(AJS.format("The \x27\x27{0}\x27\x27 field should be present on the form you are viewing",opt_data.fieldName)) : soy.$$escapeHtml(AJS.format("The \x27\x27{0}\x27\x27 field is not present on the form you are viewing",opt_data.fieldName)), '</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the \x27\x27{0}\x27\x27 field status",opt_data.fieldName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList57 = opt_data.statusLines;
    var statusLineListLen57 = statusLineList57.length;
    for (var statusLineIndex57 = 0; statusLineIndex57 < statusLineListLen57; statusLineIndex57++) {
      var statusLineData57 = statusLineList57[statusLineIndex57];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData57}, output);
    }
    output.append('<tbody></table>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.WhereIsMyCf.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ajaxerror"><div class="aui-message ', soy.$$escapeHtml(opt_data.errorClass), '">');
  if (opt_data.errorMessages.length == 1) {
    var msgList69 = opt_data.errorMessages;
    var msgListLen69 = msgList69.length;
    for (var msgIndex69 = 0; msgIndex69 < msgListLen69; msgIndex69++) {
      var msgData69 = msgList69[msgIndex69];
      output.append('<p>', soy.$$escapeHtml(msgData69), '</p>');
    }
  } else {
    output.append('<ul>');
    var msgList76 = opt_data.errorMessages;
    var msgListLen76 = msgList76.length;
    for (var msgIndex76 = 0; msgIndex76 < msgListLen76; msgIndex76++) {
      var msgData76 = msgList76[msgIndex76];
      output.append('<li>', soy.$$escapeHtml(msgData76), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div></div>', (! opt_data.noCloseLink) ? '<div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/whereismycf-dialog.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.WhereIsMyCf");JIRA.WhereIsMyCf.WhereIsMyCfDialog=JIRA.Dialog.extend({OPERATION_CREATE:0,OPERATION_EDIT:1,OPERATION_VIEW:2,_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"whereismycf-dialog",widthClass:"large",stacked:true})},_setContent:function(b,d){var a=this;if(b){this._super(b,d)}else{this._super(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.searchPage()),true)}this.get$popupContent().find(".cancel").click(function(f){a.hide();f.preventDefault()});if(JIRA.Dialog.current===this){var c=new JIRA.setFocus.FocusConfiguration();c.context=this.get$popup()[0];c.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(c);JIRA.setFocus.triggerFocus()}},_formatActionsResponse:function(a){var b=[];if(a){var c=new AJS.GroupDescriptor({showLabel:false,label:"Fields"});AJS.$(a).each(function(){var d=new AJS.ItemDescriptor({label:this.customFieldName});d.properties.cfId=this.customFieldId;c.addItem(d)});b.push(c)}return b},decorateContent:function(){var b=this,a=JIRA.Meta.getIssueKey();this.addHeading("Where is my field?");this.queryControl=new AJS.QueryableDropdownSelect({id:"whereismycf",element:this.$content.find("#whereismycf-suggestions"),ajaxOptions:{minQueryLength:1,dataType:"json",url:contextPath+"/rest/whereismycf/1.0/fields/all",formatResponse:this._formatActionsResponse},showDropdownButton:true,loadOnInit:true});this.queryControl._handleServerError=function(g){var h=JIRA.SmartAjax.buildSimpleErrorContent(g);var f=g.status===401?"warning":"error";b._setContent(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.errorPage({errrorMessage:h,errorClass:f})),false)};var c=this.queryControl.listController.options.selectionHandler;this.queryControl.listController.options.selectionHandler=function(f){c.call(this,f);b.get$popupContent().find(".field-status-results").remove();b.get$popupContent().find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));var g=this.getFocused().data("descriptor");AJS.trigger("analyticsEvent",{name:"adminhelper.whereismycf.field.select"});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/fields/{0}?{1}",g.properties.cfId,b.options.context.asRequestParams()),complete:function(j,k,i){if(i.successful){b.queryControl.$field.val("").css("color","black");b.get$popupContent().find(".status-loading").remove();var h=i.data;b.get$popupContent().find(".field-status-placeholder").append(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.resultPage({fieldName:g.label(),issueType:h.issueType,issueKey:h.issueKey,project:h.projectName,operation:h.operation,status:h.status,statusLines:d(h.statusLines),baseUrl:contextPath})))}else{e(b,i)}b._positionInCenter()}});return false};function d(i){if(i.length==0){return i}function g(l){var k=[];AJS.$.each(l,function(m,n){k.push(h(n))});return k}function h(l){if(l.parameters.length==0){return AJS.escapeHTML(l.message)}else{var k=f(l.parameters);k.splice(0,0,AJS.escapeHTML(l.message));return AJS.format.apply(this,k)}}function f(l){var k=[];AJS.$.each(l,function(m,n){if(n.type=="plain"){k.push(AJS.escapeHTML(n.value))}else{if(n.type=="link"){k.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(n.href),AJS.escapeHTML(n.text)))}else{if(n.type=="newline"){k.push("<br/>")}else{if(n.type=="tagstart"){k.push("<"+n.tagName+">")}else{if(n.type=="tagend"){k.push("</"+n.tagName+">")}else{throw"Unrecognized parameter type: "+n.type}}}}}});return k}var j=[];AJS.$.each(i,function(m,k){var l={};l.status=k.status;l.summary=g(k.summary);l.details=g(k.details);j.push(l)});return j}function e(g,h){var j=[];var i=JIRA.SmartAjax.buildSimpleErrorContent(h);if(i){j.push(i)}else{if(h.data&&h.data.errorMessages){j.push(h.data.errorMessages)}if(h.data&&h.data.errors){j.push(h.data.errors)}}var f=h.status===401?"warning":"error";g._setContent(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.errorPage({errorMessages:j,errorClass:f})),false)}},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.WhereIsMyCf.IssueContext=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},asRequestParams:function(){function a(c){return typeof(c)!="undefined"}var b="atl_token="+atl_token();if(a(this.options.issueKey)){b+="&issueKey="+this.options.issueKey}if(a(this.options.projectKey)){b+="&projectKey="+this.options.projectKey}if(a(this.options.projectId)){b+="&projectId="+this.options.projectId}if(a(this.options.issueOperation!==undefined)){b+="&issueOperation="+this.options.issueOperation}if(a(this.options.issueTypeId)){b+="&issueTypeId="+this.options.issueTypeId}return b}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/whereismycf.js' */
if(AJS.Meta.get("is-admin")){(function(g){var d="Where is my field?";JIRA.WhereIsMyCf.dialog=new JIRA.WhereIsMyCf.WhereIsMyCfDialog;g(document).delegate(".whereismycf-trigger","click",function(i){i.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.whereismycf.dialog.open"});JIRA.WhereIsMyCf.dialog.show(c())});g(document).bind("showLayer",function(j,l,k){if(l=="inlineDialog"&&k.popup.attr("id")=="inline-dialog-field_picker_popup"){if(k.popup.find(".whereismycf-qfpicker-link").length==0){var i=g("<a href='#' class='whereismycf-qfpicker-link'>"+d+"</a>").appendTo(k.popup.find(".qf-picker-header dl"));i.click(function(m){m.preventDefault();k.hide();h();JIRA.WhereIsMyCf.dialog.show(b())})}}});function h(){AJS.InlineDialog.current=null}function f(){var i=JIRA.Issue.getIssueKey();if(!i&&JIRA.IssueNavigator){i=JIRA.IssueNavigator.getSelectedIssueKey()}return i}function c(){return new JIRA.WhereIsMyCf.IssueContext({issueKey:f(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_VIEW})}function b(){var i=JIRA.Dialog.current;if((i.options.id=="create-issue-dialog")||(i.options.id=="create-subtask-dialog")){return a(i)}else{if(i.options.id=="edit-issue-dialog"){return e(i)}else{throw"Uknown current dialog ID: "+i.options.id}}}function a(i){var j=i.get$popupContent();return new JIRA.WhereIsMyCf.IssueContext({projectId:j.find("#project").val(),issueTypeId:j.find("#issuetype").val(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_CREATE})}function e(i){var j=i.get$popupContent();return new JIRA.WhereIsMyCf.IssueContext({issueKey:f(),issueTypeId:j.find("#issuetype").val(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_EDIT})}})(AJS.$)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/permission-helper-dialog.soy' */
// This file was automatically generated from permission-helper-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.PermissionHelper == 'undefined') { JIRA.Templates.Dialogs.PermissionHelper = {}; }


JIRA.Templates.Dialogs.PermissionHelper.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="permissionhelper-search-form aui ajs-dirty-warning-exempt"><div class="content-area-container"><div class="form-body"><div id="error-message-placeholder"></div><div class="action-description">', soy.$$escapeHtml("Discover why a user does or does not have certain permissions..."), '</div><div class="field-group"><label for="permissionhelper-user">', soy.$$escapeHtml("User"), '</label><select id="permissionhelper-user" name="permissionhelper-user" class="single-user-picker js-default-user-picker" data-container-class="long-field"></select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a user, leave blank for Anonymous user"), '</div></div><div class="field-group ', (opt_data.currentIssueKey) ? 'hidden' : '', '"><label for="permissionhelper-issue">', soy.$$escapeHtml("Issue"), '</label><select class="aui-field-select select" name="permissionhelper-issue" id="permissionhelper-issue"></select><div class="description">', soy.$$escapeHtml("Begin typing to find an issue"), '</div></div><div class="field-group"><label for="permissionhelper-permission">', soy.$$escapeHtml("Permission"), '</label><select class="aui-field-select select" name="permissionhelper-permission" id="permissionhelper-permission">');
  var permissionGroupList20 = opt_data.permissionGroups;
  var permissionGroupListLen20 = permissionGroupList20.length;
  for (var permissionGroupIndex20 = 0; permissionGroupIndex20 < permissionGroupListLen20; permissionGroupIndex20++) {
    var permissionGroupData20 = permissionGroupList20[permissionGroupIndex20];
    output.append('<optgroup label="', soy.$$escapeHtml(permissionGroupData20.name), '">');
    var permissionList24 = permissionGroupData20.permissions;
    var permissionListLen24 = permissionList24.length;
    for (var permissionIndex24 = 0; permissionIndex24 < permissionListLen24; permissionIndex24++) {
      var permissionData24 = permissionList24[permissionIndex24];
      output.append('<option ', (permissionData24.id == 10) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(permissionData24.id), '">', soy.$$escapeHtml(permissionData24.name), '</option>');
    }
    output.append('</optgroup>');
  }
  output.append('</select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a permission or press down to see all"), '</div></div></div><div class="form-body field-status-placeholder" /></div><div class="buttons-container form-footer"><div class="buttons"><input class="button search" type="submit" id="permission-helper-submit" value="', soy.$$escapeHtml("Submit"), '">', (! opt_data.noCloseLink) ? '<a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a>' : '', '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.PermissionHelper.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Permission name"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.permissionName), '">', soy.$$escapeHtml(opt_data.permissionName), '</dd></dl><dl><dt>', soy.$$escapeHtml("User"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.userDisplayName), '">', (opt_data.username != '') ? '<a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/secure/admin/user/ViewUser.jspa?name=' + soy.$$escapeHtml(opt_data.username) + '">' + soy.$$escapeHtml(opt_data.userDisplayName) + '</a>' : soy.$$escapeHtml(opt_data.userDisplayName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.projectName), '"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/browse/', soy.$$escapeHtml(opt_data.projectKey), '">', soy.$$escapeHtml(opt_data.projectName), '</a></dd></dl><dl><dt>', soy.$$escapeHtml("Permission scheme"), ': </dt><dd title="blah"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/project-config/', soy.$$escapeHtml(opt_data.projectKey), '/permissions">', soy.$$escapeHtml(opt_data.permissionSchemeName), '</a></dd></dl>', (opt_data.issueKey) ? '<dl><dt>' + soy.$$escapeHtml("Issue") + ': </dt><dd title="' + soy.$$escapeHtml(opt_data.issueKey) + '"><a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/browse/' + soy.$$escapeHtml(opt_data.issueKey) + '">' + soy.$$escapeHtml(opt_data.issueKey) + '</a></dd></dl>' : '', '<dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  output.append((opt_data.status == 'green') ? soy.$$escapeHtml(AJS.format("{0} has the \x27\x27{1}\x27\x27 permission",opt_data.userDisplayName,opt_data.permissionName)) : soy.$$escapeHtml(AJS.format("{0} does not have the \x27\x27{1}\x27\x27 permission",opt_data.userDisplayName,opt_data.permissionName)), '</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the \x27\x27{0}\x27\x27 permission",opt_data.permissionName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList127 = opt_data.statusLines;
    var statusLineListLen127 = statusLineList127.length;
    for (var statusLineIndex127 = 0; statusLineIndex127 < statusLineListLen127; statusLineIndex127++) {
      var statusLineData127 = statusLineList127[statusLineIndex127];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData127, hideFailedStatuses: opt_data.hideFailedStatuses}, output);
    }
    output.append('<tbody></table><div class="toggle-conditions-container"><a class="show-failed-conditions" ', (opt_data.hideFailedStatuses == false || opt_data.allGreenStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Show failed conditions"), '</a><a class="hide-failed-conditions" ', (opt_data.hideFailedStatuses == true || opt_data.allFailedStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Hide failed conditions"), '</a></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.PermissionHelper.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ajaxerror"><div class="aui-message ', soy.$$escapeHtml(opt_data.errorClass), '">');
  if (opt_data.errorMessages.length == 1) {
    var msgList152 = opt_data.errorMessages;
    var msgListLen152 = msgList152.length;
    for (var msgIndex152 = 0; msgIndex152 < msgListLen152; msgIndex152++) {
      var msgData152 = msgList152[msgIndex152];
      output.append('<p>', soy.$$escapeHtml(msgData152), '</p>');
    }
  } else {
    output.append('<ul>');
    var msgList159 = opt_data.errorMessages;
    var msgListLen159 = msgList159.length;
    for (var msgIndex159 = 0; msgIndex159 < msgListLen159; msgIndex159++) {
      var msgData159 = msgList159[msgIndex159];
      output.append('<li>', soy.$$escapeHtml(msgData159), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div></div><div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">', soy.$$escapeHtml("Close"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper-ui.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.PermissionHelper");JIRA.PermissionHelper.PERMISSIONS=WRM.data.claim("com.atlassian.jira.plugins.jira-admin-helper-plugin:permissions-provider.permissions-data");JIRA.PermissionHelper.PermissionHelperUi={initUi:function(d,b,c){i();var l={};l.searchButton=d.find("input.search");l.searchForm=d.find("form.permissionhelper-search-form");var k=function(o){o.preventDefault();var m=h(d,b);d.find(".error").remove();var n=false;if(!m.params().issueKey){e(AJS.$("#permissionhelper-issue",d),"Please select an issue");n=true}if(!m.params().permissionId){e(AJS.$("#permissionhelper-permission"),"Please select a valid permission");n=true}if(n){return}d.find("#error-message-placeholder").empty();d.find(".field-status-results").remove();d.find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.check",data:{permissionId:m.params().permissionId}});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/permissions?username={0}&issueKey={1}&permissionId={2}",m.params().username,m.params().issueKey,m.params().permissionId),complete:function(s,u,q){d.find(".status-loading").remove();if(q.successful){var t=q.data;var r=j(t.statusLines);var p=AJS.$(JIRA.Templates.Dialogs.PermissionHelper.resultPage({permissionName:t.permissionName,username:t.username,userDisplayName:t.userDisplayName,issueKey:t.issueKey,projectKey:t.projectKey,projectName:t.projectName,status:t.status,statusLines:r,hideFailedStatuses:g(r),allFailedStatuses:!g(r),allGreenStatuses:a(r),baseUrl:contextPath,permissionSchemeName:t.permissionSchemeName}));d.find(".field-status-placeholder").append(p);if(c){c()}p.delegate(".show-failed-conditions","click",function(v){console.log("SHOWING");v.preventDefault();AJS.$(".statusRow[data-status='red']").show();AJS.$(".show-failed-conditions").hide();AJS.$(".hide-failed-conditions").show();JIRA.PermissionHelper.dialog._positionInCenter()});p.delegate(".hide-failed-conditions","click",function(v){console.log("HIDING");v.preventDefault();AJS.$(".statusRow[data-status='red']").hide();AJS.$(".hide-failed-conditions").hide();AJS.$(".show-failed-conditions").show();JIRA.PermissionHelper.dialog._positionInCenter()})}else{f(d,q)}}})};l.searchForm.submit(k);l.searchButton.click(k);function e(m,n){m.parent().append(AJS.$("<div>").addClass("error").text(n))}function h(m,n){return{permissionId:function(){var o=m.find("#permissionhelper-permission option:selected");if(o.length>0){return o.val()}else{return 10}},paramsForRequest:function(){return n.asRequestParams(this._paramsFromContents())},params:function(){return n.params(this._paramsFromContents())},_paramsFromContents:function(){var r={};var q=m.find("#permissionhelper-user option:selected");if(q.length==1){r.username=q.val()}else{r.username=""}var p=m.find("#permissionhelper-issue option:selected");if(p.length>0){r.issueKey=p.val()}var o=m.find("#permissionhelper-permission option:selected");if(o.length>0){r.permissionId=o.val()}return r}}}function j(p){if(p.length==0){return p}function n(s){var r=[];AJS.$.each(s,function(t,u){r.push(o(u))});return r}function o(s){if(s.parameters.length==0){return AJS.escapeHTML(s.message)}else{var r=m(s.parameters);r.splice(0,0,AJS.escapeHTML(s.message));return AJS.format.apply(this,r)}}function m(s){var r=[];AJS.$.each(s,function(t,u){if(u.type=="plain"){r.push(AJS.escapeHTML(u.value))}else{if(u.type=="link"){r.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(u.href),AJS.escapeHTML(u.text)))}else{if(u.type=="newline"){r.push("<br/>")}else{if(u.type=="tagstart"){r.push("<"+u.tagName+">")}else{if(u.type=="tagend"){r.push("</"+u.tagName+">")}else{throw"Unrecognized parameter type: "+u.type}}}}}});return r}var q=[];AJS.$.each(p,function(t,r){var s={};s.status=r.status;s.required=r.required;s.summary=n(r.summary);s.details=n(r.details);q.push(s)});return q}function g(o){var m=false;var n=false;AJS.$.each(o,function(q,p){if(p.status=="green"){m=true}else{if(p.required){n=true}}});return n?false:m}function a(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="red"){m=true}});return !m}function f(p,o){var m=false;var r=[];if(o.data){var q=JSON.parse(o.data);if(q.errorMessages&&q.errorMessages.length){r.push(q.errorMessages);m=true}if(q.errors){if(q.errors.issue){e(AJS.$("#permissionhelper-issue",p),q.errors.issue);m=true}if(q.errors.user){e(AJS.$("#permissionhelper-user",p),q.errors.user);m=true}if(q.errors.permission){e(AJS.$("#permissionhelper-permission",p),q.errors.permission);m=true}}}if(!m){r.push(JIRA.SmartAjax.buildSimpleErrorContent(o))}var n=l.searchForm.find("#error-message-placeholder");AJS.$.each(r,function(s,t){AJS.messages.error(n,{body:t,closeable:false})})}function i(){new JIRA.AdminHelper.IssuePicker({element:AJS.$("#permissionhelper-issue"),itemAttrDisplayed:"label",width:500});new AJS.SingleSelect({element:AJS.$("#permissionhelper-permission"),itemAttrDisplayed:"label",width:500})}return l}}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper-dialog.js' */
if(AJS.Meta.get("is-admin")){JIRA.PermissionHelper.PermissionHelperDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"permission-helper-dialog",widthClass:"large",stacked:true})},_setContent:function(c,f){var a=this;if(c){this._super(c,f)}else{var e=this.context().issueKey()||"";var b=this.context().permissionId()||"";this._super(AJS.$(JIRA.Templates.Dialogs.PermissionHelper.searchPage({currentIssueKey:e,currentPermissionId:b,permissionGroups:JIRA.PermissionHelper.PERMISSIONS})),true)}this.get$popupContent().find(".cancel").click(function(g){a.hide();g.preventDefault()});if(JIRA.Dialog.current===this){var d=new JIRA.setFocus.FocusConfiguration();d.context=this.get$popup()[0];d.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(d);JIRA.setFocus.triggerFocus()}},decorateContent:function(){var a=this;this.addHeading("Permission Helper");JIRA.PermissionHelper.PermissionHelperUi.initUi(this.get$popupContent(),this.context(),function(){a._positionInCenter()})},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.PermissionHelper.Context=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},permissionId:function(a){if(a){this.options.permissionId=a}else{return this.options.permissionId}},params:function(a){var b=AJS.$.extend({},this.options);if(this._exists(a)){AJS.$.extend(b,a)}return b},asRequestParams:function(a){var c=this.params(a);var b="atl_token="+atl_token();if(this._exists(c.username)){b+="&username="+c.username}if(this._exists(c.issueKey)){b+="&issueKey="+c.issueKey}if(this._exists(c.projectKey)){b+="&projectKey="+c.projectKey}if(this._exists(c.projectId)){b+="&projectId="+c.projectId}if(this._exists(c.issueOperation!==undefined)){b+="&issueOperation="+c.issueOperation}if(this._exists(c.issueTypeId)){b+="&issueTypeId="+c.issueTypeId}return b},_exists:function(a){return typeof(a)!="undefined"}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper.js' */
if(AJS.Meta.get("is-admin")){(function(d){var c="Permission Helper";JIRA.PermissionHelper.dialog=new JIRA.PermissionHelper.PermissionHelperDialog;d(document).delegate(".permissionhelper-trigger","click",function(e){e.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.dialog.open"});JIRA.PermissionHelper.dialog.show(a())});d(function(){var e=d("#permission-helper-admin-page");if(e.length==1){b();AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.adminpage.open"});e.append(d(JIRA.Templates.Dialogs.PermissionHelper.searchPage({noCloseLink:true,permissionGroups:JIRA.PermissionHelper.PERMISSIONS})));e.trigger(JIRA.Events.NEW_CONTENT_ADDED,[e]);JIRA.PermissionHelper.PermissionHelperUi.initUi(e,new JIRA.PermissionHelper.Context());d("#permissionhelper-user-field").focus()}});function a(){var e=JIRA.Issue.getIssueKey();if(!e&&JIRA.IssueNavigator){e=JIRA.IssueNavigator.getSelectedIssueKey()}return new JIRA.PermissionHelper.Context({issueKey:e,issueOperation:JIRA.PermissionHelper.dialog.OPERATION_VIEW})}function b(){var e=d("#permission-helper-admin-page");e.prepend(d("<h2>").attr("id","admin-page-heading").text(c))}})(AJS.$)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/notification-helper.soy' */
// This file was automatically generated from notification-helper.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.NotificationHelper == 'undefined') { JIRA.Templates.Dialogs.NotificationHelper = {}; }


JIRA.Templates.Dialogs.NotificationHelper.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="notificationhelper-search-form aui ajs-dirty-warning-exempt"><div class="content-area-container"><div class="form-body"><div id="error-message-placeholder"></div><div class="action-description">', soy.$$escapeHtml("Find out why users receive, or do not receive notifications for this issue"), '</div><div class="field-group"><label for="notificationhelper-user">', soy.$$escapeHtml("User"), '</label><select id="notificationhelper-user" name="notificationhelper-user" class="single-user-picker js-default-user-picker" data-container-class="long-field"></select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a user"), '</div></div><div class="field-group ', (opt_data.currentIssueKey) ? 'hidden' : '', '"><label for="notificationhelper-issue">', soy.$$escapeHtml("Issue"), '</label><select class="aui-field-select select" name="notificationhelper-issue" id="notificationhelper-issue"></select><div class="description">', soy.$$escapeHtml("Begin typing to find an issue"), '</div></div><div class="field-group"><label for="notificationhelper-event">', soy.$$escapeHtml("Notification Event"), '</label><select class="aui-field-select select" name="notificationhelper-event" id="notificationhelper-event">');
  var eventList20 = opt_data.events;
  var eventListLen20 = eventList20.length;
  for (var eventIndex20 = 0; eventIndex20 < eventListLen20; eventIndex20++) {
    var eventData20 = eventList20[eventIndex20];
    output.append('<option ', (eventData20.id == opt_data.defaultEventId) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(eventData20.id), '">', soy.$$escapeHtml(eventData20.name), '</option>');
  }
  output.append('</select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a notification event or press down to see all"), '</div></div></div><div class="form-body field-status-placeholder" /></div><div class="buttons-container form-footer"><div class="buttons"><input class="button search" type="submit" id="permission-helper-submit" value="', soy.$$escapeHtml("Submit"), '">', (! opt_data.noCloseLink) ? '<a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a>' : '', '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.NotificationHelper.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Event"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.eventName), '">', soy.$$escapeHtml(opt_data.eventName), '</dd></dl><dl><dt>', soy.$$escapeHtml("User"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.userDisplayName), '">', (opt_data.username != '') ? '<a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/secure/admin/user/ViewUser.jspa?name=' + soy.$$escapeHtml(opt_data.username) + '">' + soy.$$escapeHtml(opt_data.userDisplayName) + '</a>' : soy.$$escapeHtml(opt_data.userDisplayName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.projectName), '"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/browse/', soy.$$escapeHtml(opt_data.projectKey), '">', soy.$$escapeHtml(opt_data.projectName), '</a></dd></dl><dl><dt>', soy.$$escapeHtml("Scheme"), ': </dt><dd title="blah"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/project-config/', soy.$$escapeHtml(opt_data.projectKey), '/notifications">', soy.$$escapeHtml(opt_data.notificationSchemeName), '</a></dd></dl>', (opt_data.issueKey) ? '<dl><dt>' + soy.$$escapeHtml("Issue") + ': </dt><dd title="' + soy.$$escapeHtml(opt_data.issueKey) + '"><a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/browse/' + soy.$$escapeHtml(opt_data.issueKey) + '">' + soy.$$escapeHtml(opt_data.issueKey) + '</a></dd></dl>' : '', '<dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  if (opt_data.status == 'green') {
    output.append(soy.$$escapeHtml(AJS.format("{0} receives notifications for the \x27\x27{1}\x27\x27 event",opt_data.userDisplayName,opt_data.eventName)));
    if (opt_data.userNotifyOwnChanges == false) {
      output.append('<br>');
      JIRA.Templates.AdminHelper.Common.warningImage(null, output);
      output.append(soy.$$escapeHtml(AJS.format("{0} does not get notified of their own changes.",opt_data.userDisplayName)), ' <a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Managing+your+User+Profile#ManagingyourUserProfile-Preferences">', soy.$$escapeHtml("Learn more"), '</a>.');
    }
  } else {
    output.append(soy.$$escapeHtml(AJS.format("{0} does not receive notifications for the \x27\x27{1}\x27\x27 event",opt_data.userDisplayName,opt_data.eventName)));
  }
  output.append('</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the notifications for the \x27\x27{0}\x27\x27 event",opt_data.eventName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList129 = opt_data.statusLines;
    var statusLineListLen129 = statusLineList129.length;
    for (var statusLineIndex129 = 0; statusLineIndex129 < statusLineListLen129; statusLineIndex129++) {
      var statusLineData129 = statusLineList129[statusLineIndex129];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData129, hideFailedStatuses: opt_data.hideFailedStatuses}, output);
    }
    output.append('<tbody></table><div class="toggle-conditions-container"><a class="show-failed-conditions" ', (opt_data.hideFailedStatuses == false || opt_data.allGreenStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Show failed conditions"), '</a><a class="hide-failed-conditions" ', (opt_data.hideFailedStatuses == true || opt_data.allFailedStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Hide failed conditions"), '</a></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper-ui.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.NotificationHelper");JIRA.NotificationHelper.NOTIFICATION_EVENTS=WRM.data.claim("com.atlassian.jira.plugins.jira-admin-helper-plugin:notification-event-provider.notification-event-data");JIRA.NotificationHelper.defaultEventId=function(){var a;AJS.$(JIRA.NotificationHelper.NOTIFICATION_EVENTS).each(function(){if(this.isDefault){a=this.id}});return a};JIRA.NotificationHelper.NotificationHelperUi={initUi:function(c,k,b){g();var l={};l.searchButton=c.find("input.search");l.searchForm=c.find("form.notificationhelper-search-form");var i=function(o){o.preventDefault();var m=f(c,k);c.find(".error").remove();var n=false;if(!m.params().username){d(AJS.$("#notificationhelper-user",c),"Please select a user");n=true}if(!m.params().issueKey){d(AJS.$("#notificationhelper-issue",c),"Please select an issue");n=true}if(!m.params().eventId){d(AJS.$("#notificationhelper-event",c),"Please select a valid notification event");n=true}if(n){return}c.find("#error-message-placeholder").empty();c.find(".field-status-results").remove();c.find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.check",data:{eventId:m.params().eventId}});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/notifications?username={0}&issueKey={1}&eventId={2}",m.params().username,m.params().issueKey,m.params().eventId),complete:function(t,u,r){c.find(".status-loading").remove();if(r.successful){var p=r.data;var s=h(p.statusLines);var q=AJS.$(JIRA.Templates.Dialogs.NotificationHelper.resultPage({eventName:p.eventName,username:p.username,userDisplayName:p.userDisplayName,userNotifyOwnChanges:p.userNotifyOwnChanges,issueKey:p.issueKey,projectKey:p.projectKey,projectName:p.projectName,status:p.status,statusLines:s,notificationSchemeName:p.notificationSchemeName,hideFailedStatuses:j(s),allFailedStatuses:!j(s),allGreenStatuses:a(s),baseUrl:contextPath}));c.find(".field-status-placeholder").append(q);if(b){b()}q.delegate(".show-failed-conditions","click",function(v){v.preventDefault();AJS.$(".statusRow[data-status='red']").show();AJS.$(".show-failed-conditions").hide();AJS.$(".hide-failed-conditions").show();if(b){b()}});q.delegate(".hide-failed-conditions","click",function(v){v.preventDefault();AJS.$(".statusRow[data-status='red']").hide();AJS.$(".hide-failed-conditions").hide();AJS.$(".show-failed-conditions").show();if(b){b()}})}else{e(c,r)}}})};l.searchForm.submit(i);l.searchButton.click(i);function d(m,n){m.parent().append(AJS.$("<div>").addClass("error").text(n))}function f(m,n){return{eventId:function(){var o=m.find("#notificationhelper-event option:selected");if(eventId.length>0){return o.val()}else{return JIRA.NotificationHelper.defaultEventId()}},paramsForRequest:function(){return n.asRequestParams(this._paramsFromContents())},params:function(){return n.params(this._paramsFromContents())},_paramsFromContents:function(){var r={};var p=m.find("#notificationhelper-user option:selected");if(p.length==1){r.username=p.val()}var o=m.find("#notificationhelper-issue option:selected");if(o.length>0){r.issueKey=o.val()}var q=m.find("#notificationhelper-event option:selected");if(q.length>0){r.eventId=q.val()}return r}}}function h(p){if(p.length==0){return p}function n(s){var r=[];AJS.$.each(s,function(t,u){r.push(o(u))});return r}function o(s){if(s.parameters.length==0){return AJS.escapeHTML(s.message)}else{var r=m(s.parameters);r.splice(0,0,AJS.escapeHTML(s.message));return AJS.format.apply(this,r)}}function m(s){var r=[];AJS.$.each(s,function(t,u){if(u.type=="plain"){r.push(AJS.escapeHTML(u.value))}else{if(u.type=="link"){r.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(u.href),AJS.escapeHTML(u.text)))}else{if(u.type=="newline"){r.push("<br/>")}else{if(u.type=="tagstart"){r.push("<"+u.tagName+">")}else{if(u.type=="tagend"){r.push("</"+u.tagName+">")}else{throw"Unrecognized parameter type: "+u.type}}}}}});return r}var q=[];AJS.$.each(p,function(t,r){var s={};s.status=r.status;s.summary=n(r.summary);s.details=n(r.details);q.push(s)});return q}function j(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="green"){m=true;return false}});return m}function a(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="red"){m=true}});return !m}function e(p,o){var m=false;var r=[];if(o.data){var q=JSON.parse(o.data);if(q.errorMessages&&q.errorMessages.length){r.push(q.errorMessages);m=true}if(q.errors){if(q.errors.issue){d(AJS.$("#notificationhelper-issue",p),q.errors.issue);m=true}if(q.errors.user){d(AJS.$("#notificationhelper-user",p),q.errors.user);m=true}if(q.errors.event){d(AJS.$("#notificationhelper-event",p),q.errors.event);m=true}}}if(!m){r.push(JIRA.SmartAjax.buildSimpleErrorContent(o))}var n=l.searchForm.find("#error-message-placeholder");AJS.$.each(r,function(s,t){AJS.messages.error(n,{body:t,closeable:false})})}function g(){new JIRA.AdminHelper.IssuePicker({element:AJS.$("#notificationhelper-issue"),itemAttrDisplayed:"label",width:500});new AJS.SingleSelect({element:AJS.$("#notificationhelper-event"),itemAttrDisplayed:"label",width:500})}return l}}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper-dialog.js' */
if(AJS.Meta.get("is-admin")){JIRA.NotificationHelper.NotificationHelperDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"permission-helper-dialog",widthClass:"large",stacked:true})},_setContent:function(b,e){var a=this;if(b){this._super(b,e)}else{var d=this.context().issueKey()||"";this._super(AJS.$(JIRA.Templates.Dialogs.NotificationHelper.searchPage({currentIssueKey:d,events:JIRA.NotificationHelper.NOTIFICATION_EVENTS,defaultEventId:JIRA.NotificationHelper.defaultEventId()})),true)}this.get$popupContent().find(".cancel").click(function(f){a.hide();f.preventDefault()});if(JIRA.Dialog.current===this){var c=new JIRA.setFocus.FocusConfiguration();c.context=this.get$popup()[0];c.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(c);JIRA.setFocus.triggerFocus()}},decorateContent:function(){var a=this;this.addHeading("Notification Helper");JIRA.NotificationHelper.NotificationHelperUi.initUi(this.get$popupContent(),this.context(),function(){a._positionInCenter()})},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.NotificationHelper.Context=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},eventId:function(a){if(a){this.options.permissionId=a}else{return this.options.eventId}},params:function(a){var b=AJS.$.extend({},this.options);if(this._exists(a)){AJS.$.extend(b,a)}return b},asRequestParams:function(a){var c=this.params(a);var b="atl_token="+atl_token();if(this._exists(c.username)){b+="&username="+c.username}if(this._exists(c.issueKey)){b+="&issueKey="+c.issueKey}if(this._exists(c.projectKey)){b+="&projectKey="+c.projectKey}if(this._exists(c.projectId)){b+="&projectId="+c.projectId}if(this._exists(c.issueOperation!==undefined)){b+="&issueOperation="+c.issueOperation}if(this._exists(c.issueTypeId)){b+="&issueTypeId="+c.issueTypeId}return b},_exists:function(a){return typeof(a)!="undefined"}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper.js' */
if(AJS.Meta.get("is-admin")){(function(d){var c="Notification Helper";JIRA.NotificationHelper.dialog=new JIRA.NotificationHelper.NotificationHelperDialog;d(document).delegate(".notificationhelper-trigger","click",function(e){e.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.dialog.open"});JIRA.NotificationHelper.dialog.show(a())});d(function(){var e=d("#notification-helper-admin-page");if(e.length==1){b();AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.adminpage.open"});e.append(d(JIRA.Templates.Dialogs.NotificationHelper.searchPage({noCloseLink:true,events:JIRA.NotificationHelper.NOTIFICATION_EVENTS,defaultEventId:JIRA.NotificationHelper.defaultEventId()})));e.trigger(JIRA.Events.NEW_CONTENT_ADDED,[e]);JIRA.NotificationHelper.NotificationHelperUi.initUi(e,new JIRA.NotificationHelper.Context());d("#notificationhelper-user-field").focus()}});function a(){var e=JIRA.Issue.getIssueKey();if(!e&&JIRA.IssueNavigator){e=JIRA.IssueNavigator.getSelectedIssueKey()}return new JIRA.NotificationHelper.Context({issueKey:e,issueOperation:JIRA.NotificationHelper.dialog.OPERATION_VIEW})}function b(){var e=d("#notification-helper-admin-page");e.prepend(d("<h2>").attr("id","admin-page-heading").text(c))}})(AJS.$)};;
;/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics', location = 'browser-metrics-legacy.js' */
(function(){var a=window.BrowserMetrics||{};var b=window.WRM||{};a.isFunction=function(c){return !!(c&&c.constructor&&c.call&&c.apply)};a.isEnabled=function(){if(a.enabled===undefined){var c="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy";a.enabled=a.isFunction(b.data)?b.data(c):b.data.claim(c)}return a.enabled};window.BrowserMetrics=a}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var f=5;var e=12000;var c=function(g){return Math.round(g)};var a=function(g){return Math.round(g*100)/100};var d=function(k){var h=(function(){var n=/^(\w+):\/\/([^\/]*)(.*)$/;return function(p){var o=p.match(n);if(!o){return{path:p}}return{scheme:o[1],host:o[2],path:o[3]}}}());var i=(function(){var n=["secureConnectionStart","requestStart","responseStart","responseEnd","domContentLoadedEventStart","domContentLoadedEventEnd","loadEventEnd"];return function(o){if(k.performance&&k.performance.getEntries){Array.prototype.forEach.call(k.performance.getEntries(),function(u){if(u.name.match("experimental/main.js")){o("experimentalMainJsDuration",u.duration)}})}if(k.performance){var s=k.performance.timing;var p=s.navigationStart;if(p){for(var r=0;r<n.length;++r){var q=n[r];var t=s[q];if(t){o(q,t-p)}}}}}}());var g=(function(){var o=[{key:"LOGIN",pattern:/^\/login.*/i},{key:"J-DASH",pattern:/^\/secure\/dashboard\.jspa.*/i},{key:"J-ISSUE",pattern:/^\/browse\/\w+\-\w+.*/i},{key:"J-NAV",pattern:/^\/issues.*/i},{key:"J-RAPID",pattern:/secure\/rapidboard\.jspa/i},{key:"SD-AGENT",pattern:/^(\/\w+)?\/servicedesk\/agent\/.*/i},{key:"SD-CUSTOMER",pattern:/^(\/\w+)?\/servicedesk\/customer\/.*/i},{key:"C-DASH",pattern:/^\/wiki(\/)?(\?.*|#.*)?$/i},{key:"C-DASH",pattern:/^\/wiki\/dashboard\.action.*$/i},{key:"C-SPACE",pattern:/^\/wiki\/display\/\w+(\?.*|#.*)?$/i},{key:"C-PAGE",pattern:/^\/wiki\/display\/\w+\/.*/i},{key:"C-PAGE",pattern:/^\/wiki\/pages\/viewpage\.action.*/i},{key:"C-BLOG",pattern:/^\/wiki\/display\/~\w+\/\d+\/\d+\/\d+\/.*/i},{key:"C-EDITOR",pattern:/^\/wiki\/pages\/editpage\.action.*/i},{key:"C-CREATE",pattern:/^\/wiki\/pages\/createpage\.action.*/i}];return function n(){var r=h(k.location.href).path;for(var p=0;p<o.length;++p){var q=o[p];if(r.match(q.pattern)){return q.key}}return null}}());function j(){var n=g();if(n){i(function(p,r){var o="browser.metrics."+p,q={version:f,page:n,value:r>e?"x":Math.ceil((r)/100),rawValue:c(r)};AJS.Analytics?AJS.Analytics.triggerPrivacyPolicySafeEvent(o,q):AJS.trigger("analyticsEvent",{name:o,data:q})})}}function m(){try{j()}catch(n){if(window.console){window.console.log("Error reporting browser metrics: "+n)}}}function l(){if(k.performance.timing.loadEventEnd){m()}else{setTimeout(l,1000)}}if(k.performance&&k.performance.timing){l()}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initPageLoad=d}}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var e=5;var d=12000;var a=function(f){return Math.round(f*100)/100};var c=function(g){var l={};function h(){return g.performance&&g.performance.now?g.performance.now():new Date().getTime()}function n(o){return o===Object(o)}function k(o){if(n(o)){return o.eventName+"."+o.eventType}else{return o}}function m(o){if(n(o)){return o.eventName}else{return o}}function j(o){if(n(o)){return o.eventType}else{return""}}function f(o){var p=k(o);l[p]=h()}function i(r,u){var v=k(r);if(!l[v]){throw ("Error logging browser metrics event end: no start event for key '"+v+"'")}var t=h()-l[v];l[v]=null;var o=m(r),q=j(r);var p="browser.metrics.e."+o+(u?"."+u:""),s={version:e,value:t>d?"x":Math.ceil((t)/100),rawValue:a(t),eventType:q};g.AJS.Analytics?g.AJS.Analytics.triggerPrivacyPolicySafeEvent(p,s):g.AJS.trigger("analyticsEvent",{name:p,data:s})}return{start:f,end:i}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initEvents=c}}());(function(){var a=window.BrowserMetrics||{};if(a.isEnabled()){if(Math.random()<0.1){window.ATL_PERF&&window.ATL_PERF.initPageLoad&&window.ATL_PERF.initPageLoad(window)}window.ATL_PERF&&window.ATL_PERF.initEvents&&(function(){window.BrowserMetrics=window.ATL_PERF.initEvents(window)}())}}());;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jira-amd.js' */
define("dndattachment/JIRA",function(){return JIRA});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/aui-amd.js' */
define("dndattachment/aui",function(){return AJS});define("dndattachment/aui/dialog",function(){return AJS.Dialog});define("dndattachment/aui/inline-dialog",function(){return AJS.InlineDialog});define("dndattachment/aui/message",function(){return AJS.messages});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jquery-amd.js' */
define("dndattachment/jquery",["dndattachment/aui"],function(a){return a.$});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/i18n.js' */
define("dndattachment/i18n",function(){var a={"dnd.attachment.unsupported.browser":"Drag and Drop of attachments is currently only available for the following browsers:","dnd.attachment.file.is.too.large":"File exceeds maximum size limit set by the administrator ({0}).","dnd.attachment.upload.in.progress":"Upload in progress, please wait."};return function(b){if(a[b]){return a[b]}else{throw"Unknown key: "+b}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/Parser.js' */
define("dndattachment/Parser",["dndattachment/aui","dndattachment/jquery"],function(a,b){var c="-dui-type-parsed";var e="*[duiType]:not(."+c+")";function d(g){var f=b(g).find(e).add(g.filter(e));var h=f.addClass(c).map(function(j,k){var i=new b.Deferred();require([b(k).attr("duiType")],function(l){if(typeof l=="function"){i.resolve(new l(k))}else{i.reject()}});return i});return b.when.apply(window,b.makeArray(h))}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f,g){d(f)});if(b.isReady){d(b("body"))}else{b(function(){d(b("body"))})}return{parse:d}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/IssueDropZone.js' */
define("dndattachment/IssueDropZone",["dndattachment/jquery","dndattachment/Parser","dndattachment/aui","dndattachment/JIRA","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(f,h,b,a,e,d){var c=5000;var g=Class.extend({eventGroup:"issuedropzone",progressBarType:"dndattachment/UploadProgressBar",init:function(i){this.$node=f(i);if(!this.isSupportedBrowser()){return this.renderUnsupported()}this.uploadLimit=this.$node.data("upload-limit");this.uploadSize=this.$node.data("upload-size");this.formToken=this.$node.data("form-token");this.pendingQueue=[];this.render();this.connectListeners();this.queueEvent("init")},queueTask:function(i){this.pendingQueue.push(i);i.always(function(){this.pendingQueue.splice(this.pendingQueue.indexOf(i),1)}.bind(this));this.markDirty(true);f.when.apply(window,this.pendingQueue).then(_.debounce(this.checkMarkDirty,false,true).bind(this))},render:function(){this.$node.html(a.Templates.DnDAttachmentPlugin.IssueDropZone({}));this.fileInput=this.$node.find(".issue-drop-zone__file");this.fileLabel=this.fileInput.parent("label.issue-drop-zone__button");if(a.Events.LOCK_PANEL_REFRESHING){a.trigger(a.Events.LOCK_PANEL_REFRESHING,["drag-and-drop-attachment-panel"])}a.trace("jira.issue.dnd.issuedropzone.render")},connectListeners:function(){this.fileInput.change(function(j){this.uploadFiles(this.fileInput[0].files);this.queueEvent("fileInput",{count:this.fileInput[0].files.length});this.fileInput.attr("value",null)}.bind(this));if(f("html.mozilla")[0]&&(parseInt(f.browser.version,10)<22)){this.fileLabel.on("click",function(j){if(j.currentTarget===this.fileLabel[0]&&j.target.nodeName!=="INPUT"){this.fileInput.click()}}.bind(this))}var i=this.$node.find(">*");i.on("dragover drop",function(j){j.preventDefault();j.stopPropagation();this.$node.addClass("dragover");if(j.dataTransfer&&j.dataTransfer.files&&j.dataTransfer.files.length>0){this.uploadFiles(j.dataTransfer.files);this.queueEvent("fileDrop",{count:j.dataTransfer.files.length})}if(j.type=="drop"){this.$node.removeClass("dragover")}}.bind(this));i.on("dragleave",function(){this.$node.removeClass("dragover")}.bind(this))},createUploadProgressBar:function(){return h.parse(f('<div duiType="'+this.progressBarType+'" class="upload-progress-bar"></div>').data("upload-size",this.uploadSize).data("form-token",this.formToken).insertAfter(this.$node))},uploadFiles:function(j){var l=[];var i=_.map(j,function(n){var m=new f.Deferred();this.createUploadProgressBar().then(function(o){this.trigger("progressBarInserted",o);l.push(o);o.uploadFile(n,this.uploadLimit).then(m.resolve.bind(m),m.resolve.bind(m)).done(function(){this.trigger("uploadFinished",o)}.bind(this))}.bind(this));return m}.bind(this));var k=f.when.apply(window,i);k.done(function(){var m=_.filter(i.length==1?[arguments]:arguments,function(n){return n&&n[0]&&n[0].id}).map(function(n){return n[0].id});if(m.length==0){return}this.commitUpload(m).then(function(){_.delay(function(){l.some(function(n){if(n.getAutoDestroy()){n.destroy();this.queueEvent("autoDestroy")}}.bind(this))}.bind(this),c)}.bind(this))}.bind(this));this.queueTask(k);return k},loadFiles:function(i){i.forEach(function(j){this.createUploadProgressBar().then(function(k){k.setFileID(j.id);k.setFileName(j.name);k.setFileSize(j.size);k.setProgress(1);k.setFinished();var l=d.getAttachment(j.id);if(l&&l.file){k.loadThumbnail(l.file)}else{}this.trigger("uploadFinished",k)}.bind(this))},this)},commitUpload:function(j){var i=new f.Deferred();a.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/AttachFile.jspa",data:{inline:true,id:a.Issue.getIssueId(),filetoconvert:j,atl_token:atl_token()},success:i.resolve.bind(i),error:i.reject.bind(i)});i.then(function(){if(a.Events.REFRESH_ISSUE_PAGE){a.trigger(a.Events.REFRESH_ISSUE_PAGE,[a.Issue.getIssueId()])}a.trace("jira.issue.dnd.attached")});this.queueTask(i);this.queueEvent("commitUpload",{count:j.length});return i},isSupportedBrowser:function(){if(f("html.webkit")[0]||f("html.safari")[0]){if(!(parseFloat(f.browser.version)>=533)){return false}}else{if(f("html.mozilla")[0]){if(!(parseFloat(f.browser.version)>=1.9)){return false}}else{if(f("html.msie")[0]){if(!(parseFloat(f.browser.version)>=10)){return false}}else{return false}}}return true},renderUnsupported:function(){this.$node.addClass("issue-drop-zone__not-supported").text(e("dnd.attachment.unsupported.browser")).append("<ul><li>FireFox 3.6+</li><li>Chrome 5+</li><li>Safari 5</li></ul>")},markDirty:function(i){this.$node.addClass(a.DirtyForm.ClassNames.SANCTIONED);this.$node.toggleClass(a.DirtyForm.ClassNames.EXEMPT,!i);this.$node.attr("value",false);this.$node.attr("defaultValue",true)},checkMarkDirty:function(){if(this.pendingQueue.length==0){this.markDirty(false)}},queueEvent:function(i,j){b.trigger("analytics",{name:"issue.dnd.attachment."+this.eventGroup+"."+i,data:j||{}})}});return g});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FormDropZone.js' */
define("dndattachment/FormDropZone",["dndattachment/Parser","dndattachment/IssueDropZone","dndattachment/jquery","dndattachment/aui","dndattachment/i18n","dndattachment/JIRA"],function(g,f,e,b,d,a){var c=f.extend({eventGroup:"formdropzone",init:function(){this._super.apply(this,arguments);this.bind("uploadFinished",this.onUploadFinished.bind(this));this.$containerNode=this.getContainerNode();this.$formNode=this.$node.parents("form");this.formToken=this.$formNode.find('input[name="formToken"]').attr("value");this.$inputNode=e('<input name="dnd-dropzone" type="hidden" />').insertAfter(this.$node);this.$fieldNode=this.$node.parents(".field-group");this.$fieldNode.addClass("long-field");this.$dragoverMask=e('<div class="attach-files-drop-zone__dragover-mask" />');this.$dragoverMask.appendTo(this.$containerNode);this.connectDialogEvents();this.connectFormEvents()},onUploadFinished:function(i,j){var h=e('<input type="checkbox" name="filetoconvert"/>').addClass("upload-progress-bar__checkbox").attr("value",j.fileID).attr("id","filetoconvert-"+j.fileID).prop("checked",true).insertBefore(j.$node);j.bind("onDestroy",function(){h.prop("checked",false)});setTimeout(function(){j.$node.addClass("upload-progress-bar__upload-ready");j.setIcon("aui-iconfont-close-dialog")},1000);a.trace("jira.issue.dnd.uploadfinished")},commitUpload:function(h){this.queueEvent("commitUpload",{count:h.length});return new e.Deferred()},getContainerNode:function(){return this.$node.parents(".jira-dialog-content")},connectDialogEvents:function(){this.$containerNode.on("dragover drop",function(h){h.preventDefault();h.stopPropagation();this.$containerNode.addClass("attach-files-drop-zone__dragover");if(h.dataTransfer&&h.dataTransfer.files&&h.dataTransfer.files.length>0){this.queueEvent("fileDrop",{count:h.dataTransfer.files.length});this.uploadFiles(h.dataTransfer.files)}if(h.type=="drop"){this.$containerNode.removeClass("attach-files-drop-zone__dragover")}}.bind(this));this.$containerNode.on("dragleave",function(){this.$containerNode.removeClass("attach-files-drop-zone__dragover")}.bind(this))},connectFormEvents:function(){this.$formNode.on("before-submit",function(h){if(this.isDirty){h.preventDefault();var i={};i[this.$inputNode.attr("name")]=d("dnd.attachment.upload.in.progress");a.applyErrorsToForm(this.$formNode,i);this.$formNode.find(".error").toArray().some(function(j){j.scrollIntoView()})}}.bind(this))},markDirty:function(h){f.prototype.markDirty.apply(this,arguments);this.isDirty=h;a.trace(h?"jira.issue.dnd.isdirty":"jira.issue.dnd.isclear")}});return c});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/AttachFilesDropZone.js' */
define("dndattachment/AttachFilesDropZone",["dndattachment/FormDropZone","dndattachment/jquery"],function(a,b){var c=a.extend({eventGroup:"attachfiledropzone",init:function(){this._super.apply(this,arguments);this.bind("progressBarInserted",function(d,f){var e=new b.Deferred();this.queueTask(e);f.result.done(e.resolve.bind(e));f.bind("onDestroy",function(){e.resolve()})}.bind(this))},checkMarkDirty:function(){if(this.pendingQueue.length<=1){this.markDirty(false)}}});return c});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/CreateIssueDropZone.js' */
define("dndattachment/CreateIssueDropZone",["dndattachment/jquery","dndattachment/FormDropZone","dndattachment/UploadProgressBar"],function(d,c,b){var a=c.extend({eventGroup:"createissuedropzone",progressBarType:"dndattachment/ProjectUploadProgressBar",getContainerNode:function(){return d(this.$node.parents(".jira-dialog-content")[0]||this.$node.parents("form#issue-create").parents(".aui-page-panel-content")[0])}});return a});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/ProjectUploadProgressBar.js' */
define("dndattachment/ProjectUploadProgressBar",["dndattachment/UploadProgressBar"],function(a){return a.extend({progressBarType:"dndattachment/ProjectUploadProgressBar",getProjectId:function(){return this.$node.parents("form").find("*[name=pid]").val()},getUploadParams:function(b){var c=a.prototype.getUploadParams.apply(this,arguments);if(this.getProjectId()){c.projectId=this.getProjectId()}return c}})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/TemporaryAttachments.js' */
define("dndattachment/TemporaryAttachments",[],function(){var a={};return{getAttachment:function(b){return a[b]},putAttachment:function(d,b){var c={id:d,name:b.name,type:b.type,file:b};a[d]=c;return c}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/UploadProgressBar.js' */
define("dndattachment/UploadProgressBar",["dndattachment/jquery","dndattachment/Parser","dndattachment/FileIconUtil","dndattachment/JIRA","dndattachment/aui","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(e,c,f,b,i,d,h){var g=["aui-iconfont-error","aui-iconfont-success","aui-iconfont-close-dialog"];function a(k,l){i.trigger("analytics",{name:"issue.dnd.attachment.uploadprogress."+k,data:l||{}})}var j=Class.extend({autoDestroy:true,init:function(k){this.result=new e.Deferred();this.$node=e(k);this.uploadSize=this.$node.data("upload-size");this.formToken=this.$node.data("form-token");this.render()},render:function(){this.$node.html(b.Templates.DnDAttachmentPlugin.UploadProgressBar({}));this.$node.find(".upload-progress-bar__control button").on("click",function(){this.destroy();a("buttonClick")}.bind(this))},destroy:function(){this.setAutoDestroy(false);this.trigger("onDestroy");this.$node.animate({opacity:0},{duration:250,complete:function(){this.$node.slideUp(250,function(){if(this.objectURL){window.URL.revokeObjectURL(this.objectURL)}this.$node.remove()}.bind(this))}.bind(this)})},setAutoDestroy:function(k){this.autoDestroy=k},getAutoDestroy:function(){return this.autoDestroy},getUploadParams:function(k){var l={filename:k.name,size:k.size,atl_token:atl_token(),formToken:this.formToken};_.extend(l,this.getEntityParams());return l},getEntityParams:function(){var k={};var m=b.Issue.getIssueId();var l=this.$node.parents("form").find('*[name="pid"]').attr("value");if(l){k.projectId=l}else{if(m){k.issueId=m}}return k},setFileID:function(k){this.fileID=k},setFileName:function(k){this.$node.find(".upload-progress-bar__file-name").text(k)},setFileSize:function(k){if(k>=0){this.$node.find(".upload-progress-bar__file-size").html(i.InlineAttach.Text.fileSize(k))}},uploadFile:function(l,m){this.setFileName(l.name);this.setFileSize(i.InlineAttach.Text.fileSize(l.size));this.loadThumbnail(l);var k=this.result;k.fail(this.reportError.bind(this));if(l.size>m){k.reject(d("dnd.attachment.file.is.too.large").replace("{0}",this.uploadSize),true);return k}this.upload=new i.InlineAttach.AjaxUpload({file:l,params:this.getUploadParams(l),url:i.InlineAttach.AjaxPresenter.DEFAULT_URL,progress:function(n){k.notify(n/l.size)},success:function(o,n){if(o.id!==undefined&&o.name!==undefined){k.notify(1);k.resolve(o,n,l)}else{k.reject(o,n,l)}},error:function(o,n){k.reject("Internal error",n)}});this.monitorUpload(k);this.checkSession().then(function(){this.upload.upload()}.bind(this)).fail(function(){k.reject("Unauthorized",401)});this.$node.find(".upload-progress-bar__control button").on("click",function(){this.upload.abort();k.reject()}.bind(this));k.done(function(n){h.putAttachment(n.id,l);this.setFileID(n.id);b.trace("jira.issue.dnd.uploaded")}.bind(this));return k},monitorUpload:function(k){k.progress(this.setProgress.bind(this));k.done(this.setFinished.bind(this));k.fail(function(){this.$node.addClass("UploadProgressBar_uploadFailed")}.bind(this))},setProgress:function(k){var l=this.$node.find(".upload-progress-bar__progress-bar");l.toggleClass("UploadProgressBar_progressUnknown",k===false);if(k>=0){l.find(".upload-progress-bar__bar").css("width",100*k+"%")}},setFinished:function(){this.$node.addClass("upload-progress-bar__upload-finished");this.$node.find(".upload-progress-bar__control button .aui-icon").addClass("aui-iconfont-success").removeClass("aui-iconfont-close-dialog")},loadThumbnail:function(k){if(k.type.match(/image.*/)){this.objectURL=window.URL.createObjectURL(k)}var l=this.objectURL||f.getIconURL(f.matchExtension(k.name),k.type);var m=this.$node.find(".upload-progress-bar__thumbnail");e("<img/>").attr("src",l).appendTo(m);m.addClass(this.objectURL?"upload-progress-bar__thumbnail_image":"upload-progress-bar__thumbnail_icon")},reportError:function(k){if(typeof k=="object"&&k.errorMessage){k=k.errorMessage}this.setIcon("aui-iconfont-error");this.$node.addClass("upload-progress-bar__upload-error");this.$node.find(".upload-progress-bar__bar").css("width","100%");this.$node.find(".upload-progress-bar__error-message").text(k);this.setAutoDestroy(false);a("error",{message:k})},setIcon:function(l){var k=this.$node.find(".upload-progress-bar__control button .aui-icon");if(!g.some(function(m){k.toggleClass(m,m==l);return m==l})){throw"Unknown icon"}},checkSession:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/auth/1/session",contentType:"application/json"}).done(function(){k.resolve()}).fail(function(){this.checkPermissions().done(function(l){k.resolve()}).fail(function(){k.reject()})}.bind(this));return k},checkPermissions:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/api/2/mypermissions",contentType:"application/json",data:this.getEntityParams()}).done(function(l){if(l.permissions.CREATE_ATTACHMENT.havePermission){k.resolve()}else{k.reject()}}).fail(function(){k.reject()});return k}});return j});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FileIconUtil.js' */
define("dndattachment/FileIconUtil",function(){function a(h,g,e,f){this.extension=h;this.mimeType=g;this.iconFile=e;this.iconURL=contextPath+"/images/icons/attach/"+e;this.extensionName=f}var b=[new a(".pdf","application/pdf","pdf.gif","PDF File"),new a(".gif","image/gif","image.gif","GIF File"),new a(".png","image/png","image.gif","PNG File"),new a(".jpeg","image/jpeg","image.gif","JPEG File"),new a(".xml","text/xml","xml.gif","XML File"),new a(".html","text/html","html.gif","HTML File"),new a(".java","","java.gif","Java Source File"),new a(".jar","","java.gif","Java Archive File"),new a(".txt","text/plain","text.gif","Text File"),new a(".zip","application/zip","zip.gif","Zip Archive"),new a(".gz","application/x-gzip-compressed","zip.gif","GZip Archive")].concat([".doc",".docx","docm","dotx","dotm"].map(function(e){return new a(e,"application/msword","word.gif","Microsoft Word")})).concat([".xls","xlsx","xlsm","xltx","xltm","xlsb","xlam"].map(function(e){return new a(e,"application/vnd.ms-excel","excel.gif","Microsoft Excel")})).concat(["pptx","pptm","potx","potm","ppam","ppsx","ppsm"].map(function(e){return new a(e,"application/vnd.ms-powerpoint","powerpoint.gif","Microsoft PowerPoint")}));var c=/(\.([a-z]+))$/g;var d=new a("","","file.gif","Unknown format");return{getIcon:function(f,e){return b.filter(function(g){return g.extension==f||g.mimeType==e})[0]||d},getIconURL:function(g,f){var e=this.getIcon(g,f);return e&&e.iconURL},matchExtension:function(f){var e=f.match(c);return e&&e[0]}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/IssueDropZone.soy' */
// This file was automatically generated from IssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.IssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-drop-zone__target"></div><div class="issue-drop-zone__text"><span>', soy.$$escapeHtml("Drop files here to attach them"), '</span><span>', soy.$$escapeHtml("or"), '</span></div><label class="issue-drop-zone__button aui-button">', soy.$$escapeHtml("Select files"), '<input class="issue-drop-zone__file ignore-inline-attach upfile" type="file" multiple /></label>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/AttachFilesDropZone.soy' */
// This file was automatically generated from AttachFilesDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.AttachFilesDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/AttachFilesDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/CreateIssueDropZone.soy' */
// This file was automatically generated from CreateIssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.CreateIssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/CreateIssueDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>', (opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/UploadProgressBar.soy' */
// This file was automatically generated from UploadProgressBar.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.UploadProgressBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="upload-progress-bar__thumbnail"> </div><span class="upload-progress-bar__file-name"> </span><span class="upload-progress-bar__file-size"> </span><div class="upload-progress-bar__progress-bar"><span class="upload-progress-bar__bar"> </span></div><div class="upload-progress-bar__control"><button type="button" class="aui-button aui-button-subtle aui-button-compact"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Cancel upload</span></button></div><div class="upload-progress-bar__error-message"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript-init', location = 'js/initIssueDropZone.js' */
require(["dndattachment/Parser","dndattachment/jquery","dndattachment/IssueDropZone","dndattachment/aui","dndattachment/FileIconUtil"],function(a,b,g,i,d){if(!g.prototype.isSupportedBrowser()){return}var e="com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript.upload-limit";var f=_.isFunction(WRM.data)?WRM.data(e):WRM.data.claim(e);function j(l,p){var k=l.find(".field-group.file-input-list");if(k.size()==0){return}if(k.find('*[duiType*="'+p+'"]').length>0){return}var n=k.find("input[name=filetoconvert]:checked").map(function(q,r){return{id:r.value,name:b(r).siblings("label").text()}}).toArray();var m=k.find(".description:last-child").html();k.empty();var o=b(JIRA.Templates.DnDAttachmentPlugin[p]({uploadLimit:i.InlineAttach.Text.fileSize(f),jiraAttachmentSize:f,description:m}));a.parse(o.appendTo(k)).then(function(q){if(q!=null){q.loadFiles(n)}})}function h(k,l){k.onContentReady(function(m){j(k.$popupContent,l)})}var c=function(){if(JIRA.Dialogs.attachFile){h(JIRA.Dialogs.attachFile,"AttachFilesDropZone")}var k=["create-issue-dialog","create-subtask-dialog","edit-issue-dialog"];var l=_.map(l,function(n){return"#"+n}).join(",");b(i).on("Dialog.show",function(p,n,o){if(_.contains(k,n.attr("id"))){h(o,"CreateIssueDropZone")}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(p,n,o){if(n.parents(l).size()>0){j(n,"CreateIssueDropZone")}});var m=b("form#issue-create, form#issue-edit");if(m.size()>0){j(m,"CreateIssueDropZone")}};if(b.isReady){c()}else{i.$(c)}b.event.props.push("dataTransfer")});;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/js/DemoProjectTemplate.js' */
JPT.DemoProjectTemplate={};JPT.DemoProjectTemplate.init=function init(){AJS.$("body").on("com.atlassian.jira-core-project-templates:jira-sample-item",function(b,a){JPT.DemoProjectTemplate.createDemoProject(a)})};JPT.DemoProjectTemplate.createDemoProject=function createDemoProject(a){a.addPanel("DemoProjectTemplate",JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject(),"");$demoProjectForm=AJS.$("<form></form>");$demoProjectForm.attr("action",contextPath+"/secure/CreateDemoProject.jspa");$demoProjectAtlTokenField=AJS.$("<input type='hidden' name='atl_token' value='' />");$demoProjectAtlTokenField.val(atl_token());$demoProjectForm.append($demoProjectAtlTokenField);$demoProjectForm.appendTo(JPT.DialogController.$dialogElement);$demoProjectForm.submit()};AJS.$(JPT.DemoProjectTemplate.init);;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/CoreProjectTemplates.soy' */
// This file was automatically generated from CoreProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'demo-loading-container\'><span class=\'icon throbber loading\'/><span class=\'demo-loading-message\'>', soy.$$escapeHtml("Loading Demo Project"), '</span></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/IssueTrackingTemplates.soy' */
// This file was automatically generated from IssueTrackingTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderIssueTrackingExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation({description: "This project provides you with a quick and easy way to get JIRA up and running for simple issue tracking. Select this project to keep things simple. You can optionally configure these later."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderProjectManagementExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation({description: "This project provides you with a quick and easy way to get JIRA up and running for project management. You can optionally configure these later."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-tracking-info"><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li></ul></div><div class="right-info issue-tracking-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-software-plugin:jira-software-project-template-resources', location = '/projecttemplates/soy/SoftwareDevelopmentTemplate.soy' */
// This file was automatically generated from SoftwareDevelopmentTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.SoftwareTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.SoftwareTemplates = {}; }


JIRA.Templates.ProjectTemplates.SoftwareTemplates.renderSoftwareDevelopmentExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="software-development-info"><div class="left-info"><p>', soy.$$escapeHtml("Select this project to work on new features for your product and to also track any bugs. JIRA will provide you with a basic workflow with the following issue types. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">', soy.$$escapeHtml("Improvement"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li></ul></div><div class="right-info software-development-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.googlecode.jira-suite-utilities:common', location = 'com/googlecode/jsu/maps/LocationField.js' */
(function(i){var d=window,j="onJSUGMapsLoad",n=[],g=false,a=false;function k(){var p;while(p=n.shift()){p()}}function e(q){var p=d.google.maps&&d.google.maps.LatLng;if(p){n.push(q);k()}else{if(a){n.push(q)}else{a=true;n.push(q);google.load("maps","3",{other_params:"sensor=false",callback:k})}}}function f(q){if(d.google&&d.google.load){e(q)}else{if(g){n.push(q)}else{g=true;d[j]=function(){e(q)};var p=document.createElement("script");p.src="https://www.google.com/jsapi?callback="+j;p.type="text/javascript";i("body").append(p)}}}function b(p,q){f(function(){new google.maps.Geocoder().geocode({address:p},q)})}function c(p){if(p.hasClass("open")||p.hasClass("notFound")){l(p)}else{m(p)}}function l(p){p.removeClass("open");p.removeClass("notFound")}function o(p){return !isNaN(parseFloat(p))&&isFinite(p)}function h(p){return(!p||0===p.length)}function m(t){var q=t.find("a.location").text(),p="",r=t.find(".jsuMap");var s=q.split("=>");if(s.length==2){q=s[0].trim();p=s[1].trim()}b(q,function(w,u){if(u==google.maps.GeocoderStatus.OK){t.addClass("open");var A=new google.maps.Map(r.get(0),{zoom:8,center:w[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP});var z=q.split(",");if(z.length==2&&o(z[0])&&o(z[1])){var B=new google.maps.LatLng(z[0],z[1]);new google.maps.Marker({position:B,map:A,title:q})}else{new google.maps.Marker({map:A,position:w[0].geometry.location,title:q})}if(!h(p)){var v=new google.maps.DirectionsRenderer();var y=new google.maps.DirectionsService();v.setMap(A);var x={origin:q,destination:p,travelMode:google.maps.TravelMode.DRIVING};y.route(x,function(D,C){if(C==google.maps.DirectionsStatus.OK){v.setDirections(D)}})}}else{t.addClass("notFound")}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(s,p,r){if(r===JIRA.CONTENT_ADDED_REASON.panelRefreshed||r===JIRA.CONTENT_ADDED_REASON.pageLoad){var q=i(".jsuLocation.ready",p);q.removeClass("ready");q.each(function(t,u){u=i(u);u.find("> a").click(function(v){v.preventDefault();c(u)})})}});JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(){JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.locationselect=JIRA.Issues.InlineEdit.BlurTriggers.Default;JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.locationtextfield=JIRA.Issues.InlineEdit.BlurTriggers.Default;JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.directionsfield=JIRA.Issues.InlineEdit.BlurTriggers.Default})})(AJS.$);;
;/* module-key = 'com.atlassian.bonfire.plugin:bonfire-active-session-headsup', location = 'includes/empty.js' */
;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/common/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks"}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getApplicationLinkState:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinkstates/id/"+f;return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)},enableFeature:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/features/"+e;return AppLinks.put(c,{},f,d)},disableFeature:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/features/"+e;return AppLinks.del(c,f,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/component/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/component/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/feature/applinks-wizard/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];if(f.applinksVersion!=undefined){var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/common/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}}};AppLinks.Urls.Local={admin:function(b){var a=AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks";return AppLinks.Urls.generateUrl(a,b)}};AppLinks.Urls.Remote={admin:function(b,e,d){var c=e==="confluence"?"/admin/listapplicationlinks.action":"/plugins/servlet/applinks/listApplicationLinks";var a=b+c;return AppLinks.Urls.generateUrl(a,d)}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
var IssueLinkAppLinks=IssueLinkAppLinks||(function($){function createHelper(servers,context,settings){var helper={};var selectedServer=null;function selectServer(appId){selectedServer=getServer(servers,appId);var authenticationRequired=selectedServer&&selectedServer.requireCredentials;doAuthenticationRequired(authenticationRequired,context);return{authenticationRequired:authenticationRequired}}function setAuthenticationRequired(appId,authenticationRequired){var server=getServer(servers,appId);if(server){server.requireCredentials=authenticationRequired;if(selectedServer&&selectedServer.id===appId){doAuthenticationRequired(authenticationRequired,context)}}}function doAuthenticationRequired(required,context){$(".issue-link-applinks-authentication-message",context).empty();if(required){createAuthRequiredBanner($(".issue-link-applinks-authentication-message",context),context);$(".issue-link-oauth-toggle").hide();$(".buttons-container input[type=submit]",context).attr("disabled","disabled")}else{$(".issue-link-oauth-toggle").show();$(".buttons-container input[type=submit]",context).removeAttr("disabled")}}function createAuthRequiredBanner($container,context){var oauthCallbacks={onSuccess:function(){selectedServer.requireCredentials=false;doAuthenticationRequired(false,context);if(settings.onAuthenticationSuccessCallback){settings.onAuthenticationSuccessCallback(context,selectedServer.id,helper)}},onFailure:function(){if(settings.onAuthenticationFailedCallback){settings.onAuthenticationFailedCallback(context,selectedServer.id,helper)}}};var encodedServerName=AJS.escapeHtml(selectedServer.name);if(selectedServer.authUrl){var $banner=$('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');$banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",selectedServer.authUrl,selectedServer.url,encodedServerName));$("a",$banner).addClass("applink-authenticate");$(".applink-authenticate",$banner).click(function(e){authenticateRemoteCredentials(selectedServer.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});$container.append($banner)}else{var warningMessage=AJS.format("Unable to create a link to \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e as the application does not have any authentication configured.",selectedServer.url,encodedServerName);AJS.messages.warning($container,{body:warningMessage})}}function createOAuthCallback(){if(!AppLinks.OAuthCallback&&typeof (oauthCallback)==="undefined"){AppLinks.OAuthCallback=function(){};AppLinks.OAuthCallback.prototype.success=function(){this.aouthWindow.close();this.onSuccess();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.failure=function(){this.aouthWindow.close();this.onFailure();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.show=function(url,onSuccess,onFailure){this.onSuccess=onSuccess;this.onFailure=onFailure;this.aouthWindow=window.open(url,"com_atlassian_applinks_authentication")};oauthCallback=new AppLinks.OAuthCallback()}}function authenticateRemoteCredentials(url,onSuccess,onFailure){createOAuthCallback();$(".applinks-error").remove();oauthCallback.show(url,onSuccess,onFailure)}return $.extend(helper,{selectServer:selectServer,setAuthenticationRequired:setAuthenticationRequired})}function getServer(servers,appId){var i;if(servers.length){for(i=0;i<servers.length;i++){if(servers[i].id===appId){return servers[i]}}}return null}function initApplinkServers(settings,context,deferred){var currentAppId=settings.getCurrentAppId(context);var applicationType=$(".issue-link-applinks-application-type",context).val();var issueId=settings.getIssueId(context);$.get(AJS.contextPath()+"/rest/issueLinkAppLink/1/appLink/info",{type:applicationType,issueIdOrKey:issueId},function(servers){var helper=createHelper(servers,context,settings);var currentRequiresCredentials;if(servers&&servers.length){var currentServer=getServer(servers,currentAppId);if(currentServer){currentRequiresCredentials=$(".issue-link-applinks-authentication-message",context).hasClass("required");if(currentRequiresCredentials){currentServer.requireCredentials=true}helper.selectServer(currentAppId)}deferred.resolve(context,helper)}else{deferred.reject(context)}})}function init(settings,context){var deferred=$.Deferred();var isIssueLinkAppLinkContent=$(".issue-link-applinks-authentication-message",context).length!==0;if(isIssueLinkAppLinkContent&&settings.shouldExecute(context)){initApplinkServers(settings,context,deferred)}return deferred.promise()}return{init:init}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#jira-app-link",context).val()},shouldExecute:function(context){return $("#jira-app-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};var updateIssuePicker=function($select,appId){if($select.length){$select.attr("data-ajax-options.data.app-id",appId);if(appId&&appId!==""){$select.attr("data-ajax-options.url",contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/picker")}else{$select.attr("data-ajax-options.url",contextPath+"/rest/api/2/issue/picker")}$select.trigger("updateOptions");$select.trigger("clearSelection")}};var updateCreateReciprocalCheckbox=function(appId,context){var $reciprocalCheckbox=$("#create-reciprocal",context);if($reciprocalCheckbox.length){if(appId&&appId!==""){var defaultChoice=($("#create-reciprocal-default",context).val()=="true");if(defaultChoice){$reciprocalCheckbox.attr("checked","checked")}else{$reciprocalCheckbox.removeAttr("checked")}$reciprocalCheckbox.removeAttr("disabled");$("#create-reciprocal-fieldset",context).removeClass("disabled")}else{$reciprocalCheckbox.attr("checked","checked");$reciprocalCheckbox.attr("disabled","disabled");$("#create-reciprocal-fieldset",context).addClass("disabled")}}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){var $select=$("#jira-issue-keys",context);if($select.length){var appId=$("#jira-app-link",context).val();updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)}IssueLinkAppLinks.init(settings,context).done(function(context,helper){$("#jira-app-link",context).change(function(){var appId=$(this).val();helper.selectServer(appId);updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)})})})})(AJS.$);;
;/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
define("jira/jql/jql-grammar",function(){var grammar={};grammar.jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];grammar.jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];grammar.jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];grammar.jql_logical_operators_and_order_by=grammar.jql_logical_operators.concat(grammar.jql_order_by);grammar.jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];grammar.empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];grammar.jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];grammar.jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];grammar.jql_changed_predicates=grammar.jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);grammar.jql_was_predicates_and_order_by=grammar.jql_was_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_was_predicates_and_logical_operators=grammar.jql_was_predicates.concat(grammar.jql_logical_operators);grammar.jql_changed_predicates_and_order_by=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_changed_predicates_and_logical_operators=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators);grammar.REGEXP_ANDS=/^AND\s/i;grammar.REGEXP_ORS=/^OR\s/i;grammar.REGEXP_NOTS=/^NOT\s/i;grammar.REGEXP_SNOT=/^\s+not/i;grammar.REGEXP_SIN=/^\s+in/i;grammar.REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;grammar.REGEXP_COMMA_DELIMITER=/^\s*,/;grammar.REGEXP_ASCENDING=/^\s+asc/i;grammar.REGEXP_DESCENDING=/^\s+desc/i;grammar.REGEXP_ORDER_BY=/^order\s+by/i;grammar.REGEXP_WHITESPACE=/^\s/;grammar.REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;grammar.REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;grammar.REGEXP_NEW_LINE=/[\r\n]/;grammar.REGEXP_NUMBER=/\d/;grammar.REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;grammar.REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;grammar.REGEXP_SPACE_OR_ELSE=/[\s(]/;grammar.REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;grammar.REGEXP_NOTSTART=/^NO?$/i;grammar.REGEXP_INSTART=/^IN?$/i;grammar.REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;return grammar});define("jira/autocomplete/jql-autocomplete",["jira/autocomplete/autocomplete","jira/jql/jql-grammar","jira/jql/util","jira/jql/operator-util","jira/util/data/meta","jira/util/objects","jquery"],function(AutoComplete,grammar,Util,OperatorUtil,Meta,Objects,jQuery){var JQLAutoComplete=function(options){var that=Objects.begetObject(AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/2/jql/autocompletedata/suggestions";that.textToSuggestionCursorPosition=function(){return that.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayNameSug}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=jQuery('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",Meta.get("advanced-search-help-title")).attr("href",Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=jQuery('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(that.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:Util.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=OperatorUtil.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(Util.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:Util.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,grammar.empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);var value;var functionSuggestions;var token=parser.parse(parseValue);result=token.getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,grammar.jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;token.calcLastOperandStartIndex();var parsedOperator=token.getParsedOperator();var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,grammar.jql_operators);if(operatorSuggestions&&operatorSuggestions.length>0){var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),grammar.jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,Util.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,grammar.jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,grammar.jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,grammar.jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),grammar.jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),grammar.jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!OperatorUtil.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),grammar.jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(that.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&OperatorUtil.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(that.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==that.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(that.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=that.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(grammar.REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(that.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=Util.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return Util.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!OperatorUtil.isListSupportingOperator(operator))||(!arrValue.isList&&OperatorUtil.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){supportedType=grammar.jql_changed_predicates[i].type;supportsList=grammar.jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){auto=grammar.jql_changed_predicates[i].auto;break}}return auto};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(grammar.REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};return JQLAutoComplete});define("jira/jql/util",["jira/jql/jql-grammar"],function(grammar){var JQLAutoCompleteUtil={};JQLAutoCompleteUtil.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal};JQLAutoCompleteUtil.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!grammar.REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};JQLAutoCompleteUtil.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};JQLAutoCompleteUtil.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};JQLAutoCompleteUtil.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(grammar.REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};return JQLAutoCompleteUtil});define("jira/jql/operator-util",function(){var that={};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return that.isWasOperator(operator)||that.isChangedOperator(operator)};return that});define("jira/jql/jql-parser",["jira/jql/jql-grammar","jira/jql/jql-parse-token","jira/jql/operator-util","jquery"],function(grammar,Token,OperatorUtil,jQuery){return function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(grammar.REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(grammar.REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!grammar.REGEXP_COMMA_DELIMITER.test(remainingString)){if(grammar.REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(grammar.REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(grammar.REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(grammar.REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(grammar.REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(grammar.REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){var remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{if(this.startsWithIgnoreCase("issue.property",remainingString)){return this.entityPropertyName("issue.property",token)}else{return this.fieldOrFunctionName(token)}}},entityPropertyName:function(propertyPrefix,token){token.consumeCharacters(propertyPrefix.length);this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();var propertyKeys=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyKeys[propertyKeys.length]=this.stringValue(token)}if(propertyKeys.length!==0&&propertyKeys[0].length!==0&&!this.startsWithIgnoreCase(".",propertyKeys[0])){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();var propertyPaths=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyPaths[propertyPaths.length]=this.stringValue(token)}return propertyPrefix+"["+propertyKeys.join(".")+"]"+propertyPaths.join(".")}}}token.setParseError();return""},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,grammar.jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(OperatorUtil.isWasOperator(operator)||OperatorUtil.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_NOTSTART.test(remainingString)||grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&grammar.REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;var matchArray;if(this.startsWithIgnoreCase("is",value)){matchArray=value.substring(2).match(grammar.REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){matchArray=value.substring(3).match(grammar.REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(grammar.REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||grammar.jql_operators[i].value.length>longestMatch){longestMatch=grammar.jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(grammar.REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||grammar.REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(grammar.REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!grammar.REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(grammar.REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(grammar.REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=grammar.jql_changed_predicates.length;for(var i=0;i<arLen;++i){if(predicate.toLowerCase()==grammar.jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}}});define("jira/jql/jql-parse-result",function(){return function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}}});define("jira/jql/jql-parse-token",["jira/jql/jql-parse-result"],function(ParseResult){return function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},calcLastOperandStartIndex:function(){var result=this.getResult();var operator=result.getLastOperator();if(operator.length>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operator.length+numSpaces+1)}},getParsedOperator:function(){var result=this.getResult();return(result.getLastOperator().length>0)?this.tokenString.substr(result.getLastOperatorStartIndex()):null},getResult:function(){return this.result}}}});AJS.namespace("jira.widget.autocomplete.JQL",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete.MyParser",null,require("jira/jql/jql-parser"));AJS.namespace("JIRA.JQLAutoComplete.ParseResult",null,require("jira/jql/jql-parse-result"));AJS.namespace("JIRA.JQLAutoComplete.Token",null,require("jira/jql/jql-parse-token"));;
;/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/initJQLAutoComplete.js' */
(function(){var JQLAutoComplete=require("jira/autocomplete/jql-autocomplete");var JQLParser=require("jira/jql/jql-parser");var Forms=require("jira/util/forms");var jQuery=require("jquery");jQuery(function(){jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JQLAutoComplete({fieldID:"jqltext",parser:JQLParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",Forms.submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode===13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-jqlautocomplete.js' */
var IssueLinkJQLAutoComplete=IssueLinkJQLAutoComplete||(function($){function initialize(options){var fieldID=options.fieldID;var errorID=options.errorID;var autoCompleteUrl=options.autoCompleteUrl;var autoCompleteData=options.autoCompleteData;var formSubmitFunction=options.formSubmitFunction;var $field=$("#"+fieldID);var hasFocus=$field.length>0&&$field[0]==document.activeElement;var jqlFieldNames=autoCompleteData.visibleFieldNames||[];var jqlFunctionNames=autoCompleteData.visibleFunctionNames||[];var jqlReservedWords=autoCompleteData.jqlReservedWords||[];var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:fieldID,parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:errorID,autoCompleteUrl:autoCompleteUrl});$field.unbind("keypress",submitOnEnter);if(formSubmitFunction){$field.keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){formSubmitFunction();return false}else{return true}}})}jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse($field.text());jqlAutoComplete.updateColumnLineCount();$field.click(function(){jqlAutoComplete.dropdownController.hideDropdown()});if(hasFocus){$field.select()}}return{initialize:initialize}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-search.js' */
AJS.$(function($){var remoteJiraSearchDialog=new JIRA.FormDialog({id:"remote-jira-search-dialog",trigger:"#link-jira-issue .remote-jira-search-trigger",widthClass:"large",content:function(render){render(JIRA.Templates.RemoteJiraIssueSearch.dialog());initSearchDialog(this.$popup)},submitHandler:function(e,callback){e.preventDefault();$("#simple-search-panel-button").removeAttr("disabled");$("#advanced-search-panel-button").removeAttr("disabled");if($(e.target).attr("id")=="remote-jira-simple-search-form"){$("#simple-search-panel-button").click()}else{$("#advanced-search-panel-button").click()}callback()}});function initSearchDialog($dialog){var appId=$("#jira-app-link").val();var autoCompletePromise=getJqlAutoCompleteData(appId);$("#simple-search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSimpleSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false});$("#advanced-search-panel-button",$dialog).click(function(){advancedSearchButtonClick($dialog);return false});$("#simple-search-toggle",$dialog).click(function(){$("#remote-jira-simple-search-form",$dialog).show();$("#remote-jira-advanced-search-form",$dialog).hide();return false});$("#linkjiraissue-add-selected",$dialog).click(function(){$("table tbody tr:visible  td.selection input:checked",$dialog).each(function(){var issueKey=$(this).parent().data("key");$("#jira-issue-keys").trigger("selectOption",[{value:issueKey}])});$("#link-issue-dialog .error").hide();remoteJiraSearchDialog.hide();$("#link-issue-dialog").show().trigger("multiSelectRevealed");$("#jira-issue-keys-textarea").focus().select()});$("#advanced-search-toggle",$dialog).click(function(){$("#remote-jira-advanced-search-form",$dialog).show();$("#remote-jira-simple-search-form",$dialog).hide();var $jqlSearchText=$("#jql-search-text");if(!$jqlSearchText.attr("jql-initialized")){setAutoCompleteLoadingIconVisible(true,$dialog);autoCompletePromise.done(function(smartAjaxResult){if(smartAjaxResult.successful){IssueLinkJQLAutoComplete.initialize({fieldID:"jql-search-text",errorID:"jql-search-error",autoCompleteUrl:getAutoCompleteUrl(appId),autoCompleteData:smartAjaxResult.data,formSubmitFunction:function(){advancedSearchButtonClick($dialog)}})}else{setJQLErrorVisible(false,$dialog);setAutoCompleteFailedIconVisible(true,$dialog)}setAutoCompleteLoadingIconVisible(false,$dialog);$jqlSearchText.attr("jql-initialized",1)})}$jqlSearchText.focus();return false});$("#simple-search-toggle",$dialog).trigger("click")}function getAutoCompleteUrl(appId){if(appId&&appId!==""){return contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocomplete?appId="+appId}return""}function advancedSearchButtonClick($dialog){$("#search-results-table",$dialog).empty();var searchText=$("#jql-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doAdvancedSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteLoadingIconVisible(visible,$context){$("#autocomplete-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteFailedIconVisible(visible,$context){$("#autocomplete-failed",$context).toggleClass("hidden",!visible)}function setJQLErrorVisible(visible,$context){$("#jql-search-error",$context).toggleClass("hidden",!visible)}function doSimpleSearch(searchText,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();var issueKeyJql='key = "'+searchText+'"';var projectJql='project = "'+searchText+'"';var plainTextJql='summary ~ "'+searchText+'" OR description ~ "'+searchText+'" OR comment ~ "'+searchText+'"';jqlSearch(issueKeyJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(projectJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(plainTextJql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{showResultsError(smartAjaxResult)}})}})}})}function doAdvancedSearch(jql,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();jqlSearch(jql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{if(smartAjaxResult.status===400){AJS.messages.warning("#search-results-table",{body:"Invalid JQL query.",closeable:false})}else{showResultsError(smartAjaxResult)}}})}function jqlSearch(jql,appId){var deferred=$.Deferred();var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/search?jql="+jql+"&appId="+appId+"&maxResults=10"}else{var currentIssueKey=$("#current-issue-key").val();jql="("+jql+") and key != "+currentIssueKey;url=contextPath+"/rest/api/2/search?jql="+jql+"&maxResults=10"}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}});return deferred.promise()}function getJqlAutoCompleteData(appId){var deferred=$.Deferred();var remote;var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata?appId="+appId;remote=true}else{url=contextPath+"/rest/api/2/jql/autocompletedata";remote=false}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){if(!smartAjaxResult.successful&&remote){JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata/legacy?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}})}else{deferred.resolve(smartAjaxResult)}}});return deferred.promise()}function showResults(smartAjaxResult,$context){var resultHtml=JIRA.Templates.RemoteJiraIssueSearch.resultsTable({result:smartAjaxResult.data});$("#search-results-table",$context).html(resultHtml);$("#linkjiraissue-select-all",$context).click(function(){var $masterStatus=$(this).prop("checked");$("tbody tr td.selection input",$context).prop("checked",$masterStatus)});$("tbody tr",$context).click(function(e){if($(e.target).is(":checkbox")){return }var checkbox=$(this).find("td.selection input");checkbox.prop("checked",!checkbox.prop("checked"))})}function showResultsError(smartAjaxResult){AJS.messages.error("#search-results-table",{body:JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult),closeable:false})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'templates/dialog/linkjiraissue-search.soy' */
// This file was automatically generated from linkjiraissue-search.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.RemoteJiraIssueSearch == 'undefined') { JIRA.Templates.RemoteJiraIssueSearch = {}; }


JIRA.Templates.RemoteJiraIssueSearch.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find JIRA issues"), '</h2><form class="aui search-form" id="remote-jira-simple-search-form" action="#" method="post"><div class="field-group"><label for="link-search-text">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" size="50"> <input type="submit" tabindex="0" class="button" id="simple-search-panel-button" value="', soy.$$escapeHtml("Search"), '"> <a id="advanced-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a JQL search"), '">', soy.$$escapeHtml("Advanced Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><form class="aui search-form" id="remote-jira-advanced-search-form" action="#" method="post"><div class="field-group"><label for="jql-search-text">', soy.$$escapeHtml("JQL Search"), '<span id="autocomplete-loading" class="hidden"><span class="icon loading throbber"/>', soy.$$escapeHtml("Loading auto-complete"), '</span><span id="autocomplete-failed" class="hidden">', soy.$$escapeHtml("(auto-complete unavailable)"), '</span></label><div id="jql-search-container"><span id="jql-search-error" class="icon jqlgood" /><div class="atlassian-autocomplete"><textarea id="jql-search-text" class="text full-width-field" tabindex="0" /></div><button class="aui-button aui-button-primary search-button" id="advanced-search-panel-button" type="submit"><span class="aui-icon aui-icon-small aui-iconfont-search" title="', soy.$$escapeHtml("Search"), '"></span></button></div> <a id="simple-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a plain text search"), '">', soy.$$escapeHtml("Simple Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button type="button" class="aui-button" id="linkjiraissue-add-selected">', soy.$$escapeHtml("Add"), '</button><button class="aui-button aui-button-link cancel" href="#" id="remote-jira-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.result.issues.length > 0) {
    output.append('<table id="remote-jira-searchresult" class="aui"><thead><tr><th class="selection" ><input id="linkjiraissue-select-all" type="checkbox"/></th><th class="type">', soy.$$escapeHtml("Type"), '</th><th class="key">', soy.$$escapeHtml("Key"), '</th><th class="summary">', soy.$$escapeHtml("Summary"), '</th><th class="status">', soy.$$escapeHtml("Status"), '</th></tr></thead><tbody>');
    var issueList44 = opt_data.result.issues;
    var issueListLen44 = issueList44.length;
    for (var issueIndex44 = 0; issueIndex44 < issueListLen44; issueIndex44++) {
      var issueData44 = issueList44[issueIndex44];
      output.append('<tr title="', soy.$$escapeHtml(issueData44.key), '"><td class="selection" data-key="', soy.$$escapeHtml(issueData44.key), '"><input type="checkbox"/></td><td class="type">');
      JIRA.Templates.RemoteJiraIssueSearch.issueType({issueType: issueData44.fields.issuetype}, output);
      output.append('</td><td class="key" title="', soy.$$escapeHtml(issueData44.key), '">', soy.$$escapeHtml(issueData44.key), '</td><td class="summary" title="', soy.$$escapeHtml(issueData44.fields.summary), '">', soy.$$escapeHtml(issueData44.fields.summary), '</td><td class="status">');
      JIRA.Templates.RemoteJiraIssueSearch.status({status: issueData44.fields.status}, output);
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.issueType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img src="', soy.$$escapeHtml(opt_data.issueType.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issueType.name), '" title="', soy.$$escapeHtml(opt_data.issueType.name), ' - ', soy.$$escapeHtml(opt_data.issueType.description), '"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: opt_data.status}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:issue-link-confluence-js', location = 'js/issuelink-confluence.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#issue-link-confluence-app-id",context).val()},shouldExecute:function(context){return $("#confluence-page-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){IssueLinkAppLinks.init(settings,context)})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'js/ConfluencePageSearch.js' */
AJS.$(function($){var confluenceSearchDialog=new JIRA.FormDialog({id:"confluence-page-search-dialog",trigger:"#confluence-page-link .confluence-search-trigger",widthClass:"large",height:"565px",content:function(render){var dialog=this;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/applink",complete:function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){var appLinks=smartAjaxResult.data.applicationLinks;render(JIRA.Templates.ConfluencePageSearch.result({appLinks:appLinks}));initAppLinks(dialog).done(function(context,helper){initSearchDialog(context,helper);$("#link-search-text",context).focus()})}else{AJS.messages.error("#search-results-table",{body:"The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.",closeable:false});render()}}})},submitHandler:function(e,callback){e.preventDefault();$("#search-panel-button").click().removeAttr("disabled");callback()}});function initSearchDialog($dialog,helper){$("#confluence-app-link",$dialog).change(function(){var authenticationRequired=helper.selectServer($(this).val()).authenticationRequired;if(!authenticationRequired){populateSpaces($dialog,$(this).val(),helper)}$("#search-results-table",$dialog).empty();setSearchControlsEnabled(true,$dialog)});$("#search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false})}var spaceAjaxId=0;function populateSpaces($context,appId,helper){$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.allSpacesOption());var myAjaxId=++spaceAjaxId;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/space?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){if(myAjaxId!==spaceAjaxId){return }if(smartAjaxResult.successful){var spaces=smartAjaxResult.data.spaces;$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.spaceOptions({spaces:spaces}))}else{if(smartAjaxResult.status===401){helper.setAuthenticationRequired(appId,true)}else{setSearchControlsEnabled(false,$context);var msg;if(smartAjaxResult.status===403){msg="Content on the Confluence site could not be accessed because the Confluence server\'s \'Remote API\' feature is disabled. The Confluence system administrator must enable this \'Remote API\' feature for JIRA to successfully access this content."}else{msg="Unable to gather information from the selected Confluence instance."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}}}})}function setSearchControlsEnabled(enabled,$context){if(enabled){$("#link-search-text",$context).removeAttr("disabled");$("#search-panel-space",$context).removeAttr("disabled");$("#search-panel-button",$context).removeAttr("disabled")}else{$("#link-search-text",$context).attr("disabled","disabled");$("#search-panel-space",$context).attr("disabled","disabled");$("#search-panel-button",$context).attr("disabled","disabled")}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function doSearch(searchText,$context){setLoadingIconVisible(true,$context);var appLinkId=$("#confluence-app-link",$context).val();var spaceKey=$("#search-panel-space option:selected",$context).val();JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/search?query="+searchText+"&appId="+appLinkId+"&spaceKey="+spaceKey+"&maxResults=10",complete:function(xhr,textStatus,smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){var results=smartAjaxResult.data.result;var resultHtml=JIRA.Templates.ConfluencePageSearch.resultsTable({results:results});$("#search-results-table",$context).html(resultHtml)}else{var msg;if(smartAjaxResult.hasData){msg="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}else{msg="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}$("#confluence-searchresult tbody tr",$context).click(function(){var linkUrl=$(this).children().first().data("url");$("#confluence-page-url").val(linkUrl);$("#link-issue-dialog .error").hide();confluenceSearchDialog.hide();$("#link-issue-dialog").show();$("#confluence-page-url").focus().select()})}})}function initAppLinks(dialog){var settings={getCurrentAppId:function(context){return $("#confluence-app-link",context).val()},shouldExecute:function(context){return $("#confluence-app-link",context).length!==0},onAuthenticationSuccessCallback:function(context,currentAppId,helper){populateSpaces(context,currentAppId,helper)},getIssueId:function(context){return $("#confluence-page-link input[name=id]").val()}};return IssueLinkAppLinks.init(settings,dialog.$popup).done(function(context,helper){populateSpaces(context,settings.getCurrentAppId(context),helper)})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'templates/dialog/searchresult.soy' */
// This file was automatically generated from searchresult.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ConfluencePageSearch == 'undefined') { JIRA.Templates.ConfluencePageSearch = {}; }


JIRA.Templates.ConfluencePageSearch.result = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find a Confluence page"), '</h2><form class="aui search-form" id="confluence-page-search-form" action="#" method="post"><div class="field-group"><label for="confluence-app-link">', soy.$$escapeHtml("Server"), ':</label>');
  if (opt_data.appLinks.length == 1) {
    output.append('<span class="field-value">', soy.$$escapeHtml(opt_data.appLinks[0].name), '</span><input id="confluence-app-link" class="hidden" type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.appLinks[0].id), '"/>');
  } else {
    output.append('<select id="confluence-app-link" class="select medium-field" name="appId">');
    var appLinkList17 = opt_data.appLinks;
    var appLinkListLen17 = appLinkList17.length;
    for (var appLinkIndex17 = 0; appLinkIndex17 < appLinkListLen17; appLinkIndex17++) {
      var appLinkData17 = appLinkList17[appLinkIndex17];
      output.append('<option value="', soy.$$escapeHtml(appLinkData17.id), '">', soy.$$escapeHtml(appLinkData17.name), '</option>');
    }
    output.append('</select>');
  }
  output.append('</div><div class="issue-link-applinks-authentication-message applinks-message-bar"></div><div class="hidden"><input class="issue-link-applinks-application-type" type="hidden" value="com.atlassian.applinks.api.application.confluence.ConfluenceApplicationType"/></div><div class="issue-link-oauth-toggle field-group"><label for="link-search-text" id="linkSearch-label">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" name="linkSearch" size="50" /> <select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All Spaces"), '</option></select> <input type="submit" tabindex="0" class="aui-button" id="search-panel-button" value="', soy.$$escapeHtml("Search"), '"/><span id="link-search-loading" class="icon loading throbber hidden"/></div><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-link cancel" id="confluence-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.results.length > 0) {
    output.append('<table id="confluence-searchresult" class="aui"><thead><tr><th width="180px">', soy.$$escapeHtml("Title"), '</th><th width="550px">', soy.$$escapeHtml("Excerpt"), '</th></tr></thead><tbody>');
    var resultList44 = opt_data.results;
    var resultListLen44 = resultList44.length;
    for (var resultIndex44 = 0; resultIndex44 < resultListLen44; resultIndex44++) {
      var resultData44 = resultList44[resultIndex44];
      output.append('<tr title="', soy.$$escapeHtml(resultData44.title), '"><td class="title" data-url="', soy.$$escapeHtml(resultData44.url), '">', soy.$$escapeHtml(resultData44.title), '</td><td class="excerpt">', soy.$$escapeHtml(resultData44.excerpt), '</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option>');
  var spaceList64 = opt_data.spaces;
  var spaceListLen64 = spaceList64.length;
  for (var spaceIndex64 = 0; spaceIndex64 < spaceListLen64; spaceIndex64++) {
    var spaceData64 = spaceList64[spaceIndex64];
    output.append('<option value="', soy.$$escapeHtml(spaceData64.key), '">', soy.$$escapeHtml(spaceData64.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.allSpacesOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="" disabled="disabled">', soy.$$escapeHtml("Loading..."), '</option>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-invite-user-plugin:inviteuser-signup-resources', location = 'js/inviteuser-signup.js' */
(function(a){JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(c,b){a("#consolation-login-link").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"invitationsignupconsolationlogin",properties:{}})})})})(AJS.$);;
;/* module-key = 'com.atlassian.support.stp:stp-license-status-resources', location = 'js/stp-licenseStatus.js' */
;
;/* module-key = 'jira.webresources:jira-analytics', location = '/includes/jira/analytics/analytics.js' */
AJS.toInit(function($){function getBrowseProjectTab(){return $("li.active a.browse-tab").attr("id")}_.defer(function(){if(AJS.EventQueue){$(document).delegate("#project-admin-link","click",function(){var selectedTab=getBrowseProjectTab();AJS.EventQueue.push({name:"browseproject.administerproject",properties:{selectedtab:selectedTab}})});$(document).delegate("#browse-projects-create-project","click",function(){AJS.EventQueue.push({name:"browseprojects.createproject",properties:{}})});$(document).delegate("#no-issues-create-issue","click",function(){AJS.EventQueue.push({name:"browseproject.issuesblankslate.createissue",properties:{}})});$(document).delegate("a.issue-filter-link","click",function(){var $el=$(this);var id=$el.attr("id").replace("filter_","");var type=$el.attr("data-type");AJS.EventQueue.push({name:"browse"+type+".issuefilter."+id,properties:{}})});$(document).on("click","#project_import_link_lnk",function(){AJS.EventQueue.push({name:"topnav.jim",properties:{}})});$(document).on("click",".issueaction-viewworkflow",function(){var isNew=AJS.$(this).attr("class").indexOf("new-workflow-designer")>-1;var version=isNew?"new":"old";var newEnabled=AJS.DarkFeatures.isEnabled("casper.VIEW_ISSUE");AJS.EventQueue.push({name:"issue.viewworkflow",properties:{version:version,newEnabled:newEnabled}})});$.fn.ready(function captureWindowSize(){var width,height,shouldCapture=false;shouldCapture=shouldCapture||$(document.body).hasClass("page-type-navigator");if(!shouldCapture){return }width=$(window).width();height=$(window).height();AJS.EventQueue.push({name:"browserWindowSize",properties:{width:width,height:height}})})}})});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/jquery/plugins/avataror/avataror.js' */
jQuery.fn.avataror=function(options){var $=jQuery,$document=$(document);this.each(function(){var $this=$(this);var imgsrc=$this.find("img").attr("src");$this.css({"-moz-border-radius":"10px","-webkit-border-radius":"10px"});$this.html("<p>Loading?</p>");var avataror={previewSize:48};avataror.preview=$("<div/>").addClass("avataror-preview").css({border:"solid 1px #000","float":"left",height:avataror.previewSize+"px",overflow:"hidden",width:avataror.previewSize+"px",position:"relative",top:"-9999em",left:"-9999em"});avataror.preview.prependTo(options.previewElement);avataror.img=$('<img src="'+imgsrc+'" alt="Avatar Source"/>');avataror.img.load(function(){avataror.image=$("<div/>").css({background:"url('"+imgsrc+"') no-repeat",clear:"left",position:"relative"});avataror.marker=$("<div/>").css({cursor:"move",position:"relative"});avataror.dash=$("<div/>");avataror.shadow=$("<div/>");avataror.dash.add(avataror.shadow).css({cursor:"move",opacity:0.5,left:0,top:0,position:"absolute"});avataror.image.append(avataror.shadow).append(avataror.dash).append(avataror.marker);$this.append(avataror.image);avataror.marker.html("<div></div><div></div><div></div><div></div>");$("div",avataror.marker).each(function(i){var $this=$(this);$this.css({background:"#000",border:"solid 1px #fff",width:"10px",height:"10px",position:"absolute","font-size":"1px"});$this.css(["left","right","right","left"][i],"-6px");$this.css(["top","top","bottom","bottom"][i],"-6px");$this.css("cursor",["nw-resize","ne-resize","se-resize","sw-resize"][i]);$this.mousedown(function(e){e.preventDefault();e.stopPropagation();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height,i:i+1};avataror.shadow.hide()})});avataror.marker.add(avataror.image).mousedown(function(e){e.preventDefault();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height};avataror.shadow.hide()});$document.mouseup(function(e){avataror.handleMouseUp(e)});$document.mousemove(function(e){if(avataror.dragging){avataror.handleMouseMove(e.pageX,e.pageY);e.preventDefault()}});avataror.imgwidth=avataror.img.width();avataror.imgheight=avataror.img.height();avataror.x=parseInt($("#avatar-offsetX").val());avataror.y=parseInt($("#avatar-offsetY").val());avataror.width=parseInt($("#avatar-width").val());avataror.height=avataror.width;avataror.image.css({width:avataror.imgwidth+"px",height:avataror.imgheight+"px"});avataror.setMarker();$this.css({width:avataror.imgwidth+"px"});avataror.preview.css({position:"static"});$("p",$this).remove();$this.trigger("AvatarImageLoaded")});avataror.preview.append(avataror.img);avataror.setMarker=function(){avataror.marker.css("border","dashed 1px #fff");avataror.dash.css("border","solid 1px #000");avataror.shadow.css("border","solid 1px #000");avataror.marker.add(this.dash).css("left",this.x-1+"px");avataror.marker.add(avataror.dash).css("top",avataror.y-1+"px");avataror.shadow.css("border-left-width",avataror.x+"px");avataror.shadow.css("border-right-width",avataror.imgwidth-avataror.x-avataror.width+"px");avataror.shadow.css("border-top-width",avataror.y+"px");avataror.shadow.css("border-bottom-width",avataror.imgheight-avataror.y-avataror.height+"px");avataror.shadow.css("width",avataror.width+"px");avataror.shadow.css("height",avataror.height+"px");avataror.marker.add(avataror.dash).css("width",avataror.width+"px");avataror.marker.add(avataror.dash).css("height",avataror.height+"px")};avataror.adjustPreview=function(){avataror.img.attr("width",avataror.imgwidth*avataror.previewSize/avataror.width);avataror.img.attr("height",avataror.imgheight*avataror.previewSize/avataror.height);avataror.img.css("margin-left","-"+avataror.x*avataror.previewSize/avataror.width+"px");avataror.img.css("margin-top","-"+avataror.y*avataror.previewSize/avataror.height+"px");avataror.preview.select()};avataror.handleMouseMove=function(newX,newY){avataror.dragging.nextExec=avataror.dragging.nextExec||0;if(avataror.dragging.nextExec==0){avataror.dragging.nextExec=3}else{avataror.dragging.nextExec--;return }var dx=newX-avataror.dragging.x;var dy=newY-avataror.dragging.y;if(this.dragging.i){var handler=avataror.resizeHandlers[this.dragging.i-1];handler(dx,dy)}else{avataror.x=avataror.dragging.ax+dx;avataror.y=avataror.dragging.ay+dy;if(avataror.x+avataror.width>avataror.imgwidth){avataror.x=avataror.imgwidth-avataror.width}if(avataror.y+avataror.height>avataror.imgheight){avataror.y=avataror.imgheight-avataror.height}if(avataror.x<0){avataror.x=0}if(avataror.y<0){avataror.y=0}}avataror.setMarker();avataror.adjustPreview()};avataror.handleMouseUp=function(e){$("#avatar-offsetX").val(avataror.x);$("#avatar-offsetY").val(avataror.y);$("#avatar-width").val(avataror.width);avataror.dragging=null;avataror.shadow.show()};avataror.originX=function(){return avataror.dragging.ax};avataror.originY=function(){return avataror.dragging.ay};avataror.originBottomX=function(){return avataror.dragging.ax+avataror.dragging.w};avataror.originBottomY=function(){return avataror.dragging.ay+avataror.dragging.h};avataror.originNw=function(){return{x:avataror.originX(),y:avataror.originY()}};avataror.originNe=function(){return{x:avataror.originBottomX(),y:avataror.originY()}};avataror.originSe=function(){return{x:avataror.originBottomX(),y:avataror.originBottomY()}};avataror.originSw=function(){return{x:avataror.originX(),y:avataror.originBottomY()}};avataror.nwHandler=function(dx,dy){var anchor=avataror.originSe();var tmpBase={x:avataror.originX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.x=anchor.x-newSize;avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.neHandler=function(dx,dy){var anchor=avataror.originSw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.seHandler=function(dx,dy){var anchor=avataror.originNw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.width=avataror.height=newSize};avataror.swHandler=function(dx,dy){var anchor=avataror.originNe();var tmpBase={x:avataror.originX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.x=anchor.x-newSize;avataror.width=avataror.height=newSize};avataror.resizeHandlers=[avataror.nwHandler,avataror.neHandler,avataror.seHandler,avataror.swHandler]})};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/Avatar.js' */
JIRA.Avatar=Class.extend({init:function(options){this._id=options.id;this._isSystemAvatar=options.isSystemAvatar;this._isSelected=options.isSelected;this._urls=options.urls},setUnSelected:function(){this._isSelected=false},setSelected:function(){this._isSelected=true},isSelected:function(){return !!this._isSelected},isSystemAvatar:function(){return this._isSystemAvatar},getId:function(){return this._id},getUrl:function(size){return this._urls[size]},toJSON:function(){return{id:this._id,isSystemAvatar:this._isSystemAvatar,isSelected:this._isSelected,urls:this._urls}}});JIRA.Avatar.createCustomAvatar=function(descriptor){descriptor.isSystemAvatar=false;return new JIRA.Avatar(descriptor)};JIRA.Avatar.createSystemAvatar=function(descriptor){descriptor.isSystemAvatar=true;return new JIRA.Avatar(descriptor)};JIRA.Avatar.getSizeObjectFromName=function(name){if("object"===typeof name){return name}var nameTrimmed="string"===typeof name?jQuery.trim(name):"";if(JIRA.Avatar.LARGE.param===name){return JIRA.Avatar.LARGE}else{if(JIRA.Avatar.MEDIUM.param===name){return JIRA.Avatar.MEDIUM}else{if(JIRA.Avatar.SMALL.param===name){return JIRA.Avatar.SMALL}else{if("xsmall"===name){return JIRA.Avatar.SMALL}else{return JIRA.Avatar.LARGE}}}}};JIRA.Avatar.LARGE={param:"large",height:48,width:48};JIRA.Avatar.MEDIUM={param:"medium",width:32,height:32};JIRA.Avatar.SMALL={param:"small",width:16,height:16};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarManager.js' */
JIRA.AvatarManager=Class.extend({init:function(options){this.store=options.store;this.ownerId=options.ownerId;this.username=options.username;this.anonymousAvatarId=options.anonymousAvatarId;this.avatarSrcBaseUrl=options.avatarSrcBaseUrl},selectAvatar:function(avatar,options){return this.store.selectAvatar(avatar,options)},getById:function(id){return this.store.getById(id)},destroy:function(avatar,options){this.store.destroy(avatar,options)},update:function(avatar,options){this.store.update(avatar,options)},add:function(avatar,options){this.store._add(avatar,options)},getAllSystemAvatars:function(){return this.store.getAllSystemAvatars()},getAllCustomAvatars:function(){return this.store.getAllCustomAvatars()},getSelectedAvatar:function(){return this.store.getSelectedAvatar()},getAllAvatars:function(){return this.store.getAllAvatars()},getAllAvatarsRenderData:function(size){var i,instance=this,avatars=this.getAllAvatars(),renderData={system:[],custom:[]};for(i=0;i<avatars.system.length;i++){renderData.system.push(instance.getAvatarRenderData(avatars.system[i],size))}for(i=0;i<avatars.custom.length;i++){renderData.custom.push(instance.getAvatarRenderData(avatars.custom[i],size))}return renderData},getAvatarRenderData:function(avatar,size){var data=avatar.toJSON();data.src=this.getAvatarSrc(avatar,size);data.width=size.width;data.height=size.height;return data},refreshStore:function(options){this.store.refresh(options)},getAvatarSrc:function(avatar,size){if(this.store.isTempAvatar(avatar)){return contextPath+"/secure/temporaryavatar?"+jQuery.param({cropped:true,magic:new Date().getTime(),size:size.param})}return avatar.getUrl(AJS.format("{0}x{1}",size.height,size.width))},createTemporaryAvatar:function(field,options){this.store.createTemporaryAvatar(field,options)},createAvatarFromTemporary:function(instructions,options){this.store.createAvatarFromTemporary(instructions,options)},getAnonymousAvatarId:function(){return this.anonymousAvatarId}});JIRA.AvatarManager.createUniversalAvatarManager=function(options){var restQueryUrl,restUpdateUrl="",restCreateTempUrl="",restUpdateTempUrl="",restSingleAvatarUrl="";if(options.projectId){var urlAvatarOwnerPrefix=contextPath+"/rest/api/latest/universal_avatar/type/"+options.avatarType+"/owner/"+options.projectId;restQueryUrl=urlAvatarOwnerPrefix;var avatarCreateUrl=urlAvatarOwnerPrefix+"/avatar";restUpdateUrl=null;restCreateTempUrl=urlAvatarOwnerPrefix+"/temp";restUpdateTempUrl=avatarCreateUrl;restSingleAvatarUrl=avatarCreateUrl}else{restQueryUrl=contextPath+"/rest/api/latest/avatar/project/system";restCreateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporary";restUpdateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporaryCrop"}var store=new JIRA.AvatarStore({restQueryUrl:restQueryUrl,restUpdateUrl:restUpdateUrl,restCreateTempUrl:restCreateTempUrl,restUpdateTempUrl:restUpdateTempUrl,restSingleAvatarUrl:restSingleAvatarUrl,defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,ownerId:options.projectId,avatarSrcBaseUrl:contextPath+"/secure/projectavatar"})};JIRA.AvatarManager.createProjectAvatarManager=function(options){options.avatarType="project";return JIRA.AvatarManager.createUniversalAvatarManager(options)};JIRA.AvatarManager.createUserAvatarManager=function(options){var userRestUrl=contextPath+"/rest/api/latest/user";var store=new JIRA.AvatarStore({restQueryUrl:userRestUrl+"/avatars",restUpdateUrl:userRestUrl+"/avatar",restCreateTempUrl:userRestUrl+"/avatar/temporary",restUpdateTempUrl:userRestUrl+"/avatar",restSingleAvatarUrl:userRestUrl+"/avatar",restParams:{"username":options.username},defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,username:options.username,avatarSrcBaseUrl:contextPath+"/secure/useravatar"})};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarStore.js' */
JIRA.AvatarStore=Class.extend({TEMP_ID:"TEMP",init:function(options){if(!options.restQueryUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restQueryUrl], The rest url for querying avatars (see class description)")}if(!options.restCreateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restCreateTempUrl], The rest url for creating a temporary avatar (see class description)")}if(!options.restUpdateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restUpdateTempUrl], The rest url for updating a temporary avatar (see class description)")}if(!options.defaultAvatarId){throw new Error("JIRA.AvatarStore.init: You must specify [defaultAvatarId] to the contructor so the store "+"knows what to select if you delete the selected one")}this.restQueryUrl=options.restQueryUrl;this.restUpdateUrl=options.restUpdateUrl;this.restCreateTempUrl=options.restCreateTempUrl;this.restUpdateTempUrl=options.restUpdateTempUrl;this.restSingleAvatarUrl=options.restSingleAvatarUrl;this.restParams=options.restParams||{};this.restParams.atl_token=atl_token();this.defaultAvatarId=options.defaultAvatarId;this.avatars={system:[],custom:[]}},_buildCompleteUrl:function(url){var completeUrl=url;if(this.restParams){var queryParams="";for(var name in this.restParams){queryParams+=AJS.format("&{0}={1}",encodeURIComponent(name),encodeURIComponent(this.restParams[name]))}completeUrl+=("?"+queryParams.substr(1))}return completeUrl},getById:function(avatarId){var match;jQuery.each(this.avatars.system,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}});if(!match){jQuery.each(this.avatars.custom,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}})}return match},isTempAvatar:function(avatar){return(avatar.getId()===this.TEMP_ID)},_selectAvatar:function(avatar){var selected=this.getSelectedAvatar();if(selected){selected.setUnSelected()}avatar.setSelected()},selectAvatar:function(avatar,options){var instance=this;if(!avatar){throw new Error("JIRA.AvatarStore.selectAvatar: Cannot select Avatar that does not exist")}if(this.restUpdateUrl){JIRA.SmartAjax.makeRequest({type:"PUT",contentType:"application/json",dataType:"json",url:this._buildCompleteUrl(this.restUpdateUrl),data:JSON.stringify(avatar.toJSON()),success:function(){instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}},error:options.error})}else{instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}}},_destory:function(avatar){var index=jQuery.inArray(avatar,this.avatars.custom);if(index!==-1){this.avatars.custom.splice(index,1)}else{throw new Error("JIRA.AvatarStore._destroy: Cannot remove avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},destroy:function(avatar,options){var instance=this;options=options||{};if(!avatar){throw new Error("JIRA.AvatarStore.destroy: Cannot delete Avatar that does not exist")}JIRA.SmartAjax.makeRequest({type:"DELETE",url:this.getRestUrlForAvatar(avatar),success:function(){instance._destory(avatar);if(avatar.isSelected()){instance.selectAvatar(instance.getById(instance.defaultAvatarId),options)}else{if(options.success){options.success.apply(this,arguments)}}},error:options.error})},getSelectedAvatar:function(){for(var i=0;i<this.avatars.custom.length;i++){if(this.avatars.custom[i].isSelected()){return this.avatars.custom[i]}}for(i=0;i<this.avatars.system.length;i++){if(this.avatars.system[i].isSelected()){return this.avatars.system[i]}}},_update:function(avatar){var instance=this;if(this.getById(avatar.getId())){jQuery.each(this.avatars.custom,function(i){if(this.getId()===avatar.getId()){instance.avatars.custom[i]=avatar}})}else{throw new Error("JIRA.AvatarStore._update: Cannot update avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},update:function(avatar,options){var instance=this;options=options||{};JIRA.SmartAjax.makeRequest({type:"PUT",url:this.getRestUrlForAvatar(avatar),error:options.error,success:function(){instance._update(avatar);if(options.success){options.success.apply(this,arguments)}}})},_add:function(avatar){if(avatar.isSystemAvatar()){this.avatars.system.push(avatar)}else{this.avatars.custom.push(avatar)}},createAvatarFromTemporary:function(instructions,options){var instance=this;options=options||{};if(this.restUpdateTempUrl){JIRA.SmartAjax.makeRequest({type:"POST",url:this._buildCompleteUrl(this.restUpdateTempUrl),data:JSON.stringify(instructions),contentType:"application/json",dataType:"json",success:function(data){if(!data){data={id:instance.TEMP_ID,isSelected:true}}var avatar=JIRA.Avatar.createCustomAvatar(data);instance._add(avatar);if(options.success){options.success.call(this,data)}},error:options.error})}},createTemporaryAvatar:function(fileInput,options){options=AJS.$.extend(true,{},options,{params:this.restParams});JIRA.AvatarUtil.uploadTemporaryAvatar(this.restCreateTempUrl,fileInput,options)},_refresh:function(avatars){var instance=this;instance.avatars.system=[];instance.avatars.custom=[];if(avatars.system){jQuery.each(avatars.system,function(i,descriptor){instance.avatars.system.push(JIRA.Avatar.createSystemAvatar(descriptor))})}if(avatars.custom){jQuery.each(avatars.custom,function(i,descriptor){instance.avatars.custom.push(JIRA.Avatar.createCustomAvatar(descriptor))})}},refresh:function(options){var instance=this;var tempAvatar=this.getById(instance.TEMP_ID);options=options||{};JIRA.SmartAjax.makeRequest({url:this._buildCompleteUrl(this.restQueryUrl),error:options.error,success:function(avatars){instance._refresh(avatars);if(tempAvatar){instance._add(tempAvatar)}if(options.success){options.success.apply(this,arguments)}}})},getAllAvatars:function(){return this.avatars},getAllSystemAvatars:function(){return this.avatars.system},getAllCustomAvatars:function(){return this.avatars.custom},getRestUrlForAvatar:function(avatar){return this._buildCompleteUrl(this.restSingleAvatarUrl+"/"+avatar.getId())}});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarUtil.js' */
JIRA.AvatarUtil={uploadUsingIframeRemoting:function(url,field,options){options=options||{};var fileName=field.val(),form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addStaticProgress(fileName);var $oldInput=form.cloneFileInput();form.fileSelector.clear();var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:url,params:AJS.$.extend({},options.params,{filename:fileName,atl_token:atl_token()}),scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val,status){if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],fileName,JIRA.AvatarUtil.getErrorTarget(form))}else{if(options.success){options.success(val,status)}}},error:function(text){console.log(text);if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),JIRA.AvatarUtil.getErrorTarget(form))}},after:function(){timer.cancel();progress.remove();if(!this.cancelled){form.enable()}}});progress.onCancel(function(){upload.abort()});upload.upload()},uploadUsingFileApi:function(url,field,options){var timer,upload,cancelled,file=field[0].files[0],form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addProgress(file);options=options||{};timer=new AJS.InlineAttach.Timer(function(){if(!cancelled){progress.show()}});upload=new AJS.InlineAttach.AjaxUpload({file:file,params:AJS.$.extend({},options.params,{filename:file.name,size:file.size,atl_token:atl_token()}),scope:this,url:url,before:function(){field.hide();!cancelled&&progress.start()},progress:function(val){progress.progress.$progress.parent().parent().show();!cancelled&&progress.update(val)},success:function(val,status){if(cancelled){return }if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],file.name,JIRA.AvatarUtil.getErrorTarget(form))}else{if(status===201){options.success(val,status)}}},error:function(text,status){if(status<0){form.addError(text,JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),JIRA.AvatarUtil.getErrorTarget(form))}if(options.error){options.error(text,status)}},after:function(){timer.cancel();progress.finish().remove();field.val("").show()}});upload.upload();progress.onCancel(function(){upload.abort()})},getErrorTarget:function(form){return{$element:form.$form.find(".error")}},uploadTemporaryAvatar:function(url,field,options){if(AJS.InlineAttach.AjaxPresenter.isSupported(field)){this.uploadUsingFileApi(url,field,options)}else{this.uploadUsingIframeRemoting(url,field,options)}}};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.js' */
JIRA.AvatarPicker=AJS.Control.extend({init:function(options){this.avatarManager=options.avatarManager;this.avatarRenderer=options.avatarRenderer;this.imageEditor=options.imageEditor;this.size=options.size;this.selectCallback=options.select;this.cropperDialog=null;this.initialSelection=options.initialSelection},render:function(ready){var instance=this;this.avatarManager.refreshStore({success:function(){if(instance.cropperDialog instanceof JIRA.Dialog){instance.cropperDialog.hide();delete instance.cropperDialog}instance.element=jQuery('<div id="jira-avatar-picker" />');instance.element.html(JIRA.Templates.AvatarPicker.picker({avatars:instance.avatarManager.getAllAvatarsRenderData(instance.size)}));instance._assignEvents("selectAvatar",instance.element.find(".jira-avatar button"));instance._assignEvents("deleteAvatar",instance.element.find(".jira-delete-avatar"));instance._assignEvents("uploader",instance.element.find("#jira-avatar-uploader"));if(undefined!=instance.initialSelection){instance.getAvatarElById(instance.initialSelection).addClass("jira-selected-avatar")}ready(instance.element)},error:function(xhr,error,textStatus,smartAjaxResult){instance.appendErrorContent(instance.element,smartAjaxResult);ready(instance.element)}})},appendErrorContent:function(el,smartAjaxResult){try{var errors=JSON.parse(smartAjaxResult.data);if(errors&&errors.errorMessages){jQuery.each(errors.errorMessages,function(i,message){AJS.messages.error(el,{body:AJS.escapeHTML(message),closeable:false,shadowed:false})})}else{el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}}catch(e){el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}},uploadTempAvatar:function(field){var instance=this;this.avatarManager.createTemporaryAvatar(field,{success:function(data){if(data.id){instance.render(function(){instance.selectAvatar(data.id)})}else{field.val("");instance.cropperDialog=new JIRA.Dialog({id:"project-avatar-cropper",width:560,content:function(ready){var $el=instance.imageEditor.render(data);instance.imageEditor.edit({confirm:function(instructions){instance.avatarManager.createAvatarFromTemporary(instructions,{success:function(data){instance.render(function(){instance.selectAvatar(data.id)})}})}});$el.find(".cancel").click(function(){instance.cropperDialog.hide()});ready($el)}});instance.cropperDialog.bind("dialogContentReady",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.LOADED)});instance.cropperDialog.bind("Dialog.hide",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.DISMISSED)});instance.cropperDialog.show()}},error:function(){console.log(arguments)}})},getAvatarElById:function(id){return this.element.find(".jira-avatar[data-id='"+id+"']")},selectAvatar:function(id){var avatar,instance=this;avatar=this.avatarManager.getById(id);this.avatarManager.selectAvatar(this.avatarManager.getById(id),{error:function(){},success:function(){instance.getAvatarElById(id).remove();if(instance.selectCallback){instance.selectCallback.call(instance,avatar,instance.avatarManager.getAvatarSrc(avatar,instance.size))}}})},deleteAvatar:function(id){var instance=this;if(confirm("Are you sure you want to delete avatar?")){this.avatarManager.destroy(this.avatarManager.getById(id),{error:function(){},success:function(){var selectedAvatar=instance.avatarManager.getSelectedAvatar(),$avatar=instance.getAvatarElById(id);$avatar.fadeOut(function(){$avatar.remove()});if(selectedAvatar.getId()!==id){instance.getAvatarElById(selectedAvatar.getId()).addClass("jira-selected-avatar");instance.selectCallback.call(instance,selectedAvatar,instance.avatarManager.getAvatarSrc(selectedAvatar,instance.size),true)}}})}},_events:{uploader:{change:function(e,el){this.uploadTempAvatar(el)}},deleteAvatar:{click:function(e,el){this.deleteAvatar(el.attr("data-id"))}},selectAvatar:{click:function(e,el){if(el[0].id==="select-avatar-button"){this.selectAvatar(el.attr("data-id"))}}}}});JIRA.AvatarPicker.ImageEditor=AJS.Control.extend({render:function(data){this.element=jQuery('<div id="avatar-picker-image-editor"/>').html(JIRA.Templates.AvatarPicker.imageEditor(data));return this.element},edit:function(options){var instance=this,avator=this.element.find(".avataror");options=options||{};avator.unbind();avator.bind("AvatarImageLoaded",function(){if(options.ready){options.ready()}});avator.find("img").load(function(){avator.avataror({previewElement:instance.element.find(".jira-avatar-cropper-header"),parent:instance.element})});this.element.find("#avataror").submit(function(e){e.preventDefault();if(options.confirm){options.confirm({cropperOffsetX:jQuery("#avatar-offsetX").val(),cropperOffsetY:jQuery("#avatar-offsetY").val(),cropperWidth:jQuery("#avatar-width").val()})}}).find(".cancel").click(function(e){e.preventDefault();if(options.cancel){options.cancel()}})}});JIRA.AvatarPicker.ImageEditor.LOADED="imageEditorLoaded";JIRA.AvatarPicker.ImageEditor.DISMISSED="imageEditorDismissed";JIRA.AvatarPicker.createUniversalAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUniversalAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,avatarType:options.avatarType}),initialSelection:options.initialSelection,imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:options.hasOwnProperty("avatarSize")?options.avatarSize:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createProjectAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createProjectAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createUserAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUserAvatarManager({username:options.username,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.createUniversalAvatarPickerDialog=function(options){var lastSelection=options.initialSelection||options.defaultAvatarId;var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text(options.title||"Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUniversalAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,initialSelection:lastSelection,avatarType:options.avatarType,avatarSize:options.avatarSize,select:function(avatar,src,implicit){lastSelection=String(avatar.getId());if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createProjectAvatarPickerDialog=function(options){var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text("Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createUserAvatarPickerDialog=function(options){var userAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"user-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="useravatar-content-wrapper"/>');jQuery("<h2 />").text("Select a User Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUserAvatarPicker({username:options.username,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}jQuery(".avatar-image").attr("src",src);if(!implicit){userAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}})};jQuery(function(){JIRA.createUserAvatarPickerDialog({trigger:"#user_avatar_image",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text()})});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/GravatarUtil.js' */
(function(){AJS.namespace("JIRA.GravatarUtil");JIRA.GravatarUtil.showGravatarHelp=function(data){if(typeof (data)!=="undefined"&&typeof (data.entry)!=="undefined"){AJS.$(".gravatar-signup-text").addClass("hidden");AJS.$(".gravatar-login-text").removeClass("hidden")}};var displayGravatarHelp=function(){var gravatarJsonUrl=AJS.$("#gravatar_json_url");if(gravatarJsonUrl.length){AJS.$.ajax(gravatarJsonUrl.val(),{dataType:"jsonp",success:JIRA.GravatarUtil.showGravatarHelp})}};AJS.$(document).ready(function(){if(AJS.$("#gravatar_help_params")){displayGravatarHelp()}})}());;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.soy' */
// This file was automatically generated from AvatarPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AvatarPicker == 'undefined') { JIRA.Templates.AvatarPicker = {}; }


JIRA.Templates.AvatarPicker.picker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="jira-avatar-upload-form" action="#"><input name="id" value="10000" type="hidden" ><input name="pid" value="10000" type="hidden" ><div class="field-group"><label for="jira-avatar-uploader">', soy.$$escapeHtml("Upload a new avatar"), '</label><input type="file" class="ignore-inline-attach" name="avatar" id="jira-avatar-uploader"/><div class="error"></div></div></form><div class="form-body"><ul class="jira-avatars">');
  var avatarList6 = opt_data.avatars.system;
  var avatarListLen6 = avatarList6.length;
  for (var avatarIndex6 = 0; avatarIndex6 < avatarListLen6; avatarIndex6++) {
    var avatarData6 = avatarList6[avatarIndex6];
    output.append('<li class="jira-avatar jira-system-avatar ', (avatarData6.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this Avatar" data-id="', soy.$$escapeHtml(avatarData6.id), '"><button id="select-avatar-button" data-id="', soy.$$escapeHtml(avatarData6.id), '" class="jira-icon-button" title="', soy.$$escapeHtml("Select this Avatar"), '"><img id="avatar-', soy.$$escapeHtml(avatarData6.id), '" src="', soy.$$escapeHtml(avatarData6.src), '" width="', soy.$$escapeHtml(avatarData6.width), '" height="', soy.$$escapeHtml(avatarData6.height), '" alt="', soy.$$escapeHtml("Select this Avatar"), '"/></button></li>');
  }
  var avatarList29 = opt_data.avatars.custom;
  var avatarListLen29 = avatarList29.length;
  for (var avatarIndex29 = 0; avatarIndex29 < avatarListLen29; avatarIndex29++) {
    var avatarData29 = avatarList29[avatarIndex29];
    output.append('<li class="jira-avatar jira-custom-avatar ', (avatarData29.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this avatar" data-id="', soy.$$escapeHtml(avatarData29.id), '"><button id="select-avatar-button" data-id="', soy.$$escapeHtml(avatarData29.id), '" class="jira-icon-button" title="', soy.$$escapeHtml("Select this Avatar"), '"><img id="avatar-', soy.$$escapeHtml(avatarData29.id), '" src="', soy.$$escapeHtml(avatarData29.src), '" width="', soy.$$escapeHtml(avatarData29.width), '" height="', soy.$$escapeHtml(avatarData29.height), '" alt="', soy.$$escapeHtml("Select this Avatar"), '" /></span><button class="jira-delete-avatar jira-icon-button" data-id="', soy.$$escapeHtml(avatarData29.id), '" title="', soy.$$escapeHtml("Delete this Avatar"), '">', soy.$$escapeHtml("Delete this Avatar"), '</button></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AvatarPicker.imageEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="avataror" class="jira-avatar-cropper-form aui" action="/jira/secure/project/AvatarPicker.jspa"><input type="hidden" name="cropperOffsetX" id="avatar-offsetX" value="', soy.$$escapeHtml(opt_data.cropperOffsetX), '"><input type="hidden" name="cropperOffsetY" id="avatar-offsetY" value="', soy.$$escapeHtml(opt_data.cropperOffsetY), '"><input type="hidden" name="cropperWidth" id="avatar-width"  value="', soy.$$escapeHtml(opt_data.cropperWidth), '"><div class="jira-avatar-cropper-header"><p>', soy.$$escapeHtml("Please select which part of the uploaded image you wish to use as the avatar."), '</p></div><div class="form-body"><div class="avataror"><img src="', soy.$$escapeHtml(opt_data.url), '" height="300" /></div></div><div class="form-footer buttons-container"><div class="buttons"><input type="submit" class="aui-button" value="', soy.$$escapeHtml("Confirm"), '"><a class="aui-button aui-button-link cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:avatar-picker-trigger', location = '/includes/jira/admin/initAvatarPickerTrigger.js' */
(function(){var AvatarPickerContentRetriever=AJS.ContentRetriever.extend({init:function(avatarPicker){this.avatarPicker=avatarPicker},content:function(finished){this.avatarPicker.render(function(el){finished(jQuery("<div />").html(el))})},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});var InlineAvatarPicker=AJS.InlineLayer.extend({init:function(options){var instance=this;this.avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectId:options.projectId,projectKey:options.projectKey,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){instance.hide()}instance.offsetTarget().attr("src",src);instance.offsetTarget().trigger("AvatarSelected")}});options.contentRetriever=new AvatarPickerContentRetriever(this.avatarPicker);jQuery(this.avatarPicker.imageEditor).bind(JIRA.AvatarPicker.ImageEditor.LOADED,function(){instance.setWidth(instance.layer().attr("scrollWidth"))});this._super(options);var $triggerImg=this.offsetTarget();var $triggerContainer=jQuery("<span class='jira-avatar-picker-trigger'></span>");$triggerContainer.insertBefore($triggerImg).append($triggerImg);this._assignEvents("offsetTarget",$triggerContainer)},_events:{offsetTarget:{click:function(e){this.show()}}}});function initProjectAvatarPicker(ctx){var trigger=jQuery(".jira-avatar-picker-trigger");var triggerImg=jQuery(".jira-avatar-picker-trigger img, img.jira-avatar-picker-trigger",ctx);var avatarIdField=jQuery(ctx).find("#avatar-picker-avatar-id");var avatarIconurlField=jQuery(ctx).find("#avatar-picker-iconurl");var avatarTypeElement=jQuery(ctx).find("#avatar-type");if(""===avatarTypeElement.text()){return }JIRA.createUniversalAvatarPickerDialog({trigger:trigger,title:jQuery(ctx).find("#avatar-dialog-title").text(),projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),initialSelection:avatarIdField.val(),avatarSize:JIRA.Avatar.getSizeObjectFromName(jQuery(ctx).find("#avatar-size").text()),avatarType:avatarTypeElement.text(),select:function(avatar,src){triggerImg.attr("src",src);avatarIconurlField.val(src);avatarIdField.val(avatar.getId())}})}function initProjectInlineAvatarPicker(ctx){var $triggerImg=jQuery(".jira-inline-avatar-picker-trigger",ctx);if($triggerImg.length){new InlineAvatarPicker({offsetTarget:$triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),alignment:AJS.LEFT,width:420,allowDownsize:true})}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initProjectAvatarPicker(context);initProjectInlineAvatarPicker(context)}})})();;
;/* module-key = 'jira.webresources:croneditor', location = '/includes/js/cron/croneditor.js' */
function hideCronEdit(elementid){document.getElementById(elementid).style.display="none"}function showCronEdit(elementid){document.getElementById(elementid).style.display=""}function toggleFrequencyControl(paramPrefix,setOriginal){var select=document.getElementById(paramPrefix+"interval");if(select.value==0){switchToOnce(paramPrefix,setOriginal)}else{switchToMany(paramPrefix,setOriginal)}}function switchToOnce(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runMany");showCronEdit(paramPrefix+"runOnce");if(setOriginal){timesOnce[paramPrefix]=true}}function switchToMany(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runOnce");showCronEdit(paramPrefix+"runMany");if(setOriginal){timesOnce[paramPrefix]=false}}function switchToDaysOfMonth(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");showCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");hideCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOnce(paramPrefix,false)}function switchToDaysOfWeek(paramPrefix){showCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToDaily(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToAdvanced(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");hideCronEdit(paramPrefix+"runOnce");hideCronEdit(paramPrefix+"runMany");hideCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"advanced")}function switchToOriginal(paramPrefix){if(timesOnce[paramPrefix]){switchToOnce(paramPrefix,false)}else{switchToMany(paramPrefix,false)}};;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/create.js' */
JIRA.Forms.CreateIssueModel=JIRA.Forms.Model.extend({DEFAULT_NON_RETAINED_FIELDS:["summary","description","timetracking","timetracking_originalestimate","timetracking_remainingestimate","worklog","worklog_startDate","worklog_timeLogged","worklog_newEstimate","worklog_adjustmentAmount","attachment"],CUSTOMFIELD_PATTERN:/^(customfield_(\d+))(?:|\:(?:\d+))$/,TIMETRACKING_PATTERN:/^timetracking_/,init:function(a){a=a||{};this.userFieldsResource=contextPath+"/rest/quickedit/1.0/userpreferences/create";this._hasRetainFeature=true;this._hasVisibilityFeature=true;this.retainedFields=[];this.dirtyFields=[];this.initIssueType=a.issueType;this.initProjectId=a.projectId;this.parentIssueId=a.parentIssueId;this.nonRetainedFields=this.DEFAULT_NON_RETAINED_FIELDS;if(a.nonRetainedFields){this.nonRetainedFields=_.union(a.nonRetainedFields,this.DEFAULT_NON_RETAINED_FIELDS)}},getParentIssueId:function(){return this.parentIssueId},isInMultipleMode:function(){return this.multipleMode},setIsMultipleMode:function(a){this.multipleMode=a},getActiveFieldIds:function(){var a=this,b=jQuery.Deferred(),c=[];this.getUserFields().done(function(d){jQuery.each(d,function(f,e){c.push(e)});a.getRequiredFields().done(function(e){jQuery.each(e,function(g,f){if(jQuery.inArray(f.id,c)===-1){c.push(f.id)}});b.resolve(c)})});return b.promise()},hasVisibilityFeature:function(a){return !a.required},getFieldsResource:function(){var a=contextPath+"/secure/QuickCreateIssue!default.jspa?decorator=none";if(this.parentIssueId){return a+"&parentIssueId="+this.parentIssueId}if(this.initIssueType){a=a+"&issuetype="+this.initIssueType;delete this.initIssueType}if(this.initProjectId){a=a+"&pid="+this.initProjectId;delete this.initProjectId}return a},addFieldToRetainValue:function(d,b){var a=!_.contains(this.nonRetainedFields,d);var c=d.match(/^filetoconvert/)!==null;if(a||c||b){this._super(d)}},getRequiredFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.required){b.push(e)}});a.resolve(b)});return a.promise()},getConfigurableFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.id!=="project"&&e.id!=="issuetype"){b.push(e)}});a.resolve(b)});return a.promise()},getIssueSetupFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.id==="project"||e.id==="issuetype"){b.push(e)}});a.resolve(b)});return a.promise()},markFieldAsDirty:function(a){a=this.normalizeCustomFieldId(a);if(!this.fieldIsDirty(a)){this.dirtyFields.push(a)}},fieldIsDirty:function(a){return _.contains(this.dirtyFields,a)},isCustomFieldId:function(a){return a&&!!a.match(this.CUSTOMFIELD_PATTERN)},isTimetrackingFieldId:function(a){return a&&!!a.match(this.TIMETRACKING_PATTERN)},normalizeCustomFieldId:function(a){if(this.isCustomFieldId(a)){return a.match(this.CUSTOMFIELD_PATTERN)[1]}else{return a}},normalizeFieldParam:function(a,b){if(a=="filetoconvert"){return a+"-"+b}else{if(this.isCustomFieldId(a)){return this.normalizeCustomFieldId(a)}else{if(this.isTimetrackingFieldId(a)){return"timetracking"}else{return a}}}}});JIRA.Forms.CreateIssueHelper=Class.extend({init:function(a){this.form=a},handleSubmitSuccess:function(d){function c(e,g,f){var h='<a href="'+f+'">'+e+" - "+AJS.escapeHTML(g)+"</a>";return AJS.format("Issue {0} has been successfully created",h)}var a=this,b=this.form.$element.find("#summary").val();d.summary=b;this.form.triggerEvent("submitted",[d,this]);this.form.triggerEvent("issueCreated",[d,this],true);if(a.form.model.isInMultipleMode()){this.form.render().done(function(){var e=c(d.issueKey,b,contextPath+"/browse/"+d.issueKey);JIRA.applySuccessMessageToForm(a.form.getForm(),e)})}else{this.form.triggerEvent("sessionComplete")}},getCreateAnotherCheckbox:function(){return this.form.$element.find("#qf-create-another")},isInMultipleMode:function(){return this.getCreateAnotherCheckbox().is(":checked")},getProjectField:function(){return this.form.$element.find(".issue-setup-fields #project")},getIssueTypeField:function(){return this.form.$element.find(".issue-setup-fields #issuetype")},serializeForToggle:function(c){if(!this.form.model.hasRetainFeature()){return this.form.getForm().serialize()}var e=this.form.model.prevActiveFields||[];var k=this.form.getForm().serializeArray();var g=function(l){return this.form.model.normalizeFieldParam(l.name,l.value)}.bind(this);var d=this.form.getActiveFieldIds();var f=jQuery.grep(k,function(l){return jQuery.inArray(g(l),d)!==-1});var a=jQuery.grep(e,function(l){return jQuery.inArray(g(l),d)===-1});var b=jQuery.map(a,function(l){return g(l)});var i=jQuery.merge(f,a);var h=jQuery.merge(d,b);this.form.model.prevActiveFields=jQuery.extend(true,[],i);if(c){h=this.executeProjectChangedSecuritySettingAction(h)}h=h.filter(function(l){return !this.form.model.isCustomFieldId(l)||this.form.model.fieldIsDirty(l)}.bind(this));var j=jQuery.merge([{name:"retainValues",value:true}],i);jQuery.each(k,function(l,m){if(m.name==="pid"||m.name==="issuetype"){j.push(m)}});j.push({name:"toggle",value:true});jQuery.each(h,function(l,m){j.push({name:"fieldsToRetain",value:m})});j.push({name:"formToken",value:this.form.model.getFormToken()});return jQuery.param(j)},executeProjectChangedSecuritySettingAction:function(a){return _.reject(a,function(b){return b==="security"})},prepareFieldsToRetain:function(a,b){jQuery.each(a,function(c,d){b.push({name:"fieldsToRetain",value:d})});return b},setIssueType:function(){var a=this,b=this.serializeForToggle();this.form.invalidateFieldsCache();this.form.disable();this.form.render(b).done(function(){a.form.enable()})},setProjectId:function(){var a=this,b=this.serializeForToggle(true);this.form.invalidateFieldsCache();this.form.disable();this.form.render(b).done(function(){a.form.enable()})},saveFormDirtyStatus:function(){this.form.isDirty=this.form.getForm().isDirty()},restoreFormDirtyStatus:function(){if(this.form.isDirty){this.form.getForm().addClass(JIRA.DirtyForm.ClassNames.BY_DEFAULT)}},decorate:function(){var a=this;this.getProjectField().change(function(){a.saveFormDirtyStatus();JIRA.trigger("dialogBeforeContentChange",["projectId",this.value,JIRA.Dialog.current.options.id]);a.setProjectId(this.value)});this.getIssueTypeField().change(function(){a.saveFormDirtyStatus();JIRA.trigger("dialogBeforeContentChange",["issueType",this.value,JIRA.Dialog.current.options.id]);a.setIssueType(this.value)});this.getCreateAnotherCheckbox().change(function(){a.form.model.setIsMultipleMode(this.checked)})},decorateFields:function(){var a=this;this.form.$element.find('*[id^="customfield_"]').off("change.customField").on("change.customField",function(){if(a.form.model.isCustomFieldId(this.name)){a.form.model.markFieldAsDirty(this.name)}})}});JIRA.Forms.CreateIssueError=JIRA.Forms.Error.extend({_render:function(a){return jQuery(JIRA.Templates.Issue.createIssueError({errorHtml:a,useLegacyDecorator:JIRA.useLegacyDecorator()}))}});JIRA.Forms.UnconfigurableCreateIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(a){this._serialization={};this.globalEventNamespaces=a.globalEventNamespaces||[];this.model=a.model;this.helper=new JIRA.Forms.CreateIssueHelper(this);this.title=a.title;this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";this.$element=jQuery("<div class='qf-unconfigurable-form' />")},handleSubmitSuccess:function(a){this.helper.handleSubmitSuccess(a)},_render:function(){var b=jQuery.Deferred(),a=this;this.getFieldsHtml().done(function(c){a.model.getIssueSetupFields().done(function(f){var e=JIRA.Templates.Issue.createIssueForm({issueSetupFields:f,fieldsHtml:c,parentIssueId:a.model.getParentIssueId(),atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),title:a.title,multipleMode:a.model.isInMultipleMode(),useLegacyDecorator:JIRA.useLegacyDecorator(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()}),d=JIRA.extractScripts(e);a.$element.empty().append(d.html);a.helper.restoreFormDirtyStatus();a.helper.decorate();a.helper.decorateFields();b.resolveWith(a,[a.$element,d.scripts])})});return b.promise()}});JIRA.Forms.ConfigurableCreateIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(a){this.model=a.model;this.helper=new JIRA.Forms.CreateIssueHelper(this);this.globalEventNamespaces=a.globalEventNamespaces||[];this.issueId=a.issueId;this.title=a.title;this._serialization={};this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")},handleSubmitSuccess:function(a){return this.helper.handleSubmitSuccess(a)},_render:function(){var b=jQuery.Deferred(),a=this;a.model.getIssueSetupFields().done(function(d){var c=JIRA.Templates.Issue.createIssueForm({issueSetupFields:d,atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),isConfigurable:true,title:a.title,parentIssueId:a.model.getParentIssueId(),useLegacyDecorator:JIRA.useLegacyDecorator(),multipleMode:a.model.isInMultipleMode(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()});a.$element.html(c);a.helper.decorate();a.renderFormContents().done(function(f,e){a.helper.decorateFields();b.resolveWith(a,[a.$element,e])});a.bind("QuickForm.fieldAdded",function(){a.helper.decorateFields()})});return b.promise()}});JIRA.Forms.createCreateIssueForm=function(a){a=a||{};return new JIRA.Forms.Container(function(){a.globalEventNamespaces=a.globalEventNamespaces||["QuickCreateIssue"];var e="Create Issue",b=new JIRA.Forms.CreateIssueModel({projectId:a.pid,issueType:a.issueType}),d=new JIRA.Forms.ConfigurableCreateIssueForm({model:b,title:e,globalEventNamespaces:a.globalEventNamespaces}),c=new JIRA.Forms.UnconfigurableCreateIssueForm({model:b,title:e,globalEventNamespaces:a.globalEventNamespaces});return{globalEventNamespaces:a.globalEventNamespaces,model:b,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:d,unconfigurableForm:c}})};JIRA.Forms.createSubtaskForm=(function(){var a=function a(c){return c.parentIssueId||JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()};var b=function b(c){c=c||{};return new JIRA.Forms.Container(function(){c.globalEventNamespaces=c.globalEventNamespaces||["QuickCreateSubtask"];var g=a(c),h=JIRA.Dialog.getIssueActionTitle("Create Subtask"),d=new JIRA.Forms.CreateIssueModel({parentIssueId:g,projectId:c.pid,issueType:c.issueType}),f=new JIRA.Forms.ConfigurableCreateIssueForm({model:d,title:h,globalEventNamespaces:c.globalEventNamespaces}),e=new JIRA.Forms.UnconfigurableCreateIssueForm({model:d,title:h,globalEventNamespaces:c.globalEventNamespaces});return{globalEventNamespaces:c.globalEventNamespaces,model:d,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:f,unconfigurableForm:e}})};return b})();jQuery(function(){var a;jQuery(document).on("simpleClick",".create-issue, .create-issue-type",function(f){var b=jQuery(f.target);var d=b.is("a")?b:b.find("a");var g=parseUri(d.attr("href")).queryKey;var c={pid:g.pid,issueType:g.issuetype};c=jQuery.extend(c,{pid:b.attr("data-pid"),issueType:b.attr("data-issue-type")});JIRA.Forms.createCreateIssueForm(c).asDialog({trigger:document.createElement("a"),id:"create-issue-dialog",windowTitle:"Create Issue"}).show();f.preventDefault()});a=document.getElementById("stqc_show");if(a){a.onclick=null}jQuery(document).on("simpleClick",".issueaction-create-subtask",function(f){var b=jQuery(f.target);var d=b.is("a")?b:b.find("a");var c={parentIssueId:d.attr("data-issueid")};JIRA.Forms.createSubtaskForm(c).asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Create Subtask")},trigger:document.createElement("a"),id:"create-subtask-dialog"}).show();f.preventDefault()})});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>');
  if (opt_data.showFieldConfigurationToolBar) {
    JIRA.Templates.Issue.fieldConfigurationToolbar(null, output);
  }
  output.append(opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.fieldConfigurationToolbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param64 = new soy.StringBuilder();
  var param66 = new soy.StringBuilder();
  aui.buttons.button({text: ' ' + soy.$$escapeHtml("Configure Fields"), id: 'qf-field-picker-trigger', extraClasses: 'toolbar-trigger', iconText: "Configure Fields", iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-configure'}, param66);
  aui.toolbar2.item({item: 'secondary', content: param66.toString()}, param64);
  aui.toolbar2.toolbar2({extraClasses: 'qf-form-operations', content: param64.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      output.append((tabData82) ? '<li class="menu-item ' + ((tabData82.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData82.position) + '" ><strong>' + soy.$$escapeHtml(tabData82.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList96 = opt_data.tabs;
    var tabListLen96 = tabList96.length;
    for (var tabIndex96 = 0; tabIndex96 < tabListLen96; tabIndex96++) {
      var tabData96 = tabList96[tabIndex96];
      if (tabData96) {
        output.append('<div class="tabs-pane ', (tabData96.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData96.position), '">');
        var fieldList106 = tabData96.fields;
        var fieldListLen106 = fieldList106.length;
        for (var fieldIndex106 = 0; fieldIndex106 < fieldListLen106; fieldIndex106++) {
          var fieldData106 = fieldList106[fieldIndex106];
          output.append((fieldData106.editHtml) ? fieldData106.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList116 = opt_data.fields;
    var fieldListLen116 = fieldList116.length;
    for (var fieldIndex116 = 0; fieldIndex116 < fieldListLen116; fieldIndex116++) {
      var fieldData116 = fieldList116[fieldIndex116];
      output.append((fieldData116.editHtml) ? fieldData116.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>');
  if (opt_data.showFieldConfigurationToolBar) {
    JIRA.Templates.Issue.fieldConfigurationToolbar(null, output);
  }
  output.append(soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList138 = opt_data.issueSetupFields;
    var fieldListLen138 = fieldList138.length;
    for (var fieldIndex138 = 0; fieldIndex138 < fieldListLen138; fieldIndex138++) {
      var fieldData138 = fieldList138[fieldIndex138];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData138.id), ' qf-required" data-field-id="', soy.$$escapeHtml(fieldData138.id), '">', fieldData138.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button aui-button-primary" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList205 = opt_data.errors;
  var errorListLen205 = errorList205.length;
  for (var errorIndex205 = 0; errorIndex205 < errorListLen205; errorIndex205++) {
    var errorData205 = errorList205[errorIndex205];
    output.append('<li>', soy.$$escapeHtml(errorData205), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-analytics-tracker', location = 'includes/js/rapid/AnalyticsTracker.js' */
if(typeof GH==="undefined"){window.GH={}}GH.AnalyticsTracker=function(b,d,a){if(_.isUndefined(b)){throw new Error("You must specify a category")}this.params={};this.params.category=b;var c=0;if(!_.isUndefined(d)){this.params.action=d;c++;if(!_.isUndefined(a)){this.params.label=a;c++}}this.requiredArgumentNames=["action","label","value"].slice(c);this.useAsync=true};GH.AnalyticsTracker.prototype.setAsync=function(a){this.useAsync=a;return this};GH.AnalyticsTracker.prototype.trigger=function(){if(this.requiredArgumentNames.length<arguments.length){AJS.log("Warning: too many arguments passed in. Needed at most "+this.requiredArgumentNames.length+" but got "+arguments.length)}var c=_.clone(this.params);for(var b=0;b<arguments.length&&!_.isUndefined(this.requiredArgumentNames[b]);b++){c[this.requiredArgumentNames[b]]=arguments[b]}this._validateParams(c);var a="gh.analytics.async";AJS.$(AJS).trigger(a,c)};GH.AnalyticsTracker.prototype._validateParams=function(b){var a=["category","action","label"];_.each(a,function(c){if(!_.isUndefined(b[c])&&!_.isString(b[c])){b[c]=b[c].toString()}else{if(_.isUndefined(b[c])){b[c]=""}}});_.each(["category","action"],function(c){b[c]=b[c].replace(/\s+/g,"")});if(!_.isUndefined(b.value)){b.value=parseInt(b.value,10);if(isNaN(b.value)){b.value=undefined}}};;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/ui/help/HelpAnalytics.js' */
AJS.$(function(){var a=function(c){if(GH&&GH.AnalyticsTracker){return new GH.AnalyticsTracker(c).setAsync(false)}else{return{trigger:function(){}}}};AJS.$("#gh_view_help").click(function(c){a("gh.gethelp").trigger("usermenu","docs");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement").click(function(c){a("gh.myjirahome").trigger("usermenu","enabled");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-disablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","disable");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-set").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#beta_gh\\.configuration\\.rapid\\.removal").click(function(f){var c=AJS.$(this),d=c.attr("checked")?"on":"off";a("gh.labs.feature").trigger("rapid_removal",d);return true});AJS.$(document).delegate("#js-classic-link_lnk","click",function(c){a("gh.agile.menu").trigger("classic");return true});var b=function(c){if(c.attr("target")=="_blank"){return true}else{setTimeout('document.location = "'+c.attr("href")+'"',100);return false}}});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/Analytics.js' */
if(typeof GH==="undefined"){window.GH={}}(function(c,g,e,d){d.AnalyticsEnabled=true;var b="gh.analytics.async";function f(){g(document).on(b,function(i,h){a(h)})}function a(i){var j={};var h=i.category;if(!e.isUndefined(i.action)){h=h+"."+i.action}if(!e.isUndefined(i.label)){j.label=i.label}if(!e.isUndefined(i.value)){j.value=i.value}c.trigger("analytics",{name:h,data:j})}f()})(AJS,AJS.$,_,GH);;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var c=new GH.AnalyticsTracker("gh.issueaction.gotorapidboard").setAsync(false);var b=JIRA.FormDialog.extend({_performRedirect:function(e){c.trigger("direct");window.location.href=e}});var d=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:function(){return JIRA.Dialogs.getDefaultAjaxOptions.apply(this,arguments)}});var a=function(f,g){var h="";var e=AJS.$(f);if(e.hasClass("js-rapidboard-operation-sprint")){h="sprint."}else{if(e.hasClass("js-rapidboard-operation-issue")){h="issue."}}h+=g;return h};AJS.$(function(){AJS.$(document).on("simpleClick",".issueaction-greenhopper-rapidboard-operation",function(f){f.preventDefault();var e=a(f.currentTarget,"open");c.trigger(e);d.show()});AJS.$(document).on("simpleClick",".js-select-rapidboard",function(f){var e=a(f.currentTarget,"chosen");c.trigger(e)})})})();;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(n){var f=n.element;var c;var m=this;AJS.$.extend(n,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:b,formatResponse:d,error:i}});g();function b(o){return{searchQuery:o,projectKey:AJS.$(f).attr("data-project-key"),maxResults:10}}function k(u,p,r){u=AJS.escapeHTML(String(u));p=AJS.escapeHTML(String(p));r=AJS.escapeHTML(String(r));var v=r.toUpperCase();var q=u.toUpperCase();var w=p.toUpperCase();var v=(v+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var o=new RegExp("("+v+")","gi");var s=q.search(o);var t;if(s>-1){t=u.slice(s,s+r.length);u=u.replace(t,"<em>"+t+"</em>")}s=w.search(o);if(s>-1){t=p.slice(s,s+r.length);p=p.replace(t,"<em>"+t+"</em>")}return u+" - ("+p+")"}function d(p){if(!p.epicNames){return[]}var r=[];var q=p.epicNames;var v;var u=m.getQueryVal();var t=a(u.length,q.length,p.total);for(var s=0,o=q.length;s<o;s++){v=q[s];t.addItem(j(v,u))}r.push(t);return r}function j(r,q){var p=r.key;var s=r.name;var o=k(s,p,q);return new AJS.ItemDescriptor({value:"key:"+p,fieldText:s,label:o,html:o,allowDuplicate:false,highlighted:true})}function a(o,q,p){return new AJS.GroupDescriptor({weight:1,id:"epic-names",label:o===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",q,p),replace:true})}function i(q,r,p){var o=AJS.$(f);o.siblings(".ghx-error").remove();o.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+p),type:"error",className:"ghx-error aui-ss"}))}function h(q){var o="";var p=false;if(q&&q.length>0){o=AJS.format("Epic with key \'\'{0}\'\' does not exist.",q);p=true}return{isError:p,message:o}}function l(p){var o,q;c.apply(m,[p]);p=p||AJS.$.trim(m.$field.val());q=m.model.getDescriptor(p);if(!q&&m.$container.hasClass("aui-ss-editing")){o=h(p);if(o.isError){m.options.errorMessage=o.message;m.showErrorMessage(p)}else{m.hideErrorMessage()}}}function e(){AJS.$(m.$field[0].form).submit()}function g(){m._super(n);c=m.handleFreeInput;m.handleFreeInput=l}}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(f){var n={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var j=10;var b=f.element;var l,o;var u=b.data("saved-state"),t=b.data("saved-id");var h,q=this;var e=AJS.SelectSuggestHandler.extend({formatSuggestions:function(x,y){x=this._super(x,y);if(y.length===0){x[x.length-1].footerText("Start typing for sprints.")}return x}});AJS.$.extend(f,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:j,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:v,error:s}});p();function i(y){var x=l.apply(this,arguments);x.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(y.properties));return x}function w(z){var y=this.getSelectedDescriptor(),x;if(!z&&!y){c(null)}k();this.hideErrorMessage();if(!y){x=d(z)}else{x=r(y)}if(x.message){this.options.errorMessage=x.message;o.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(x.needsScopeChangeWarning){m()}}function d(z){var y=null,x=false;if(z&&z.length>0){if(u){y=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",z);if(u===n.ACTIVE){x=true}}else{y=AJS.format("{0} is not a valid sprint name.",z)}}else{if(u===n.ACTIVE){x=true}}return{message:y,needsScopeChangeWarning:x}}function r(y){var x=false;if(u===n.ACTIVE){if(t!=y.properties.value){x=true}}else{if(u===n.FUTURE){if(y.properties.stateKey===n.ACTIVE){x=true}}else{if(!u){if(y.properties.stateKey===n.ACTIVE){x=true}}}}return{message:null,needsScopeChangeWarning:x}}function m(){if(!h){h=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var x=q.$container.closest(".inline-edit-fields");if(x.size()>0){x.closest(".editable-field").append(h)}else{q.$container.closest(".field-group").append(h)}}h.show()}function k(){if(h){h.remove();h=null}}function v(x){if(!x.suggestions&&!x.allMatches){return[]}var z=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var y=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(x.suggestions),function(A){z.addItem(g(A,true))});_.each(a(x.allMatches),function(A){y.addItem(g(A,false))});return[z,y]}function g(z,y){var x=AJS.escapeHTML(String(z.name));return new AJS.ItemDescriptor({value:z.id.toString(),label:z.name,html:x,stateKey:z.stateKey,boardName:z.boardName,allowDuplicate:false,isSuggestion:y})}function a(x){return _.sortBy(x,function(y){return y.name.toLowerCase()})}function c(x){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:t,updated:x?x.properties.value:null}})}}function p(){q._super(f);l=q.listController._renders.suggestion;o=q.showErrorMessage;q.listController._renders.suggestion=i;q.showErrorMessage=w;b.bind("selected",function(z,y,x){x.showErrorMessage(x.getQueryVal());c(y)});q.suggestionsHandler=new e(q.options,q.model)}function s(y,A,z){var x=AJS.$(b);x.siblings(".ghx-error").remove();x.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+z),type:"error",className:"ghx-error aui-ss"}))}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintMultiselect.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,d){function c(e){var h=new AJS.GroupDescriptor({weight:0,label:"Suggestions",items:_.map(e.suggestions,b)});var g=new AJS.GroupDescriptor({weight:1,label:"All sprints",items:_.map(e.allMatches,b)});return[h,g]}function b(g){g.date=moment(g.date,"YYYY-MM-DDTHH:mm:ssZ").format("LL");var e=GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta(g);return new AJS.ItemDescriptor({value:g.id,label:g.name,html:e,title:GH.tpl.customfields.sprintmultiselect.renderTooltip(g),date:g.date,boardName:g.boardName,stateKey:g.stateKey,highlighted:true,allowDuplicate:false})}function a(e){return _.sortBy(e,"id")}AJS.$(".js-sprint-checkboxmultiselect",d).each(function(){var e=new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"ajax",removeOnUnSelect:true,ajaxOptions:{url:AJS.contextPath()+"/rest/greenhopper/1.0/sprint/picker",error:function(){e._setSuggestions([])},data:{excludeCompleted:false},query:true,formatResponse:c},suggestionsHandler:GH.SprintSuggestHandler})})});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintMultiselect.soy' */
// This file was automatically generated from SprintMultiselect.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintmultiselect == 'undefined') { GH.tpl.customfields.sprintmultiselect = {}; }


GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml(opt_data.name), '</div><div><span class=\'ghx-sprint-multiselect-meta\'> ');
  if (opt_data.boardName) {
    GH.tpl.customfields.sprintmultiselect.renderMetaWithBoardName(opt_data, output);
  } else {
    GH.tpl.customfields.sprintmultiselect.renderMetaWithoutBoardName(opt_data, output);
  }
  output.append('</span></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future") : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml("Closed") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active \xb7 {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future \xb7 {0}",opt_data.boardName)) : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml(AJS.format("Closed \xb7 {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Started on {0}",opt_data.date)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future") : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml(AJS.format("Closed on {0}",opt_data.date)) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintSuggestHandler.js' */
define("includes/js/field/sprint-suggest-handler",["jira/ajs/select/suggestions/checkbox-multi-select-suggest-handler"],function(a){return a.extend({formatSuggestions:function(c,d){var b=this.model.getDisplayableSelectedDescriptors();prepareSelectedDescriptors(b);var e=function(f){var g;for(g in b){if(b[g].properties.value===f.properties.value.toString()){return false}}return true};c=_.map(c,function(g){var f=_.filter(g.properties.items,e);g.properties.items=f;return g});return this._super(c,d)}})});function prepareSelectedDescriptors(a){_.each(a,function(c){var b=JSON.parse(c.properties.meta);b.date=moment(b.date).format("LL");c.properties.title=GH.tpl.customfields.sprintmultiselect.renderTooltip(b);c.properties.html=GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta(b)})}AJS.namespace("GH.SprintSuggestHandler",null,require("includes/js/field/sprint-suggest-handler"));;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicLinkMultiselect.js' */
require(["require"],function(c){var d=c("jquery");var b=c("underscore");function e(f){if(f.indexOf("project")!==0){return""}return a(f).trim()}function a(f){function g(i){var j=i.match(/\bproject\s*=\s*(\S+)/i);return j?j[1]:null}function h(i){var j=i.match(/\bproject\s+in\s+\((.*?)\)/i);return j?j[1]:null}return g(f)||h(f)}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f){var g=d("#jql",this).val();f.find(".js-epiclink-checkboxmultiselect").each(function(){var i=new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"ajax",removeOnUnSelect:true,ajaxOptions:{url:AJS.contextPath()+"/rest/greenhopper/1.0/epics",error:function(){i._setSuggestions([])},data:{searchQuery:e(g),projectKey:null,maxResults:100},query:true,minQueryLength:0,formatResponse:function(j){return[new AJS.GroupDescriptor({weight:1,items:[new AJS.ItemDescriptor({highlighted:true,label:"No Epic Link",value:"EMPTY",title:"EMPTY"})]}),new AJS.GroupDescriptor({items:b.map(j.epicNames,function(k){return new AJS.ItemDescriptor({highlighted:true,label:k.name+" - ("+k.key+")",value:k.key,title:k.key})}),label:"Suggestions",weight:0})]}},suggestionsHandler:GH.EpicLinkSuggestHandler})})})});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicLinkSuggestHandler.js' */
define("includes/js/field/epic-link-suggest-handler",["jira/ajs/select/suggestions/checkbox-multi-select-suggest-handler"],function(a){return a.extend({formatSuggestions:function(c,e){var b=this.model.getDisplayableSelectedDescriptors();var d=function(f){var g;for(g in b){if(b[g].properties.value===f.properties.value.toString()){return false}}return true};c=_.map(c,function(g){var f=_.filter(g.properties.items,d);g.properties.items=f;return g});return this._super(c,e)}})});AJS.namespace("GH.EpicLinkSuggestHandler",null,require("includes/js/field/epic-link-suggest-handler"));;
;/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.js' */
;
;/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.soy' */
;
;/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplates.soy' */
// This file was automatically generated from ProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.kanbanInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.kanbanInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to optimize the flow of work in your development project. Add constraints to work-in-progress, analyze how long it takes to complete issues, find bottlenecks in your process, and more. This project includes a Kanban board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'kanban-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.scrumInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to manage your Agile development work. Create a backlog, organise work into sprints, check progress using reports, and more. This project includes a Scrum board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'scrum-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.softwareDevelopmentInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to work on new features for your product and also track any bugs. This project provides you with a basic workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'basic-development-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.infoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list ', soy.$$escapeHtml(opt_data.issueTypeListClass), '"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-info ', soy.$$escapeHtml(opt_data.workflowScreenshotClass), '"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplatesJira7.soy' */
// This file was automatically generated from ProjectTemplatesJira7.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to optimize the flow of work in your development project. Add constraints to work-in-progress, analyze how long it takes to complete issues, find bottlenecks in your process, and more. This project includes a Kanban board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'kanban-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to manage your Agile development work. Create a backlog, organise work into sprints, check progress using reports, and more. This project includes a Scrum board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'scrum-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to work on new features for your product and also track any bugs. This project provides you with a basic workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'basic-development-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.templateInfoDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="top-panel"><p>', soy.$$escapeHtml(opt_data.description), '</p></div><div class="left-panel"><h6>', soy.$$escapeHtml("Issue Types"), '</h6><ul class="project-template-issuetype-list" ><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-panel"><h6>', soy.$$escapeHtml("workflow"), '</h6><div class="workflow ', soy.$$escapeHtml(opt_data.workflowScreenshotClass), '"></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:bamboo-soy-resources', location = 'templates/plugins/bamboo/components.soy' */
// This file was automatically generated from components.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.components == 'undefined') { bamboo.components = {}; }


bamboo.components.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (opt_data.headerImageContent) {
    aui.page.pageHeaderImage({content: opt_data.headerImageContent}, param3);
  }
  aui.page.pageHeaderMain({content: opt_data.headerMainContent}, param3);
  if (opt_data.headerActionsContent) {
    aui.page.pageHeaderActions({content: opt_data.headerActionsContent}, param3);
  }
  aui.page.pageHeader({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bamboo-icon bamboo-icon-', soy.$$escapeHtml(opt_data.type), '"', (opt_data.text && opt_data.showTitle) ? ' title="' + soy.$$escapeHtml(opt_data.text) + '"' : '', '>', (opt_data.text) ? '<span>' + soy.$$escapeHtml(opt_data.text) + '</span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.buildDetail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt class="', soy.$$escapeHtml(opt_data.keyClass), '">', soy.$$escapeHtml(opt_data.key), '</dt><dd>', opt_data.value, '</dd></dl>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifacts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="shared-artifacts">');
  var artifactList42 = opt_data.artifacts;
  var artifactListLen42 = artifactList42.length;
  for (var artifactIndex42 = 0; artifactIndex42 < artifactListLen42; artifactIndex42++) {
    var artifactData42 = artifactList42[artifactIndex42];
    bamboo.components.artifactItem(soy.$$augmentData(artifactData42, {id: artifactData42.name, url: artifactData42.link.href}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifactItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li>');
  bamboo.components.icon({type: 'artifact-shared'}, output);
  output.append(' <a class="artifact-link" id="artifact-', soy.$$escapeHtml(opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</a><span class="filesize">(', soy.$$escapeHtml(opt_data.prettySizeDescription), ')</span></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="labels">');
  var labelList65 = opt_data.labels;
  var labelListLen65 = labelList65.length;
  for (var labelIndex65 = 0; labelIndex65 < labelListLen65; labelIndex65++) {
    var labelData65 = labelList65[labelIndex65];
    bamboo.components.labelItem(soy.$$augmentData(labelData65, {url: opt_data.baseBambooUrl + '/browse/label/' + labelData65.name}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labelItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="lozenge" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '"><span>', soy.$$escapeHtml(opt_data.name), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.errorResponseMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  bamboo.components.auiWarning({body: (opt_data.errorMessage.messageBody) ? '<p>' + soy.$$escapeHtml(opt_data.errorMessage.messageBody) + '</p>' : (opt_data.errorMessage.oauthCallback) ? '<p><a href="' + opt_data.errorMessage.oauthCallback + '&amp;redirectUrl=' + opt_data.oAuthDanceReturnUrl + '">' + soy.$$escapeHtml("Log in \x26 approve") + '</a></p>' : '<p>' + soy.$$escapeHtml(opt_data.errorMessage.message) + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.auiWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning"><span class="aui-icon icon-warning"></span>', opt_data.body, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'path.js' */
(function(a){a.basename=function(b){return b.split(/\//).pop()};a.dirname=function(b){var c=JIRA.AttachImagesPlugin.basename(b);return b.substring(0,b.length-c.length)}})(AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'resource-uris.js' */
(function(a){var b=null,c="com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources.resource-uris";a.resourceUris={_resetForTesting:function(){b=null},get:function(d){if(b===null){b=WRM.data.claim(c)||{}}return b[d]}}})(AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'templates/soy/attach-screenshot-form.soy' */
// This file was automatically generated from attach-screenshot-form.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Html5Screenshot == 'undefined') { JIRA.Templates.Html5Screenshot = {}; }


JIRA.Templates.Html5Screenshot.attachScreenshotForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2 class="dialog-title">', soy.$$escapeHtml("Attach Screenshot"), '</h2><form action="ShowAttachScreenshotFormAction.jspa" class="aui" method="post" id="attach-screenshot-form" data-attach-secure-token="', soy.$$escapeHtml(opt_data.attachUserToken), '" data-submit-secure-token="', soy.$$escapeHtml(opt_data.submitUserToken), '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.id), '"/><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '"><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '"><input type="hidden" name="filetoconvert" value=""><div class="attach-screenshot-padding"><div class="attach-screenshot-container"><div id="attach-screenshot-inner-container"><div class="mod-content"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Take a screenshot:"), '</dt>', (opt_data.userPlatform == 'pc') ? '<dd>' + "\x3ckbd\x3ePrtScn\x3c/kbd\x3e" + '</dd>' : '<dd>' + "\x3ckbd\x3e\x26#8963; Ctrl\x3c/kbd\x3e + \x3ckbd\x3e\x26#8984; Cmd\x3c/kbd\x3e + \x3ckbd\x3e\x26#8679; Shift\x3c/kbd\x3e + \x3ckbd\x3e3\x3c/kbd\x3e" + '</dd>', '</dl></li><li><dl><dt>', soy.$$escapeHtml("Paste the image:"), '</dt>', (opt_data.userPlatform == 'pc') ? '<dd>' + "\x3ckbd\x3eCtrl\x3c/kbd\x3e + \x3ckbd\x3ev\x3c/kbd\x3e" + '</dd>' : '<dd>' + "\x3ckbd\x3e\x26#8984; Cmd\x3c/kbd\x3e + \x3ckbd\x3ev\x3c/kbd\x3e" + '</dd>', '</dl></li></ul></div><input type="text" id="attach-screenshot-fake-input"><div class="attach-screenshot-padding attach-screenshot-padding-inner"><div id="attach-screenshot-image-container" class="attach-screenshot-image-container"><div class="attach-screenshot-placeholder"><div class="mod-content"><ul class="item-details"><li><dl><dt id="attach-screenshot-placeholder-message">', soy.$$escapeHtml("Your image will be pasted here"), '</dt></dl></li></ul></div></div></div></div><div id=\'attach-max-size\' class="hidden">', soy.$$escapeHtml(opt_data.maxSize), '</div></div></div></div><fieldset><div><legend><span>', soy.$$escapeHtml("Attach Screenshot"), '</span></legend><div id="attach-screenshot-filename-group" class="field-group"><div id="attach-screenshot-progress-container"></div><label for="attachscreenshotname">', soy.$$escapeHtml("File name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("Required"), '</span></label><input class="text" type="text" id="attachscreenshotname" name="attachscreenshotname" title="File Name" value="', soy.$$escapeHtml(opt_data.nextScreenshotName), '"><div class="description">', soy.$$escapeHtml("A file name to be used as attached image name"), '</div></div></div></fieldset><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-primary" id="attach-screenshot-html5-upload">', soy.$$escapeHtml("Upload"), '</button><a href="#" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'base64decode.js' */
(function(a){function b(c){return c>64&&c<91?c-65:c>96&&c<123?c-71:c>47&&c<58?c+4:c===43?62:c===47?63:0}a.base64decode=function(e){var l=e.replace(/[^A-Za-z0-9\+\/]/g,""),f=l.length,c=f*3+1>>2,j=new Uint8Array(c);for(var i,g,h=0,d=0,k=0;k<f;k++){g=k&3;h|=b(l.charCodeAt(k))<<18-6*g;if(g===3||f-k===1){for(i=0;i<3&&d<c;i++,d++){j[d]=h>>>(16>>>i&24)&255}h=0}}return j}})(AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'utility.js' */
(function(b,a){a.isKeyPasteEvent=function(f,c){var d=86,e=(c||navigator.platform).indexOf("Mac")!==-1;return f.which===d&&(e?f.metaKey:f.ctrlKey)};a.isImagePasteEvent=function(c){if(c&&c.clipboardData){return _.union(_.toArray(c.clipboardData.items),_.toArray(c.clipboardData.files)).some(function(d){return d.type.indexOf("image")!==-1})}};a.isHtmlImagePasteEvent=function(c){return a.getHtmlImagePaste(c)!=null};a.isTextPasteEvent=function(c){return c.clipboardData.types&&(_.contains(c.clipboardData.types,"text/plain")||_.contains(c.clipboardData.types,"text/html"))};a.isContentEditable=function(c){return c.contentEditable=="true"||c.contentEditable==""||(c.contentEditable=="inherit"&&b(c).parents().is("[contenteditable=true]"))};a.isValidFileName=function(c){return !_(["\\","/",'"',":","?","*","<","|",">","!"]).any(function(d){return c.indexOf(d)>-1})};a.getHtmlImagePaste=function(c){if(!c.clipboardData||!c.clipboardData.types||!_.contains(c.clipboardData.types,"text/html")){return}var d=c.clipboardData.getData("text/html");return(d.match(/^(?:|<meta (?:[^>]+)>)<img src="([^"]+)"(?:[^/^>]+)(?:[^>]+)(?:|\/)>(?:|.)$/)||[])[1]};a.getTextPasteContent=function(c){return c.clipboardData.types&&_.contains(c.clipboardData.types,"text/plain")&&c.clipboardData.getData("text/plain")||""};a.normalizePasteEvent=function(c){if(c&&c.originalEvent&&c.originalEvent.clipboardData){c.clipboardData=c.originalEvent.clipboardData}if(c&&!c.clipboardData&&window.clipboardData){c.clipboardData={files:window.clipboardData.files,types:{contains:function(d){if(d=="text/plain"){return !!window.clipboardData.getData("Text")}}},getData:function(d){if(d=="text/plain"){return window.clipboardData.getData("Text")}}}}return c};a.browserIsSupported=function(c){var e=document.documentElement.className.split(/\s+/),f=(c||navigator.platform).indexOf("Mac")!==-1,d=b.inArray("safari",e)!==-1;return !(f&&d)};a.insertWikiMarkup=function(g,d,e,f){var c="!"+g+".png!";a.insertToInput(c,d,e,f)};a.insertToInput=function(d,c,e,f){if(!b(c).is(":input")){return}b(c).one("focus",function(){var h=b(c).val();var g=h.substring(0,e);var i=h.substring(f,h.length);b(c).val(g+d+i);b(c).trigger("input");c.selectionStart=c.selectionEnd=e+d.length;var j=b(c).data("wikiEditor");if(j&&j.undoRedoEl&&_.isFunction(j.undoRedoEl.recordHistoryItem)){j.undoRedoEl.recordHistoryItem()}})};a.loadImage=function(e){var c=new b.Deferred();var d=new Image();d.setAttribute("crossOrigin","anonymous");d.onload=function(){c.resolve(d)};d.onerror=c.reject.bind(c);d.src=e;if(d.width>0&&d.height>0){c.resolve(d)}return c};a.convertImageToBlob=function(f){var c=b("<canvas>").attr("width",f.width).attr("height",f.height)[0];c.getContext("2d").drawImage(f,0,0);try{if(c.mozGetAsFile){return c.mozGetAsFile("image/png")}if(c.toDataURL){return new Blob([a.handler.decodeBase64DataUri(c.toDataURL("image/png"))],{type:"image/png"})}}catch(d){return null}}})(jQuery,AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'requireDeployJava.js' */
(function(c,b){var a=null;b.requireDeployJava=function(){var d;if(a!==null){return a}d=c.Deferred();a=d.promise();c('<iframe style="display: none !important; visibility: hidden !important; opacity: 0"/>').attr("src",b.resourceUris.get("deployJava.html")).one("load",function(){d.resolve(this.contentWindow.deployJava,this.contentWindow)}).one("error",d.reject.bind(d)).appendTo("body");return a};b.requireDeployJava._resetForTesting=function(){a=null}})(AJS.$,AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'polyfill.js' */
(function(f,b,c){var g,e,h,d;function a(){var i=f.Deferred();return i.reject.apply(i,arguments)}(function(){var k=document.documentElement.className.split(/\s+/),m=f.inArray("msie",k)>-1,n=f.inArray("msie-gt-7",k)>-1,l=f.inArray("msie-gt-8",k)>-1,j=f.inArray("msie-gt-9",k)>-1,i=f.inArray("msie-gt-10",k)>-1;g=m&&n&&!l;e=m&&l&&!j;h=m&&j&&!i})();c.polyfill=new (function(){var j;var k=b.bind(function(n){if(c.isKeyPasteEvent(n)){d.reload();var m=d.getClipboardData();if(m){var l=d.getClipboardData(this.pasteImageWidth,this.pasteImageHeight);if(l.length>this.dataURILimit){var o=this.dataURILimit/l.length;l=d.getClipboardData(this.pasteImageWidth*o,this.pasteImageHeight*o)}j.trigger("polyPaste",[m,l])}}},this);this.install=b.once(function(l){j=f(l);return c.requireDeployJava().pipe(function(p,m){var o,s,n,q="1.7.0_06",r;if(p.getJREs().length===0){return a("java-absent")}else{if(!p.versionCheck(q+"+")){return a("java-version")}}n=!p.versionCheck("1.7.0_45+");r=c.resourceUris.get(n?"clipboard-legacy.jar":"clipboard.jar");o={id:"JIRA HTML5 Images Applet",codebase:c.dirname(r),code:"com.atlassian.plugins.jira.screenshot.applet.ScreenshotApplet.class",archive:c.basename(r),width:0,height:0};s={permissions:"all-permissions"};p.runApplet(o,s,q);d=m.document.getElementById(o.id);try{if(!d||!d.isSecurityOk()){return a("java-security")}}catch(t){return a("java-security")}j.on("keydown",k);return i},function(){return a("unknown")}).pipe(null,function(n){var m;if(n==="unknown"){m="A problem occurred while running Java."}else{if(n==="java-version"){m=AJS.format("You need to {0}upgrade Java{1}.",'<a href="//java.com">',"</a>")}else{if(n==="java-absent"){m=AJS.format("You need to install {0}Java{1}.",'<a href="//java.com">',"</a>")}else{if(n==="java-security"){m=AJS.format("Your Java security settings are blocking this feature. Please upgrade to the latest {0}Java{1}.",'<a href="//java.com">',"</a>")}}}}return a(n,m)})});this.isRequired=function(){return g||e||h};this.isRequiredForBinaryAjax=function(){return g||e};this.pasteImageWidth=510;this.pasteImageHeight=280;this.dataURILimit=g?32000:Number.MAX_VALUE;function i(p,n){var o=document.cookies,l=f.Deferred();var q={getResponseHeader:function(r){return responseHeaders[r]}};var m=new f.Deferred().progress(b.bind(l.notify,l)).done(b.bind(l.resolve,l)).fail(function(t,r){var s=r||JSON.stringify({errorMessage:s});l.reject(null,null,null,new JIRA.SmartAjax.SmartAjaxResult(q,0,"error",s,true))});d.doMultipartRequest(n,"UTF-8",window.navigator.userAgent,m);l.always(function(){document.cookies=o});return l}this.proxyAjaxRequest=function(l,m){return function(){var n=JIRA.SmartAjax.makeRequest;JIRA.SmartAjax.makeRequest=function(o){var p=b.reduce(b.keys(o.data),function(t,s){t.push(s,o.data[s]);return t},[]);p.push("secureToken",m());var q=d.doAjaxRequest(o.url,"UTF-8",window.navigator.userAgent,f.Deferred(),p);q.abort=f.noop;q.then(function(t){var s=b.filter(arguments,function(x,w){return w>0});s[0]="Status";s=b.reduce(b.reduce(s,function(z,y,w){var x=(w/2)<<0;(z[x]||(z[x]=[])).push(y);return z},[]),function(x,w){x[w[0]]=w[1];return x},{});var u={getResponseHeader:function(w){return s[w]}};var v="success";var r=new JIRA.SmartAjax.SmartAjaxResult(u,0,"success",t,true);o.complete(u,v,r)});return q};l.apply(this,arguments);JIRA.SmartAjax.makeRequest=n}}})})(AJS.$,_,AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'html5.js' */
AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.handler=(function(e,b,d){var a;a={REQUEST_TIMEOUT_MILLIS:5*60*1000,screenshotFileUpload:{},screenshotFileUploadUri:null,$document:undefined,$window:undefined,$container:undefined,$fakeInput:undefined,uploadError:false,uploadErrorMsg:"",progressView:{hidden:false,progress:0,old:0,progressBarContainer:undefined,progressEl:undefined,container:undefined,options:undefined,staticProgress:undefined,initProgress:function(){this.container=this.buildContainer();this.progressEl=this.buildProgress();this.container.append(this.progressEl);this.options={showPercentage:false,height:"5px"};this.progressBarContainer=e("#attach-screenshot-progress-container");this.progressBarContainer.empty();this.progressBarContainer.append(this.container);this.staticProgress=this.container;this.hidden=true},finish:function(){this.value(100)},progressHandler:function(g){var f=Math.round(g.loaded*100/g.total);a.progressView.value(f)},value:function(f){if(f>100){f=100}else{if(f<0){f=0}}if(this.hidden){this.progressEl.show();this.hidden=false}if(this.old!==f){this.progressEl.progressBar(f,this.options);if(f>=100){this.progressEl.fadeOut()}this.old=f}},buildContainer:function(){return e("<div>").addClass("file-progress")},buildProgress:function(){return e("<div>").attr("id","attach-screenshot-upload-progress")}},dialogView:{pasteCatcher:{},presenter:undefined,getMaxSize:function(){return e("#attach-max-size").text()},getFileSize:function(){if(e.isPlainObject(this.presenter.screenshotFileUpload)&&b.isEmpty(this.presenter.screenshotFileUpload)){return 0}return this.presenter.screenshotFileUpload.size||this.presenter.screenshotFileUpload.byteLength||this.presenter.screenshotFileUpload.length},cleanGeneralErrors:function(){e("#error-attach-screenshot-image").closest(".field-group").remove()},cleanFileErrors:function(){e("#error-attach-screenshot-filename").remove()},displayErrors:function(f){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if("compatibility" in f){e("#attach-screenshot-inner-container").before(aui.message.error({content:f.compatibility}))}if("fileName" in f){e("#attach-screenshot-filename-group").append('<div class="error" id="error-attach-screenshot-filename" data-field="attachscreenshotname"></div>').find(".error").text(f.fileName)}if("fileUpload" in f){e("#attach-screenshot-inner-container").append('<div class="field-group attach-screenshot-image-error"><div class="error" id="error-attach-screenshot-image"></div></div>').find(".error").text(f.fileUpload)}},appendBlobImage:function(f){var h=window.URL||window.webkitURL;var g=h.createObjectURL(f);this.presenter.screenshotFileUpload=f;this.createImage(g)},createImage:function(i){var g=new Image();g.onload=function(){};g.src=i;this.presenter.screenshotToUpload=g;var h=e(g);h.addClass("attach-screenshot-pasted-image");var f=e("#attach-screenshot-image-container");f.empty();f.append(h);this.presenter.$fakeInput.focus();b.defer(function(){a.imageCreatedHandler()})},checkInput:function(){var g,f=a.dialogView.pasteCatcher.childNodes[0];if(f){if("IMG"===f.tagName){if(f.src.startsWith("data:")){g=f.src}else{}}a.dialogView.pasteCatcher.innerHTML=""}if(!g){a.$fakeInput.focus()}return g},onPaste:function(f){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if(d.isImagePasteEvent(f)){a.getFileFromEvent(f).then(function(g){this.appendBlobImage(g)}.bind(this))}else{setTimeout(function(){var g=this.checkInput();if(g){a.screenshotFileUpload=a.decodeBase64DataUri(g);a.dialogView.createImage(g)}}.bind(this),0)}},getFakeInput:function(){return e("#attach-screenshot-fake-input")},getContainer:function(){return e("#attach-screenshot-image-container")},getIssueKey:function(){return e("input[name='id']").val()},getDocument:function(){return e(document)},getWindow:function(){return e(window)},getFileNameInput:function(){return e("#attachscreenshotname")},hasPngExtension:function(g){var f=/\.png$/i;return f.test(g)},setFileToConvert:function(f){e("input[name='filetoconvert']").val(f)},buildPasteCatcher:function(){if(!document.getElementById("attach-screenshot-form")){return}var f=document.createElement("div");f.setAttribute("contenteditable","true");f.style.width=0;f.style.height=0;f.style.position="absolute";f.style.top="-5000px";document.getElementById("attach-screenshot-form").appendChild(f);return f},_getFormSubmits:function(){return e("#attach-screenshot-form").find("button.aui-button")},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},isEnabled:function(){return this.isVisible()&&!this._getFormSubmits().attr("disabled")},isVisible:function(){return e("#attach-screenshot-form").length>0},initDialog:function(f){this.pasteCatcher={};this.presenter=f;if(!d.polyfill.isRequired()){this.pasteCatcher=this.buildPasteCatcher()}}},initScreenshotPasteHandler:function(){var f=a.dialogView;a.screenshotFileUpload={};a.resetUploadErrors();a.dialogView.initDialog(a.getPresenter());a.$document=f.getDocument();a.$window=f.getWindow();a.$container=f.getContainer();a.$fakeInput=f.getFakeInput();a.bindOnce(a.$container,"click",a.setFocusOnClickHandler);a.bindOnce(a.$fakeInput,"focus",a.showFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"blur",a.hideFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"keydown",a.keyDownHandler);if(!d.browserIsSupported()){f.displayErrors({compatibility:AJS.format("Your browser is not supported. Consider using an alternative supported browser such as {0}Google Chrome{1} or {2}Firefox{3}.",'<a href="//www.google.com/chrome/browser/">',"</a>",'<a href="//www.mozilla.org/firefox/">',"</a>")})}else{if(d.polyfill.isRequired()){d.polyfill.install(document).done(function(g){a.bindOnce(a.$document,"polyPaste",a.polyPasteHandler);if(d.polyfill.isRequiredForBinaryAjax()){a.executeAjaxUpload=g}}).fail(function(h,g){f.displayErrors({compatibility:g})})}else{a.bindOnce(a.$window,"paste",a.pasteHandler)}}},resetUploadErrors:function(){a.uploadError=false;a.uploadErrorMsg=undefined},setUploadError:function(f){a.uploadError=true;a.uploadErrorMsg=f},bindOnce:function(h,f,g){h.unbind(f,g);h.bind(f,g)},showFocusOnFieldHandler:function(){a.$container.addClass("focus")},hideFocusOnFieldHandler:function(){a.$container.addClass("focus")},setFocusOnClickHandler:function(){a.$fakeInput.focus()},pasteHandler:function(f){f=d.normalizePasteEvent(f);if(!a.dialogView.isEnabled()){return}a.dialogView.onPaste(f)},polyPasteHandler:function(g,f,h){if(!a.dialogView.isEnabled()){return}a.screenshotFileUpload={length:-1};a.screenshotFileUploadUri=f;a.dialogView.createImage(h)},keyDownHandler:function(f){if(d.isKeyPasteEvent(f)){if(a.dialogView.pasteCatcher.focus){a.dialogView.pasteCatcher.focus()}}},getPresenter:function(){return a},imageCreatedHandler:function(){a.doAjaxUpload(this.dialogView.getIssueKey(),this.dialogView.getFileNameInput().val())},getMimeType:function(){if(a.screenshotFileUploadUri){return"image/jpeg"}return"image/png"},createData:function(){if(d.polyfill.isRequired()&&!d.polyfill.isRequiredForBinaryAjax()){return this.decodeBase64DataUri(a.screenshotFileUploadUri)}return a.screenshotFileUpload},decodeBase64DataUri:function(g){var i=";base64,",h=g.slice(0,g.indexOf(i))+i,f=g.substring(h.length);return d.base64decode(f)},getFileFromEvent:function(g){var f=new e.Deferred();if(d.isImagePasteEvent(g)){f.resolve(b(g.clipboardData.items).filter(function(h){return h.type.indexOf("image")!==-1}).map(function(h){return h.getAsFile()})[0]||b(g.clipboardData.files).filter(function(h){return h.type.indexOf("image")!==-1})[0])}else{f.reject()}return f.promise()},clipboardDataIsEmpty:function(f){if(window.clipboardData!=null){return false}return !(f&&f.clipboardData&&f.clipboardData.types&&f.clipboardData.types.length>0)},validateFileSize:function(i){var f=a.dialogView.getFileSize();var h=a.dialogView.getMaxSize();if(f>h){var g=AJS.InlineAttach.Text.fileSize(h,f);i.fileUpload=AJS.format("Screenshot is too large to attach. Attachment is {0} but the largest allowed attachment is {1}.",g[1],g[0])}},validateFormData:function(f,h){var g={};if(e.isPlainObject(f)&&b.isEmpty(f)){g.fileUpload="Please paste the image you wish to upload"}a.validateFileSize(g);if(a.uploadError){g.fileUpload="The error occurred during image upload - you will need to try the pasting image again. Sorry for the inconvenience."}if(""==h){g.fileName="You must specify a filename of the image."}if(!d.isValidFileName(h)){g.fileName="Filename must not contain the characters \'\\\', \'/\', \'\"\', \':\', \'?\', \'*\', \'\u003c\', \'|\', \'\u003e\', \'!\'"}return g},doAjaxUpload:function(f,m){a.dialogView.disable();var l={};a.validateFileSize(l);if(!b.isEmpty(l)){a.dialogView.displayErrors(l);a.dialogView.enable();return}var j=a.createData(),k=a.getMimeType(),h=e("#attach-screenshot-form").data("attach-secure-token"),g=e("#attach-screenshot-form").find("input[name='formToken']").attr("value");var i=AJS.contextPath()+"/rest/internal/1.0/AttachTemporaryFile"+(d.polyfill.isRequired()?"/secure?":"?")+"size="+this.dialogView.getFileSize()+"&filename="+encodeURIComponent(m)+"&atl_token="+encodeURIComponent(atl_token())+"&issueId="+encodeURIComponent(this.dialogView.getIssueKey())+(h?("&secureToken="+encodeURIComponent(h)):"")+(g?("&formToken="+encodeURIComponent(g)):"");a.resetUploadErrors();a.executeAjaxUpload(j,i,k).progress(function(n){if(n=="init"){a.progressView.initProgress()}}).done(function(n){if(typeof n=="string"){n=JSON.parse(n)}a.dialogView.setFileToConvert(n.id)}).fail(function(p,s,r,n){var o;if(n.statusText=="abort"){o="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."}else{if(n.hasData){var q=JSON.parse(n.data);if(q.errorMessage){o=q.errorMessage}else{o=JIRA.SmartAjax.buildSimpleErrorContent(n,{alert:false})}}}a.setUploadError(o);a.dialogView.displayErrors({fileUpload:o})}).always(function(){var n=e.Deferred();if(d.polyfill.isRequired()){a.reloadSecureToken(n)}else{n.resolve()}n.then(function(){a.dialogView.enable();a.progressView.finish()})}).progress(function(n){if(n!="init"){a.progressView.progressHandler(n)}})},executeAjaxUpload:function(h,g,j){var f=e.Deferred();var i=JIRA.SmartAjax.makeRequest({type:"POST",url:g,contentType:j,processData:false,data:h,timeout:a.REQUEST_TIMEOUT_MILLIS,success:f.resolve.bind(f),error:f.reject.bind(f),xhr:function(){var k=e.ajaxSettings.xhr();f.notify("init");k.upload.addEventListener("progress",f.notify.bind(f));return k}});f.always(function(){e.ajaxSettings.xhr().removeEventListener("progress",a.progressView.progressHandler);e(JIRA.Dialogs.attachScreenshotDialog).off("Dialog.hide",i.abort)});e(JIRA.Dialogs.attachScreenshotDialog).one("Dialog.hide",i.abort);return f.promise()},reloadSecureToken:function(f){var g=AJS.contextPath()+"/secure/ShowAttachScreenshotFormAction!default.jspa?id="+encodeURIComponent(this.dialogView.getIssueKey())+"&inline=true&decorator=dialog&_="+(new Date().getTime());e.get(g).then(function(h){var i=e(h).find("#attach-screenshot-form").data("attach-secure-token");if(i){e("#attach-screenshot-form").data("attach-secure-token",i);f.resolve(i)}else{f.reject()}},b.bind(f.reject,f))},show:function(){var f=new e.Deferred();var g=e(".issueaction-attach-screenshot-html5.aui-list-item-link");if(JIRA.Dialog.current!=null){return f.reject().promise()}if(g.length==0){return f.reject().promise()}b.defer(function(){g.trigger("click")});e(document).on("dialogContentReady",function(i,h){if(h===JIRA.Dialogs.attachScreenshotDialog&&a.dialogView.isEnabled()){f.resolve(h)}else{f.reject()}});e(document).on("ajaxComplete.jira.screenshot.dialog",function(j,i,h){if(h.url.indexOf(g.attr("href"))>-1){setTimeout(function(){if(!f.isResolved()){f.reject()}},1000)}});f.always(function(){e(document).off("ajaxComplete.jira.screenshot.dialog")});return f.promise()}};var c=JIRA.FormDialog.extend({options:{}});JIRA.ScreenshotDialog=c;e(document).ready(function(){var g=e.Deferred();if(!d.browserIsSupported()||!d.polyfill.isRequired()){g.resolve()}JIRA.Dialogs.attachScreenshotDialog=new c({id:"attach-screenshot-dialog",trigger:"a.issueaction-attach-screenshot-html5",isIssueDialog:true,onContentRefresh:function f(){this.$form.bind("before-submit",function h(i){var j=a.validateFormData(a.screenshotFileUpload,e.trim(a.dialogView.getFileNameInput().val()));if(a.dialogView.getFileSize()==0){i.preventDefault();return false}else{if(!b.isEmpty(j)){a.dialogView.displayErrors(j);i.preventDefault();return false}}return true})},delayShowUntil:function(){if(d.polyfill.isRequired()){d.polyfill.install(document).done(function(){c.prototype._submitForm=d.polyfill.proxyAjaxRequest(c.prototype._submitForm,function(){return e("#attach-screenshot-form").data("submit-secure-token")})}).always(function(){g.resolve()})}return g}});e(document).bind("dialogContentReady",function(i,h){if(h===JIRA.Dialogs.attachScreenshotDialog&&document.getElementById("attach-screenshot-form")!==null){AJS.trigger("analytics",{name:"attach.screenshot.html5.contentReady",data:{}});a.initScreenshotPasteHandler()}});e(document).ready(function(){e(document).on("click","#attach-screenshot-html5",function(){AJS.trigger("analytics",{name:"attach.screenshot.html5.display",data:{}})})})});return a})(AJS.$,_,JIRA.AttachImagesPlugin);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'issue-paste.js' */
(function(c,f,w,g){var v=0;var k=1;var d=2;var t=3;var n=4;var q=5;var i=7;var s=8;var o=9;var m=10;function j(A,z){z.stateName=A;var y=function(){var B=z.apply(null,arguments);B.stateName=A;return B};y.stateName=A;return y}function b(z,y,A){return j(z,function(){var D=setTimeout(function(){a(m)},A);var C=y.apply(null,arguments);var B=function(G,F){var E=C(G,F);if(E){clearTimeout(D);return E}};B.stateName=z;return B})}var l=j("idle",function(){function y(z){if(f(z.target).is(":input:not(.wiki-textfield)")||c.isContentEditable(z.target)){return}return true}return function(A,z){if(w.Dialog.current){return}if(g.DarkFeatures.isEnabled("com.atlassian.plugins.jira.screenshot.issuePasteDisabled")){w.trace("JIRA.AttachImagesPlugin.issuePasteDisabled");return}if(A==v&&c.isKeyPasteEvent(z)){if(f("html").is(".chrome, .safari")||!y(z)||!c.browserIsSupported()){return}g.trigger("analytics",{name:"attach.screenshot.html5.catchClipboard"});return new r(z)}if(A==k){if(c.isImagePasteEvent(z)){g.trigger("analytics",{name:"attach.screenshot.html5.handlePaste"});if(!y(z)){w.trace("JIRA.AttachImagesPlugin.pasteIgnored");return}if(f(z.target).is(":input.wiki-textfield")){z.preventDefault()}return new p(z)}}}});var r=b("catchClipboard",function(A){var y=document.activeElement;A.selectionStart=A.target.selectionStart;A.selectionEnd=A.target.selectionEnd;var B=f('<div contenteditable="true" class="attach-screenshot-paste-catcher"></div>').appendTo("body");B.focus();if(f(y).is(":focusable:input")){setTimeout(function(){y.focus()})}function z(){B.remove()}return function(F,C){if(F==k){if(c.isImagePasteEvent(C)){z();C.target=y;return new p(C)}if(c.isHtmlImagePasteEvent(C)){z();C.target=y;return new u(C)}if(c.isTextPasteEvent(C)){z();var G=c.getTextPasteContent(C);c.insertToInput(G,A.target,A.selectionStart,A.selectionEnd);C.preventDefault();return new l()}}if(F==m){z();var E=B.find(">img");if(E.is(":only-child")){var H=c.handler.decodeBase64DataUri(E.attr("src"));var D=new Blob([H],{type:"image/png"});return new e(D,A)}else{var G=B.text();c.insertToInput(G,A.target,A.selectionStart,A.selectionEnd);return l()}}}});var u=j("imageLoading",function(y){var z=c.getHtmlImagePaste(y);if(!z){a(q)}else{c.loadImage(z).then(function(A){a(n,A)},a.bind(null,q))}return function(C,A){if(C==n){var B=c.convertImageToBlob(A);if(B){return new e(B,y)}else{return new l()}}if(C==m||C==q){return new l()}}});var p=b("fileLoading",function(y){c.handler.getFileFromEvent(y).done(function(z){a(d,z)}).fail(function(){a(t)});return function(A,z){if(A==d){return new e(z,y)}else{if(A==t||A==m){return new l()}}}},1000);var e=b("dialogLoading",function(z,y){y.selectionStart=y.target.selectionStart;y.selectionEnd=y.target.selectionEnd;c.handler.show().done(function(A){a(i,A)}).fail(function(){a(s)});return function(B,A){if(B==i){return new h(z,A,y)}else{if(B==s||B==m){return new l()}}}},20000);var h=b("dialog",function(A,z,y){c.handler.dialogView.appendBlobImage(A);return function(C,B){if(C==o){return new l()}else{if(C==s){var E=B.find("#attachscreenshotname").val();var D=y.target;g.trigger("analytics",{name:"attach.screenshot.html5.dialogClosed"});if(E&&f(D).is(".wiki-textfield")){c.insertWikiMarkup(E,D,y.selectionStart,y.selectionEnd);setTimeout(function(){D.focus()});g.trigger("analytics",{name:"attach.screenshot.html5.insertWikiMarkup",data:{targetId:D.id}})}return new l()}else{if(C==m){if(!w.Dialog.current){return l()}}}}}});var x=new l();function a(z,y){if(a.eventQueue){a.eventQueue.push({type:z,object:y});return}a.eventQueue=[{type:z,object:y}];while(a.eventQueue.length>0){var A=a.eventQueue.splice(0,1)[0];var B=x(A.type,A.object);if(B){x=B}}delete a.eventQueue}f(document).ready(function(){f(window).on("keydown",function(y){a(v,y)});f(window).on("paste",function(y){a(k,c.normalizePasteEvent(y))});w.bind("Dialog.hide",function(y,A,z){if(z){a(o,A)}else{a(s,A)}})});c._getStateMap=function(){return{events:{EVENT_WINDOW_KEYDOWN:v,EVENT_WINDOW_PASTE:k,EVENT_FILE_LOADED:d,EVENT_FILE_LOAD_ERROR:t,EVENT_IMAGE_LOADED:n,EVENT_IMAGE_LOAD_ERROR:q,EVENT_DIALOG_LOADED:i,EVENT_DIALOG_CLOSED:s,EVENT_DIALOG_CANCELED:o,EVENT_TIMEOUT:m},states:{StateIdle:l,StateCatchClipboard:r,StateImageLoading:u,StateFileLoading:p,StateDialogLoading:e,StateDialog:h}}}})(AJS.namespace("JIRA.AttachImagesPlugin"),AJS.$,JIRA,AJS);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'applet/deployJava.js' */
var deployJava=function(){var l={core:["id","class","title","style"],i18n:["lang","dir"],events:["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onkeypress","onkeydown","onkeyup"],applet:["codebase","code","name","archive","object","width","height","alt","align","hspace","vspace"],object:["classid","codebase","codetype","data","type","archive","declare","standby","height","width","usemap","name","tabindex","align","border","hspace","vspace"]};var b=l.object.concat(l.core,l.i18n,l.events);var m=l.applet.concat(l.core);function g(o){if(!d.debug){return}if(console.log){console.log(o)}else{alert(o)}}function k(p,o){if(p==null||p.length==0){return true}var r=p.charAt(p.length-1);if(r!="+"&&r!="*"&&(p.indexOf("_")!=-1&&r!="_")){p=p+"*";r="*"}p=p.substring(0,p.length-1);if(p.length>0){var q=p.charAt(p.length-1);if(q=="."||q=="_"){p=p.substring(0,p.length-1)}}if(r=="*"){return(o.indexOf(p)==0)}else{if(r=="+"){return p<=o}}return false}function e(){var o="//java.com/js/webstart.png";try{return document.location.protocol.indexOf("http")!=-1?o:"http:"+o}catch(p){return"http:"+o}}function n(p){var o="http://java.com/dt-redirect";if(p==null||p.length==0){return o}if(p.charAt(0)=="&"){p=p.substring(1,p.length)}return o+"?"+p}function j(q,p){var o=q.length;for(var r=0;r<o;r++){if(q[r]===p){return true}}return false}function c(o){return j(m,o.toLowerCase())}function i(o){return j(b,o.toLowerCase())}function a(o){if("MSIE"!=deployJava.browserName){return true}if(deployJava.compareVersionToPattern(deployJava.getPlugin().version,["10","0","0"],false,true)){return true}if(o==null){return false}return !k("1.6.0_33+",o)}var d={debug:null,version:"20120801",firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",launchButtonPNG:e(),browserName:null,browserName2:null,getJREs:function(){var t=new Array();if(this.isPluginInstalled()){var r=this.getPlugin();var o=r.jvms;for(var q=0;q<o.getLength();q++){t[q]=o.get(q).version}}else{var p=this.getBrowser();if(p=="MSIE"){if(this.testUsingActiveX("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingActiveX("1.6.0")){t[0]="1.6.0"}else{if(this.testUsingActiveX("1.5.0")){t[0]="1.5.0"}else{if(this.testUsingActiveX("1.4.2")){t[0]="1.4.2"}else{if(this.testForMSVM()){t[0]="1.1"}}}}}}else{if(p=="Netscape Family"){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){t[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes("1.7")){t[0]="1.7.0"}else{if(this.testUsingMimeTypes("1.6")){t[0]="1.6.0"}else{if(this.testUsingMimeTypes("1.5")){t[0]="1.5.0"}else{if(this.testUsingMimeTypes("1.4.2")){t[0]="1.4.2"}else{if(this.browserName2=="Safari"){if(this.testUsingPluginsArray("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingPluginsArray("1.6")){t[0]="1.6.0"}else{if(this.testUsingPluginsArray("1.5")){t[0]="1.5.0"}else{if(this.testUsingPluginsArray("1.4.2")){t[0]="1.4.2"}}}}}}}}}}}}}if(this.debug){for(var q=0;q<t.length;++q){g("[getJREs()] We claim to have detected Java SE "+t[q])}}return t},installJRE:function(r,p){var o=false;if(this.isPluginInstalled()&&this.isAutoInstallEnabled(r)){var q=false;if(this.isCallbackSupported()){q=this.getPlugin().installJRE(r,p)}else{q=this.getPlugin().installJRE(r)}if(q){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return q}else{return this.installLatestJRE()}},isAutoInstallEnabled:function(o){if(!this.isPluginInstalled()){return false}if(typeof o=="undefined"){o=null}return a(o)},isCallbackSupported:function(){return this.isPluginInstalled()&&this.compareVersionToPattern(this.getPlugin().version,["10","2","0"],false,true)},installLatestJRE:function(q){if(this.isPluginInstalled()&&this.isAutoInstallEnabled()){var r=false;if(this.isCallbackSupported()){r=this.getPlugin().installLatestJRE(q)}else{r=this.getPlugin().installLatestJRE()}if(r){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return r}else{var p=this.getBrowser();var o=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(o.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("deployJava.poll()",3000)}location.href=this.EarlyAccessURL;return false}else{if(p=="MSIE"){return this.IEInstall()}else{if((p=="Netscape Family")&&(o.indexOf("win32")!=-1)){return this.FFInstall()}else{location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""))}}return false}}},runApplet:function(p,u,r){if(r=="undefined"||r==null){r="1.1"}var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(this.returnPage==null){this.returnPage=document.location}if(o!=null){var q=this.getBrowser();if(q!="?"){if(this.versionCheck(r+"+")){this.writeAppletTag(p,u)}else{if(this.installJRE(r+"+")){this.refresh();location.href=document.location;this.writeAppletTag(p,u)}}}else{this.writeAppletTag(p,u)}}else{g("[runApplet()] Invalid minimumVersion argument to runApplet():"+r)}},writeAppletTag:function(r,w){var o="<applet ";var q="";var t="</applet>";var x=true;if(null==w||typeof w!="object"){w=new Object()}for(var p in r){if(!c(p)){w[p]=r[p]}else{o+=(" "+p+'="'+r[p]+'"');if(p=="code"){x=false}}}var v=false;for(var u in w){if(u=="codebase_lookup"){v=true}if(u=="object"||u=="java_object"||u=="java_code"){x=false}q+='<param name="'+u+'" value="'+w[u]+'"/>'}if(!v){q+='<param name="codebase_lookup" value="false"/>'}if(x){o+=(' code="dummy"')}o+=">";document.write(o+"\n"+q+"\n"+t)},versionCheck:function(p){var v=0;var x="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var y=p.match(x);if(y!=null){var r=false;var u=false;var q=new Array();for(var t=1;t<y.length;++t){if((typeof y[t]=="string")&&(y[t]!="")){q[v]=y[t];v++}}if(q[q.length-1]=="+"){u=true;r=false;q.length--}else{if(q[q.length-1]=="*"){u=false;r=true;q.length--}else{if(q.length<4){u=false;r=true}}}var w=this.getJREs();for(var t=0;t<w.length;++t){if(this.compareVersionToPattern(w[t],q,r,u)){return true}}return false}else{var o="Invalid versionPattern passed to versionCheck: "+p;g("[versionCheck()] "+o);alert(o);return false}},isWebStartInstalled:function(r){var q=this.getBrowser();if(q=="?"){return true}if(r=="undefined"||r==null){r="1.4.2"}var p=false;var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(o!=null){p=this.versionCheck(r+"+")}else{g("[isWebStartInstaller()] Invalid minimumVersion argument to isWebStartInstalled(): "+r);p=this.versionCheck("1.4.2+")}return p},getJPIVersionUsingMimeType:function(){for(var p=0;p<navigator.mimeTypes.length;++p){var q=navigator.mimeTypes[p].type;var o=q.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(o!=null){this.firefoxJavaVersion=o[1];if("Opera"!=this.browserName2){break}}}},launchWebStartApplication:function(r){var o=navigator.userAgent.toLowerCase();this.getJPIVersionUsingMimeType();if(this.isWebStartInstalled("1.7.0")==false){if((this.installJRE("1.7.0+")==false)||((this.isWebStartInstalled("1.7.0")==false))){return false}}var u=null;if(document.documentURI){u=document.documentURI}if(u==null){u=document.URL}var p=this.getBrowser();var q;if(p=="MSIE"){q='<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" width="0" height="0"><PARAM name="launchjnlp" value="'+r+'"><PARAM name="docbase" value="'+u+'"></object>'}else{if(p=="Netscape Family"){q='<embed type="application/x-java-applet;jpi-version='+this.firefoxJavaVersion+'" width="0" height="0" launchjnlp="'+r+'"docbase="'+u+'" />'}}if(document.body=="undefined"||document.body==null){document.write(q);document.location=u}else{var t=document.createElement("div");t.id="div1";t.style.position="relative";t.style.left="-10000px";t.style.margin="0px auto";t.className="dynamicDiv";t.innerHTML=q;document.body.appendChild(t)}},createWebStartLaunchButtonEx:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:deployJava.launchWebStartApplication('"+q+"');";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},createWebStartLaunchButton:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:if (!deployJava.isWebStartInstalled(&quot;"+p+"&quot;)) {if (deployJava.installLatestJRE()) {if (deployJava.launch(&quot;"+q+"&quot;)) {}}} else {if (deployJava.launch(&quot;"+q+"&quot;)) {}}";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},launch:function(o){document.location=o;return true},isPluginInstalled:function(){var o=this.getPlugin();if(o&&o.jvms){return true}else{return false}},isAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().isAutoUpdateEnabled()}return false},setAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().setAutoUpdateEnabled()}return false},setInstallerType:function(o){this.installType=o;if(this.isPluginInstalled()){return this.getPlugin().setInstallerType(o)}return false},setAdditionalPackages:function(o){if(this.isPluginInstalled()){return this.getPlugin().setAdditionalPackages(o)}return false},setEarlyAccess:function(o){this.EAInstallEnabled=o},isPlugin2:function(){if(this.isPluginInstalled()){if(this.versionCheck("1.6.0_10+")){try{return this.getPlugin().isPlugin2()}catch(o){}}}return false},allowPlugin:function(){this.getBrowser();var o=("Safari"!=this.browserName2&&"Opera"!=this.browserName2);return o},getPlugin:function(){this.refresh();var o=null;if(this.allowPlugin()){o=document.getElementById("deployJavaPlugin")}return o},compareVersionToPattern:function(v,p,r,t){if(v==undefined||p==undefined){return false}var w="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var x=v.match(w);if(x!=null){var u=0;var y=new Array();for(var q=1;q<x.length;++q){if((typeof x[q]=="string")&&(x[q]!="")){y[u]=x[q];u++}}var o=Math.min(y.length,p.length);if(t){for(var q=0;q<o;++q){if(y[q]<p[q]){return false}else{if(y[q]>p[q]){return true}}}return true}else{for(var q=0;q<o;++q){if(y[q]!=p[q]){return false}}if(r){return true}else{return(y.length==p.length)}}}else{return false}},getBrowser:function(){if(this.browserName==null){var o=navigator.userAgent.toLowerCase();g("[getBrowser()] navigator.userAgent.toLowerCase() -> "+o);if((o.indexOf("msie")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("trident")!=-1||o.indexOf("Trident")!=-1){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("iphone")!=-1){this.browserName="Netscape Family";this.browserName2="iPhone"}else{if((o.indexOf("firefox")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Firefox"}else{if(o.indexOf("chrome")!=-1){this.browserName="Netscape Family";this.browserName2="Chrome"}else{if(o.indexOf("safari")!=-1){this.browserName="Netscape Family";this.browserName2="Safari"}else{if((o.indexOf("mozilla")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Other"}else{if(o.indexOf("opera")!=-1){this.browserName="Netscape Family";this.browserName2="Opera"}else{this.browserName="?";this.browserName2="unknown"}}}}}}}}g("[getBrowser()] Detected browser name:"+this.browserName+", "+this.browserName2)}return this.browserName},testUsingActiveX:function(o){var q="JavaWebStart.isInstalled."+o+".0";if(typeof ActiveXObject=="undefined"||!ActiveXObject){g("[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?");return false}try{return(new ActiveXObject(q)!=null)}catch(p){return false}},testForMSVM:function(){var p="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var o=oClientCaps.getComponentVersion(p,"ComponentID");if((o=="")||(o=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(p){if(!navigator.mimeTypes){g("[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?");return false}for(var q=0;q<navigator.mimeTypes.length;++q){s=navigator.mimeTypes[q].type;var o=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(o!=null){if(this.compareVersions(o[1],p)){return true}}}return false},testUsingPluginsArray:function(p){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var o=navigator.platform.toLowerCase();for(var q=0;q<navigator.plugins.length;++q){s=navigator.plugins[q].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions("1.5.0",p)){return true}}else{if(s.search(/^Java/)!=-1){if(o.indexOf("win")!=-1){if(this.compareVersions("1.5.0",p)||this.compareVersions("1.6.0",p)){return true}}}}}if(this.compareVersions("1.5.0",p)){return true}return false},IEInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""));return false},done:function(p,o){},FFInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):""));return false},compareVersions:function(r,t){var p=r.split(".");var o=t.split(".");for(var q=0;q<p.length;++q){p[q]=Number(p[q])}for(var q=0;q<o.length;++q){o[q]=Number(o[q])}if(p.length==2){p[2]=0}if(p[0]>o[0]){return true}if(p[0]<o[0]){return false}if(p[1]>o[1]){return true}if(p[1]<o[1]){return false}if(p[2]>o[2]){return true}if(p[2]<o[2]){return false}return true},enableAlerts:function(){this.browserName=null;this.debug=true},poll:function(){this.refresh();var o=this.getJREs();if((this.preInstallJREList.length==0)&&(o.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}if((this.preInstallJREList.length!=0)&&(o.length!=0)&&(this.preInstallJREList[0]!=o[0])){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}},writePluginTag:function(){var o=this.getBrowser();if(o=="MSIE"){document.write('<object classid="clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA" id="deployJavaPlugin" width="0" height="0" style="position: absolute; top: -5000px;"></object>')}else{if(o=="Netscape Family"&&this.allowPlugin()){this.writeEmbedTag()}}},refresh:function(){navigator.plugins.refresh(false);var o=this.getBrowser();if(o=="Netscape Family"&&this.allowPlugin()){var p=document.getElementById("deployJavaPlugin");if(p==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var o=false;if(navigator.mimeTypes!=null){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.mimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.mimeType+'" hidden="true" />');o=true}}}if(!o){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.oldMimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.oldMimeType+'" hidden="true" />')}}}}}}};d.writePluginTag();if(d.locale==null){var h=null;if(h==null){try{h=navigator.userLanguage}catch(f){}}if(h==null){try{h=navigator.systemLanguage}catch(f){}}if(h==null){try{h=navigator.language}catch(f){}}if(h!=null){h.replace("-","_");d.locale=h}}return d}();;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:update-plugin-banner-resources', location = 'js/banner/update-hipchat-link-banner.js' */
(function(a){AJS.toInit(function(){var e="HIPCHAT_ADMIN_BANNER_DISMISS";var c;if(!d()&&AJS.Meta.get("is-admin")&&!g()){a.ajax({url:AJS.contextPath()+"/rest/hipchat/integrations/1.0/configuration/status",dataType:"json",cache:false}).done(function(i){if(i.requiresManualInstallation||i.v1){c=b(i)}})}function b(k){var j=JIRA.Templates.HipChat.Banner.updateHipChatLink({removeV1link:!k.v2&&k.v1});var i=JIRA.Messages.showWarningMsg(j);a(document).on("click","#remove-hipchat-v1-link",h);a(document).on("aui-flag-close",".aui-flag",f);return i}function d(){return window.location.toString().indexOf("/plugins/servlet/hipchat/configure")>0}function f(i){if(a(i.target).find(".hipchat-update-banner").length>0){AJS.Cookie.save(e,true)}}function g(){return AJS.Cookie.read(e)=="true"}function h(i){i.preventDefault();a.ajax({url:AJS.contextPath()+"/rest/hipchat/integrations/1.0/configuration/v1",cache:false,type:"DELETE"}).error(function(j){if(c){c.hide()}JIRA.Messages.showErrorMsg(AJS.format("We couldn\'\'t find your integration. If the problem persists, contact Atlassian Support.\u003cbr/\u003e Error Status [{0}]",j.status))}).done(function(j){if(c){c.hide()}JIRA.Messages.showSuccessMsg("Integration has been removed successfully")})}})})(AJS.$);;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:update-plugin-banner-resources', location = 'soy/banner/update-hipchat-link-banner.soy' */
// This file was automatically generated from update-hipchat-link-banner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.Banner == 'undefined') { JIRA.Templates.HipChat.Banner = {}; }


JIRA.Templates.HipChat.Banner.updateHipChatLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-update-banner"><b>', soy.$$escapeHtml("HipChat Integration is out of date"), '</b><p>', soy.$$escapeHtml("Update to take full advantage of the latest features."), '</p><p/><a href="', soy.$$escapeHtml("" + '/plugins/servlet/hipchat/configure'), '">', soy.$$escapeHtml("Update Now!"), '</a>', (opt_data.removeV1link) ? '<a id="remove-hipchat-v1-link">' + soy.$$escapeHtml("Remove Integration") + '</a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.administration.atlassian-admin-quicksearch-jira:admin-quicksearch-webresources', location = 'com/atlassian/administration/quicksearch/jira/js/adminQuickNav.js' */
/**
 * Shifter group for admin search
 */
JIRA.Shifter && JIRA.Shifter.register(function() {
    var suggestionsDeferred = jQuery.Deferred();

    function formatItem(item) {
        return {
            label: item.label,
            value: item.linkUrl,
            keywords: item.aliases
        };
    }

    function getItemsInSection(section) {
        return _.map(section.items, formatItem).concat(_.map(section.sections, getItemsInSection));
    }

    function formatResponse(data) {
        return _.flatten(getItemsInSection(data));
    }

    JIRA.SmartAjax.makeRequest({
        dataType: 'json',
        url: AJS.contextPath() + '/rest/adminquicksearch/latest/links/default'
    })
    .pipe(formatResponse)
    .done(function(suggestions) {
        suggestionsDeferred.resolve(suggestions);
    })
    .fail(function() {
        suggestionsDeferred.reject();
    });

    return {
        id: 'admin',
        name: "Administration",
        weight: 500,
        getSuggestions: function() {
            return suggestionsDeferred;
        },
        onSelection: function(value) {
            window.location = value;
            return jQuery.Deferred();
        }
    };
});
;
;/* module-key = 'com.atlassian.jira.ext.calendar:browse-project-tip', location = 'com/atlassian/jira/ext/calendar/resources/js/BrowseProjectTip.js' */
AJS.toInit(function(d){var c=WRM.data.claim("com.atlassian.jira.ext.calendar:tipDataProvider.tip").suppressTip;if(!c){var a="browse-project-calendar-info";var b=function(e){if(e.length){var f=d("<div/>");AJS.messages.info(f,{body:AJS.format("This calendar shows when issues are due to be completed. This is set by the {0} field for an issue.","Due Date"),closeable:true});f.find(".aui-message").attr("id",a);e.prepend(f)}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,g,h){var f;if(g.attr("id")=="project-tab"){f=d(".issues-calendar-container",g)}else{f=d("#project-tab .issues-calendar-container",g)}b(f)});b(d("#project-tab .issues-calendar-container"));AJS.bind("messageClose",function(g,f){if(f.attr("id")==a){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectcalendarinfo.closebutton"});d.ajax({data:{tipKey:"browseProjectCalendarTab"},type:"POST",url:contextPath+"/rest/calendar-plugin/1.0/suppressedTips"})}})}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/dialog-ids.js' */
define("jira/analytics/browser-metrics/dialog-checker",[],function(){allowedIdsArray=["about-dialog","add-basicuser-dialog","add-developer-dialog","add-field-configuration-dialog","add-field-configuration-scheme-dialog","add-field-dialog","add-field-screen-dialog","add-field-screen-scheme-dialog","add-incoming-mail-handler-dialog","add-issue-type-dialog","add-issue-type-field-configuration-association-dialog","add-issue-type-screen-scheme-configuration-association-dialog","add-issue-type-screen-scheme-dialog","add-new-issue-type-to-scheme-dialog","add-screen-scheme-item-dialog","add-subtask-type-dialog","add-workflow-dialog","add_workflowscheme-dialog","assign-dialog","assign-issue-types-dialog","assign-to-me-link-handler","attach-file-dialog","attach-screenshot-dialog","auditing-settings-dialog","clone-issue-dialog","comment-add-dialog","configure_wallboard_dialog","confluence-page-search-dialog","copy_classic default workflow-dialog","copy-filter-dialog","copy_jira-dialog","create-issue-dialog","create-issue-dialog.issueType","create-issue-dialog.projectId","create-request-dialog","create-service-desk-dialog","create-status-dialog","create-story-dialog","create-story-dialog.issueType","create-story-dialog.projectId","create-subtask-dialog","create-subtask-dialog.issueType","create-team-dialog","create_user-dialog","credits-dialog","delete-attachment-dialog","delete-comment-dialog","delete-dshboard","delete-filter-dialog","delete-issue-dialog","delete-issue-link-dialog","delete-log-work-dialog","delete-metric","delete-queue","delete-status-dialog","deleteuser_link-dialog","devstatus-branch-detail-dialog","devstatus-build-detail-dialog","devstatus-commit-detail-dialog","devstatus-cta-dialog","devstatus-deployment-detail-dialog","devstatus-pullrequest-detail-dialog","devstatus-review-detail-dialog","discard-draft-dialog","discard_draft_workflow-dialog","edit-attachments-dialog","edit-comment","editgroups_admin-dialog","editgroups_link-dialog","editgroups_sysadmin-dialog","edit-issue-dialog","edit-labels-dialog","edit-log-work-dialog","edit-status-dialog","edituser_link_admin-dialog","edit-workflow-dialog","gh-rapidboard-dialog","inline-issue-create-dialog","invite_user-dialog","issue-actions-dialog","issue-tab-error-dialog","jim-create-project-dialog","keyboard-shortcuts-dialog","link-issue-dialog","log-work-dialog","manage-attachment-dialog","metric-pre-save-dialog","modal-field-view","permission-helper-dialog","project-avatar-cropper","project-avatar-picker","project-config-details-project-category-dialog","project-config-project-edit-dialog","project-config-project-edit-lead-and-default-assignee-dialog","project-email-dialog","publish_draft_workflow-dialog","queue-dirty-edits","QuickCreateIssue.error","QuickCreateIssue.success","QuickCreateSubtask.error","QuickCreateSubtask.success","QuickEdit.error","QuickEdit.success","remote-jira-search-dialog","rename-filter-dialog","report-dirty-edits","save-filter-dialog","sd-add-default-value","sd-add-remove-agent-dialog","sd-remove-field-dialog","server-error-dialog","report-delete-confirm","tempo-add-hours-issue-dialog","tempo-add-internal-activity-form","tempo-core-medium-form","tempo-delete-form-dialog","tempo-grace-form","tempo-large-form","tempo-medium-form","tempo-move-form-dialog","tempo-pdf-form","tempo-small-form","tempo-split-form-dialog","tempo-user-settings-dialog","user-avatar-picker","user-defaults-edit-dialog","versionsMergeDialog","view-workflow-dialog","view-workflow-dialog-project-admin","view-workflow-dialog-workflow-schemes","wait-migrate-dialog","whereismycf-dialog","workflow-text-view"];var a={};allowedIdsArray.forEach(function(c){a[c]=true});var b=[{key:"component-delete-dialog",pattern:/^component-\d+-delete-dialog$/i},{key:"version-delete-dialog",pattern:/^version-\d+-delete-dialog$/i},{key:"workflow-transition-dialog",pattern:/^workflow-transition-\d+-dialog$/i}];return{transformDialogId:function(c){if(!c){return undefined}if(a[c]){return c}for(var d=0;d<b.length;++d){var e=b[d];if(c.match(e.pattern)){return e.key}}return undefined}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/browser-metrics.js' */
require(["jira/analytics/browser-metrics/dialog-checker","jira/util/events","jquery"],function(c,a,b){b(function(){var e={startEvent:function(g){try{window.BrowserMetrics&&BrowserMetrics.start(g)}catch(h){console.log(h)}},endEvent:function(g,i){try{window.BrowserMetrics&&BrowserMetrics.end(g,i)}catch(h){console.log(h)}}};var f={openDialogs:{},start:function(){a.bind("dialogContentReady",function(k,i){var h=c.transformDialogId(i.options.id);if(!h){return}var j=f.openDialogs[h];if(j){if(!j.initialized){e.endEvent("jira.dialog.open."+h);j.initialized=true}else{if(j.action){e.endEvent("jira.dialog.change."+h+"."+j.action);j.action=undefined}}}});a.bind("beforeShow",function(j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]===undefined){f.openDialogs[i]={initialized:false};e.startEvent("jira.dialog.open."+i)}});a.bind("Dialog.hide",function(l,j,k,h){var i=c.transformDialogId(h);if(!i){return}delete f.openDialogs[i]});a.bind("dialogBeforeContentChange",function(l,k,j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]){f.openDialogs[i].action=k;e.startEvent("jira.dialog.change."+i+"."+k)}});function g(i,j){var h=c.transformDialogId(i);if(!h){return}a.bind(i+".submitting",function(){e.startEvent("jira.dialog."+h)});a.bind(i+"."+j,function(){e.endEvent("jira.dialog."+h,"success")});a.bind(i+".validationError",function(){e.endEvent("jira.dialog."+h,"error")})}["QuickCreateIssue","QuickCreateSubtask"].forEach(function(h){g(h,"issueCreated")});g("QuickEdit","issueEdited")}};var d={start:function(){a.bind("aui-dropdown2-show-before",function(g,h){e.startEvent("jira.header.menu."+h)});a.bind("aui-dropdown2-show-after",function(g,h){e.endEvent("jira.header.menu."+h)})}};if(window.BrowserMetrics!==undefined&&AJS.BrowserMetrics===undefined){[f,d].forEach(function(g){g.start()})}})});;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:newsletter-signup-tip', location = 'static/components/newsletter/NewsletterSignup.soy' */
// This file was automatically generated from NewsletterSignup.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }


JIRA.Templates.newsletterSignupTip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><p>', soy.$$escapeHtml("Stay up-to-date with the latest JIRA tips, tricks, and exclusive inside jokes. All this and more in JIRA Insiders, delivered every month from our inbox to yours."), '</p>');
  var param9 = new soy.StringBuilder();
  aui.form.textField({id: 'jira-newsletter-user-email', placeholderText: soy.$$escapeHtml("Email address"), value: opt_data.userEmail}, param9);
  var param15 = new soy.StringBuilder();
  aui.form.submit({type: 'primary', text: "Sign me up"}, param15);
  aui.form.linkButton({text: soy.$$escapeHtml("No thanks")}, param15);
  aui.form.buttons({content: param15.toString()}, param9);
  aui.form.form({action: '#', isTopLabels: true, extraClasses: 'insiders-signup-form', content: param9.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:newsletter-signup-tip', location = 'static/components/newsletter/NewsletterSignup.js' */
define('jira/newsletter/signuptip', [
    'jquery'
], function(
    $
    ) {

    // taken from setup-mac-util.js
    // http://www.w3.org/TR/html5/forms.html#valid-e-mail-address without &
    var emailRegex = /^[a-zA-Z0-9.!#$%'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;

    function validateEmail(email) {
        if (email.length > 255) {
            return false;
        }
        return emailRegex.test(email);
    }

    return {
        render : function (newsletterFormDetails, helpTipOptions) {
            var defaults = {
                id: "newsletter-signup-tip",
                title: "JIRA Insiders",
                bodyHtml: JIRA.Templates.newsletterSignupTip({
                    userEmail: newsletterFormDetails.userEmail
                }),
                anchor: "#user-options",
                isSequence: false,
                showCloseButton: false
            };
            var tip = new AJS.HelpTip($.extend(defaults, helpTipOptions));
            tip.show();

            AJS.trigger('analyticsEvent', { name: "jira.newsletter.signuptip.shown" });

            var $body = $("body");
            $body.on("submit", "form.aui.insiders-signup-form", function (e) {
                e.preventDefault();

                var $form = $(this);
                $form.find(".error").remove();

                var $emailInput = $form.find("#jira-newsletter-user-email");
                var email = $emailInput.val();
                if (validateEmail(email)) {
                    $.ajax({
                        type: 'POST',
                        url: AJS.format(newsletterFormDetails.formUrl, encodeURI(email)),
                        dataType: 'json'
                    }).success(function() {
                        AJS.trigger('analyticsEvent', { name: "jira.newsletter.signuptip.submitted" });
                    }).error(function(xhr) {
                        AJS.trigger('analyticsEvent', {
                            name: "jira.newsletter.signuptip.error",
                            data: {
                                statusCode: xhr.status
                            }
                        });
                    });

                    if(newsletterFormDetails.userEmail !== email) {
                        AJS.trigger('analyticsEvent', { name: "jira.newsletter.signuptip.email.changed" });
                    }

                    tip.dismiss("newslettersubscribed");
                }
                else {
                    AJS.trigger('analyticsEvent', { name: "jira.newsletter.signuptip.email.validationerror" });
                    $emailInput.after(aui.form.fieldError({message: "Please enter a valid e-mail address."}));
                }
            });

            $body.on("click", "form.aui.insiders-signup-form a.cancel", function (e) {
                e.preventDefault();
                AJS.trigger('analyticsEvent', { name: "jira.newsletter.signuptip.dismissed" });
                tip.dismiss("newslettercancelled");
            });
        }
    };
});
;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:newsletter-signup-tip', location = 'static/components/newsletter/initNewsletterSignup.js' */
define('jira/newsletter/init-signup', [
    'jira/newsletter/signuptip'
], function(
    NewsletterSignup
    ) {
    return function() {
        var newsletterSignupData = WRM.data.claim("com.atlassian.jira.jira-header-plugin:newsletter-signup-tip.newsletterSignup");

        if (newsletterSignupData && newsletterSignupData.showNewsletterTip) {
            NewsletterSignup.render({
                userEmail: newsletterSignupData.userEmail,
                formUrl: newsletterSignupData.formUrl
            });
        }
    }
});

AJS.$(function () {
    require('jira/newsletter/init-signup')();
});
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'lib/brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View);if(typeof JIRA==="undefined"){JIRA={}}if(!JIRA.Issues){JIRA.Issues={}}JIRA.Issues.Brace=k}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'namespaces.js' */
JIRA.Components=JIRA.Components||{};JIRA.Issues=JIRA.Issues||{};JIRA.Events=JIRA.Events||{};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'lib/jquery.hoverIntent.min.js' */
/**
* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne brian(at)cherne(dot)net
*/
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'util/TipsyView.js' */
if(!jQuery.fn.tooltip){jQuery.fn.tooltip=jQuery.noop;jQuery.fn.tipsy=jQuery.noop}JIRA.Issues.Tipsy=JIRA.Issues.Brace.View.extend({events:{click:"hide"},initialize:function(a){if(_.isFunction(a.showCondition)){this.shouldShow=a.showCondition}else{if(a.showCondition){this.shouldShow=_.bind(function(){return this.$el.filter(a.showCondition).length>0},this)}else{this.shouldShow=function(){return true}}}this.tipsy=this.$el.tooltip(_.extend({trigger:"manual"},a.tipsy));this.hoverIntent(a.intents)},hoverIntent:function(a){if(this.tipsy){this.tipsy.hoverIntent(_.extend({interval:200,over:_.bind(this.show,this),out:_.bind(this.hide,this)},a))}return this},show:function(){if(this.shouldShow()&&this.tipsy){this.$el.tipsy("show")}},hide:function(){if(this.tipsy){this.$el.tipsy("hide")}},remove:function(){this.hide();this.$el.removeData("tipsy")}});JIRA.Issues.Tipsy.revalidate=function(){return jQuery.fn.tipsy.revalidate()};JIRA.Issues.Tipsy.autoBounds=function(){return jQuery.fn.tipsy.autoBounds.apply(jQuery.fn.tipsy,arguments)};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/CatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/RecurringPromise.js' */
jQuery.RecurringPromise=function(a){if(!(this instanceof jQuery.RecurringPromise)){return new jQuery.RecurringPromise()}this._parent=a;this._doneCallbacks=jQuery.Callbacks();this._failCallbacks=jQuery.Callbacks();this._alwaysCallbacks=jQuery.Callbacks()};jQuery.RecurringPromise.prototype={add:function(b){var a=jQuery.Deferred();a.original=b;var c=this._getPending();this._abortIfPending(c);this._setPending(a);b.done(_.bind(function(){if(a===this._getPending()){a.resolveWith(this,arguments);this._doneCallbacks.fireWith(this,arguments)}},this));b.fail(_.bind(function(){if(a===this._getPending()){a.rejectWith(this,arguments);this._failCallbacks.fireWith(this,arguments)}},this));b.always(_.bind(function(){if(a===this._getPending()){this._alwaysCallbacks.fireWith(this,arguments)}},this));return a.promise()},done:function(a){this._doneCallbacks.add(a);return this},fail:function(a){this._failCallbacks.add(a);return this},always:function(a){this._alwaysCallbacks.add(a);return this},reset:function(){this._abortIfPending(this._getPending());this._setPending(null)},sub:function(){return new jQuery.RecurringPromise(this)},_getPending:function(){return this._parent?this._parent._getPending():this._pending},_setPending:function(a){if(this._parent){this._parent._setPending(a)}else{this._pending=a}},_abortIfPending:function(a){if(a&&a.state()==="pending"){a.reject("abort");if(jQuery.isFunction(a.original.abort)){a.original.abort()}}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/ConcurrentDeferred.js' */
jQuery.ConcurrentDeferred=function(c){var b=jQuery.Deferred();var d;var a=function(e){d=e;e.done(function(){if(d===e){b.resolve.apply(b,arguments)}}).fail(function(){if(d===e){b.reject.apply(b,arguments)}})};a(c);jQuery.extend(b,{update:function(e){if(!this.isPending()){throw"Cannot update non-pending ConcurrentDeferred"}var f=d;a(e);if(jQuery.isFunction(f.abort)){f.abort()}return this},isPending:function(){return this.state()==="pending"}});return b};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/patches/backbone-0.9.2-events-patch.js' */
(function(){var a=[Backbone.View.prototype,Backbone.Events,Backbone.Model.prototype];if(!Backbone.Events.listenTo){b("listenTo","on")}if(!Backbone.Events.listenToOnce){b("listenToOnce","once")}function b(d,c){_.each(a,function(e){e[d]=function(h,f,j){var g=this._listeners||(this._listeners={});var i=h._listenerId||(h._listenerId=_.uniqueId("l"));g[i]=h;if(typeof f==="object"){j=this}h[c](f,j,this);return this}})}_.each(a,function(c){c.stopListening=function(g,d,i){var e=this._listeners;if(!e){return this}var f=!d&&!i;if(typeof d==="object"){i=this}if(g){(e={})[g._listenerId]=g}for(var h in e){e[h].off(d,i,this);if(f){delete this._listeners[h]}}return this}})}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/patches/backbone-0.9.2-misc-patch.js' */
(function(){Backbone.View.prototype.remove=_.compose(function(a){this.stopListening();return a},Backbone.View.prototype.remove);Backbone.$=AJS.$}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/backbone.marionette-noconflict-1.4.1.js' */
/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
(function(){var b=this;var a=b.Marionette;Backbone.ChildViewContainer=(function(g,f){var d=function(h){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();f.each(h,this.add,this)};f.extend(d.prototype,{add:function(h,j){var i=h.cid;this._views[i]=h;if(h.model){this._indexByModel[h.model.cid]=i}if(j){this._indexByCustom[j]=i}this._updateLength()},findByModel:function(h){return this.findByModelCid(h.cid)},findByModelCid:function(h){var i=this._indexByModel[h];return this.findByCid(i)},findByCustom:function(i){var h=this._indexByCustom[i];return this.findByCid(h)},findByIndex:function(h){return f.values(this._views)[h]},findByCid:function(h){return this._views[h]},remove:function(h){var i=h.cid;if(h.model){delete this._indexByModel[h.model.cid]}f.any(this._indexByCustom,function(k,j){if(k===i){delete this._indexByCustom[j];return true}},this);delete this._views[i];this._updateLength()},call:function(h){this.apply(h,f.tail(arguments))},apply:function(i,h){f.each(this._views,function(j){if(f.isFunction(j[i])){j[i].apply(j,h||[])}})},_updateLength:function(){this.length=f.size(this._views)}});var e=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];f.each(e,function(h){d.prototype[h]=function(){var i=f.values(this._views);var j=[i].concat(f.toArray(arguments));return f[h].apply(f,j)}});return d})(Backbone,_);Backbone.Wreqr=(function(g,f,d){var e={};e.Handlers=(function(j,i){var h=function(k){this.options=k;this._wreqrHandlers={};if(i.isFunction(this.initialize)){this.initialize(k)}};h.extend=j.Model.extend;i.extend(h.prototype,j.Events,{setHandlers:function(k){i.each(k,function(n,l){var m=null;if(i.isObject(n)&&!i.isFunction(n)){m=n.context;n=n.callback}this.setHandler(l,n,m)},this)},setHandler:function(l,n,m){var k={callback:n,context:m};this._wreqrHandlers[l]=k;this.trigger("handler:add",l,n,m)},hasHandler:function(k){return !!this._wreqrHandlers[k]},getHandler:function(l){var k=this._wreqrHandlers[l];if(!k){throw new Error("Handler not found for '"+l+"'")}return function(){var m=Array.prototype.slice.apply(arguments);return k.callback.apply(k.context,m)}},removeHandler:function(k){delete this._wreqrHandlers[k]},removeAllHandlers:function(){this._wreqrHandlers={}}});return h})(g,d);e.CommandStorage=(function(){var h=function(i){this.options=i;this._commands={};if(d.isFunction(this.initialize)){this.initialize(i)}};d.extend(h.prototype,g.Events,{getCommands:function(j){var i=this._commands[j];if(!i){i={command:j,instances:[]};this._commands[j]=i}return i},addCommand:function(j,i){var k=this.getCommands(j);k.instances.push(i)},clearCommands:function(i){var j=this.getCommands(i);j.instances=[]}});return h})();e.Commands=(function(h){return h.Handlers.extend({storageType:h.CommandStorage,constructor:function(j){this.options=j||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var i=Array.prototype.slice.call(arguments);h.Handlers.prototype.constructor.apply(this,i)},execute:function(j,i){j=arguments[0];i=Array.prototype.slice.call(arguments,1);if(this.hasHandler(j)){this.getHandler(j).apply(this,i)}else{this.storage.addCommand(j,i)}},_executeCommands:function(i,k,j){var l=this.storage.getCommands(i);d.each(l.instances,function(m){k.apply(j,m)});this.storage.clearCommands(i)},_initializeStorage:function(i){var k;var j=i.storageType||this.storageType;if(d.isFunction(j)){k=new j()}else{k=j}this.storage=k}})})(e);e.RequestResponse=(function(h){return h.Handlers.extend({request:function(){var j=arguments[0];var i=Array.prototype.slice.call(arguments,1);return this.getHandler(j).apply(this,i)}})})(e);e.EventAggregator=(function(j,h){var i=function(){};i.extend=j.Model.extend;h.extend(i.prototype,j.Events);return i})(g,d);return e})(Backbone,Backbone.Marionette,_);var c=(function(e,j,d){var i={};j.Marionette=i;i.$=j.$;var f=Array.prototype.slice;function g(k){return f.call(k)}function h(m,l){var k=new Error(m);k.name=l||"Error";throw k}i.extend=j.Model.extend;i.getOption=function(m,k){if(!m||!k){return}var l;if(m.options&&(k in m.options)&&(m.options[k]!==undefined)){l=m.options[k]}else{l=m[k]}return l};i.triggerMethod=(function(){var l=/(^|:)(\w)/gi;function m(o,p,n){return n.toUpperCase()}var k=function(o){var n="on"+o.replace(l,m);var p=this[n];if(d.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(d.isFunction(p)){return p.apply(this,d.tail(arguments))}};return k})();i.MonitorDOMRefresh=(function(){function m(n){n._isShown=true;k(n)}function l(n){n._isRendered=true;k(n)}function k(n){if(n._isShown&&n._isRendered){if(d.isFunction(n.triggerMethod)){n.triggerMethod("dom:refresh")}}}return function(n){n.listenTo(n,"show",function(){m(n)});n.listenTo(n,"render",function(){l(n)})}})();(function(p){function o(u,s,q,r){var t=r.split(/\s+/);d.each(t,function(v){var w=u[v];if(!w){h("Method '"+v+"' was configured as an event handler, but does not exist.")}u.listenTo(s,q,w,u)})}function k(s,r,q,t){s.listenTo(r,q,t,s)}function m(u,s,q,r){var t=r.split(/\s+/);d.each(t,function(v){var w=u[v];u.stopListening(s,q,w,u)})}function l(s,r,q,t){s.stopListening(r,q,t,s)}function n(t,q,u,s,r){if(!q||!u){return}if(d.isFunction(u)){u=u.call(t)}d.each(u,function(w,v){if(d.isFunction(w)){s(t,q,v,w)}else{r(t,q,v,w)}})}p.bindEntityEvents=function(r,q,s){n(r,q,s,k,o)};p.unbindEntityEvents=function(r,q,s){n(r,q,s,l,m)}})(i);i.Callbacks=function(){this._deferred=i.$.Deferred();this._callbacks=[]};d.extend(i.Callbacks.prototype,{add:function(l,k){this._callbacks.push({cb:l,ctx:k});this._deferred.done(function(n,m){if(k){n=k}l.call(n,m)})},run:function(k,l){this._deferred.resolve(l,k)},reset:function(){var k=this._callbacks;this._deferred=i.$.Deferred();this._callbacks=[];d.each(k,function(l){this.add(l.cb,l.ctx)},this)}});i.Controller=function(k){this.triggerMethod=i.triggerMethod;this.options=k||{};if(d.isFunction(this.initialize)){this.initialize(this.options)}};i.Controller.extend=i.extend;d.extend(i.Controller.prototype,j.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});i.Region=function(l){this.options=l||{};this.el=i.getOption(this,"el");if(!this.el){var m=new Error("An 'el' must be specified for a region.");m.name="NoElError";throw m}if(this.initialize){var k=Array.prototype.slice.apply(arguments);this.initialize.apply(this,k)}};d.extend(i.Region,{buildRegion:function(l,r){var p=(typeof l==="string");var o=(typeof l.selector==="string");var s=(typeof l.regionType==="undefined");var m=(typeof l==="function");if(!m&&!p&&!o){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var k,n;if(p){k=l}if(l.selector){k=l.selector}if(m){n=l}if(!m&&s){n=r}if(l.regionType){n=l.regionType}var q=new n({el:k});if(l.parentEl){q.getEl=function(t){var u=l.parentEl;if(d.isFunction(u)){u=u()}return u.find(t)}}return q}});d.extend(i.Region.prototype,j.Events,{show:function(m){this.ensureEl();var k=m.isClosed||d.isUndefined(m.$el);var l=m!==this.currentView;if(l){this.close()}m.render();if(l||k){this.open(m)}this.currentView=m;i.triggerMethod.call(this,"show",m);i.triggerMethod.call(m,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(k){return i.$(k)},open:function(k){this.$el.empty().append(k.el)},close:function(){var k=this.currentView;if(!k||k.isClosed){return}if(k.close){k.close()}else{if(k.remove){k.remove()}}i.triggerMethod.call(this,"close");delete this.currentView},attachView:function(k){this.currentView=k},reset:function(){this.close();delete this.$el}});i.Region.extend=i.extend;i.RegionManager=(function(m){var l=m.Controller.extend({constructor:function(n){this._regions={};m.Controller.prototype.constructor.call(this,n)},addRegions:function(n,o){var p={};d.each(n,function(r,q){if(typeof r==="string"){r={selector:r}}if(r.selector){r=d.defaults({},r,o)}var s=this.addRegion(q,r);p[q]=s},this);return p},addRegion:function(p,q){var s;var o=d.isObject(q);var n=d.isString(q);var r=!!q.selector;if(n||(o&&r)){s=m.Region.buildRegion(q,m.Region)}else{if(d.isFunction(q)){s=m.Region.buildRegion(q,m.Region)}else{s=q}}this._store(p,s);this.triggerMethod("region:add",p,s);return s},get:function(n){return this._regions[n]},removeRegion:function(n){var o=this._regions[n];this._remove(n,o)},removeRegions:function(){d.each(this._regions,function(o,n){this._remove(n,o)},this)},closeRegions:function(){d.each(this._regions,function(o,n){o.close()},this)},close:function(){this.removeRegions();var n=Array.prototype.slice.call(arguments);m.Controller.prototype.close.apply(this,n)},_store:function(n,o){this._regions[n]=o;this._setLength()},_remove:function(n,o){o.close();delete this._regions[n];this._setLength();this.triggerMethod("region:remove",n,o)},_setLength:function(){this.length=d.size(this._regions)}});var k=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];d.each(k,function(n){l.prototype[n]=function(){var p=d.values(this._regions);var o=[p].concat(d.toArray(arguments));return d[n].apply(d,o)}});return l})(i);i.TemplateCache=function(k){this.templateId=k};d.extend(i.TemplateCache,{templateCaches:{},get:function(k){var l=this.templateCaches[k];if(!l){l=new i.TemplateCache(k);this.templateCaches[k]=l}return l.load()},clear:function(){var l;var k=g(arguments);var m=k.length;if(m>0){for(l=0;l<m;l++){delete this.templateCaches[k[l]]}}else{this.templateCaches={}}}});d.extend(i.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var k=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(k);return this.compiledTemplate},loadTemplate:function(k){var l=i.$(k).html();if(!l||l.length===0){h("Could not find template: '"+k+"'","NoTemplateError")}return l},compileTemplate:function(k){return d.template(k)}});i.Renderer={render:function(m,n){if(!m){var k=new Error("Cannot render the template since it's false, null or undefined.");k.name="TemplateNotFoundError";throw k}var l;if(typeof m==="function"){l=m}else{l=i.TemplateCache.get(m)}return l(n)}};i.View=j.View.extend({constructor:function(l){d.bindAll(this,"render");var k=Array.prototype.slice.apply(arguments);this.options=d.extend({},this.options,l);this.events=this.normalizeUIKeys(d.result(this,"events"));j.View.prototype.constructor.apply(this,k);i.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:i.triggerMethod,getTemplate:function(){return i.getOption(this,"template")},mixinTemplateHelpers:function(k){k=k||{};var l=i.getOption(this,"templateHelpers");if(d.isFunction(l)){l=l.call(this)}return d.extend(k,l)},normalizeUIKeys:function(k){if(typeof(k)==="undefined"){return}d.each(d.keys(k),function(l){var m=l.split("@ui.");if(m.length===2){k[m[0]+this.ui[m[1]]]=k[l];delete k[l]}},this);return k},configureTriggers:function(){if(!this.triggers){return}var l={};var k=this.normalizeUIKeys(d.result(this,"triggers"));d.each(k,function(o,n){var p=d.isObject(o);var m=p?o.event:o;l[n]=function(v){if(v){var q=v.preventDefault;var u=v.stopPropagation;var t=p?o.preventDefault:q;var s=p?o.stopPropagation:u;if(t&&q){q.apply(v)}if(s&&u){u.apply(v)}}var r={view:this,model:this.model,collection:this.collection};this.triggerMethod(m,r)}},this);return l},delegateEvents:function(k){this._delegateDOMEvents(k);i.bindEntityEvents(this,this.model,i.getOption(this,"modelEvents"));i.bindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(k){k=k||this.events;if(d.isFunction(k)){k=k.call(this)}var m={};var l=this.configureTriggers();d.extend(m,k,l);j.View.prototype.delegateEvents.call(this,m)},undelegateEvents:function(){var k=Array.prototype.slice.call(arguments);j.View.prototype.undelegateEvents.apply(this,k);i.unbindEntityEvents(this,this.model,i.getOption(this,"modelEvents"));i.unbindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return}var k=this.triggerMethod("before:close");if(k===false){return}this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return}if(!this._uiBindings){this._uiBindings=this.ui}var k=d.result(this,"_uiBindings");this.ui={};d.each(d.keys(k),function(m){var l=k[m];this.ui[m]=this.$(l)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return}d.each(this.ui,function(l,k){delete this.ui[k]},this);this.ui=this._uiBindings;delete this._uiBindings}});i.ItemView=i.View.extend({constructor:function(){i.View.prototype.constructor.apply(this,g(arguments))},serializeData:function(){var k={};if(this.model){k=this.model.toJSON()}else{if(this.collection){k={items:this.collection.toJSON()}}}return k},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var m=this.serializeData();m=this.mixinTemplateHelpers(m);var l=this.getTemplate();var k=i.Renderer.render(l,m);this.$el.html(k);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return}this.triggerMethod("item:before:close");i.View.prototype.close.apply(this,g(arguments));this.triggerMethod("item:closed")}});i.CollectionView=i.View.extend({itemViewEventPrefix:"itemview",constructor:function(k){this._initChildViewStorage();i.View.prototype.constructor.apply(this,g(arguments));this._initialEvents();this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment()},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true},endBuffering:function(){this.appendBuffer(this,this.elBuffer);this.initRenderBuffer();this.isBuffering=false},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(n,o,l){this.closeEmptyView();var m=this.getItemView(n);var k=this.collection.indexOf(n);this.addItemView(n,m,k)},onShowCalled:function(){this.children.each(function(k){i.triggerMethod.call(k,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.startBuffering();this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}this.endBuffering()},showCollection:function(){var k;this.collection.each(function(m,l){k=this.getItemView(m);this.addItemView(m,k,l)},this)},showEmptyView:function(){var l=this.getEmptyView();if(l&&!this._showingEmptyView){this._showingEmptyView=true;var k=new j.Model();this.addItemView(k,l,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getEmptyView:function(){return i.getOption(this,"emptyView")},getItemView:function(l){var k=i.getOption(this,"itemView");if(!k){h("An `itemView` must be specified","NoItemViewError")}return k},addItemView:function(n,m,l){var o=i.getOption(this,"itemViewOptions");if(d.isFunction(o)){o=o.call(this,n,l)}var k=this.buildItemView(n,m,o);this.addChildViewEventForwarding(k);this.triggerMethod("before:item:added",k);this.children.add(k);this.renderItemView(k,l);if(this._isShown){i.triggerMethod.call(k,"show")}this.triggerMethod("after:item:added",k)},addChildViewEventForwarding:function(k){var l=i.getOption(this,"itemViewEventPrefix");this.listenTo(k,"all",function(){var m=g(arguments);m[0]=l+":"+m[0];m.splice(1,0,k);i.triggerMethod.apply(this,m)},this)},renderItemView:function(k,l){k.render();this.appendHtml(this,k,l)},buildItemView:function(m,k,n){var l=d.extend({model:m},n);return new k(l)},removeItemView:function(l){var k=this.children.findByModel(l);this.removeChildView(k);this.checkEmpty()},removeChildView:function(k){if(k){this.stopListening(k);if(k.close){k.close()}else{if(k.remove){k.remove()}}this.children.remove(k)}this.triggerMethod("item:removed",k)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendBuffer:function(l,k){l.$el.append(k)},appendHtml:function(k,m,l){if(k.isBuffering){k.elBuffer.appendChild(m.el)}else{k.$el.append(m.el)}},_initChildViewStorage:function(){this.children=new j.ChildViewContainer()},close:function(){if(this.isClosed){return}this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");i.View.prototype.close.apply(this,g(arguments))},closeChildren:function(){this.children.each(function(k){this.removeChildView(k)},this);this.checkEmpty()}});i.CompositeView=i.CollectionView.extend({constructor:function(){i.CollectionView.prototype.constructor.apply(this,g(arguments))},_initialEvents:function(){this.once("render",function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}})},getItemView:function(l){var k=i.getOption(this,"itemView")||this.constructor;if(!k){h("An `itemView` must be specified","NoItemViewError")}return k},serializeData:function(){var k={};if(this.model){k=this.model.toJSON()}return k},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var k=this.renderModel();this.$el.html(k);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){i.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var l={};l=this.serializeData();l=this.mixinTemplateHelpers(l);var k=this.getTemplate();return i.Renderer.render(k,l)},appendBuffer:function(l,k){var m=this.getItemViewContainer(l);m.append(k)},appendHtml:function(k,m,l){if(k.isBuffering){k.elBuffer.appendChild(m.el)}else{var n=this.getItemViewContainer(k);n.append(m.el)}},getItemViewContainer:function(n){if("$itemViewContainer" in n){return n.$itemViewContainer}var l;var m=i.getOption(n,"itemViewContainer");if(m){var k=d.isFunction(m)?m():m;l=n.$(k);if(l.length<=0){h("The specified `itemViewContainer` was not found: "+n.itemViewContainer,"ItemViewContainerMissingError")}}else{l=n.$el}n.$itemViewContainer=l;return l},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});i.Layout=i.ItemView.extend({regionType:i.Region,constructor:function(k){k=k||{};this._firstRender=true;this._initializeRegions(k);i.ItemView.prototype.constructor.call(this,k)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var l=Array.prototype.slice.apply(arguments);var k=i.ItemView.prototype.render.apply(this,l);return k},close:function(){if(this.isClosed){return}this.regionManager.close();var k=Array.prototype.slice.apply(arguments);i.ItemView.prototype.close.apply(this,k)},addRegion:function(k,l){var m={};m[k]=l;return this._buildRegions(m)[k]},addRegions:function(k){this.regions=d.extend({},this.regions,k);return this._buildRegions(k)},removeRegion:function(k){delete this.regions[k];return this.regionManager.removeRegion(k)},_buildRegions:function(m){var k=this;var l={regionType:i.getOption(this,"regionType"),parentEl:function(){return k.$el}};return this.regionManager.addRegions(m,l)},_initializeRegions:function(k){var l;this._initRegionManager();if(d.isFunction(this.regions)){l=this.regions(k)}else{l=this.regions||{}}this.addRegions(l)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(k){k.reset()})},_initRegionManager:function(){this.regionManager=new i.RegionManager();this.listenTo(this.regionManager,"region:add",function(k,l){this[k]=l;this.trigger("region:add",k,l)});this.listenTo(this.regionManager,"region:remove",function(k,l){delete this[k];this.trigger("region:remove",k,l)})}});i.AppRouter=j.Router.extend({constructor:function(l){j.Router.prototype.constructor.apply(this,g(arguments));this.options=l||{};var m=i.getOption(this,"appRoutes");var k=this._getController();this.processAppRoutes(k,m)},appRoute:function(m,l){var k=this._getController();this._addAppRoute(k,m,l)},processAppRoutes:function(k,m){if(!m){return}var l=d.keys(m).reverse();d.each(l,function(n){this._addAppRoute(k,n,m[n])},this)},_getController:function(){return i.getOption(this,"controller")},_addAppRoute:function(k,m,l){var n=k[l];if(!n){throw new Error("Method '"+l+"' was not found on the controller")}this.route(m,l,d.bind(n,k))}});i.Application=function(k){this._initRegionManager();this._initCallbacks=new i.Callbacks();this.vent=new j.Wreqr.EventAggregator();this.commands=new j.Wreqr.Commands();this.reqres=new j.Wreqr.RequestResponse();this.submodules={};d.extend(this,k);this.triggerMethod=i.triggerMethod};d.extend(i.Application.prototype,j.Events,{execute:function(){var k=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,k)},request:function(){var k=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,k)},addInitializer:function(k){this._initCallbacks.add(k)},start:function(k){this.triggerMethod("initialize:before",k);this._initCallbacks.run(k,this);this.triggerMethod("initialize:after",k);this.triggerMethod("start",k)},addRegions:function(k){return this._regionManager.addRegions(k)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(k){this._regionManager.removeRegion(k)},getRegion:function(k){return this._regionManager.get(k)},module:function(k,m){var l=g(arguments);l.unshift(this);return i.Module.create.apply(i.Module,l)},_initRegionManager:function(){this._regionManager=new i.RegionManager();this.listenTo(this._regionManager,"region:add",function(k,l){this[k]=l});this.listenTo(this._regionManager,"region:remove",function(k,l){delete this[k]})}});i.Application.extend=i.extend;i.Module=function(k,l){this.moduleName=k;this.submodules={};this._setupInitializersAndFinalizers();this.app=l;this.startWithParent=true;this.triggerMethod=i.triggerMethod};d.extend(i.Module.prototype,j.Events,{addInitializer:function(k){this._initializerCallbacks.add(k)},addFinalizer:function(k){this._finalizerCallbacks.add(k)},start:function(k){if(this._isInitialized){return}d.each(this.submodules,function(l){if(l.startWithParent){l.start(k)}});this.triggerMethod("before:start",k);this._initializerCallbacks.run(k,this);this._isInitialized=true;this.triggerMethod("start",k)},stop:function(){if(!this._isInitialized){return}this._isInitialized=false;i.triggerMethod.call(this,"before:stop");d.each(this.submodules,function(k){k.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();i.triggerMethod.call(this,"stop")},addDefinition:function(k,l){this._runModuleDefinition(k,l)},_runModuleDefinition:function(l,m){if(!l){return}var k=d.flatten([this,this.app,j,i,i.$,d,m]);l.apply(this,k)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new i.Callbacks();this._finalizerCallbacks=new i.Callbacks()}});d.extend(i.Module,{create:function(q,k,l){var m=q;var o=g(arguments);o.splice(0,3);k=k.split(".");var n=k.length;var p=[];p[n-1]=l;d.each(k,function(r,s){var t=m;m=this._getModule(t,r,q);this._addModuleDefinition(t,m,p[s],o)},this);return m},_getModule:function(o,l,p,n,k){var m=o[l];if(!m){m=new i.Module(l,p);o[l]=m;o.submodules[l]=m}return m},_addModuleDefinition:function(p,l,o,k){var n;var m;if(d.isFunction(o)){n=o;m=true}else{if(d.isObject(o)){n=o.define;m=o.startWithParent}else{m=true}}if(n){l.addDefinition(n,k)}l.startWithParent=l.startWithParent&&m;if(l.startWithParent&&!l.startWithParentIsConfigured){l.startWithParentIsConfigured=true;p.addInitializer(function(q){if(l.startWithParent){l.start(q)}})}}});return i})(this,Backbone,_);c.noConflict=function(){b.Marionette=a;return this};b.Marionette=c})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/marionette.adapter.js' */
AJS.namespace("JIRA.Libs.Marionette");JIRA.Libs.Marionette=Marionette.noConflict();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Mixins.js' */
AJS.namespace("JIRA.Marionette.Mixins");JIRA.Marionette.Mixins={listenAndRethrow:function(b,a){a=[].concat(a);_.each(a,function(c){this.listenTo(b,c,function(){this.trigger.apply(this,[c].concat(_.toArray(arguments)))},this)},this)}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/LinkRegion.js' */
AJS.namespace("JIRA.Marionette.LinkRegion");JIRA.Marionette.LinkRegion=JIRA.Libs.Marionette.Region.extend({open:function(a){this.$el.append(a.$el.children());a.setElement(this.$el)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/ReplaceRegion.js' */
AJS.namespace("JIRA.Marionette.ReplaceRegion");JIRA.Marionette.ReplaceRegion=JIRA.Libs.Marionette.Region.extend({open:function(a){this.$el.replaceWith(a.el)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Controller.js' */
AJS.namespace("JIRA.Marionette.Controller");JIRA.Marionette.Controller=JIRA.Libs.Marionette.Controller.extend({});_.extend(JIRA.Marionette.Controller.prototype,JIRA.Marionette.Mixins);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/ItemView.js' */
AJS.namespace("JIRA.Marionette.ItemView");JIRA.Marionette.ItemView=JIRA.Libs.Marionette.ItemView.extend({renderTemplate:function(){var c=this.serializeData();c=this.mixinTemplateHelpers(c);var b=this.getTemplate();var a=JIRA.Libs.Marionette.Renderer.render(b,c);return JIRA.Libs.Marionette.$(a)},applyToDom:function(){this.delegateEvents();this.bindUIElements();this.triggerMethod("applyToDom")},unwrapTemplate:function(){if(this.$el.parent().length){var a=this.$el.children();this.$el.replaceWith(a);this.setElement(a)}else{this.setElement(this.$el.children())}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/CollectionView.js' */
AJS.namespace("JIRA.Marionette.CollectionView");JIRA.Marionette.CollectionView=JIRA.Libs.Marionette.CollectionView.extend({_appendHtmlWithIndex:function(a,d,b){var c=a.children();var e=c.length;if(b<=0){a.prepend(d.$el)}else{if(!e||b>=e){a.append(d.$el)}else{d.$el.insertBefore(c.eq(b))}}},appendHtml:function(a,c,b){this._appendHtmlWithIndex(a.$el,c,b)},unwrapTemplate:function(){JIRA.Marionette.ItemView.prototype.unwrapTemplate.call(this)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/CompositeView.js' */
AJS.namespace("JIRA.Marionette.CompositeView");JIRA.Marionette.CompositeView=JIRA.Libs.Marionette.CompositeView.extend({appendHtml:function(a,c,b){JIRA.Marionette.CollectionView.prototype._appendHtmlWithIndex(this.getItemViewContainer(a),c,b)},unwrapTemplate:function(){JIRA.Marionette.ItemView.prototype.unwrapTemplate.call(this)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Layout.js' */
AJS.namespace("JIRA.Marionette.Layout");JIRA.Marionette.Layout=JIRA.Libs.Marionette.Layout.extend({applyToDom:function(){this.delegateEvents();this.bindUIElements();this._reInitializeRegions();this.triggerMethod("applyToDom")}});_.extend(JIRA.Marionette.Layout.prototype,JIRA.Marionette.Mixins);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Application.js' */
AJS.namespace("JIRA.Marionette.Application");JIRA.Marionette.Application=JIRA.Libs.Marionette.Application.extend({constructor:function(a){JIRA.Libs.Marionette.Application.call(this,a)},start:function(a){if(!a||a.forceStop!==false){this.stop()}JIRA.Libs.Marionette.Application.prototype.start.call(this,a)},stop:function(){_.invoke(this.submodules,"stop")}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/AppModule.js' */
AJS.namespace("JIRA.Marionette.AppModule");JIRA.Marionette.AppModule=function(){this.definition=_.bind(this.definition,this)};JIRA.Marionette.AppModule.extend=JIRA.Libs.Marionette.extend;_.extend(JIRA.Marionette.AppModule.prototype,{create:function(){throw new Error("create() must be implemented by AppModules")},generateMasterRequest:false,name:"",commands:{},requests:{},events:[],definition:function(b,d){var c=this.name;var a=this;if(!c){throw new Error("'name' must be defined by AppModules")}b.addInitializer(function(g){var f=a.create.apply(a,_.toArray(arguments));function i(k){if(_.isFunction(k)){k=k(f)}var l={};_.each(k,function(n,m){if(n===true){n=_.bind(f[m],f)}if(m&&c){m=c+":"+m}else{m=c}l[m]=n});return l}function h(l,k){if(_.isFunction(k)){k=k(f)}_.each(k,function(n){var m=c+":"+n;l.listenTo(f,n,function(){this.trigger.apply(this,[m].concat(_.toArray(arguments)))})})}var e=i(a.commands);var j=i(a.requests);if(a.generateMasterRequest){_.extend(j,i({"":function(){return f}}))}d.commands.setHandlers(e);d.reqres.setHandlers(j);h(d,a.events)})}});_.extend(JIRA.Marionette.AppModule.prototype,JIRA.Marionette.Mixins);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/DialogView.js' */
AJS.namespace("JIRA.Marionette.DialogView");JIRA.Marionette.DialogView=JIRA.Marionette.ItemView.extend({dialog:null,template:jQuery.noop,_generateDialog:function(){var c=this.serializeData();var b=this.getTemplate();var d={id:this.id,content:function(e){e(b(c))},submitHandler:_.bind(this._generateSubmissionXHR,this)};var a=JIRA.Libs.Marionette.getOption(this,"dialogOptions");if(_.isFunction(a)){a=a.apply(this)}return new JIRA.FormDialog(_.extend(d,a))},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.dialog=this._generateDialog();this.dialog.show();this.$el=this.dialog.get$popup();jQuery(this.dialog).on("Dialog.hide",_.bind(function(c,a,b){if(b===JIRA.Dialog.HIDE_REASON.cancel||b===JIRA.Dialog.HIDE_REASON.escape){this.close()}},this));this.triggerMethod("render",this);return this},close:function(){if(this.isClosed){return}var a=this.triggerMethod("before:close");if(a===false){return}jQuery(this.dialog).off("Dialog.hide");this.dialog.hide(true);this.dialog.destroy();this.isClosed=true;this.triggerMethod("close");this.remove()},_generateSubmissionXHR:function(f,a){f.preventDefault();var c=this.dialog.$form;var d=JIRA.Libs.Marionette.getOption(this,"formToRequestData");if(_.isFunction(d)){d=d.call(this,c)}var b=JIRA.SmartAjax.makeRequest({type:c.attr("method"),url:c.attr("action"),contentType:"application/json",dataType:"json",processData:false,data:JSON.stringify(d)}).done(a).done(_.bind(this._onSubmitSuccess,this)).fail(_.bind(this._onSubmitError,this));return b},_onSubmitSuccess:function(a){this.triggerMethod("submit:success",a);this.close()},_onSubmitError:function(a){this.dialog.getButtonsContainer().find("input").removeAttr("disabled");this.dialog.hideFooterLoadingIndicator();this.dialog.$form.removeClass("submitting");this._showErrorFromXHR(a);this.triggerMethod("submit:error")},_displayFieldErrors:function(b){var a=this.dialog.$popup;_.each(b,function(c,d){a.find("#"+d).after("<div class='error'>"+AJS.escapeHTML(c)+"</div>")})},_displayGenericErrors:function(b){var a=this.dialog.$popup.find(".aui-messages");_.each(b,function(d){var c={closeable:true,timeout:5};c.body=AJS.escapeHTML(d);c.shadowed=false;AJS.messages.error(a,c)})},_displayXHRErrors:function(b){var a=this.dialog.$popup.find(".aui-messages");a.append(JIRA.SmartAjax.buildDialogErrorContent(b,true))},_showErrorFromXHR:function(b){this._removeErrorMessages();var c;try{c=JSON.parse(b.responseText)}catch(a){c=null}if(c){this._displayFieldErrors(c.errors);this._displayGenericErrors(c.errorMessages)}else{this._displayXHRErrors(b)}},_removeErrorMessages:function(){this.dialog.$popup.find(".error").remove();this.dialog.$popup.find(".aui-messages").empty()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/InlineDialogView.js' */
AJS.namespace("JIRA.Marionette.InlineDialogView");JIRA.Marionette.InlineDialogView=JIRA.Marionette.ItemView.extend({dialog:null,template:jQuery.noop,_getDialogOptions:function(){var b={noBind:true};var a=JIRA.Libs.Marionette.getOption(this,"dialogOptions")||{};if(_.isFunction(a)){a=a.apply(this)}a=_.extend({},b,a);a.hideCallback=_.bind(function(){this.close()},this);return a},_getTrigger:function(){var a=JIRA.Libs.Marionette.getOption(this,"trigger");if(_.isFunction(a)){a=a.apply(this)}return a},_generateDialog:function(){var d=this.serializeData();var c=this.getTemplate();var b=this._getDialogOptions();var a=this._getTrigger();return AJS.InlineDialog(a,this.id,function(f,e,g){f.html(c(d));g()},b)},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.dialog=this._generateDialog();this.$el=this.dialog;this.id=this.dialog.id;this.dialog.show();this.triggerMethod("render",this);return this},close:function(){if(this.isClosed){return}var a=this.triggerMethod("before:close");if(a===false){return}this.dialog.hide();this.isClosed=true;this.triggerMethod("close");this.remove()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/Analytics.js' */
AJS.namespace("JIRA.Components.Analytics");JIRA.Components.Analytics=JIRA.Marionette.Controller.extend({initialize:function(a){this.triggerService=new JIRA.Components.Analytics.Services.Trigger(a);this.trackerService=new JIRA.Components.Analytics.Services.DomTracker(this.triggerService)},trigger:function(a,b){this.triggerService.trigger(a,b)},registerEvent:function(b){var a=[].concat(b);_.each(a,function(c){this.triggerService.registerEvent(c)},this)},registerTracker:function(a){var b=[].concat(a);_.each(b,function(c){this.trackerService.registerTracker(c)},this)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/AnalyticsAppModule.js' */
AJS.namespace("JIRA.Components.Analytics.AppModule");JIRA.Components.Analytics.AppModule=JIRA.Marionette.AppModule.extend({name:"analytics",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{useLog:false});return new JIRA.Components.Analytics(a)},commands:{trigger:true,registerEvent:true,registerTracker:true}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/services/Trigger.js' */
AJS.namespace("JIRA.Components.Analytics.Services.Trigger");JIRA.Components.Analytics.Services.Trigger=JIRA.Marionette.Controller.extend({initialize:function(a){this.useLog=a.useLog;this.allowedEvents=[];this.startTime=new Date().getTime();this.pageSessionGuid=Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)},trigger:function(b,c){if(!AJS.EventQueue){return}if(!_.contains(this.allowedEvents,b)){return}c=c||{};c.context_pageSession=this.pageSessionGuid;c.context_pageTime=new Date().getTime()-this.startTime;AJS.EventQueue.push({name:b,properties:c});if(this.useLog){var a="***** Analytics log ["+b+"]";a+="["+JSON.stringify(c)+"]";AJS.log(a)}},registerEvent:function(a){this.allowedEvents.push(a)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/services/DomTracker.js' */
AJS.namespace("JIRA.Components.Analytics.Services.DomTracker");JIRA.Components.Analytics.Services.DomTracker=JIRA.Marionette.Controller.extend({initialize:function(a){this.triggerService=a;this.trackers=[]},registerTracker:function(a){var b=this.triggerService;_.defaults(a,{type:"click",handler:function(d,c){b.trigger(this.name,c)},context:document});b.registerEvent(a.name);a.domHandler=function(c){if(!c.preventFurtherAnalytics){a.handler.apply(a,Array.prototype.slice.call(arguments))}};AJS.$(a.context).on(a.type,a.selector,a.domHandler);this.trackers.push(a)},clear:function(){_.each(this.trackers,function(a){AJS.$(a.context).off(a.type,a.selector,a.domHandler)})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/AttributesMixinCreator.js' */
AJS.namespace("JIRA.Issues.AttributesMixinCreator");(function(){JIRA.Issues.AttributesMixinCreator={create:function(b){var a={};if(_.indexOf(b,"id")===-1){b.unshift("id")}_.each(b,function(d){var e=JIRA.Issues.Mixins.createMethodName("set",d);a[e]=function(h,f){var g={};g[d]=h;this.set(g,f);return this};var c=JIRA.Issues.Mixins.createMethodName("get",d);a[c]=function(){return this.get(d)}});return a}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/EventsMixinCreator.js' */
(function(){JIRA.Issues.EventsMixinCreator={create:function(b){var a={};var c=function(e){var d=JIRA.Issues.Mixins.createMethodName("bind",e);a[d]=function(){return this.bind.apply(this,[e].concat(_.toArray(arguments)))};var g=JIRA.Issues.Mixins.createMethodName("unbind",e);a[g]=function(){return this.unbind.apply(this,[e].concat(_.toArray(arguments)))};var f=JIRA.Issues.Mixins.createMethodName("trigger",e);a[f]=function(){return this.trigger.apply(this,[e].concat(_.toArray(arguments)))};var h=JIRA.Issues.Mixins.createMethodName("one",e);a[h]=function(){var i=this;var j=arguments[0];var l=function(){i.unbind(e,l);j(arguments)};var k=_.toArray(arguments).slice(1);return this.bind.apply(this,[e,l].concat(k))}};_.each(b,_.bind(c,this));return a}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Extensions.js' */
AJS.namespace("JIRA.Issues.BaseModel");AJS.namespace("JIRA.Issues.BaseCollection");AJS.namespace("JIRA.Issues.BaseView");AJS.namespace("JIRA.Issues.BaseRouter");(function(){function applyMixin(ctor,mixin){_.forEach(_.keys(mixin),function(key){var proto=ctor.prototype;if("initialize"===key){var oldInitialize=proto.initialize;proto.initialize=function(){mixin.initialize.apply(this,arguments);if(oldInitialize){oldInitialize.apply(this,arguments)}};return}if("validate"===key){var oldValidate=proto.validate;proto.validate=function(){var errors=mixin.validate.apply(this,arguments);if(errors){return errors}if(oldValidate){return oldValidate.apply(this,arguments)}};return}if("defaults"===key){var defaults=proto.defaults||(proto.defaults={});var mixinDefaults=mixin[key];for(var id in mixinDefaults){if(defaults.hasOwnProperty(id)){throw"Mixin error: object "+ctor+" already has default "+id+" defined for mixin "+mixin}defaults[id]=mixinDefaults[id]}return}if("properties"===key){if(!_.isArray(mixin[key])){throw"Expects properties member on mixin to be an array"}if(!proto.properties){proto.properties=[]}proto.properties=proto.properties.concat(mixin[key]);return}if("namedEvents"===key){if(!_.isArray(mixin[key])){throw"Expects events member on mixin to be an array"}if(!proto.namedEvents){proto.namedEvents=[]}proto.namedEvents=proto.namedEvents.concat(mixin[key]);return}if(proto.hasOwnProperty(key)){throw"Mixin error: object "+ctor+" already has property "+key+" for mixin "+mixin}proto[key]=mixin[key]},this)}function generateMixinExtend(oldExtend){return function(protoProps,classProps){var child;var cleanProtoProps=_.extend({},protoProps);var mixins;if(protoProps&&protoProps.mixins){mixins=protoProps.mixins;delete cleanProtoProps.mixins}child=oldExtend.call(this,cleanProtoProps,classProps);if(mixins){_.each(protoProps.mixins,function(mixin){applyMixin(child,mixin)})}if(child.prototype.namedEvents){applyMixin(child,JIRA.Issues.EventsMixinCreator.create(child.prototype.namedEvents))}if(child.prototype.properties){applyMixin(child,JIRA.Issues.AttributesMixinCreator.create(child.prototype.properties))}child.extend=arguments.callee;return child}}function overrideSetGet(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.set=function(key,value,options){var attrs,properties=this.properties;if(properties){if(_.isObject(key)||key==null){attrs=key}else{attrs={};attrs[key]=value}for(var attr in attrs){if(_.indexOf(properties,attr)<0){throw"Property '"+attr+"' does not exist"}}}return proto.set.apply(this,arguments)};childProto.get=function(attr){if(this.properties&&_.indexOf(this.properties,attr)<0){throw"Property '"+attr+"' does not exist"}return proto.get.apply(this,arguments)}}function addListenMethods(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.addListener=function(other,event,callback,context){if(arguments.length<3){throw"The 'other', 'event', and 'callback' arguments are mandatory"}var capitalisedEvent=event.charAt(0).toUpperCase()+event.slice(1);var registerMethodName="on"+capitalisedEvent;var unregisterMethodName="off"+capitalisedEvent;var braceRegisterMethodName="bind"+capitalisedEvent;var braceUnregisterMethodName="unbind"+capitalisedEvent;var finalRegisterName;var finalUnRegisterName;if(other[registerMethodName]){finalRegisterName=registerMethodName;finalUnRegisterName=unregisterMethodName||braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have method "+registerMethodName+"'"}if(typeof other[finalUnRegisterName]!=="function"){throw"object does not have method "+unregisterMethodName+"'"}}else{finalRegisterName=braceRegisterMethodName;finalUnRegisterName=braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have event ["+event+"] registered'"}}other[finalRegisterName](callback,context);this._cleanerUppers=this._cleanerUppers||[];this._cleanerUppers.push(function(){other[finalUnRegisterName](callback,context)})};childProto.removeListeners=function(){if(this._cleanerUppers){_.each(this._cleanerUppers,function(cleanerUpper){cleanerUpper()})}}}function addViewCleanupMethods(ctor,childCtor){var childProto=childCtor.prototype;var superRemove=ctor.prototype.remove;childProto.remove=function(){this.removeListeners();return superRemove.apply(this,arguments)};childProto.deactivate=function(){this.undelegateEvents();this.removeListeners()}}function applyExtensions(ctor){var child=ctor.extend();var oldExtend=ctor.extend;child.extend=generateMixinExtend(oldExtend);return child}function applyModelExtensions(ctor){var child=applyExtensions(ctor);overrideSetGet(ctor,child);return child}function applyViewExtensions(ctor){var child=applyExtensions(ctor);addListenMethods(ctor,child);addViewCleanupMethods(ctor,child);return child}JIRA.Issues.BaseModel=applyModelExtensions(Backbone.Model);JIRA.Issues.BaseCollection=applyExtensions(Backbone.Collection);JIRA.Issues.BaseView=applyViewExtensions(Backbone.View);JIRA.Issues.BaseRouter=applyExtensions(Backbone.Router);var Evented=function(){this.initialize.apply(this,arguments)};_.extend(Evented.prototype,Backbone.Events,{initialize:function(){}});Evented.extend=Backbone.Model.extend;JIRA.Issues.BaseEvented=applyExtensions(Evented);_.mixin({lambda:function(x){return function(){return x}},isNotBlank:function(object){return !!object},bindObjectTo:function(obj,context){_.map(obj,function(value,key){if(_.isFunction(value)){obj[key]=_.bind(value,context)}})}});Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Mixins.js' */
(function(){JIRA.Issues.Mixins={createMethodName:function(a,b){return a+b.charAt(0).toUpperCase()+b.substr(1)}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/ModelUtils.js' */
(function(){var d;function c(){this.modelEvents={}}c.prototype.captureEvent=function(g,f){var e=f[0];this.modelEvents[g.cid]||(this.modelEvents[g.cid]={model:g,events:{}});this.modelEvents[g.cid].events[e]=f};c.prototype.replayEvents=function(){_.each(this.modelEvents,function(e){_.each(e.events,function(g,f){Backbone.Events.trigger.apply(e.model,g)})})};function a(f){var e=this;if(f==="change"||f.indexOf("change:")===0){d.log.captureEvent(e,_.toArray(arguments))}else{Backbone.Events.trigger.apply(e,arguments)}}var b=function(){if(d){return{commit:function(){}}}d={log:new c()};var e=JIRA.Issues.Utils.patch(Backbone.Model.prototype,"trigger",a);return{commit:function(){e();d.log.replayEvents();d=null}}};JIRA=JIRA||{};JIRA.Issues=JIRA.Issues||{};JIRA.Issues.ModelUtils=JIRA.Issues.ModelUtils||{};JIRA.Issues.ModelUtils.transaction=function(g,f){var e=b();try{return g.apply(f)}finally{e.commit()}};JIRA.Issues.ModelUtils.makeTransactional=function(f){var g=function(h){return function(){var i=arguments;return JIRA.Issues.ModelUtils.transaction(function(){return h.apply(this,i)},this)}};var e=Array.prototype.slice.call(arguments,1);if(e.length===0){e=_.functions(f)}_.each(e,function(h){if(h.indexOf("_")!==0){f[h]=g(f[h])}})}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.queryparams.js' */
/*! THIS FILE HAS BEEN MODIFIED BY ATLASSIAN, SEE https://github.com/jhudson8/backbone-query-parameters/pull/63/files */
(function(a,b){if(typeof exports==="object"&&a.require){module.exports=b(require("underscore"),require("backbone"))}else{if(typeof define==="function"&&define.amd){define(["underscore","backbone"],function(c,d){return b(c||a._,d||a.Backbone)})}else{b(_,Backbone)}}}(this,function(q,b){var i=/^\?(.*)/,g=/\((.*?)\)/g,e=/(\(\?)?:\w+/g,o=/\*\w+/g,d=/[\-{}\[\]+?.,\\\^$|#\s]/g,h=/^([^\?]*)/,k=/[\:\*]([^\:\?\/]+)/g,j=/^[#\/]|\s+$/g,c=/\/$/;b.Router.arrayValueSplit="|";var f=function(u,t){if(u==null){if(this._hasPushState||!this._wantsHashChange||t){u=this.location.pathname;var s=this.root.replace(c,"");var v=this.location.search;if(!u.indexOf(s)){u=u.substr(s.length)}if(v){u+=v}}else{u=this.getHash()}}return u.replace(j,"")};function l(u,t,s){q.each(Array.prototype.slice.call(arguments,2),function(v){Object.defineProperty(t,v,{get:function(){return u[v]},set:function(w){u[v]=w}})})}l.isSupported=(function(){try{Object.defineProperty({},"x",{});return true}catch(s){return false}})();function a(u){var s=u.location,t={};l(s,t,"assign","ancestorOrigins","origin","hash","search","pathname","port","hostname","host","protocol","href","reload");t.replace=function(){s.replace(u.root+"#"+u.fragment)};t.unPatch=function(){return u.location=s};u.location=t}function r(u){var s=u.history,t={};l(s,t,"length","state","back","forward","go","pushState");t.replaceState=function(w,x,v){v=u.root+u.fragment;return s.replaceState(w,x,v)};t.unPatch=function(){u.history=s};u.history=t}var m=b.History.prototype.start,n=b.History.prototype.loadUrl;q.extend(b.History.prototype,{getFragment:f,getQueryParameters:function(u,s){u=f.apply(this,arguments);var w=u.replace(h,"");var t=w.match(i);if(t){w=t[1];var v={};p(w,function(x,y){y=y.replace(/\+/g,"%20");y=decodeURIComponent(y);if(!v[x]){v[x]=y}else{if(q.isString(v[x])){v[x]=[v[x],y]}else{v[x].push(y)}}});return v}else{return{}}},start:function(){if(l.isSupported){a(this);r(this)}try{return m.apply(this,arguments)}finally{this.location.unPatch&&this.location.unPatch();this.history.unPatch&&this.history.unPatch()}},loadUrl:function(){this.location&&this.location.unPatch&&this.location.unPatch();this.history&&this.history.unPatch&&this.history.unPatch();return n.apply(this,arguments)}});q.extend(b.Router.prototype,{initialize:function(s){this.encodedSplatParts=s&&s.encodedSplatParts},getFragment:f,_routeToRegExp:function(t){var u=(o.exec(t)||{index:-1}),s=(e.exec(t)||{index:-1}),w=t.match(k)||[];t=t.replace(d,"\\$&").replace(g,"(?:$1)?").replace(e,function(y,x){return x?y:"([^\\/\\?]+)"}).replace(o,"([^??]*?)");t+="(\\?.*)?";var v=new RegExp("^"+t+"$");if(u.index>=0){if(s>=0){v.splatMatch=u.index-s.index}else{v.splatMatch=-1}}v.paramNames=q.map(w,function(x){return x.substring(1)});v.namedParameters=this.namedParameters;return v},_extractParameters:function(A,y){var u=A.exec(y).slice(1),z={};if(u.length>0&&q.isUndefined(u[u.length-1])){u.splice(u.length-1,1)}var x=u.length&&u[u.length-1]&&u[u.length-1].match(i);if(x){var s=x[1];var w={};if(s){var B=this;p(s,function(C,D){B._setParamValue(C,D,w)})}u[u.length-1]=w;q.extend(z,w)}var t=u.length;if(A.splatMatch&&this.encodedSplatParts){if(A.splatMatch<0){return u}else{t=t-1}}for(var v=0;v<t;v++){if(q.isString(u[v])){u[v]=decodeURIComponent(u[v]);if(A.paramNames&&A.paramNames.length>=v-1){z[A.paramNames[v]]=u[v]}}}return(b.Router.namedParameters||A.namedParameters)?[z]:u},_setParamValue:function(u,x,w){u=u.replace("[]","");var y=u.split(".");var v=w;for(var t=0;t<y.length;t++){var s=y[t];if(t===y.length-1){v[s]=this._decodeParamValue(x,v[s])}else{v=v[s]=v[s]||{}}}},_decodeParamValue:function(v,u){v=v.replace(/\+/g,"%20");var w=b.Router.arrayValueSplit;if(w&&v.indexOf(w)>=0){var s=v.split(w);for(var t=s.length-1;t>=0;t--){if(!s[t]){s.splice(t,1)}else{s[t]=decodeURIComponent(s[t])}}return s}v=decodeURIComponent(v);if(!u){return v}else{if(q.isArray(u)){u.push(v);return u}else{return[u,v]}}},toFragment:function(t,s){if(s){if(!q.isString(s)){s=this._toQueryString(s)}if(s){t+="?"+s}}return t},_toQueryString:function(u,s){var B=b.Router.arrayValueSplit;function w(D){return String(D).replace(B,encodeURIComponent(B))}if(!u){return""}s=s||"";var z="";for(var t in u){var y=u[t];if(q.isString(y)||q.isNumber(y)||q.isBoolean(y)||q.isDate(y)){y=this._toQueryParam(y);if(q.isBoolean(y)||q.isNumber(y)||q.isString(y)||y){z+=(z?"&":"")+this._toQueryParamName(t,s)+"="+w(encodeURIComponent(y))}}else{if(q.isArray(y)){var A="";for(var x=0;x<y.length;x++){var v=this._toQueryParam(y[x]);if(q.isBoolean(v)||v!==null){A+=B+w(v)}}if(A){z+=(z?"&":"")+this._toQueryParamName(t,s)+"="+A}}else{var C=this._toQueryString(y,this._toQueryParamName(t,s,true));if(C){z+=(z?"&":"")+C}}}}return z},_toQueryParamName:function(s,u,t){return(u+s+(t?".":""))},_toQueryParam:function(s){if(q.isNull(s)||q.isUndefined(s)){return null}return s}});function p(u,t){var s=u.split("&");q.each(s,function(w){var v=w.split("=");t(v.shift(),v.join("="))})}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k=i.Brace={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View)}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.define.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Utils.js' */
JIRA.Issues.Actions=JIRA.Issues.Actions||{};JIRA.Issues.Actions.DELETE="delete";JIRA.Issues.Actions.UPDATE="update";JIRA.Issues.Actions.INLINE_EDIT="inlineEdit";JIRA.Issues.Actions.ROW_UPDATE="rowUpdate";JIRA.Issues.XsrfTokenHeader={"X-Atlassian-Token":"nocheck"};JIRA.Issues.Utils={isIssueDialog:function(a){return !!a.issueId||_.include(JIRA.Dialogs,a)},isDeleteDialog:function(a){return a.options.id==="delete-issue-dialog"},isEditCommentDialog:function(a){return a.options.id==="edit-comment"},getEffectiveIssueKeyForDialog:function(a){var b=a&&a.$activeTrigger&&a.$activeTrigger.data("issuekey");if(b){return b}else{return JIRA.Issues.Api.getSelectedIssue().getKey()}},getEffectiveIssueIdForDialog:function(a){if(a.issueId){return a.issueId}else{return JIRA.Issues.Api.getSelectedIssue().getId()}},getAction:function(a){if(this.isDeleteDialog(a)){return JIRA.Issues.Actions.DELETE}else{if(this.isEditCommentDialog(a)){return JIRA.Issues.Actions.EDIT_COMMENT}else{return JIRA.Issues.Actions.UPDATE}}},getMessage:function(a){if(!this.isEditCommentDialog(a)){return a.options.issueMsg||"thanks_issue_updated"}},getMeta:function(a){if(this.isEditCommentDialog(a)){return{commentId:a.$activeTrigger.attr("id").replace("edit_comment_","")}}else{return{}}},getUpdateCommandForDialog:function(b){var a=this;if(this.isIssueDialog(b)){return{key:a.getEffectiveIssueKeyForDialog(b),id:a.getEffectiveIssueIdForDialog(b),action:a.getAction(b),message:a.getMessage(b),meta:a.getMeta(b)}}},debounce:function(a,c){var b=Array.prototype.slice.call(arguments,2);if(!a){console.error("JIRA.Issues.Utils.debounce: ctx must be defined")}clearTimeout(a[c+"DebounceTimeout"]);a[c].apply(a,b);if(!a[c+"DebounceTimeout"]){a[c+"Original"]=a[c];a[c]=_.debounce(function(){return a[c+"Original"].apply(a,arguments)},300)}a[c+"DebounceTimeout"]=setTimeout(function(){a[c]=a[c+"Original"];a[c+"DebounceTimeout"]=null},500)},waitForDeferreds:function(e,d,a){a=a||window;var c=[];var b=jQuery.Deferred();_.each(e,function(){var f=d.apply(a,arguments);if(f&&f.promise){c.push(f)}});if(c.length){jQuery.when.apply(jQuery,c).then(function(){b.resolveWith(a)})}else{b.resolveWith(a)}return b.promise()},resolvedPromise:function(){return jQuery.Deferred().resolve().promise()},patch:function(b,a,e){var f=b.hasOwnProperty(a),c=b[a];b[a]=e;return function d(){if(f){b[a]=c}else{delete b[a]}}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/AuiOverrides.js' */
AJS.undim=function(){if(AJS.dim.$dim){AJS.dim.$dim.remove();AJS.dim.$dim=null;if(AJS.dim.shim){AJS.dim.shim.remove()}if(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<8){AJS.$("html").removeAttr("style")}else{AJS.$("body").removeAttr("style")}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollIntoView.js' */
/*!
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(g){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:0,direction:"y"};var f=/^(?:html)$/i;var h=function(l,k){k=k||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var j=document.defaultView&&document.defaultView.getComputedStyle?true:false;var i={top:(parseFloat(j?k.borderTopWidth:g.css(l,"borderTopWidth"))||0),left:(parseFloat(j?k.borderLeftWidth:g.css(l,"borderLeftWidth"))||0),bottom:(parseFloat(j?k.borderBottomWidth:g.css(l,"borderBottomWidth"))||0),right:(parseFloat(j?k.borderRightWidth:g.css(l,"borderRightWidth"))||0)};return{top:i.top,left:i.left,bottom:i.bottom,right:i.right,vertical:i.top+i.bottom,horizontal:i.left+i.right}};var d=function(i){var k=g(window);var j=f.test(i[0].nodeName);return{border:j?{top:0,left:0,bottom:0,right:0}:h(i[0]),scroll:{top:(j?k:i).scrollTop(),left:(j?k:i).scrollLeft()},scrollbar:{right:j?0:i.innerWidth()-i[0].clientWidth,bottom:j?0:i.innerHeight()-i[0].clientHeight},rect:(function(){var l=i[0].getBoundingClientRect();return{top:j?0:l.top,left:j?0:l.left,bottom:j?i[0].clientHeight:l.bottom,right:j?i[0].clientWidth:l.right}})()}};g.fn.extend({scrollIntoViewForAuto:function(k){k=g.extend({},b,k);k.direction=c[typeof(k.direction)==="string"&&k.direction.toLowerCase()]||c.both;var o="";if(k.direction.x===true){o="horizontal"}if(k.direction.y===true){o=o?"both":"vertical"}var m=this.eq(0);var j=m.closest(":scrollable("+o+")");if(j.length>0){j=j.eq(0);var n={e:d(m),s:d(j)};var i={top:n.e.rect.top-(n.s.rect.top+n.s.border.top),bottom:n.s.rect.bottom-n.s.border.bottom-n.s.scrollbar.bottom-n.e.rect.bottom,left:n.e.rect.left-(n.s.rect.left+n.s.border.left),right:n.s.rect.right-n.s.border.right-n.s.scrollbar.right-n.e.rect.right};var l={};if(k.direction.y===true){if(i.top<0){l.scrollTop=n.s.scroll.top+i.top-30}else{if(i.top>0&&i.bottom<0){l.scrollTop=n.s.scroll.top+Math.min(i.top,-i.bottom)+30}}}if(k.direction.x===true){if(i.left<0){l.scrollLeft=n.s.scroll.left+i.left}else{if(i.left>0&&i.right<0){l.scrollLeft=n.s.scroll.left+Math.min(i.left,-i.right)}}}if(!g.isEmptyObject(l)){if(f.test(j[0].nodeName)){j=g("html,body")}j.animate(l,k.duration).eq(0).queue(function(p){g.isFunction(k.complete)&&k.complete.call(j[0]);p()})}else{g.isFunction(k.complete)&&k.complete.call(j[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};g.extend(g.expr[":"],{scrollable:function(l,j,o,i){var n=c[typeof(o[3])==="string"&&o[3].toLowerCase()]||c.both;var m=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var p={x:a[m.overflowX.toLowerCase()]||false,y:a[m.overflowY.toLowerCase()]||false,isRoot:f.test(l.nodeName)};if(!p.x&&!p.y&&!p.isRoot){return false}var k={height:{scroll:l.scrollHeight,client:l.clientHeight},width:{scroll:l.scrollWidth,client:l.clientWidth},scrollableX:function(){return(p.x||p.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(p.y||p.isRoot)&&this.height.scroll>this.height.client}};return n.y&&k.scrollableY()||n.x&&k.scrollableX()}});var e=jQuery.fn.scrollIntoView;JIRA.Issues.overrideScrollIntoViewForSplit=function(){jQuery.fn.scrollIntoView=jQuery.fn.scrollIntoViewForAuto};JIRA.Issues.restoreScrollIntoViewForNormal=function(){jQuery.fn.scrollIntoView=e}})(jQuery);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/IssueNavFeatures.js' */
AJS.namespace("JIRA.Issues.Feature");JIRA.Issues.Feature=Class.extend({init:function(a){this.featureKey=a},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});AJS.namespace("JIRA.Issues.DarkFeatures");JIRA.Issues.DarkFeatures={NO_PREFETCH:new JIRA.Issues.Feature("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new JIRA.Issues.Feature("rotp.project.shortcuts")};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/analytics.js' */
AJS.namespace("JIRA.Issues.AnalyticsLoader");JIRA.Issues.AnalyticsLoader=function(){JIRA.Issues.Application.execute("analytics:registerEvent",["kickass.search","kickass.switchtobasic","kickass.switchtoadvanced","kickass.returntosearch","kickass.editField","kickass.editMultipleFields","kickass.editClientDuration","kickass.editClientCancelledDuration","kickass.editSaveonserverDuration","kickass.issueLoadDuration","kickass.openIssueFromTable","kickass.issueTotalSaveDuration","kickass.focusshifteropened","kickass.queryTooComplexSwitchToAdvanced","kickass.basicModeCriteriaCountWhenSearching","kickass.criteriaAutoUpdateEnabled","kickass.issueTableRefresh","kickass.conditionalLoading","kickass.viewIssue","kickass.inlineEdit"]);JIRA.Issues.Application.execute("analytics:trigger","kickass.criteriaAutoUpdateEnabled",{enabled:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.Issues.Application.execute("analytics:registerTracker",[{name:"kickass.clickedOnSystemFilter",selector:".system-filters a",handler:a},{name:"kickass.clickedOnFavouriteFilter",selector:".favourite-filters a.filter-link"},{name:"kickass.clickedOnFavouriteFilterActionsMenu",selector:".favourite-filters a.filter-actions"},{name:"kickass.renamedFilterFromActionsMenu",selector:"#rename-filter-form",type:"submit"},{name:"kickass.deletedFilterFromActionsMenu",selector:"#delete-filter-form",type:"submit"},{name:"kickass.copiedFilterFromActionsMenu",selector:"#copy-filter-dialog form",type:"submit"},{name:"kickass.removeFilterFromFavouritesViaActionsMenu",selector:".unfavourite-filter"},{name:"kickass.saveACopyOfFilterFromSearchHeader",selector:"#save-filter-dialog form",type:"submit"},{name:"kickass.filterChangesSaved",selector:".header-section-primary .save-changes"},{name:"kickass.clickedOnShowFiltersDetailsDropDown",selector:".show-filter-details",type:"mousedown"},{name:"kickass.clickedOnChangePermissions",selector:".filter-permissions .change-permissions"},{name:"kickass.clickedOnUnfavouriteStar",selector:".filter-operations .fav-link.aui-iconfont-unstar"},{name:"kickass.clickedOnSaveFilterAs",selector:".save-as-new-filter",handler:f},{name:"kickass.clickedOnPagniationLink",selector:".pagination a",handler:e},{name:"kickass.inbrowsersearch",type:"keydown",handler:c},{name:"kickass.reloadPage",type:"keydown",handler:g},{name:"kickass.moreCriteriaNewlySelectedCount",type:AJS.InlineLayer.EVENTS.beforeHide,handler:d},{name:"kickass.createdNewSearch",selector:".new-search"},{name:"kickass.sortByColumn",selector:".sortable",handler:b},{name:"kickass.findFiltersClicked",selector:".find-filters"}]);function a(j){var i=AJS.$(j.target);JIRA.Issues.Application.execute("analytics:trigger",this.name,{name:h(i.attr("href"))})}function f(){var j=AJS.$(".system-filters a.active").length===1,i=AJS.$(".favourite-filters a.active").length===1;JIRA.Issues.Application.execute("analytics:trigger",this.name,{systemFilterSelected:j,favouriteFilterSelected:i})}function h(i){var j=parseUri(i);return j.queryKey.filter}function e(k){var j=AJS.$(k.target),i=j.text();JIRA.Issues.Application.execute("analytics:trigger",this.name,{page:i})}function c(i){if(i.keyCode===70&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Application.execute("analytics:trigger",this.name)}}function g(i){if(i.keyCode===82&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Application.execute("analytics:trigger",this.name)}}function d(l,j){if(j&&j.find("#criteria-multi-select").length){var k=AJS.$("#criteria-multi-select");var i=k.find("input[checked]").length-k.find(".selected-group input[checked]").length;JIRA.Issues.Application.execute("analytics:trigger",this.name,{count:i})}}function b(i){var j=jQuery(i.target);if(!j.is("th")){j=j.parent("th")}if(j.length){JIRA.Issues.Application.execute("analytics:trigger",this.name,{direction:j.hasClass("ascending")?"descending":"ascending",column:j.data("id")})}}JIRA.Issues.Application.on("issueEditor:loadComplete",function(i,j){if(!j.fromCache){JIRA.Issues.Application.execute("analytics:trigger","kickass.viewIssue",{issueId:i.getId(),loadReason:j.loadReason,duration:j.duration,loadedFromDom:false})}JIRA.Issues.Application.execute("analytics:trigger","kickass.issueLoadDuration",{issueId:j.issueId,duration:j.duration,loadReason:j.loadReason,fromCache:j.fromCache})});JIRA.Issues.Application.on("issueEditor:render",function(j,i){if(i.loadedFromDom){JIRA.Issues.Application.execute("analytics:trigger","kickass.viewIssue",{issueId:i.issueId,loadedFromDom:true})}});JIRA.Issues.Application.on("issueEditor:saveSuccess",function(i){JIRA.Issues.Application.execute("analytics:trigger","kickass.inlineEdit",{issueId:i.issueId,savedFieldIds:i.savedFieldIds,duration:i.duration})})};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Stalker.js' */
(function(b){var a;b.fn.stalker=function(d){var e=this,h;if(!e.length||e.data("stalker-applied")){return}e.data("stalker-applied",true);d=d||{};d.offsetTop=d.offsetTop||0;function g(){if(a){e.css({position:"",top:"",left:"",right:"",height:""}).removeClass("detached");e.unbind("stalkerHeightUpdated",j);a.remove();a=null}}function f(){if(!a){a=jQuery("<div class='stalker-placeholder' />").css("visibility","hidden").addClass(e[0].className).height(e.outerHeight()).width(e.outerWidth()).insertBefore(e);e.bind("stalkerHeightUpdated",j);e.css({position:"fixed",top:d.offsetTop,left:h.left,right:h.right}).addClass("detached");if(typeof c.timeout==="undefined"){c()}}}function j(){a.height(e.height())}function i(){if(!e.is(":visible")){return}if(!h){h=e.offset()}if(b(window).scrollTop()+d.offsetTop>=h.top){f()}else{g()}}function c(){if(a){i();c.timeout=setTimeout(c,250)}else{delete c.timeout}}b(window).bind("resize scroll",i);i();return{unstalk:function(){g();b(window).unbind("resize scroll",i)}}}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Sidebar.js' */
/*!
 * jQuery UI Sidebar
 * http://jqueryui.com
 *
 * Depends:
 *   jquery.ui.widget.js
 */
(function(a){a.widget("ui.sidebar",{version:"0.1",options:{minWidth:function(b){return 50},maxWidth:function(b){return window.innerWidth},resize:a.noop,easeOff:0},_create:function(){_.bindAll(this,"_handleDrag","_persist","_setContainment","_setHandlePosition","updatePosition");if(this.options.easeOff){this.updatePosition=_.debounce(this.updatePosition,this.options.easeOff)}if(!this.options.id){console.error("ui.sidebar: You must specify an id")}this._addHandle();this._restore();a(window).resize(_.debounce(this.updatePosition,30))},_restore:function(){if(window.localStorage){var b=localStorage.getItem("ui.sidebar."+this.options.id);if(b){this._setWidth(b)}}},_persist:function(){if(window.localStorage){localStorage.setItem("ui.sidebar."+this.options.id,this.element.outerWidth())}},_setContainment:function(){var b=window.innerHeight;this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth(this);this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth(this));this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]})},_handleDrag:function(d,b){var c=b.position.left-this._elementLeft;this._setWidth(c,true)},_setWidth:function(e,d){if(!d){var c=this.options.maxWidth(this);var b=this.options.minWidth(this);if(e>c){e=c}else{if(e<b){e=b}}}e-=this.element.outerWidth()-this.element.width();this.element.width(e);this.options.resize(e)},_addHandle:function(){var b=document.createElement("div");b.setAttribute("class","ui-sidebar");this.handle=a(b).appendTo(this.element);this.handle.draggable({axis:"x",drag:this._handleDrag,stop:this._persist});this.handle.mousedown(this._setContainment);_.defer(this._setHandlePosition)},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var c=this.element.offset();var b=c.left+this.element.outerWidth();this.handle.css({top:c.top,left:b,height:this.element.outerHeight()}).show()}},updatePosition:function(){this._setHandlePosition();this._setWidth(this.handle.offset().left-this._elementLeft);this._persist()}})})(jQuery);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/PopoutSidebar.js' */
(function(a){a.widget("ui.popoutSidebar",{version:"0.1",options:{renderExpanded:a.noop,renderCollapsed:a.noop,persist:a.noop,collapsedWidth:30,expandedWidth:200,minWidth:function(){return 200},maxWidth:function(){return 500},resize:a.noop,dockText:"Dock",undockText:"Undock",dockTitle:"Dock the filter panel so you can always see the list of filters",undockTitle:"Undock the filter panel so it is hidden when not being focused"},CLASS_NAMES:{popout:"ui-popout",placeholder:"ui-popout-placeholder",detached:"ui-popout-detached",expanding:"ui-popout-expanding",expanded:"ui-popout-expanded",collapsed:"ui-popout-collapsed",collapsing:"ui-popout-collapsing"},_create:function(){_.bindAll(this,"_handleDropdown","_registerMousePos","collapse","expand","updateOffsets");if(!this.element.data("popoutsidebar")){this.element.data("popoutsidebar",true);this.element.bind("updateOffsets.popout",this.updateOffsets);this.element.delegate(".ui-dock","click",_.bind(function(b){this.dock(true);b.preventDefault()},this));this.element.delegate(".ui-undock","click",_.bind(function(b){this.undock(true);b.preventDefault()},this));this.isDocked=this.options.isDocked;this.expandedWidth=this.options.expandedWidth;this.useTransitions=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)>8;if(this.options.isDocked){this._renderUnDock()}else{this._enableUndockedMode()}this.updateOffsets()}},_init:function(){if(this.options.isDocked){this._setupHandle()}},_persistState:function(){this.expandedWidth=this.element.outerWidth();this.options.persist(this.isDocked,this.expandedWidth)},_setContainment:function(){var b=window.innerHeight;this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth();this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth());this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]});this.handle.css("position","absolute")},_setWidth:function(b){b=Math.min(Math.max(this.options.minWidth(),b),this.options.maxWidth());this.element.width(b)},_setupHandle:function(){this._getContents();this.handle=jQuery("<div />").addClass("ui-sidebar").appendTo(this.element);this._setWidth(this.expandedWidth);this._setHandlePosition();this.handle.mousedown(_.bind(this._setContainment,this));this.handle.draggable({axis:"x",drag:_.bind(this._handleDrag,this),stop:_.bind(this._persistState,this)})},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var b=this.element.offset();var c=b.left+this.element.outerWidth();this.handle.css({left:c}).show()}},_handleDrag:function(d,b){var c=b.position.left;this._setWidth(c);this.options.resize()},_getUndockedClasses:function(){return[this.CLASS_NAMES.detached].join(" ")},_getUndockedStates:function(){return[this.CLASS_NAMES.collapsed,this.CLASS_NAMES.collapsing,this.CLASS_NAMES.expanding,this.CLASS_NAMES.expanded].join(" ")},_setUndockedState:function(b){this.element.removeClass(this._getUndockedStates());this.element.addClass(b)},unbindHoverIntent:function(){this.element.off("mouseleave mouseenter mousemove");this.element[0].hoverIntent_s=0},bindHoverIntent:function(){this.element.hoverIntent({interval:40,over:this.expand,out:this.collapse,sensitivity:8})},_unbindUnDockedEvents:function(){this.unbindHoverIntent();JIRA.unbind(AJS.InlineLayer.EVENTS.show,this._handleDropdown);a(window).unbind("scroll",this.updateOffsets)},_bindUnDockedEvents:function(b){this.bindHoverIntent();a(window).scroll(this.updateOffsets);this.element[0].hoverIntent_s=b?1:0},isUndocked:function(){return this.element.hasClass(this.CLASS_NAMES.detached)},_registerMousePos:function(b){this._clientX=b.clientX;this._clientY=b.clientY},_handleDropdown:function(){a(document).mousemove(this._registerMousePos);if(this.isUndocked()&&AJS.InlineLayer.current.offsetTarget().closest(this.element).size()){this.unbindHoverIntent();JIRA.one(AJS.InlineLayer.EVENTS.hide,_.bind(function(){_.defer(_.bind(function(){if(!AJS.InlineLayer.current){if(JIRA.Dialog.current||this._clientX>this.element.offset().left+this.element.outerWidth()){this.collapse(JIRA.Dialog.current?false:true);this.bindHoverIntent()}else{this.bindHoverIntent();this.element[0].hoverIntent_s=1}a(document).unbind("mousemove",this._registerMousePos)}},this))},this))}},updateOffsets:function(f){if(this.element.is(":visible")){var i=window.innerHeight;var d=a("body").height()>i;if(d){this.element.addClass("ui-sidebar-scrollable")}else{this.element.removeClass("ui-sidebar-scrollable")}if(this.isUndocked()){var c=this._getPlaceholder().offset().top;var g=jQuery(window).scrollTop();var h=Math.max(c-g,0);var b=d?i-h:Math.min(this._getPlaceholder().outerHeight(),i-this._getPlaceholder().offset().top);var e={top:h,height:b};if(f){e.width=f}this.element.css(e)}}},_renderUnDock:function(){if(this.isDocked&&!this.element.find(".ui-undock").size()){this.element.find(".ui-dock").remove();this._renderDockingLink(this.options.undockText,this.options.undockTitle,"ui-undock")}},_renderDock:function(){if(this.isUndocked()&&!this.element.find(".ui-dock").size()){this.element.find(".ui-undock").remove();this._renderDockingLink(this.options.dockText,this.options.dockTitle,"ui-dock")}},_renderDockingLink:function(e,d,b){var c=a("<a class='aui-button aui-button-subtle' href='#'/>").addClass(b).append(a("<span class='icon'/>").text(e)).attr("title",d);this.dockTipsy=new JIRA.Issues.Tipsy({el:c});this._getContents().find(this.options.toggleTarget).append(c)},renderDockState:function(){if(this.isDocked){this._renderUnDock()}else{this._renderDock()}},_enableUndockedMode:function(b){this.element.addClass(this.CLASS_NAMES.popout);if(!this.isUndocked()){this._getPlaceholder().insertBefore(this.element);this.element.addClass(this.CLASS_NAMES.detached).addClass(this.CLASS_NAMES.collapsed).appendTo("body")}this.updateOffsets();this._bindUnDockedEvents(b);JIRA.bind(AJS.InlineLayer.EVENTS.show,this._handleDropdown)},_getPlaceholder:function(){if(!this.placeholder){this.placeholder=a("<div class='navigator-sidebar collapsed' />")}return this.placeholder},toggle:function(){if(!this.isExpanding()&&!this.isCollapsing()){if(this.isDocked){this.undock(false)}else{this.dock(false)}}},undock:function(b){if(!this.isUndocked()){this.isDocked=false;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._persistState();this._getPlaceholder().insertBefore(this.element);this.element.addClass(this._getUndockedClasses()+" "+this.CLASS_NAMES.expanded).appendTo("body");if(b!==false&&this.useTransitions){this._getPlaceholder().width(this.expandedWidth).animate({width:this.options.collapsedWidth},200)}else{this._getPlaceholder().width(this.options.collapsedWidth)}this.updateOffsets(this.expandedWidth);this.collapse(b,_.bind(function(){this._enableUndockedMode(false)},this))}},dock:function(b){if(this.isUndocked()){this.isDocked=true;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._unbindUnDockedEvents();this._persistState();if(b!==false&&this.useTransitions){this._getPlaceholder().animate({width:this.expandedWidth},200,_.bind(this._dockingComplete,this))}else{this._dockingComplete()}}},_dockingComplete:function(){this.element.removeClass(this._getUndockedClasses());this.element.removeClass(this._getUndockedStates());this.element.css({height:"",width:"",top:""}).insertBefore(this._getPlaceholder());this._getPlaceholder().remove();this.options.renderExpanded(this.element);this._setupHandle();this._renderUnDock();JIRA.Issues.triggerHorizontalResize()},_getContents:function(){if(!this.element.find(".ui-sidebar-content").size()){this.element.wrapInner("<div class='ui-sidebar-content' />")}return this.element.find(".ui-sidebar-content")},expand:function(b){if(this.isCollapsed()){this.updateOffsets();if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.expanding);this.element.animate({width:this.expandedWidth},150,_.bind(function(){this._setUndockedState(this.CLASS_NAMES.expanded);this.options.renderExpanded(this.element);this._renderDock();this._getContents().css("opacity",0).animate({opacity:1},200,_.bind(this._expandingComplete,this))},this))}else{this.element.css("width",this.expandedWidth);this.options.renderExpanded(this.element);this._renderDock();this._expandingComplete()}}else{if(this.isCollapsing()){this.activityAfterTransition="expand"}else{if(this.isExpanding()){this.activityAfterTransition=null}}}},_expandingComplete:function(){JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(true);this._setUndockedState(this.CLASS_NAMES.expanded);if(this.activityAfterTransition==="collapse"){this.activityAfterTransition=null;this.collapse(true)}},collapse:function(b,c){if(this.isExpanded()){if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.collapsing);this._getContents().animate({opacity:0},150,_.bind(function(){this.options.renderCollapsed(this.element);this.element.width(this.expandedWidth);this.element.animate({width:this.options.collapsedWidth},150,_.bind(function(){this._collapsingComplete(c)},this))},this))}else{this.options.renderCollapsed(this.element);this.element.width("");this._collapsingComplete(c)}}else{if(this.isExpanding()){this.activityAfterTransition="collapse"}else{if(this.isCollapsing()){this.activityAfterTransition=null}}}},_collapsingComplete:function(b){this._setUndockedState(this.CLASS_NAMES.collapsed);JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(false);if(this.activityAfterTransition==="expand"){this.activityAfterTransition=null;this.expand(true)}if(typeof b==="function"){b()}},isCollapsed:function(){return this.element.hasClass(this.CLASS_NAMES.collapsed)},isCollapsing:function(){return this.element.hasClass(this.CLASS_NAMES.collapsing)},isExpanded:function(){return this.element.hasClass(this.CLASS_NAMES.expanded)},isExpanding:function(){return this.element.hasClass(this.CLASS_NAMES.expanding)}})}(jQuery));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/HtmlCatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){if(console&&console.error&&typeof d==="string"){console.error("Error while evaluating HTML: "+f.message+", in: ",d)}}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/mixin/SingleSelect.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={properties:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/DefaultMessageOptions.js' */
AJS.namespace("JIRA.Issues.getDefaultMessageOptions",window,function(){return{closeable:true,timeout:5}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/SessionTimedOutDialog.js' */
AJS.namespace("JIRA.Issues.SessionTimedOutDialog");JIRA.Issues.SessionTimedOutDialog={dialogHasShown:false,whiteList:["/secure/Search!Jql.jspa","/secure/SearchRendererEdit!Default.jspa","/rest/issueNav/1/issueTable","/rest/issueNav/latest","/rest/api/2/filter"],onRequestResponse:function(f,g,d){if(!this.dialogHasShown&&this.urlIsInWhiteList(d.url)){var b=JIRA.Issues.LoginUtils.loggedInUserName(),a=g.getResponseHeader("X-AUSERNAME");if(this.userHasChanged(b,a)){this.dialogHasShown=true;var c=new JIRA.FormDialog({content:AJS.$(JIRA.Templates.Issues.Util.anonymousErrorDialog({modifierKey:AJS.Navigator.modifierKey(),redirect:window.location.href.substring(window.location.href.indexOf(contextPath)+contextPath.length)}))});c.show()}}},userHasChanged:function(b,a){if(b===""&&a==="anonymous"){return false}if(b===""&&a&&a!=="anonymous"&&a!==""){return false}if(b!==""&&a==="anonymous"){return true}return false},urlIsInWhiteList:function(b){for(var c=0;c<this.whiteList.length;c++){var a=this.whiteList[c];if(b.indexOf(a)>-1){return true}}return false}};(function(a){a(document).ajaxComplete(function(c,d,b){JIRA.Issues.SessionTimedOutDialog.onRequestResponse(c,d,b)})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/LoginUtils.js' */
JIRA.Issues.LoginUtils={isLoggedIn:function(){return !!this.loggedInUserName()},loggedInUserName:function(){return AJS.Meta.get("remote-user")},currentContextRelativePath:function(){var b=this._getWindowLocation();var c=b.protocol+"//"+b.host+(contextPath||"");var a=b.href;if(a.indexOf(c)===0){return a.substr(c.length)}return a},redirectUrlToCurrent:function(){var a=this.currentContextRelativePath();return contextPath+"/login.jsp?os_destination="+encodeURIComponent(a)},redirectUrl:function(a){return AJS.contextPath()+"/login.jsp?os_destination="+encodeURIComponent(a)},_getWindowLocation:function(){return window.location}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/cache/IssueCacheManager.js' */
(function(){Backbone.define("JIRA.Issues.Cache.IssueCacheManager",JIRA.Issues.BaseEvented.extend({initialize:function(a){this.searchResults=a.searchResults;this.viewIssueData=a.viewIssueData;this.searchResults.bind("issueDeleted",this._onIssueDeleted,this);this.searchResults.bind("nextIssueSelected",this._onNextIssueSelected,this);this.searchResults.bind("prevIssueSelected",this._onPrevIssueSelected,this);this._prefetchCandidate=null},prefetchIssues:function(){if(this._prefetchCandidate&&this._prefetchCandidate.key){this._prefetchIssue(this._prefetchCandidate.key);this._prefetchCandidate=null}},scheduleIssueToBePrefetched:function(a){this._prefetchCandidate=a},_onIssueDeleted:function(a){this.viewIssueData.remove(a.key)},_onNextIssueSelected:function(a){this._prefetchCandidate=a.nextNextIssue},_onPrevIssueSelected:function(a){this._prefetchCandidate=a.prevPrevIssue},_prefetchIssue:function(a){if(!JIRA.Issues.DarkFeatures.NO_PREFETCH.enabled()){this.viewIssueData.get(a,false,{prefetch:true})}}}))})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/SimpleIssue.js' */
Backbone.define("JIRA.Issues.SimpleIssue",JIRA.Issues.BaseModel.extend({properties:["id","key"],defaults:{id:null,key:null},hasIssue:function(){return !!this.getId()}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/FullScreenIssue.js' */
Backbone.define("JIRA.Issues.FullScreenIssue",JIRA.Issues.BaseView.extend({namedEvents:["issueHidden"],initialize:function(a){_.extend(this,a);_.bindAll(this,"onLoadComplete","showError");if(this.issueContainer.hasClass("hidden")){this.issueContainer.detach();this.issueContainer.removeClass("hidden")}if(this.searchContainer.hasClass("hidden")){this.searchContainer.detach();this.searchContainer.removeClass("hidden")}},bindSearchService:function(a){this.listenTo(a,{issueUpdated:function(d,b,c){if(c.action!=="inlineEdit"&&c.action!=="rowUpdate"){return this.updateIssue(c)}},selectedIssueChanged:function(b){if(b.hasIssue()){JIRA.Issues.Application.execute("issueEditor:abortPending");this.show({id:b.getId(),key:b.getKey(),pager:a.getPager()});this.updatePager(a.getPager())}else{if(this.isVisible()){this.hide();JIRA.trace("jira.returned.to.search");JIRA.trace("jira.psycho.returned.to.search");JIRA.Issues.Application.execute("analytics:trigger","kickass.returntosearch")}}}})},deactivate:function(){this.stopListening();if(this.active){if(this.stalker){this.stalker.unstalk()}JIRA.Issues.Application.off("issueEditor:loadComplete",this.onLoadComplete);JIRA.Issues.Application.off("issueEditor:loadError",this.showError);JIRA.Issues.Application.execute("issueEditor:abortPending");this.active=false}},activate:function(){if(!this.active){JIRA.Issues.Application.on("issueEditor:loadComplete",this.onLoadComplete);JIRA.Issues.Application.on("issueEditor:loadError",this.showError);this.active=true}},onLoadComplete:function(a,b){this.stalker=AJS.$(".js-stalker",this.issueContainer).stalker();this._makeIssueVisible();if(b.isNewIssue){this._scrollToTop()}},_makeIssueVisible:function(){JIRA.Issues.Application.execute("issueEditor:beforeShow");this._setBodyClasses({error:false,issue:true,search:true});if(!this.isVisible()){this.issueContainer.insertBefore(this.searchContainer);this.searchContainer.detach();JIRA.trace("jira.psycho.issue.refreshed",{id:JIRA.Issues.Application.request("issueEditor:getIssueId")});JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.issueContainer,JIRA.CONTENT_ADDED_REASON.pageLoad])}},updateIssue:function(c){var a,b;b=c.key==JIRA.Issues.Application.request("issueEditor:getIssueKey");if(this.isVisible()){a=JIRA.Issues.Application.request("issueEditor:refreshIssue",c);a.done(function(){if(!b&&c.message){JIRA.Issues.showNotification(c.message,c.key)}})}else{a=jQuery.Deferred().resolve().promise()}return a},showError:function(){this._setBodyClasses({error:true,issue:false,search:false})},isVisible:function(){return this.issueContainer.closest("body").length>0},_scrollToTop:function(){AJS.$(window).scrollTop(0)},_setBodyClasses:function(a){AJS.$("body").toggleClass("page-type-message",a.error).toggleClass("navigator-issue-only",a.issue).toggleClass("page-type-navigator",a.search)},hide:function(){this._setBodyClasses({error:false,issue:false,search:true});if(this.isVisible()){this.searchContainer.insertBefore(this.issueContainer);this.issueContainer.detach();this.trigger("issueHidden")}},updatePager:function(a){JIRA.Issues.Application.execute("pager:update",a)},show:function(a){this.activate();JIRA.Issues.Application.execute("issueEditor:setContainer",this.issueContainer);return JIRA.Issues.Application.request("issueEditor:loadIssue",a).always(_.bind(function(){AJS.$(".js-stalker",this.issueContainer).stalker();this.updatePager(a.pager);this.issueCacheManager.prefetchIssues()},this))}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Resize.js' */
(function(){var a="horizontalResize",b="verticalResize";JIRA.Issues.offHorizontalResize=function(c){AJS.$(document).off(a,c)};JIRA.Issues.onHorizontalResize=function(c){AJS.$(document).on(a,c)};JIRA.Issues.triggerHorizontalResize=_.throttle(function(){AJS.$(document).trigger(a)},100);JIRA.Issues.offVerticalResize=function(c){AJS.$(document).off(b,c)};JIRA.Issues.onVerticalResize=function(c){AJS.$(document).on(b,c)};JIRA.Issues.triggerVerticalResize=_.throttle(function(){AJS.$(document).trigger(b)},100);jQuery(window).resize(JIRA.Issues.triggerVerticalResize)}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/UserParms.js' */
JIRA.Issues.UserParms={createSharedObjects:function(){return this.get().createSharedObjects},get:function(){if(!this.data){this.data=AJS.$("#user-parms").data("user-parms")||{}}return this.data}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/QueryStringParser.js' */
AJS.namespace("JIRA.Issues.QueryStringParser");JIRA.Issues.QueryStringParser={parser:/(?:^|&)([^&=]*)=?([^&]*)/g,parse:function(b){if(!b&&b!==0){return{}}b=""+b;if("?"===b.charAt(0)){b=b.substring(1)}var a={};b.replace(this.parser,function(d,c,f){var e=decodeURIComponent((f||"").replace(/\+/g," "));a[decodeURIComponent(c)]=e});return a}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/orderby.soy' */
// This file was automatically generated from orderby.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.OrderBy == 'undefined') { JIRA.Templates.OrderBy = {}; }


JIRA.Templates.OrderBy.orderBy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.sortBy && opt_data.sortBy.fieldId) ? '<a class="order-by ' + ((opt_data.sortBy.order == 'ASC') ? 'ascending' : 'descending') + '" data-field-id="' + soy.$$escapeHtml(opt_data.sortBy.fieldId) + '" data-direction="' + soy.$$escapeHtml(opt_data.sortBy.order) + '" href="#" title="' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '"><span>' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '</span><span class="aui-icon aui-icon-small aui-iconfont-' + ((opt_data.sortBy.order == 'ASC') ? 'up' : 'down') + '"></span></a>' : '<a class="order-by" title="' + soy.$$escapeHtml("Order by") + '"><span>' + soy.$$escapeHtml("Order by") + '</span></a>', '<a class="order-options" title="', soy.$$escapeHtml("Select the field that issues are ordered by."), '">', soy.$$escapeHtml("Select the field that issues are ordered by."), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.OrderBy.orderByOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="order-by-options" multiple="multiple" class="hidden"><optgroup data-footer-text="', soy.$$escapeHtml(opt_data.footer), '">');
  var optionList41 = opt_data.options;
  var optionListLen41 = optionList41.length;
  for (var optionIndex41 = 0; optionIndex41 < optionListLen41; optionIndex41++) {
    var optionData41 = optionList41[optionIndex41];
    output.append('<option title="', soy.$$escapeHtml(optionData41.fieldName), '" value="', soy.$$escapeHtml(optionData41.fieldId), '" data-meta="', soy.$$escapeHtml(optionData41.meta), '">', soy.$$escapeHtml(optionData41.fieldName), '</option>');
  }
  output.append('</optgroup></select>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByModel.js' */
JIRA.Issues.OrderByModel=JIRA.Issues.Brace.Model.extend({namedEvents:["sort"],namedAttributes:["sortBy","jql"],initialize:function(){this.on("change:jql",this.updateSelectedSort,this)},updateSelectedSort:function(){jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/orderbycomponent/latest/orderByOptions/primary",data:JSON.stringify({jql:this.getJql()}),contentType:"application/json",success:_.bind(function(a){this.setSortBy(a)},this)})},toggleSort:function(){this.setJql(this.getSortBy().toggleJql);this.triggerSort(this.getJql())},doSort:function(a){this.setJql(a);this.triggerSort(this.getJql())}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByView.js' */
JIRA.Issues.OrderByView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.OrderBy.orderBy,events:{"click a.order-by":"_onClickOrderBy","click a.order-options":"_toggleShowDropDown"},initialize:function(){this.model.on("change:sortBy",this.render,this)},render:function(){this.$el.html(this.template(this.model.toJSON()));return this},deactivate:function(){this.orderByDropDown&&this.orderByDropDown.deactivate();this.undelegateEvents()},_onClickOrderBy:function(c){var b=new AJS.$.Event(JIRA.Events.ISSUE_TABLE_REORDER);JIRA.trigger(b);if(!b.isDefaultPrevented()){var a=AJS.$(c.currentTarget).data("field-id");if(a){this.model.toggleSort()}}c.preventDefault()},_toggleShowDropDown:function(a){if(!this.orderByDropDown){this.orderByDropDown=new JIRA.Issues.OrderByDropDownView({model:this.model,offsetTarget:this.$("a.order-by"),onHideCallback:_.bind(function(){this.orderByDropDown=null},this)})}this.orderByDropDown.toggle();a.preventDefault()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByDropDownView.js' */
JIRA.Issues.OrderByDropDownView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.bindAll(this,"_onDropdownHidden","_onDropdownShown");this.offsetTarget=a.offsetTarget;this._onHideCallback=a.onHideCallback;this._pending=null;this._inlineLayer=null},deactivate:function(){this._inlineLayer&&this._inlineLayer.hide();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},toggle:function(){if(!this._inlineLayer){this._pending=AJS.$.ajax(this._ajaxDefaults());this._inlineLayer=this._createInlineLayer(this._pending);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.show,this._onDropdownShown);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.hide,this._onDropdownHidden);this._inlineLayer.show()}else{this._inlineLayer.hide()}},_createInlineLayer:function(a){var b=_.bind(function(d){this._deferredAddTipsyToFooter(d);return this._renderInitialContent(d)},this);var c=new AJS.InlineLayer({offsetTarget:this.offsetTarget,content:function(){return a.pipe(b)},width:218});if(this._onHideCallback){c.bind(AJS.InlineLayer.EVENTS.hide,this._onHideCallback)}return c},_initSingleSelect:function(b){var c=b.find("select");c.bind("selected",_.bind(this._onFieldSelected,this));this.selectControl=new AJS.CheckboxMultiSelect({element:c,itemAttrDisplayed:"label",suggestionsHandler:AJS.SelectSuggestHandler,ajaxOptions:this._ajaxDefaults({data:_.bind(function(d){return JSON.stringify(this._ajaxOptionsData(d))},this),query:true,minQueryLength:0,formatResponse:_.bind(function(d){this._removeTipsy();var f=new AJS.GroupDescriptor();_.each(d.fields,function(g){f.addItem(new AJS.ItemDescriptor({title:g.fieldName,value:g.fieldId,label:g.fieldName,meta:{sortJql:g.sortJql}}))});var e=this._getFooterText(d);if(e){f.footerText(e);this._deferredAddTipsyToFooter(d)}return[f]},this)})});var a=b.find("#order-by-options-input");a.focus()},_ajaxDefaults:function(b){var a={url:AJS.contextPath()+"/rest/orderbycomponent/latest/orderByOptions",type:"POST",contentType:"application/json",data:JSON.stringify(this._ajaxOptionsData())};return _.extend(a,b)},_ajaxOptionsData:function(b){var a=this.model.getJql();var c=this.model.getSortBy();return{query:b,jql:a?a:undefined,sortBy:c?c.fieldId:undefined}},_renderInitialContent:function(a){var b=_.map(a.fields,function(c){return _.extend({},c,{meta:JSON.stringify({sortJql:c.sortJql})})});return AJS.$("<div></div>").addClass("order-dropdown").html(JIRA.Templates.OrderBy.orderByOptions({options:b,footer:this._getFooterText(a)}))},_onDropdownShown:function(b,a,c){this._initSingleSelect(a)},_onDropdownHidden:function(b,a,c){this._removeTipsy();AJS.$("div.order-dropdown").remove();this._inlineLayer=null},_onFieldSelected:function(c,b){var a=new AJS.$.Event(JIRA.Events.ISSUE_TABLE_REORDER);JIRA.trigger(a);if(!a.isDefaultPrevented()){_.defer(_.bind(function(){if(this.selectControl.outstandingRequest){this.selectControl.outstandingRequest.reject()}AJS.InlineLayer.current.hide();var d=b.meta();this.model.doSort(d.sortJql)},this))}},_getFooterText:function(a){if(typeof a.matchesCount==="number"&&typeof a.maxResults==="number"){var b=a.matchesCount-a.maxResults;if(b>0){return AJS.format("{0} more fields...",b)}}return""},_deferredAddTipsyToFooter:function(d){if(this._inlineLayer){var b=d.matchesCount;var e=Math.min(d.matchesCount,d.maxResults);var c=AJS.format("Showing {0} of {1} matching fields. Find more fields by typing in the search box.",e,b);var a=this;_.defer(function(){a._tipsyTrigger=new JIRA.Issues.Tipsy({el:a._inlineLayer.$layer.find(".aui-list-section-footer"),tipsy:{title:function(){return c},className:"tipsy-front"}})})}},_removeTipsy:function(){if(this._tipsyTrigger){this._tipsyTrigger.hide();this._tipsyTrigger=null}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderBy.js' */
JIRA.Events.ISSUE_TABLE_REORDER="issueTableReorder";JIRA.Components.OrderBy={create:function(c){var b,a;c=c||{};b=new JIRA.Issues.OrderByModel({sortBy:c.sortBy,jql:c.jql});a=new JIRA.Issues.OrderByView({model:b});return{onSort:function(){b.onSort.apply(b,arguments);return this},offSort:function(d){b.off("sort",d);return this},render:function(){a.render();return this},setElement:function(d){a.setElement(d);return this},setJql:function(d){b.setJql(d);return this},setSortBy:function(d){b.setSortBy(d);return this}}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.soy' */
// This file was automatically generated from ColumnPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.ColumnPicker == 'undefined') { JIRA.Templates.Dialogs.ColumnPicker = {}; }


JIRA.Templates.Dialogs.ColumnPicker.popup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><form action="#" method="post"  class="aui top-label column-picker"><div class="check-list-top-panel"><h3>', soy.$$escapeHtml("Columns"), '</h3>');
  if (opt_data.columns.length > 1) {
    output.append('<p class="aui-buttons">');
    var columnList9 = opt_data.columns;
    var columnListLen9 = columnList9.length;
    for (var columnIndex9 = 0; columnIndex9 < columnListLen9; columnIndex9++) {
      var columnData9 = columnList9[columnIndex9];
      output.append('<button type="button" class="config-chooser aui-button ', (columnData9.isActive) ? ' active' : '', '" id="columns-chooser-', soy.$$escapeHtml(columnData9.name), '" data-value="', soy.$$escapeHtml(columnData9.name), '"', (columnData9.isDisabled) ? 'aria-disabled="true"' : '', '>', soy.$$escapeHtml(columnData9.description), '</button>');
    }
    output.append('</p>');
  }
  output.append('</div>');
  var columnList28 = opt_data.columns;
  var columnListLen28 = columnList28.length;
  for (var columnIndex28 = 0; columnIndex28 < columnListLen28; columnIndex28++) {
    var columnData28 = columnList28[columnIndex28];
    output.append('<div class="', soy.$$escapeHtml(columnData28.name), '-column-sparkler hidden"></div>');
  }
  output.append((! opt_data.isAutoUpdate) ? '<div class="button-panel"><input accesskey="' + soy.$$escapeHtml("s") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)) + '" class="aui-button submit" type="submit" value="' + soy.$$escapeHtml("Done") + '"/> <a accesskey="' + soy.$$escapeHtml("`") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)) + '" class="aui-button aui-button-link close-dialog" href="javascript:">' + soy.$$escapeHtml("Cancel") + '</a></div>' : '', '</form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-subtle column-picker-trigger" title="', soy.$$escapeHtml("Columns"), '">', soy.$$escapeHtml("Columns"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-link restore-defaults">', soy.$$escapeHtml(opt_data.linkText), '</button>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.js' */
if(!JIRA.Components){JIRA.Components={}}JIRA.Components.ColumnPicker=JIRA.Issues.Brace.Model.extend({initialize:function(a,b){this.columnPickerModel=new JIRA.Issues.ColumnPickerModel({autoUpdate:b.autoUpdate});this.columnPickerView=new JIRA.Issues.ColumnPickerView({columnPickerModel:this.columnPickerModel});_.each(b.providers,_.bind(function(c){if(c instanceof JIRA.Issues.ColumnConfigModel){this.columnPickerModel.addColumnProvider(c.getName(),c)}else{this.columnPickerModel.addColumnProvider(c.id,this._createProviderModel(c));if(c.columns){this.columnPickerModel.syncColumns(c.id,c.columns)}}},this));this.setCurrentColumnConfig(b.providers[0].id);if(b.el){this.columnPickerView.setElement(b.el).render()}},_createProviderModel:function(a){return JIRA.Issues.ColumnConfigModel.create(a.id,a.label,_.omit(a,"id","label","columns"))},getCurrentColumnConfig:function(){return this.columnPickerModel.getCurrentColumnConfig()},setElement:function(a){this.columnPickerView.setElement(a);return this},render:function(){this.columnPickerView.render();return this},clearFilterConfiguration:function(){this.columnPickerModel.clearFilterConfiguration();return this},adjustHeight:function(){this.columnPickerView.adjustHeight();return this},setCurrentColumnConfig:function(a){this.columnPickerModel.setCurrentColumnConfig(a);return this},saveColumns:function(a){this.columnPickerModel.saveColumns(a);return this},syncColumns:function(a,b){this.columnPickerModel.syncColumns(a,b);return this},getColumnConfig:function(){this.columnPickerModel.getColumnConfig()},onColumnsSync:function(b,a){this.columnPickerModel.onColumnsSync(b,a);return this},on:function(b,c,a){this.columnPickerModel.on(b,c,a);return this},off:function(a,b){this.columnPickerModel.off(a,b);return this}});JIRA.Components.ColumnPicker.create=function(a){return new JIRA.Components.ColumnPicker(null,a)};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerModel.js' */
JIRA.Issues.ColumnPickerModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["columnConfig","savedColumnConfig","search","availableColumns","autoUpdate"],namedEvents:["columnsSync","changeColumnConfigDisabled","destroyColumnConfig"],allColumnsUrl:AJS.contextPath()+"/rest/gadget/1.0/availableColumns",shouldRefreshSearchOnActivation:function(){return this.getCurrentColumnConfig().shouldRefreshSearchOnActivation()},shouldCloseOnActivation:function(){return this.getCurrentColumnConfig().shouldCloseOnActivation()},shouldLoadDefaultsOnActivation:function(){return this.getCurrentColumnConfig().shouldLoadDefaultsOnActivation()},shouldRevertOnHide:function(){return this.getCurrentColumnConfig().shouldRevertOnHide()},loadDefaultColumns:function(){this.getCurrentColumnConfig().loadDefaultColumns()},initialize:function(){this.columnsData={}},refreshSearchWithColumns:function(a){a=a||this.getCurrentColumnConfig();this.triggerColumnsSync(a.getName(),a.getColumns())},fetchAvailableColumnsIfNeeded:function(){if(!this.has("availableColumns")){jQuery.ajax(this.allColumnsUrl).done(_.bind(function(a){this.setAvailableColumns(a.availableColumns)},this))}},getCurrentColumnConfig:function(a){if(!a){a=this.getColumnConfig()}return this.columnsData[a]},revertColumnConfig:function(){if(this.shouldRevertOnHide()&&this.getSavedColumnConfig()!=this.getColumnConfig()){this._previousAttributes.columnConfig=this.getSavedColumnConfig();this.setColumnConfig(this.getSavedColumnConfig(),{silent:true})}},setCurrentColumnConfig:function(a){this.setColumnConfig(a);this.setSavedColumnConfig(a)},syncColumns:function(a,b){_.each(this.columnsData,function(c){if(c.getName()==a){c.setColumns(b);c.setSavedColumns(b)}})},saveColumns:function(a){this.getCurrentColumnConfig().setColumns(a);this.getCurrentColumnConfig().save();this.getCurrentColumnConfig().triggerColumnsSync()},addColumnProvider:function(b,a){this.columnsData[b]=a;a.on("columnsSync sync destroy",_.bind(function(){this.refreshSearchWithColumns(a)},this));a.on("change:isDisabled",_.bind(function(d,c){this.triggerChangeColumnConfigDisabled(d,c)},this));a.on("destroy",_.bind(function(c){this.triggerDestroyColumnConfig(c)},this))}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerView.js' */
JIRA.Issues.ColumnPickerView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.extend(this,a);_.bindAll(this,"_generateInlineDialogContent","_onDOMCloseDialogClick","_onDOMConfigChooserClick","_onDOMDialogHide","_onDOMFormSubmit","_onDOMTriggerClick","_onModelChangeAvailableColumns","_onModelChangeColumnConfig","_onModelChangeColumnConfigDisabled","_onModelDestroyColumnConfig");this.subViews={}},dialog:null,activeSubview:null,_onDOMConfigChooserClick:function(b){var a=jQuery(b.target);if(a.attr("aria-disabled")){return}this.columnPickerModel.setColumnConfig(a.data("value")||"user")},_activateNewSubView:function(a){a.activate();if(this.columnPickerModel.shouldCloseOnActivation()){this.dialog.hide()}else{this.activeSubview=a;this.activeSubview.show();this.adjustHeight()}if(this.columnPickerModel.shouldRefreshSearchOnActivation()){this.columnPickerModel.refreshSearchWithColumns()}if(this.columnPickerModel.shouldLoadDefaultsOnActivation()){this.columnPickerModel.loadDefaultColumns()}},_onDOMFormSubmit:function(a){a.preventDefault();this.activeSubview.saveColumns();this.dialog.hide()},_onDOMCloseDialogClick:function(a){this.dialog.hide()},_onDOMTriggerClick:function(a){this.dialog.show();this.activeSubview=this.subViews[this.columnPickerModel.getCurrentColumnConfig().getName()];this.activeSubview.show();this._activateConfigChooserButton(this.columnPickerModel.getCurrentColumnConfig().getName());this.columnPickerModel.fetchAvailableColumnsIfNeeded()},_activateConfigChooserButton:function(a){this.dialog.find(".config-chooser.active").removeClass("active");this.dialog.find("#columns-chooser-"+a).addClass("active")},_onDOMDialogHide:function(a){this.columnPickerModel.revertColumnConfig();this.activeSubview.hide()},_onModelChangeColumnConfig:function(d,b){var a=this.subViews[b];this._activateConfigChooserButton(a.model.getName());var c=this.subViews[d.previous("columnConfig")];if(c!=a){c.hide();c.deactivate();this._activateNewSubView(a)}},_onModelChangeAvailableColumns:function(b,a){_.each(this.subViews,function(c){c.createSparklerControl(a)})},_onModelDestroyColumnConfig:function(){this.dialog.hide()},_onModelChangeColumnConfigDisabled:function(b,a){var c=this.dialog.find("#columns-chooser-"+b.getName());if(a){c.attr("aria-disabled",true)}else{c.removeAttr("aria-disabled")}},render:function(){if(!this.$trigger){this.$trigger=jQuery(JIRA.Templates.Dialogs.ColumnPicker.trigger())}this.$el.append(this.$trigger);this.$trigger.click(this._onDOMTriggerClick);this._renderInlineDialog()},adjustHeight:function(){if(AJS.InlineDialog.current&&AJS.InlineDialog.current.id==="column-picker-dialog"&&this.activeSubview){var c=jQuery(this.activeSubview.el).find(".aui-list-scroll");var d=((window.innerHeight-this.$trigger.offset().top)-90);var b=d-this.dialog.height();var a=Math.max(Math.min(c.height()+b,270),80);c.css("height",a);return true}return false},_generateInlineDialogContent:function(c,a,b){if(!this.dialogContent){c.html(JIRA.Templates.Dialogs.ColumnPicker.popup({modifierKey:AJS.Navigator.modifierKey(),isAutoUpdate:this.columnPickerModel.getAutoUpdate(),columns:_.map(this.columnPickerModel.columnsData,_.bind(function(d){return{name:d.getName(),description:d.getDescription(),selected:false,isDisabled:d.isDisabled(),isActive:this.columnPickerModel.getCurrentColumnConfig()==d}},this))}));c.find(".config-chooser").click(this._onDOMConfigChooserClick);c.find("form").submit(this._onDOMFormSubmit);c.find(".close-dialog").click(this._onDOMCloseDialogClick);c.click(function(d){d.stopPropagation()});this._createSubViews(c);this.dialogContent=c.children()}else{c.append(this.dialogContent)}b()},_renderInlineDialog:function(){if(this.dialog){return}this.dialog=AJS.InlineDialog(this.$trigger,"column-picker-dialog",this._generateInlineDialogContent,{offsetY:15,addActiveClass:true,hideDelay:null,noBind:true,initCallback:_.bind(function(){var a=this;var b=function(){if(!a.adjustHeight()){setTimeout(b,100)}};b()},this),hideCallback:this._onDOMDialogHide})},_createSubViews:function(a){_.each(this.columnPickerModel.columnsData,_.bind(function(b){this.subViews[b.getName()]=new JIRA.Issues.ColumnPickerSparklerView({el:a.find("."+b.getName()+"-column-sparkler"),model:b,autoUpdate:this.columnPickerModel.getAutoUpdate()})},this));if(this.columnPickerModel.has("availableColumns")){this._onModelChangeAvailableColumns(this.columnPickerModel,this.columnPickerModel.getAvailableColumns())}this.columnPickerModel.on("change:availableColumns",this._onModelChangeAvailableColumns);this.columnPickerModel.on("change:columnConfig",this._onModelChangeColumnConfig);this.columnPickerModel.onChangeColumnConfigDisabled(this._onModelChangeColumnConfigDisabled);this.columnPickerModel.onDestroyColumnConfig(this._onModelDestroyColumnConfig)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnConfigModel.js' */
JIRA.Issues.ColumnConfigModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["name","columns","autoUpdate","savedColumns","description","previousColumns","actionBarText","isActive"],namedEvents:["columnsSync"],defaults:{actionBarText:"Restore Defaults",isActive:false},idAttribute:"name",initialize:function(a,b){_.extend(this,b)},getDefaultColumns:function(){var a=jQuery.Deferred();this.defaultColumns().done(_.bind(function(b){var c=this.parse(b);if(c&&c.columns){a.resolve(c.columns)}else{a.reject(null)}},this));return a.promise()},parse:function(a){if(!a){return{}}return{columns:_.compact(_.pluck(a,"value"))}},isDisabled:function(){return false},isEditDisabled:function(){return false},defaultColumns:function(){var a=jQuery.Deferred();a.resolve([]);return a.promise()},_sortColumnsUsingOriginalOrder:function(a,b){return _.intersection(a,b).concat(_.difference(b,a))},setUnsortedColumns:function(a){a=this._sortColumnsUsingOriginalOrder(this.getColumns(),a);this.setPreviousColumns(this.getColumns(),{silent:true});this.setColumns(a)},toJSON:function(){return{columns:this.getColumns()}},revertUnsavedColumns:function(a){if(this.getSavedColumns()!=this.getColumns()){this.setColumns(this.getSavedColumns(),a)}},loadDefaultColumns:function(){this.getDefaultColumns().done(_.bind(function(a){this.setColumns(a)},this))},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return true},shouldLoadDefaultsOnActivation:function(){return false},shouldRevertOnHide:function(){return true}});JIRA.Issues.ColumnConfigModel.create=function(b,d,c,a){return new JIRA.Issues.ColumnConfigModel({autoUpdate:a,name:b,description:d},c)};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSparklerView.js' */
JIRA.Issues.ColumnPickerSparklerView=JIRA.Issues.Brace.View.extend({initialize:function(a){this._maxResults=(typeof a.maxResults=="number")?a.maxResults:this.MAX_DISPLAYED_ITEMS;this._autoUpdate=!!a.autoUpdate;this.$el.scrollLock(".aui-list-scroll");if(!this._autoUpdate){this.model.on("change:columns",_.bind(this._setSelectedColumns,this))}},MAX_DISPLAYED_ITEMS:25,_sparkler:null,activate:function(){this.model.setIsActive(true)},deactivate:function(){this.model.setIsActive(false)},hide:function(){this.model.revertUnsavedColumns({silent:true});this.$el.addClass("hidden");var a=this.$el.find("input[id *= column-sparkler-input]");a.val("")},show:function(){this.$el.removeClass("hidden");this._setSelectedColumns();var a=this.$el.find("input[id *= column-sparkler-input]");if(!a.is(":disabled")){a.focus()}},addMessage:function(a){if(this.$el.find(".aui-message."+a.type).length===0){AJS.messages[a.type](this.$el,{body:a.content,closeable:false,insert:"prepend",id:a.id})}},_disableEditIfNeeded:function(){if(this.model.isEditDisabled()){this._disableEdit()}else{this._enableEdit()}},_showEditDisabledMessage:function(){this.addMessage({content:"You cannot update the columns for a filter owned by another user.",type:"warning",id:this.model.getName()+"-edit-disabled-message"})},_hideEditDisabledMessage:function(){this.$el.find("#"+this.model.getName()+"-edit-disabled-message").remove()},_disableEdit:function(){this._sparkler.disable();this.$el.find("input[type='checkbox']").attr("disabled","disabled");this.$el.find(".check-list-item").addClass("disabled");this.$el.find(".no-suggestions").addClass("disabled");this.$el.find(".restore-defaults").attr("aria-disabled","true");this._showEditDisabledMessage()},_enableEdit:function(){this._sparkler.enable();this.$el.find("input[type='checkbox']").removeAttr("disabled");this.$el.find(".check-list-item").removeClass("disabled");this.$el.find(".no-suggestions").removeClass("disabled");this.$el.find(".restore-defaults").removeAttr("aria-disabled");this._hideEditDisabledMessage()},createSparklerControl:function(a){if(this._sparkler){this._sparkler.remove()}var b=this._buildQueryableSelect(a);this.$el.append(b);this._sparkler=new AJS.CheckboxMultiSelect({element:b,maxInlineResultsDisplayed:this._maxResults,suggestionsHandler:JIRA.Issues.ColumnPickerSuggestHandler,actionBar:this.model.getActionBarText()});this._setSelectedColumns();if(this._autoUpdate){b.bind("selected",_.bind(this.saveColumns,this));b.bind("unselect",_.bind(this.saveColumns,this))}this._sparkler.$field.focus();this.$el.on("actionclick",_.bind(function(c){c.preventDefault();this.model.unset("columns");this.model.destroy()},this));this.model.on("change:editDisabled",_.bind(this._disableEditIfNeeded,this))},saveColumns:function(){this.model.setUnsortedColumns(this._sparkler.model.getSelectedValues());this.model.save(null,{wait:false})},_setSelectedColumns:function(){var a=this.model.getColumns();var b=this._sparkler;if(b&&a&&a.length){_.each(b.model.getDisplayableUnSelectedDescriptors(),function(c){if(_.contains(a,c.value())){b.selectItem(c)}});_.each(b.model.getDisplayableSelectedDescriptors(),function(c){if(!_.contains(a,c.value())){b.unselectItem(c)}});b.render();this._disableEditIfNeeded()}},_buildQueryableSelect:function(c){var a=this;var b=_.map(c,function(d){return new AJS.ItemDescriptor(_.extend(d,{title:d.label}))});return jQuery(AJS.Templates.queryableSelect({id:a.model.getName()+"-column-sparkler",descriptors:[new AJS.GroupDescriptor({items:b})]}))}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSuggestHandler.js' */
JIRA.Issues.ColumnPickerSuggestHandler=AJS.SelectSuggestHandler.extend({createActionBar:function(b){if(!b){return null}var a=jQuery(JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink({linkText:b}));a.click(function(c){if(jQuery(c.target).attr("aria-disabled")!=="true"){a.trigger("actionclick")}c.preventDefault()});return jQuery("<li class='check-list-group-actions'></li>").append(a)},formatSuggestions:function(d,e){var f=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());var c=new AJS.GroupDescriptor({styleClass:"selected-group",items:f});d.splice(0,0,c);var a=_.find(d,function(g){return g.items().length});if(a){a.actionBarHtml(this.createActionBar(this.options.actionBar))}if(e.length>0){d=AJS.SuggestHelper.removeDuplicates(d);var b=AJS.SuggestHelper.extractItems(d).sort(function(h,g){h=h.label().toLowerCase();g=g.label().toLowerCase();return h.localeCompare(g)});d=[new AJS.GroupDescriptor({items:b})]}return d}});;
;/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api', location = 'browser-metrics.js' */
(function(){var i,v,g,x,l,o,r,n,s,b,q,h,c,w,k,j,t,u,a,p,e,m,d;i=window.jQuery;v=function(){var z=window.HTMLElement.prototype;var y=z.matches||z.msMatchesSelector||z.webkitMatchesSelector||z.mozMatchesSelector||z.oMatchesSelector;return y}();g=function f(y){var z=false;return function(){if(!z){z=true;setTimeout(function(){z=false;y()},1)}}};x=function(y){function A(D){this.callback=D;this.elements=[]}A.prototype={observe:function(K,S){function E(T){R.push(T);D()}function Q(V){var U=V.target;if(!U){return}var T=U.parentNode;if(!L(T)){return}if(P&&C(P,U)){return}if(!N||N.target!==T){M.push(N=B(T))}if(T){if(!N.addedNodes){N.addedNodes=[]}N.addedNodes.push(U)}else{if(!N.removedNodes){N.removedNodes=[]}N.removedNodes.push(U)}P=U}function J(T){return S.attributes&&(S.subtree||T===K)}function L(T){return S.childList&&(S.subtree||T===K)}var H=this;var P;var N;var R=[];var M=[];var D=y(function(){var T=R.length;for(var U=0;U<T;U++){Q(R[U])}H.callback(M);R=[];M=[];P=undefined;N=undefined});var O={};var G=[];var I=y(function(){var T=G.length;H.callback(G);G.splice(0,T)});var F={target:K,options:S,insertHandler:E,removeHandler:E,attributeHandler:function(Y){var W=Y.target;if(!J(W)){return}var U=Y.attrName;var V=Y.prevValue;var X=Y.newValue;var T=B(W,"attributes");T.attributeName=U;if(S.attributeOldValue){T.oldValue=O[U]||V||null}G.push(T);if(S.attributeOldValue){O[U]=X}I()}};this.elements.push(F);if(S.childList){K.addEventListener("DOMNodeInserted",F.insertHandler);K.addEventListener("DOMNodeRemoved",F.removeHandler)}if(S.attributes){K.addEventListener("DOMAttrModified",F.attributeHandler)}return this},disconnect:function(){this.elements.forEach(function(D){D.target.removeEventListener("DOMNodeInserted",D.insertHandler);D.target.removeEventListener("DOMNodeRemoved",D.removeHandler);D.target.removeEventListener("DOMAttrModified",D.attributeHandler)});this.elements=[];return this}};function B(E,D){return{addedNodes:null,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:null,target:E,type:D||"childList"}}var z=window.HTMLElement.prototype.contains;function C(D,E){if(D.nodeType!==1){return false}return D.contains?D.contains(E):z.call(D,E)}return A}(g);l=function(y){return window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver||y}(x);o=function(){function y(){this._items={};this.length=0}y.prototype.add=function(A,z){if(!this._items.hasOwnProperty(A)){this.length++;this._items[A]=[]}this._items[A].push(z)};y.prototype.remove=function(C,A){var z,B=false;if(this._items.hasOwnProperty(C)){if(arguments.length===1){delete this._items[C];B=true}else{z=this._items[C].indexOf(A);if(z>-1){this._items[C].splice(z,1);if(this._items[C].length===0){delete this._items[C]}B=true}}}return B};y.prototype.get=function(z){if(this._items.hasOwnProperty(z)){return this._items[z]}return[]};y.prototype.forEach=function(A){var z=this._items;Object.keys(z).forEach(function(B){A(z[B],B)})};return y}();r=function(D,H,A,C){var G,B=false,E;E=new C();function z(I,J){if(!B){G.observe(document,{attributes:true,childList:true,subtree:true});B=true}E.add(I,J)}function F(I,J){E.remove.apply(E,arguments);if(E.length===0){G.disconnect();B=false}}G=new A(function(I){I.forEach(function(K){var J=K.type==="childList"&&K.addedNodes&&K.addedNodes.length>0;var L=K.type==="attributes";if(!J&&!L){return}E.forEach(function(N,M){if(K.target.querySelector(M)||H.call(K.target,M)){N.forEach(function(O){O()});F(M)}})})});function y(K){var L=[],J,I;if(!K.forEach){K=[K]}K.forEach(function(M){var N;if(!document.querySelector(M)){N=D.Deferred();N.selector=M;N.callback=function(){N.resolve()};L.push(N);z(M,N.callback)}});J=D.when.apply(D,L);J.always(function(){L.forEach(function(M){F(M.selector,M.callback)})});I=J.promise();I.dismiss=function(){L.forEach(function(M){M.reject()})};return I}return y}(i,v,l,o);n=function(D,H,z,B){var G,A=false,E;E=new B();function y(I,J){if(!A){G.observe(document,{childList:true,subtree:true});A=true}E.add(I,J)}function F(I,J){E.remove.apply(E,arguments);if(E.length===0){G.disconnect();A=false}}G=new z(function(I){I.forEach(function(J){var K=J.type==="childList"&&J.removedNodes&&J.removedNodes.length>0;if(K){E.forEach(function(O,L){var P;for(var N=0;N<J.removedNodes.length;N++){P=J.removedNodes[N];if(P.querySelector&&(P.querySelector(L)||H.call(P,L))){for(var M=0;M<O.length;M++){O[M]()}F(L)}}})}})});function C(K){var L=[],J,I;if(!K.forEach){K=[K]}K.forEach(function(M){var N;if(document.querySelector(M)){N=D.Deferred();N.selector=M;N.callback=function(){N.resolve()};L.push(N);y(M,N.callback)}});J=D.when.apply(D,L);J.always(function(){L.forEach(function(M){F(M.selector,M.callback)})});I=J.promise();I.dismiss=function(){L.forEach(function(M){M.reject()})};return I}return C}(i,v,l,o);s=function(A){var y,z;z=A("<div></div>");y={};y.on=function(B,C){z.on(B,function(D,E){C(E)})};y.one=function(B,C){z.one(B,function(D,E){C(E)})};y.trigger=function(B,C){z.trigger(B,[C])};return y}(i);b=function(y){return function(){var z=y.Deferred();z.resolve.apply(z,arguments);return z.promise()}}(i);q=function(z){var y=false;z(function(){setTimeout(function(){y=true},0)});function A(){return y}return A}(i);h=function(B,y,C,F,G,z){var D={};function E(I,H){if(!Array.isArray(I)){I=[I]}return I.map(function(J){if(typeof J==="string"){J={selector:J}}return B.extend({},H,J)})}function A(I){var H;H=I.map(function(K){var J;if(K.requireUpdate){J=new C(K.selector);F.one("start",function(){J.dismiss()})}else{J=G()}return J.pipe(function(){var L=new y(K.selector);F.one("start",function(){L.dismiss()});return L})});return B.when.apply(B,H)}D.start=function(H){var J,I="isInitial" in H?H.isInitial:z()===false;F.trigger("start",{key:H.key,isInitial:I});if(H.ready){J=E(H.ready,{requireUpdate:!I});A(J).done(function(){D.end({key:H.key})})}};D.end=function(H){F.trigger("end",{key:H.key})};return D}(i,r,n,s,b,q);c=window.AJS||(window.AJS={});w=function(y){y.EventQueue=y.EventQueue||[];function z(A,B){y.EventQueue.push({name:A,properties:B})}return z}(c);k=function(z){function y(D,B){var A=z.Deferred(),E;function C(){var F=D();if(F!==undefined){clearInterval(E);A.resolve(F)}}E=setInterval(C,B);C();return A.promise()}return y}(i);j=function(y){return function(){var z=y.Deferred();z.reject.apply(z,arguments);return z.promise()}}(i);t=function(D,z,C,B){var y=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"];function E(){return window.performance&&window.performance.timing&&typeof window.performance.timing.navigationStart!=="undefined"}function A(){if(!E()){return C()}function G(){var H=window.performance.timing.loadEventEnd;if(H>0){return H}}function F(){var H={};y.forEach(function(J){var I=window.performance.timing[J];if(I>0){H[J]=I}});return z(H)}return B(G,500).pipe(F)}return A}(i,b,j,k);u=function(){function y(A,B){var z={};Object.keys(A).forEach(function(C){z[C]=A[C]+B});return z}return y}();a=function(B,A,D,z,C){function y(H){var G=z(),I=H.start,F={},E=C.Deferred();if(H.isInitial){G=G.pipe(A).pipe(function(J){C.extend(F,J);I=F.navigationStart;delete F.navigationStart})}G.always(function(){F.readyForUser=H.end;F=D(F,-I);F.key=H.key;F.isInitial=H.isInitial;F.userAgent=window.navigator.userAgent;E.resolve(F)});return E.promise()}return y}(k,t,u,b,i);p=function(C,B,y){function z(D){return C.extend({start:new Date().getTime(),end:null},D)}function A(D){var E;D.on("start",function(F){E=z(F)});D.on("end",function(F){if(E&&E.key===F.key){E.end=new Date().getTime();y(E).done(function(G){B("browser.metrics.navigation",G)});E=null}})}return A}(i,w,a);e=window.WRM||(window.WRM={});m=function(y){var D="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.feature-data-provider",z;function C(E){return !!(E&&E.constructor&&E.call&&E.apply)}function B(E,F){if(y&&y.data&&y.data.claim&&C(y.data.claim)){return y.data.claim(E)}else{if(y&&y.data&&C(y.data)){return y.data(E)}else{return F}}}function A(){if(z===undefined){z=B(D,true)}return z}return A}(e);d=function(B,A,y,z){if(!z()){return{start:function(){},end:function(){}}}A(y);return B}(h,p,s,m);window["browser-metrics"]=d;if(window.define){window.define("internal/browser-metrics",[],function(){return d})}}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:metrics', location = 'content/js/util/metrics.js' */
define("jira/issues/navigator/metrics",["internal/browser-metrics"],function(a){return{notifyIssueView:function(){a.start({key:"jira.issue.view",ready:[{selector:"#key-val",requireUpdate:false},".issue-body-content"]})},notifyIssueNavDetail:function(){a.start({key:"jira.issue.nav-detail",ready:[{selector:".navigator-content",requireUpdate:false},{selector:"ol.issue-list, .error, .no-results-hint, #errorPageContainer",requireUpdate:false},"#issue-content, .error, .no-results-hint, #errorPageContainer"]})},notifyIssueNavList:function(){a.start({key:"jira.issue.nav-list",ready:[{selector:".navigator-content",requireUpdate:false},"#issuetable, .error, .no-results-hint, #errorPageContainer"]})}}});;
;/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/datePicker.soy' */
// This file was automatically generated from datePicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DateSearcher == 'undefined') { JIRA.Templates.DateSearcher = {}; }


JIRA.Templates.DateSearcher.dateMeasurement = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select class="js-measurement"><option value="m">', soy.$$escapeHtml("minutes"), '</option><option value="h">', soy.$$escapeHtml("hours"), '</option><option value="d">', soy.$$escapeHtml("days"), '</option><option value="w">', soy.$$escapeHtml("weeks"), '</option></select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderWithinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Within the last {0} {1}",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.withinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" class="js-dp-type-toggle" id="withinTheLastRadio"/>');
  var param19 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param19);
  JIRA.Templates.DateSearcher.renderWithinTheLast({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param19.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.nowOverdue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label><input type="radio" class="js-dp-type-toggle" />', soy.$$escapeHtml("Now overdue"), '</label>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} ago",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.moreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param33 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param33);
  JIRA.Templates.DateSearcher.renderMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param33.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} overdue",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param43 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param43);
  JIRA.Templates.DateSearcher.renderDueMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param43.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Due in next {0} {1} {2} overdue",opt_data.inputField,opt_data.dateMeasurementField,opt_data.clauseField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dueInNextRadio"/>');
  var param53 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param53);
  JIRA.Templates.DateSearcher.renderDueInNext({inputField: '<input class="js-val" maxlength="15" type="text" />', dateMeasurementField: param53.toString(), clauseField: '<select class="js-clause"><option value="orIs">' + soy.$$escapeHtml("or is") + '</option><option value="andNot">' + soy.$$escapeHtml("and not") + '</option></select>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Between {0} and {1}",opt_data.startField,opt_data.endField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dateBetweenRadio"/>');
  JIRA.Templates.DateSearcher.renderDateBetween({startField: '<input class="js-start-date" maxlength="15" placeholder="11-Jan-2012" type="text" /><span class="js-start-date-trigger aui-icon aui-icon-small aui-iconfont-calendar">' + soy.$$escapeHtml("Select a date") + '</span>', endField: '<input class="js-end-date" maxlength="12" placeholder="30-Jan-2012" type="text" /><span class="js-end-date-trigger aui-icon aui-icon-small aui-iconfont-calendar">' + soy.$$escapeHtml("Select a date") + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderInRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("In range {0} to {1}",opt_data.startInput,opt_data.endInput));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.inRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" maxlength="15" class="js-dp-type-toggle" id="inRangeRadio"/>');
  JIRA.Templates.DateSearcher.renderInRange({startInput: '<input class="js-start-range" placeholder="-3w 4d 12h" type="text" />', endInput: '<input class="js-end-range" maxlength="15" placeholder="3w 4d 12h" type="text" />'}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/DateSearcher.js' */
(function($){var _excludeList=["js-dp-type-toggle","js-val","js-measurement","js-clause","js-start-date","js-end-date","js-start-range","js-end-range"];var _labelfyContent=function(content,radioKey){var $content=jQuery("<div></div>").html(content).contents();var transformed=[];$content.each(function(index,element){var $element=jQuery(element);var value=jQuery("<div/>").html(element).html();if(!_.contains(_excludeList,$element.attr("class"))){value=value.replace(/^\s+|\s+$/g,"&nbsp;");transformed.push("<label for='"+radioKey+"'>"+value+"</label>")}else{transformed.push(value)}});return transformed.join("")};var _generateSearcherAndBindHandler=function(data){var radioKey=data.radioKey+"Radio";var outputContent=data.$el.html(_labelfyContent(data.rawTemplate,radioKey));outputContent.find(":not(.js-dp-type-toggle):not(select):input").mousedown(function(){var $label=outputContent.find("label");if($label.length>0){$label[0].click()}});return outputContent};var NowOverdue=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"nowOverdue"},template:JIRA.Templates.DateSearcher.nowOverdue,getValues:function(){return{to:0}},updateFromValues:function(values){if(!values.from&&values.to==="0"){return true}},render:function(){return this.$el.html(this.template())}});var WithinTheLast=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"withinTheLast"},template:JIRA.Templates.DateSearcher.withinTheLast,getValues:function(){var val=this.$(".js-val").val();if(val){return{from:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.to&&values.from&&values.from.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.from);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var MoreThan=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"moreThan"},template:JIRA.Templates.DateSearcher.moreThan,getValues:function(){var val=this.$(".js-val").val();if(val){return{to:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.from&&values.to&&values.to.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.to);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DueMoreThan=MoreThan.extend({className:"field-group",template:JIRA.Templates.DateSearcher.dueMoreThan});var DueInNext=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dueInNext"},template:JIRA.Templates.DateSearcher.dueInNext,getValues:function(){var val=this.$el.find(".js-val").val();if(val){return{from:this.$el.find(".js-clause").val()==="andNot"?"0":null,to:val+this.$(".js-measurement").val()}}},updateFromValues:function(values){if((!values.from||values.from==="0")&&values.to){var vals=this.model.parseRelativeStr(values.to);var clause=values.from==="0"?"andNot":"orIs";this.$(".js-val").val(vals.val);this.$(".js-clause").val(clause);if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DatesBetween=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dateBetween"},template:JIRA.Templates.DateSearcher.dateBetween,getValues:function(){return{startDate:this.$el.find(".js-start-date").val(),endDate:this.$el.find(".js-end-date").val()}},updateFromValues:function(values){if(values.startDate||values.endDate){this.$el.find(".js-start-date").val(values.startDate);this.$el.find(".js-end-date").val(values.endDate);return true}},bindCalendar:function(inputClass,triggerClass){var trigger=this.$el.find("."+triggerClass)[0];var input=this.$el.find("."+inputClass)[0];var calendarParams=_.extend({},this.model.calendarConfig,{inputField:input,button:trigger});Calendar.setup(calendarParams)},render:function(){_generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]});this.bindCalendar("js-end-date","js-end-date-trigger");this.bindCalendar("js-start-date","js-start-date-trigger");return this.$el}});var InRange=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"inRange"},template:JIRA.Templates.DateSearcher.inRange,getValues:function(){return{from:this.$el.find(".js-start-range").val(),to:this.$el.find(".js-end-range").val()}},updateFromValues:function(values){if(values.from||values.to){this.$el.find(".js-start-range").val(values.from);this.$el.find(".js-end-range").val(values.to);return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DateSeacherModel=Backbone.Model.extend({initialize:function(options){this.from$El=options.$el.find(".js-date-picker-from").hide();this.to$El=options.$el.find(".js-date-picker-to").hide();this.startDate$El=options.$el.find(".js-date-picker-start-date").hide();this.endDate$El=options.$el.find(".js-date-picker-end-date").hide();this.errors=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.js-date-picker-errors"));this.calendarConfig=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.datepicker-params"))},parseRelativeStr:function(str){var measurement=str.slice(str.length-1);var val=str.slice(0,str.length-1);return{val:val,measurement:measurement}},update:function(updateParams){this.clear();if(updateParams){if(typeof updateParams.from!=="undefined"){this.from$El.val(updateParams.from)}if(typeof updateParams.to!=="undefined"){this.to$El.val(updateParams.to)}if(typeof updateParams.startDate!=="undefined"){this.startDate$El.val(updateParams.startDate)}if(typeof updateParams.endDate!=="undefined"){this.endDate$El.val(updateParams.endDate)}}},toJSON:function(){return{from:this.from$El.val(),to:this.to$El.val(),startDate:this.startDate$El.val(),endDate:this.endDate$El.val(),errors:this.errors}},clear:function(){this.from$El.val("");this.to$El.val("");this.startDate$El.val("");this.endDate$El.val("")}});JIRA.DateSearcher=Backbone.View.extend({initialize:function(options){var instance=this;this.verb=options.verb;this.model=new DateSeacherModel({$el:this.$el});this.setElement($("<div />").addClass("js-picker-ui").appendTo(this.$el));this.views=[];var useInputEvent=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)<10;_.each(options.dateTypes,function(dateType){var view=new dateType({model:instance.model});instance.views.push(view);if(useInputEvent){view.$el.delegate(":text","input",function(){instance.update(view)})}else{view.$el.delegate(":text","keydown",function(){var $this=jQuery(this);var currentVal=$this.val();$this.one("keyup",function(){if($this.val()!==currentVal){instance.update(view)}})});view.$el.delegate(":text","change",function(){instance.update(view)})}view.$el.delegate(":radio,select,input","change",function(){instance.update(view)}).delegate(".aui-iconfont-calendar","click",function(){instance.update(view)})})},update:function(selectedView,error){this.model.update(selectedView.getValues());_.each(this.views,function(view){if(view===selectedView){view.$(":radio").prop("checked",true)}else{view.$(":radio").prop("checked",false)}})},render:function(){var instance=this;var values=this.model.toJSON();_.each(this.views,function(view){instance.$el.append(view.render(instance.verb))});$.each(this.views,function(i,view){if(this.updateFromValues(values)){instance.update(this);if(values.errors){$.each(values.errors,function(i,error){$("<div />").addClass("error").text(error).appendTo(view.$el);return false})}return false}});window.setTimeout(function(){instance.$el.find(":radio:checked").focus()},30)}});JIRA.DateSearcher.createDueDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[NowOverdue,DueMoreThan,DueInNext,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createResolvedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCreatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createUpdatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCustomDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()}})(AJS.$);;
;/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initDateSearchers.js' */
jQuery(function(){function initDueDateSearcher($ctx){$ctx.find(".js-duedate-searcher").each(function(){JIRA.DateSearcher.createDueDateSearcher(this)})}function initResolvedDateSearcher($ctx){$ctx.find(".js-resolutiondate-searcher").each(function(){JIRA.DateSearcher.createResolvedDateSearcher(this)})}function initCreatedDateSearcher($ctx){$ctx.find(".js-created-searcher").each(function(){JIRA.DateSearcher.createCreatedDateSearcher(this)})}function initUpdatedDateSearcher($ctx){$ctx.find(".js-updated-searcher").each(function(){JIRA.DateSearcher.createUpdatedDateSearcher(this)})}function initCustomFieldDateSearcher($ctx){$ctx.find(".js-customdate-searcher").each(function(){JIRA.DateSearcher.createCustomDateSearcher(this)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initDueDateSearcher(context);initResolvedDateSearcher(context);initCreatedDateSearcher(context);initUpdatedDateSearcher(context);initCustomFieldDateSearcher(context)}})});;
;/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initSparklers.js' */
jQuery(function(){function initSparklers($ctx){$ctx.find(".js-default-checkboxmultiselect").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselect")){$select.data("checkboxmultiselect",new AJS.CheckboxMultiSelect({element:this}))}else{$select.data("checkboxmultiselect").render()}})}function initStatusLozengeSparklers($ctx){$ctx.find(".js-default-checkboxmultiselectstatuslozenge").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselectstatuslozenge")){$select.data("checkboxmultiselectstatuslozenge",new AJS.CheckboxMultiSelectStatusLozenge({element:this}))}else{$select.data("checkboxmultiselectstatuslozenge").render()}})}function initLabelSparkler($ctx){$ctx.find(".js-label-checkboxmultiselect").each(function(){var cms=new AJS.CheckboxMultiSelect({element:this,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels/suggest",query:true,minQueryLength:0,formatResponse:function(response){var selectedValues=cms.model.getSelectedValues();return[new AJS.GroupDescriptor({items:_.map(_.sortBy(_.reject(response.suggestions,function(suggestion){return _.contains(selectedValues,suggestion.label)}),"label"),function(suggestion){return new AJS.ItemDescriptor({highlighted:true,html:suggestion.html,label:suggestion.label,value:suggestion.label,title:suggestion.label})})})]}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initSparklers($context);initStatusLozengeSparklers($context);initLabelSparkler($context)}})});;
;/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initUserSparkler.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){function _formatUserGroupResponse(response){var users=_formatUserResponse(response.users,true);var groups=_formatGroupResponse(response.groups,true);var items=[].concat(users).concat(groups);return[new AJS.GroupDescriptor({items:items})]}function _formatUserResponse(response,prefix){return _.map(response.users,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:item.avatarUrl,label:item.displayName,value:(prefix?"user:":"")+item.name})})}function _formatGroupResponse(response,prefix){return _.map(response.groups,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:AJS.contextPath()+"/images/icons/icon_groups_16.png",label:item.name,value:(prefix?"group:":"")+item.name})})}jQuery(".js-usergroup-checkboxmultiselect",$ctx).each(function(){var ajaxData={};AJS.$("fieldset.user-group-searcher-params",$ctx).each(function(){ajaxData=JIRA.parseOptionsFromFieldset(AJS.$(this))});ajaxData.showAvatar=true;new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:10,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groupuserpicker",data:ajaxData,query:true,formatResponse:_formatUserGroupResponse}})});jQuery(".js-user-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/user/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatUserResponse(items,false)}}})});jQuery(".js-group-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groups/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatGroupResponse(items,false)}}})})});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/util/URLSerializer.js' */
(function(){var b="browse/",d="issues/";var c=function(e){return e};var a=function(e){if(typeof e==="string"){return parseInt(e,10)}return e};JIRA.Issues.URLSerializer={getURLFromState:function(g){g=g||{};var f=[];var e;if(g.selectedIssueKey){e=b+g.selectedIssueKey}else{e=d}if(g.filter!=null){f.push("filter="+g.filter)}if(g.jql!=null&&(g.filterJql==null||g.jql!==g.filterJql)){f.push("jql="+encodeURIComponent(g.jql))}if(g.startIndex&&!g.selectedIssueKey){f.push("startIndex="+g.startIndex)}return e+(f.length?"?"+f.join("&"):"")},getStateFromURL:function(e){var g={},i=e.split("?")[0],j,h;h={filter:null,jql:null,selectedIssueKey:null,startIndex:0};if(e.indexOf(b)==0){h.selectedIssueKey=i.split("/")[1]}if(e.indexOf("?")!==-1){j=e.substr(e.indexOf("?"));g=JIRA.Issues.QueryStringParser.parse(j);var f=_.pick(g,"focusedCommentId","attachmentSortBy","attachmentOrder");if(!_.isEmpty(f)){h.viewIssueQuery=f}}return _.inject(this.PARAMETER_TRANSFORM,function(n,k,l){var m=g[l];if(m!==undefined){n[l]=k(m)}return n},_.extend(h))},PARAMETER_TRANSFORM:{filter:c,jql:c,startIndex:a}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssueSearchManager.js' */
Backbone.define("JIRA.Issues.IssueSearchManager",JIRA.Issues.BaseEvented.extend({namedEvents:["beforeSearch","searchError"],initialize:function(a){_.extend(this,a);this.issueKeys=new JIRA.Components.IssueViewer.Legacy.AsyncData()},hasInitialSearch:function(){return !!this.initialIssueTableState},search:function(c){var b,a;c=_.extend({},c);if(_.isNumber(c.startIndex)===false){c.startIndex=0}if(this.activeResultsReq){if(JSON.stringify(this.activeRequestData)===JSON.stringify(c)){return jQuery.Deferred().reject().promise()}else{this.activeResultsReq.abort()}}this.activeRequestData=c;this.triggerBeforeSearch();if(this.hasInitialSearch()){b=jQuery.Deferred().resolve(this.initialIssueTableState);a="jira.search.finished.initial";this.initialIssueTableState=null;this.initialIssueIds=null}else{b=this.activeResultsReq=this._doSearch(c);a="jira.search.finished.secondary"}b.always(_.bind(function(){this.activeResultsReq=null;this.activeRequestData=null;JIRA.trace(a)},this));b.done(_.bind(this._updateIssueKeysOnSearchSuccess,this));b.fail(_.bind(function(){this.issueKeys.reset();this.triggerSearchError();_.defer(JIRA.trace,"jira.search.finished")},this));return b.pipe(function(d){if(d.issueTable){delete d.issueTable.issueKeys}return d}).promise()},_doSearch:function(c){var b=/^-?\d+$/;if(c.filterId&&!b.test(c.filterId)){var a={status:400,responseText:JSON.stringify({errors:["Invalid filter id. Filter id must be a number."]})};return jQuery.Deferred().reject(a).promise()}return jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/issueNav/1/issueTable",headers:JIRA.Issues.XsrfTokenHeader,data:_.extend(c,{layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()})})},_updateIssueKeysOnSearchSuccess:function(a){var c=a.issueTable.issueIds;var b=a.issueTable.issueKeys;if(c&&b){var d={};_.each(c,function(f,e){d[f]={value:b[e],error:false}});this.issueKeys.reset(d)}else{var d=JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(a.issueTable.table);this.issueKeys.reset(d)}},getRowsForIds:function(b,a){if(!b.length){return jQuery.Deferred().resolve({}).promise()}var c=jQuery.ajax({data:_.extend({id:b,layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()},a),type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/1/issueTable/stable"});c.fail(_.bind(function(){this.triggerSearchError()},this));return c.pipe(function(d){return d.issueTable}).done(_.bind(function(d){this.issueKeys.setMultiple(JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(d.table,b));_.defer(JIRA.trace,"jira.search.finished")},this)).promise()},setAsInaccessible:function(a){return this.issueKeys.setError(a)}},{_extractIssueKeysFromTable:function(a,b){var c={};AJS.$(a).find(".issuerow").each(function(f){var d=AJS.$(this);var g=b?b[f]:d.attr("rel");var e=d.data("issuekey")||null;if(g){c[g]=e?{value:e,error:false}:{error:true}}});return c}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/SearchResults.js' */
(function(a){Backbone.define("JIRA.Issues.SearchResults",JIRA.Issues.BaseModel.extend({defaults:{issueIds:[],selectedIssue:new JIRA.Issues.SimpleIssue(),highlightedIssue:new JIRA.Issues.SimpleIssue(),total:0},properties:["columnSortJql","highlightedIssue","issueIds","issueIdsForPage","jiraHasIssues","pageSize","resultsId","selectedIssue","startIndex","sortBy","columns","table","total","initialPayload","columnConfig"],namedEvents:["prevIssueSelected","nextIssueSelected","issueUpdated","issueDeleted","issueDoesNotExist","stableUpdate"],initialize:function(b,c){JIRA.Issues.ModelUtils.makeTransactional(this,"resetFromSearch","selectNextIssue","selectPrevIssue");this.issueUpdateCallbacks=[];this._issueSearchManager=c.issueSearchManager;this._initialSelectedIssue=c.initialSelectedIssue;this._columnConfig=c.columnConfig},getStartIndexForPage:function(b){return b*this.getPageSize()},hasIssue:function(b){return _.indexOf(this.getIssueIds(),b)!==-1},getPager:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var e=this.getIssueIds();var f=this.getSelectedIssue().getId();var c=_.indexOf(e,f);var g=this.getTotal();var h=e.length;var d={position:JIRA.NumberFormatter.format(c+1),resultCount:JIRA.NumberFormatter.format(g)};if(c>0){var i=this._getPrevIssueId(f);if(i){d.previousIssue={id:i,key:this._getIssueKeyForId(i)}}}if(c<g-1&&c<h-1){var b=this._getNextIssueId(f);if(b){d.nextIssue={id:b,key:this._getIssueKeyForId(b)}}}return d}},getNumberOfPages:function(){return this._getPageNumberForStartIndex(this.getDisplayableTotal()-1)},removeIssue:function(e){e=parseInt(e,10);var d=this.getIssueIds()[0]===e,c=this.getHighlightedIssue().getId()===e,b=_.last(this.getIssueIds())===e;if(c){if(!b){this.highlightNextIssue({replace:true})}else{if(!d){this.highlightPrevIssue({replace:true})}}}this.setIssueIds(_.without(this.getIssueIds(),e));this.setTotal(this.getTotal()-1);this.triggerIssueDeleted({id:e,key:this._getIssueKeyForId(e)})},isFirstIssueHighlighted:function(){if(!this.hasHighlightedIssue()){return false}return this.getHighlightedIssue().getId()===this.getIssueIds()[0]},updateIssueById:function(c,b){return this.updateIssue(c,b)},updateIssue:function(f,b){var d=f.action===JIRA.Issues.Actions.DELETE,e=f.id,c=[];b=_.defaults({},b,{showMessage:true,filter:null});if(d){this.removeIssue(e);b.showMessage&&this._notifyOfIssueUpdate(f);return jQuery.Deferred().resolve().promise()}else{return this.getResultForId(e,b.filter).done(_.bind(function(g){_.each(this.issueUpdateCallbacks,function(i){var h=i.handler.call(i.ctx||window,e,g,f);if(h&&h.promise){c.push(h)}});a.when(c).done(_.bind(function(){b.showMessage&&this._notifyOfIssueUpdate(f)},this))},this))}},_notifyOfIssueUpdate:function(b){b.message&&JIRA.Issues.showNotification(b.message,b.key);JIRA.trace("jira.search.stable.update")},getResultForId:function(d,c){var b={columnConfig:this._columnConfig.columnPickerModel.getColumnConfig()};if(c&&!c.getIsSystem()){b=_.extend({filterId:c.getId()},b)}return this._issueSearchManager.getRowsForIds([d],b)},isHighlightedIssueAccessible:function(){if(!this.hasHighlightedIssue()){return null}return !this._issueSearchManager.issueKeys.hasError(this.getHighlightedIssue().getId())},getDisplayableTotal:function(){return this.getIssueIds().length},selectIssueByKey:function(c,b){if(!c){this.unselectIssue();return}var d=this._getIssueIdForKey(c);if(!d||d==-1){this._unhighlightIssue();this.getSelectedIssue().set({id:-1,key:c});this.triggerIssueDoesNotExist()}else{this._selectExistingIssueById(d,b)}},_unhighlightIssue:function(){this.getHighlightedIssue().set({id:null,key:null})},selectFirstInPage:function(b){this.selectIssueById(this.getIssueIds()[this.getStartIndex()],b)},getPrevPageStartIndex:function(){var b=(this.getStartIndex()||0)-this.getPageSize();return(b<0)?null:b},getNextPageStartIndex:function(){var b=this.getPositionOfLastIssueInPage();return(b>=this.getDisplayableTotal())?null:b},getPositionOfLastIssueInPage:function(){var c=this.getStartIndex();var b=this._pageSize();return Math.min(c+b,this.getDisplayableTotal())},highlightFirstInPage:function(){this.highlightIssueById(this.getIssueIds()[this.getStartIndex()])},selectIssueById:function(c,b){if(!c){this.unselectIssue()}else{this._selectExistingIssueById(c,b)}},_selectExistingIssueById:function(c,b){if(c!==this.getSelectedIssue().getId()&&JIRA.Issues.Application.request("issueEditor:canDismissComment")){c=c?parseInt(c,10):null;this.getSelectedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);this.highlightIssueById(c)}},highlightIssueById:function(c,b){b=_.defaults({},b,{replace:false});if(c&&c!==this.getHighlightedIssue().getId()){c=c?parseInt(c,10):null;this.getHighlightedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);if(c){this.setStartIndex(this._getStartIndexForIssueId(c))}}},getState:function(){return{selectedIssueKey:this.getSelectedIssue().getKey(),startIndex:this.getStartIndex()}},resetFromSearch:function(b){b.resultsId=_.uniqueId();this.getSelectedIssue().set({id:null,key:null});this.set({sortBy:null});this.set("startIndex",b.startIndex,{silent:true});this.set(_.pick(b,this.properties));if(typeof b.selectedIssueKey==="string"){this.selectIssueByKey(b.selectedIssueKey)}else{if(this.hasIssues()){this.highlightFirstInPage()}else{this.getHighlightedIssue().set({id:null,key:null})}}},hasIssues:function(){return !!this.getIssueIds().length},isIssueOnPage:function(b){return _.indexOf(this.getPageIssueIds(),b)!==-1},isFirstIssueSelected:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var c=this.getIssueIds();var d=this.getSelectedIssue().getId();var b=_.indexOf(c,d);return b===0}return false},getResultsForPage:function(c){_.extend(c,{columnConfig:this._columnConfig.columnPickerModel.getColumnConfig()});if(this.getTable()){var b=this.getTable();this.setTable(null,{silent:true});_.defer(function(){JIRA.trace("jira.search.finished")});return a.Deferred().resolve(b).promise()}return this.getResultsForIds(this.getPageIssueIds(),c)},getResultsForIds:function(e,d){var b=this;var c=a.Deferred();this._issueSearchManager.getRowsForIds(e,d).done(function(f){var g=_.isArray(f.table);if(!g){b.setColumnConfig(f.columnConfig);b.setColumns(f.columns);b.setColumnSortJql(f.columnSortJql)}c.resolve(f.table)}).fail(c.reject).always(function(){_.defer(function(){JIRA.trace("jira.search.finished")})});return c},applyState:function(b){this.set(_.pick(b,this.properties))},unselectIssue:function(b){var c=this.getSelectedIssue();if(c.getId()&&JIRA.Issues.Application.request("issueEditor:canDismissComment")){c.set({id:null,key:null},b)}},hasSelectedIssue:function(){return !!this.getSelectedIssue().getId()},hasHighlightedIssue:function(){return !!this.getHighlightedIssue().getId()},getPageIssueIds:function(){var d=this.getStartIndex();var c=this._pageSize();var b=this.getIssueIds();return b?b.slice(d,Math.min(d+c,b.length)):[]},getPageIssues:function(){return _.map(this.getPageIssueIds(),function(b){return{id:b,key:this._getIssueKeyForId(b)}},this)},getPageNumber:function(){return Math.floor(this.getStartIndex()/this._pageSize())},getPositionOfIssueInPage:function(b){return this.getPositionOfIssueInSearchResults(b)%this._pageSize()},getPositionOfIssueInSearchResults:function(b){return _.indexOf(this.getIssueIds(),b)},selectNextIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getSelectedIssue().getId());this._triggerNextIssueSelectedEvent(c);return this._selectIssue(c,b)},selectPrevIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getSelectedIssue().getId());this._triggerPrevIssueSelectedEvent(c);return this._selectIssue(c,b)},_selectIssue:function(c,b){this.selectIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightNextIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightPrevIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},goToPage:function(d,c){c=_.defaults({},c,{replace:false});if(d===null||d===this.getStartIndex()){return a.Deferred().resolve().promise()}var b=this.getIssueIds()[d];this.highlightIssueById(b,c);return a.Deferred().resolve(b).promise()},onHighlightedIssueChange:function(c,b){this.getHighlightedIssue().on("change",c,b)},offHighlightedIssueChange:function(c,b){this.getHighlightedIssue().off("change",c,b)},onSelectedIssueChange:function(c,b){this.getSelectedIssue().on("change",c,b)},offSelectedIssueChange:function(c,b){this.getSelectedIssue().off("change",c,b)},onColumnConfigChange:function(c,b){this.on("change:columnConfig",c,b)},offColumnConfigChange:function(c,b){this.off("change:columnConfig",c,b)},onColumnsChange:function(c,b){this.on("change:columns",c,b)},offColumnsChange:function(c,b){this.off("change:columns",c,b)},onStartIndexChange:function(c,b){this.on("change:startIndex",c,b)},onNewIssueIds:function(c,b){this.on("change:issueIds",c,b)},offNewIssueIds:function(c,b){this.off("change:issueIds",c,b)},offStartIndexChange:function(c,b){this.off("change:startIndex",c,b)},onNewPayload:function(c,b){this.on("change:resultsId",c,b)},offNewPayload:function(c,b){this.off("change:resultsId",c,b)},onIssueUpdated:function(c,b){this.issueUpdateCallbacks.push({handler:c,ctx:b})},offIssueUpdated:function(c){var b=[];this.issueUpdateCallbacks=_.each(this.issueUpdateCallbacks,function(d){if(d.handler!==c){b.push(d)}});this.issueUpdateCallbacks=b},_getNextIssueId:function(c){var b=this.getIssueIds();return b[Math.min(_.indexOf(b,c)+1,this.getDisplayableTotal()-1)]},getNextIssueForId:function(c){var b=this._getNextIssueId(c);return{id:b,key:this._getIssueKeyForId(b)}},getNextIssueForSelectedIssue:function(){return this.getNextIssueForId(this.getSelectedIssue().getId())},_getPrevIssueId:function(c){var b=this.getIssueIds();return b[Math.max(0,_.indexOf(this.getIssueIds(),c)-1)]},_getStartIndexForIssueId:function(d){var c=_.indexOf(this.getIssueIds(),d),b=this._pageSize();return Math.max(0,Math.floor(c/b)*b)},_getIssueIdForKey:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.key){return this._initialSelectedIssue.id}return this._getIssueKeysToIds()[b]},_getIssueKeyForId:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.id){return this._initialSelectedIssue.key}return this._getIssueIdsToKeys()[b]},_getIssueIdsToKeys:function(){return this._issueSearchManager.issueKeys.getAllCached()},_getIssueKeysToIds:function(){var b={};var c=this._issueSearchManager.issueKeys.getAllCached();_.each(c,function(e,d){b[e]=d});return b},_getPageNumberForStartIndex:function(b){return Math.floor(b/this._pageSize())},_pageSize:function(){return this.getPageSize()},_triggerPrevIssueSelectedEvent:function(c){if(c!==this.getSelectedIssue().getId()){var b=this._getPrevIssueId(c);this.trigger("prevIssueSelected",{prevIssue:{id:c,key:this._getIssueKeyForId(c)},prevPrevIssue:{id:b,key:this._getIssueKeyForId(b)}})}},_triggerNextIssueSelectedEvent:function(b){if(b!==this.getSelectedIssue().getId()){var c=this._getNextIssueId(b);this.trigger("nextIssueSelected",{nextIssue:{id:b,key:this._getIssueKeyForId(b)},nextNextIssue:{id:c,key:this._getIssueKeyForId(c)}})}}}))})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/SearchModule.js' */
Backbone.define("JIRA.Issues.SearchModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._issueSearchManager=a.issueSearchManager;this._searchPageModule=a.searchPageModule;this._searchResults=new JIRA.Issues.SearchResults(null,{issueSearchManager:this._issueSearchManager,initialSelectedIssue:a.initialSelectedIssue,columnConfig:this._searchPageModule.columnConfig});JIRA.Issues.Application.reqres.setHandler("issueNav:currentSearchRequest",this.getCurrentSearchRequest,this);JIRA.Issues.Application.commands.setHandler("issueNav:refreshSearch",this.refresh,this)},doSort:function(a){if(a){this._searchPageModule.update({jql:a,startIndex:null,selectedIssueKey:null},true)}},getFilterId:function(){var a=this._searchPageModule.getFilter();return a&&a.getId()},getJql:function(){return this._searchPageModule.getJql()},getEffectiveJql:function(){return this._searchPageModule.getEffectiveJql()},getResults:function(){return this._searchResults},getState:function(){return this._searchPageModule.getState()},getCurrentSearchRequest:function(){return{jql:this.getJql(),filterId:this.getFilterId()}},isStandAloneIssue:function(a){a=a||this._searchPageModule.getState();return !!a.selectedIssueKey&&!_.isString(a.jql)&&!a.filter},onBeforeSearch:function(b,a){this._issueSearchManager.bindBeforeSearch(b,a)},offBeforeSearch:function(b,a){this._issueSearchManager.unbindBeforeSearch(b,a)},onSearchError:function(b,a){this._issueSearchManager.bindSearchError(b,a)},offSearchError:function(b,a){this._issueSearchManager.unbindSearchError(b,a)},refresh:function(){return this._searchPageModule.refreshSearch()},stableUpdate:function(a){this._searchResults.triggerStableUpdate(_.extend({force:true},a))}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/EmptyResultsView.js' */
Backbone.define("JIRA.Issues.EmptyResultsView",JIRA.Issues.BaseView.extend({initialize:function(a){this.searchResults=a.searchResults},render:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca\u003elogging in\u003c/a\u003e to see more results";b="not-logged-in-message";a="login"}else{if(this.searchResults.getJiraHasIssues()===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca\u003ecreate an issue\u003c/a\u003e":null;b="empty-results-message";a="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca\u003ecreating a new issue\u003c/a\u003e":"Try modifying your search criteria";b="no-results-message";a="create"}}this.$el.addClass("empty-results");this.$el.html(JIRA.Templates.IssueNavTable.noResults({message:d,hint:e,cssClass:b}));var f=this.$(".no-results-hint a");switch(a){case"create":f.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa");break;case"login":f.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link");break}_.defer(jQuery.event.trigger,"updateOffsets.popout");_.defer(JIRA.trace,"jira.search.finished")}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/SearchPageModule.js' */
Backbone.define("JIRA.Issues.SearchPageModule",JIRA.Issues.BaseModel.extend({namedEvents:["changeFilterProps"],properties:["currentLayout","layouts","filter","jql","searchId"],defaults:function(){return{filter:null,jql:null}},initialize:function(a,b){_.extend(this,b);this.registerColumnPicker();this.setLayouts({});this.registerLayout("list-view",{label:"List View",iconClass:"aui-iconfont-view-table",view:JIRA.Issues.FullScreenLayout});this.registerLayout("split-view",{label:"Detail View",iconClass:"aui-iconfont-view-list",view:JIRA.Issues.SplitScreenLayout});this._onFilterChanged();this.on("change:filter",this._onFilterChanged,this);JIRA.Issues.Application.on("issueEditor:close",this.returnToSearch,this);JIRA.Issues.Application.on("issueEditor:loadComplete",function(c,d){if(!this.standalone&&!d.reason){this.searchResults.selectIssueById(c.getId(),{reason:"issueLoaded"});this.searchResults.updateIssueById({id:c.getId(),action:"rowUpdate"},{filter:this.getFilter()});if(c.getKey()){var e=this._getUpdateState({selectedIssueKey:c.getKey()});if(this._validateNavigate(e)){this.issueNavRouter.replaceState(e)}}}},this);JIRA.Issues.Application.on("issueEditor:saveSuccess",function(c){this.searchResults.updateIssueById({id:c.issueId,action:"inlineEdit"},{filter:this.getFilter()})},this)},registerColumnPicker:function(){this.columnConfig=JIRA.Issues.ColumnPicker.create({search:this})},getInactiveLayouts:function(){var a=[];_.each(this.getLayouts(),function(c,b){if(b!==JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()){a.push(c)}},this);return a},getActiveLayout:function(){return this.getLayouts()[JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()]},changeLayout:function(c,b){var d=this.getLayout(c),e,a=this.getCurrentLayout();JIRA.Issues.changingLayout=true;jQuery("body, html").scrollTop(0);b=_.defaults({},b,{ajax:true,render:true});if(d){if(a instanceof d.view){return}if(a&&a.close){a.close();this.searchResults.unselectIssue({replace:true})}JIRA.Issues.LayoutPreferenceManager.setPreferredLayoutKey(c,b);e=new d.view({fullScreenIssue:this.fullScreenIssue,issueContainer:this.issueContainer,issueCacheManager:this.issueCacheManager,search:this.search,searchContainer:this.searchContainer,searchHeaderModule:this.searchHeaderModule,columnConfig:this.columnConfig});e.on("close",function(){this.searchContainer.find(".navigator-content").addClass("pending")},this);e.on("render",function(){this.searchContainer.find(".navigator-content").removeClass("pending");JIRA.trigger(JIRA.Events.LAYOUT_RENDERED,[c])},this);b.render&&e.render();this.setCurrentLayout(e);this.standalone=false}},createLayout:function(){if(!this.getCurrentLayout()){this.changeLayout(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey(),{render:false});this.fullScreenIssue.deactivate()}},_onFilterChanged:function(){var a=this.previous("filter");if(a){a.off("change",this.triggerChangeFilterProps,this)}var b=this.getFilter();if(b){b.on("change",this.triggerChangeFilterProps,this)}},getLayout:function(a){return this.getLayouts()[a]||null},getSortedLayouts:function(){return _.sortBy(this.getLayouts(),"label")},registerLayout:function(a,b){b.id=a;this.getLayouts()[a]=b},getJqlDeferred:function(){var b=jQuery.Deferred();var a=this;_.defer(function(){a.queryModule.searchersReady().always(function(){_.defer(function(){b.resolve(a.getEffectiveJql())})})});return b.promise()},registerIssueSearchManager:function(a){this.issueSearchManager=a},registerIssueCacheManager:function(a){this.issueCacheManager=a},registerQueryModule:function(a){this.queryModule=a;this.queryModule.onJqlChanged(this.queryModuleSearchRequested,this);this.queryModule.onJqlError(this.disableLayoutSwitcher,this);this.queryModule.onJqlSuccess(this.enableLayoutSwitcher,this);this.queryModule.onVerticalResize(JIRA.Issues.triggerVerticalResize);this.queryModule.onQueryTooComplexSwitchToAdvanced(function(){JIRA.Issues.Application.execute("analytics:trigger","kickass.queryTooComplexSwitchToAdvanced")});this.queryModule.onBasicModeCriteriaCountWhenSearching(function(b){JIRA.Issues.Application.execute("analytics:trigger","kickass.basicModeCriteriaCountWhenSearching",b)});this.queryModule.onChangedPreferredSearchMode(function(b){JIRA.Issues.Application.execute("analytics:trigger","kickass.switchto"+b)});this.queryModule.onSearchChanged(_.bind(function(e){var h=this.getState();var g=e.newJql;var c=h.filterJql;var d=h.jql;var b;var f;if(d===null){b=c!==g;f=c!==g}else{b=c!==d||d!==g;f=d!==g}this.filterModule.updateFilterHeader({isEdited:b,isPendingSearch:f})},this));JIRA.Shifter.register(new JIRA.Issues.SearchShifter({isBasicMode:_.bind(this.queryModule.isBasicMode,this.queryModule),isFullScreenIssue:_.bind(this.isFullScreenIssueVisible,this),searcherCollection:this.queryModule.getSearcherCollection()}))},disableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.disableLayoutSwitcher()}},enableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.enableLayoutSwitcher()}},registerLayoutSwitcher:function(a){this.layoutSwitcher=a},registerFilterModule:function(a){if(this.filterModule){this.filterModule.off("filterRemoved");this.filterModule.off("filterSelected")}this.filterModule=a;this.filterModule.on("filterRemoved",function(c){var b=this.getFilter();if(b&&c.filterId===b.getId()){this.resetToBlank()}},this);this.filterModule.on("filterSelected",function(b){this.resetToFilter(b.filterId)},this)},registerSearch:function(b){this.search=b;this.searchResults=this.search.getResults();this.searchResults.on("change:resultsId",this._handleSearchResultsChange,this);this.searchResults.onStartIndexChange(this._handleSearchResultsChange,this);this.searchResults.onSelectedIssueChange(this._handleSearchResultsChange,this);var a=this.columnConfig;this.on("change:filter",function(){a.clearFilterConfiguration()});this.searchResults.onColumnsChange(function(c){var d=c.getColumnConfig();if(d){a.syncColumns(d,c.getColumns())}});this.searchResults.onColumnConfigChange(function(c){var d=c.getColumnConfig();if(d){a.setCurrentColumnConfig(d);a.syncColumns(d,c.getColumns())}});a.onColumnsSync(function(c){b.stableUpdate({columnConfig:c})});this.searchResults.onSelectedIssueChange(_.bind(function(c){if(!c.hasIssue()){JIRA.Issues.Application.execute("issueEditor:removeIssueMetadata")}},this))},_handleSearchResultsChange:function(b,a){a=a||{};a.replace?this.issueNavRouter.replaceState(this.getState()):this.issueNavRouter.pushState(this.getState())},registerSearchHeaderModule:function(a){this.searchHeaderModule=a},registerFullScreenIssue:function(a){this.fullScreenIssue=a;this.fullScreenIssue.bindIssueHidden(function(){JIRA.Issues.Application.execute("issueEditor:dismiss");this.updateWindowTitle(this.getFilter());JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.searchContainer,JIRA.CONTENT_ADDED_REASON.returnToSearch])},this)},registerViewContainers:function(a){this.issueContainer=a.issueContainer;this.searchContainer=a.searchContainer},registerIssueNavRouter:function(a){this.issueNavRouter=a},prevIssue:function(){if(this._overlayIsVisible()){return false}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")&&!this.standalone){this.getCurrentLayout().prevIssue();return true}return false},nextIssue:function(){if(this._overlayIsVisible()){return false}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")&&!this.standalone){this.getCurrentLayout().nextIssue();return true}return false},isCurrentlyLoadingIssue:function(){return JIRA.Issues.Application.request("issueEditor:isCurrentlyLoading")},_overlayIsVisible:function(){return AJS.$(".aui-blanket").filter(":visible").length>0},getEffectiveIssueId:function(a){return this.getEffectiveIssue().getId()},updateIssue:function(c){var b=c.action===JIRA.Issues.Actions.DELETE,a=this.fullScreenIssue.isVisible();if(b){return this._deleteIssue(c)}else{if(a){return this.fullScreenIssue.updateIssue(c).done(_.bind(function(){!this.standalone&&this.searchResults.updateIssue(c,{showMessage:false,filter:this.getFilter()})},this))}else{return this.searchResults.updateIssue(c,{filter:this.getFilter()})}}},_deleteIssue:function(c){var a=this.fullScreenIssue.isVisible(),b=c.key==JIRA.Issues.Application.request("issueEditor:getIssueKey");if(!a){return this.searchResults.updateIssue(c)}else{if(!b){return this.fullScreenIssue.updateIssue(c)}else{if(this.standalone){this.resetToBlank();JIRA.Issues.showNotification(c.message,c.key);return jQuery.Deferred().resolve().promise()}else{this.returnToSearch();return this.searchResults.updateIssue(c)}}}},getEffectiveIssueKey:function(){return this.getEffectiveIssue().getKey()},getEffectiveIssue:function(){var b=this.searchResults.hasHighlightedIssue(),c=this.searchResults.hasSelectedIssue(),a;a=new JIRA.Issues.SimpleIssue({id:JIRA.Issues.Application.request("issueEditor:getIssueId"),key:JIRA.Issues.Application.request("issueEditor:getIssueKey")});if(this.standalone){return a}else{if(c){return this.searchResults.getSelectedIssue()}else{if(b){return this.searchResults.getHighlightedIssue()}else{return a}}}},isHighlightedIssueAccessible:function(){return this.search.getResults().isHighlightedIssueAccessible()},returnToSearch:function(){if(this.standalone){this.resetToBlank();JIRA.trace("jira.returned.to.search")}else{if(this.fullScreenIssue.isVisible()){require("jira/issues/navigator/metrics").notifyIssueNavList();this.searchResults.unselectIssue();JIRA.Issues.Application.execute("issueEditor:beforeHide");if(this.queryModule.refreshLayout){this.queryModule.refreshLayout()}}else{JIRA.trace("jira.returned.to.search")}}jQuery.event.trigger("updateOffsets.popout")},toggleFilterPanel:function(){return this.filterModule.toggleFilterPanel()},issueTableSortRequested:function(a,b){this.update({jql:a,startIndex:b})},issueTableSearchError:function(a){if(a.status!==0){this.filterModule.filtersComponent.markFilterHeaderAsInvalid();var c;try{c=JSON.parse(a.responseText)}catch(b){c={errorMessages:["Error occurred communicating with the server. Please reload the page and try again."]}}this.queryModule.onSearchError(c)}},issueTableSearchSuccess:function(a){this.update({startIndex:a.startIndex});this.queryModule.onSearchSuccess(a.warnings)},issueTableStableUpdate:function(a){this.update({startIndex:a})},confirmNavigation:function(a){a=_.defaults({},a,{confirm:function(c){return window.confirm(c)},ignoreDirtiness:false});var b=JIRA.DirtyForm.getDirtyWarning()||JIRA.Issue.getDirtyCommentWarning();return !!a.ignoreDirtiness||b===undefined||a.confirm(b)},isFullScreenIssueVisible:function(){return this.fullScreenIssue&&this.fullScreenIssue.isVisible()},isIssueVisible:function(){var a=JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey();if(this.isFullScreenIssueVisible()){return true}else{if(a==="list-view"){return this.fullScreenIssue.isVisible()}else{if(a==="split-view"){return this.search.getResults().hasIssues()}}}return false},queryModuleSearchRequested:function(a){this.update({jql:a,startIndex:0,selectedIssueKey:null,searchId:_.uniqueId()})},filterModuleSaved:function(a){this.reset({filter:a.getId()})},discardFilterChanges:function(){this.update({jql:null,selectedIssueKey:null},true)},getState:function(){var a=this.getFilter();var b={filter:a&&a.getId(),filterJql:a&&a.getJql(),jql:this.getJql()};if(this.standalone){b.selectedIssueKey=JIRA.Issues.Application.request("issueEditor:getIssueKey")}else{_.extend(b,this.search.getResults().getState())}return b},_doSearch:function(a){a=a||{};var b={};var d;var c=this.getFilter();b.startIndex=a.startIndex;if(c){b.filterId=c.getId()}if(a.columnConfig){b.columnConfig=a.columnConfig}b.jql=this.getEffectiveJql();d=this.issueSearchManager.search(b);d.done(_.bind(function(e){if(this.fullScreenIssue.isVisible()&&!AJS.Meta.get("serverRenderedViewIssue")){JIRA.Issues.Application.execute("issueEditor:beforeHide")}this.searchResults.resetFromSearch(_.extend(a,e.issueTable));this.queryModule.onSearchSuccess(e.warnings);jQuery.event.trigger("updateOffsets.popout")},this)).fail(_.bind(function(e){if(e.statusText!=="abort"){if(e.status==400&&a.selectedIssueKey){this.reset({selectedIssueKey:a.selectedIssueKey},{replace:true})}else{this.searchResults.resetFromSearch(_.extend(_.pick(a,"selectedIssueKey"),this.searchResults.defaults));this.issueTableSearchError(e)}}},this));return d},updateWindowTitle:function(a){if(this.isFullScreenIssueVisible()){return}var b=a,c=AJS.format("{0} - {1}","Issue Navigator",JIRA.Settings.ApplicationTitle.get());if(b&&b.getIsValid()){document.title="["+b.getName()+"] "+c}else{document.title=c}},_applyState:function(d,g,c){c=c||{};var f=_.extend(this.toJSON(),this.search.getResults().toJSON());var b=_.pick(d,this.properties);this.set(b);var e=_.extend(this.toJSON(),d);this.updateWindowTitle(this.getFilter());if(g){var a=(d.filter&&d.jql==null)?d.filter.getJql():d.jql;this.queryModule.resetToQuery(a,{focusQuery:c.isNewSearch}).always(_.bind(function(){this.queryModule.setVisible(!d.filter||d.filter.getIsValid())},this))}if(this.shouldPerformNewSearch(f,e)){var h=this._doSearch(e)}else{var h=jQuery.Deferred().resolve();if("selectedIssueKey" in d){this.searchResults.selectIssueByKey(d.selectedIssueKey)}if("startIndex" in d&&!d.selectedIssueKey){this.searchResults.goToPage(d.startIndex)}}this._showIntroDialogs(h)},shouldPerformNewSearch:function(f,e){var g=f.filter&&f.filter.getId();var a=e.filter&&e.filter.getId();var c=g!==a;var d=e.jql!==f.jql;var b=e.searchId!==f.searchId;return c||d||b},refreshSearch:function(){return this._doSearch(_.extend({},this.getState(),{selectedIssueKey:undefined}))},_navigateToState:function(b,c,a){a=a||{};if(!JIRA.Issues.Application.request("issueEditor:canDismissComment")){this.queryModule.queryChanged();AJS.InlineLayer.current&&AJS.InlineLayer.current.hide();return null}if(this._validateNavigate(b)){a.replace?this.issueNavRouter.replaceState(b):this.issueNavRouter.pushState(b)}if(this.search.isStandAloneIssue(b)){this.resetToStandaloneIssue(b)}else{return this.applyState(b,c,a)}},_validateNavigate:function(b){var a=JIRA.Issues.URLSerializer.getURLFromState;return a(b)!==a(this.getState())},_getUpdateState:function(a){return _.extend({},this.getState(),a)},update:function(b,c,a){this._navigateToState(this._getUpdateState(b),c,a)},reset:function(c,b){var a=_.extend({},this.defaults(),c);a.searchId=_.uniqueId();this._navigateToState(a,true,b)},_deactivateCurrentLayout:function(){var a=this.getCurrentLayout();if(a){a.close&&a.close();this.setCurrentLayout(null)}},resetToStandaloneIssue:function(a){this._deactivateCurrentLayout();this.set(this.defaults());this.standalone=true;this.fullScreenIssue.show({key:a.selectedIssueKey,viewIssueQuery:a.viewIssueQuery})},applyState:function(d,f,c){var b,a=d.filter&&!(d.filter instanceof JIRA.Components.Filters.Models.Filter),e=this.initSystemFilters();if(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()==="split-view"){require("jira/issues/navigator/metrics").notifyIssueNavDetail()}else{if(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()==="list-view"){if(d.selectedIssueKey){require("jira/issues/navigator/metrics").notifyIssueView()}else{require("jira/issues/navigator/metrics").notifyIssueNavList()}}}JIRA.Issues.Application.execute("issueEditor:abortPending");this.createLayout();if(a){b=jQuery.Deferred();e.always(_.bind(function(){this.filterModule.getFilterById(d.filter).always(function(g){d.filter=g;b.resolve()})},this))}jQuery.when(b,e).always(_.bind(function(){this._applyState(d,f,c)},this))},updateFromRouter:function(a){if(this.search.isStandAloneIssue(a)){require("jira/issues/navigator/metrics").notifyIssueView();this.resetToStandaloneIssue(a)}else{this.applyState(a,!this._isSearchStateEqual(a))}},hasSelectedIssue:function(){return this.search.getResults().getSelectedIssue().getKey()},resetToFilter:function(a){this.reset({filter:a,searchId:_.uniqueId()})},resetToBlank:function(a){this.reset({jql:""},a)},isDirty:function(){var a=this.getFilter();return !!a&&a.getJql()!==this.getEffectiveJql()},getSearchMode:function(){return this.queryModule.getSearchMode()},getActiveBasicModeSearchers:function(){return this.queryModule.getActiveBasicModeSearchers()},setSessionSearch:function(a){AJS.$.ajax({data:{filterId:a.getId()},type:"PUT",url:AJS.contextPath()+"/rest/issueNav/1/issueTable/sessionSearch/"})},openFocusShifter:function(){JIRA.Issues.FocusShifter.show()},setAsInaccessible:function(a){this.issueTableModule.setAsInaccessible(a)},showInlineIssueLoadError:function(b){var a=JIRA.Components.IssueViewer.Templates.Body.errorsLoading();JIRA.Messages.showErrorMsg(a,{closeable:true})},getEffectiveJql:function(){var b=this.getFilter(),a=this.getJql();if(_.isString(a)){return a}else{if(b){return b.getJql()||""}else{return""}}},initSystemFilters:function(){return this.filterModule.initSystemFilters()},addOwnerToSystemFilters:function(c){var d=AJS.Meta.get("remote-user");if(!d){return c}var b=AJS.Meta.get("remote-user-fullname");var a=AJS.Meta.get("remote-user-avatar-url");return _.map(c,function(e){e.ownerUserName=d;e.ownerDisplayName=b;e.avatarUrl=a;return e})},handleLeft:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleLeft()}},handleRight:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleRight()}},handleUp:function(){if(!this._allowUpDownNavigation()){return false}if(this.searchResults.isFirstIssueHighlighted()){return false}return this.prevIssue()},handleDown:function(){if(!this._allowUpDownNavigation()){return false}return this.nextIssue()},_allowLeftRightNavigation:function(){return !AJS.keyboardShortcutsDisabled},_allowUpDownNavigation:function(){if(AJS.keyboardShortcutsDisabled){return false}if(AJS.InlineLayer.current||AJS.Dropdown.current||JIRA.Dialog.current||AJS.$(".aui-dropdown2:visible").length>0){return false}return this.getCurrentLayout()&&!this.getCurrentLayout().isIssueViewActive()},_isSearchStateEqual:function(a){var b=["filter","jql","startIndex"];return _.isEqual(_.pick(a,b),_.pick(this.getState(),b))},removeOpenTipsies:JIRA.Issues.Tipsy.revalidate,_showIntroDialogs:function(b){if(!JIRA.Issues.LoginUtils.isLoggedIn()){return}var a=(this.filterModule&&this.filterModule.filterPanelView)?this.filterModule.filterPanelView.panelReady:undefined;if(!this._shownIntroDialog&&this.layoutSwitcher){jQuery.when(b,a).done(_.bind(function(){this.layoutSwitcher.createHelptipForSwitchingToDetailView(1);this.filterModule.createHelptipForFilterPanelDocking(2);AJS.HelpTip.Manager.showSequences()},this));this._shownIntroDialog=true}}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssuesApi.js' */
JIRA.Issues.Api=(function(){var a;return{initialize:function(b){a=b.searchPageModule},editFieldOnSelectedIssue:function(c){var b=JIRA.Issues.Api.getFieldsOnSelectedIssue(),d=b&&b.get(c),e=d&&d.isEditable();if(e&&a){JIRA.Issues.Application.execute("issueEditor:editField",d)}return e},focusSearch:function(){AJS.$(".criteria-selector:first, #advanced-search").focus().select()},getSelectedIssue:function(){return a.getEffectiveIssue()},getSelectedIssueId:function(){return a.getEffectiveIssueId()},getSelectedIssueKey:function(){return a.getEffectiveIssueKey()},getFieldsOnSelectedIssue:function(){var b=JIRA.Issues.Application.request("issueEditor:fields");return b.length?b:undefined},hasSavesInProgress:function(){return JIRA.Issues.Application.request("issueEditor:hasSavesInProgress")},isCurrentlyLoadingIssue:function(){return a.isCurrentlyLoadingIssue()},isSelectedIssueAccessible:function(){return a.isHighlightedIssueAccessible()},issueIsVisible:function(){return a.isIssueVisible()},nextIssue:function(){a.nextIssue()},openFocusShifter:function(){if(a.isIssueVisible()){a.openFocusShifter()}},prevIssue:function(){a.prevIssue()},refreshSelectedIssue:function(b){return JIRA.Issues.Application.request("issueEditor:refreshIssue",b)},returnToSearch:function(b){a.returnToSearch({ignoreDirtiness:b})},showInlineIssueLoadError:function(b){a.showInlineIssueLoadError(b)},switchLayouts:function(c){var b=-1,d=a.getCurrentLayout(),f=a.getSortedLayouts(),e;_.find(f,function(h,g){if(d instanceof h.view){b=g;return true}});e=f[(b+1)%f.length];if(e.id==="split-view"){require("jira/issues/navigator/metrics").notifyIssueNavDetail()}else{if(e.id==="list-view"){require("jira/issues/navigator/metrics").notifyIssueNavList()}}a.changeLayout(e.id,c)},isQueryValid:function(){return a.queryModule.isQueryValid()},isFullScreenIssueVisible:function(){return a.isFullScreenIssueVisible()},viewSelectedIssue:function(){if(!JIRA.Issues.Api.isSelectedIssueAccessible()){return}var b=JIRA.Issues.Api.getSelectedIssueKey();if(!a.isIssueVisible()){a.update({selectedIssueKey:b})}},toggleFilterPanel:function(){a.toggleFilterPanel()},waitForSavesToComplete:function(){var b=jQuery.Deferred();window.setTimeout(function(){if(!JIRA.Issues.Api.hasSavesInProgress()){b.resolve()}else{JIRA.bind(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE,function(c){if(!JIRA.Issues.Api.hasSavesInProgress()){b.resolve()}})}},10)},updateIssue:function(b,c){c=c||"thanks_issue_updated";return a.updateIssue({key:b.key,id:b.id,action:JIRA.Issues.Actions.UPDATE,message:c,meta:{}})}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssueAPI.js' */
JIRA.Issues.IssueAPI=(function(){var a;var b={getIssueId:function(){return JIRA.Issues.Api.getSelectedIssueId()},getIssueKey:function(){return JIRA.Issues.Api.getSelectedIssueKey()}};return{override:function(c){c=_.defaults({},c,{target:JIRA.Issue});a=c.searchPageModule;_.extend(c.target,b)}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssueNavigatorAPI.js' */
JIRA.Issues.IssueNavigatorAPI=(function(){var a;var b={isNavigator:function(){return a.isIssueVisible()}};var c={focusSearch:JIRA.Issues.Api.focusSearch,isNavigator:b.isNavigator,selectNextIssue:JIRA.Issues.Api.nextIssue,selectPreviousIssue:JIRA.Issues.Api.prevIssue,viewSelectedIssue:JIRA.Issues.Api.viewSelectedIssue};return{override:function(d){a=d.searchPageModule;JIRA.IssueNavigator=_.extend(JIRA.IssueNavigator,b);JIRA.IssueNavigator.Shortcuts=_.extend(JIRA.IssueNavigator.Shortcuts,c)}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/IssueViewer.js' */
AJS.namespace("JIRA.Components.IssueViewer");JIRA.Components.IssueViewer=JIRA.Marionette.Controller.extend({namedEvents:["loadComplete","loadError","close","replacedFocusedPanel"],initialize:function(a){a=a||{};this.model=new JIRA.Components.IssueViewer.Models.Issue();this.eventBus=new JIRA.Components.IssueViewer.Legacy.IssueEventBus();this.viewIssueData=new JIRA.Components.IssueViewer.Legacy.ViewIssueData();this._buildIssueLoader();this._buildErrorController({showReturnToSearchOnError:a.showReturnToSearchOnError});this._buildIssueController();JIRA.bind(JIRA.Events.REFRESH_ISSUE_PAGE,_.bind(function(c,d,b){if(this.model.isCurrentIssue(d)){this.refreshIssue(b)}},this))},_buildIssueLoader:function(){this.issueLoader=new JIRA.Components.IssueViewer.Services.IssueLoader();this.listenTo(this.issueLoader,"error",function(b,a){this.trigger("loadError",a);this.errorController.render(b,a.issueKey);this.removeIssueMetadata();JIRA.trace("jira.issue.refreshed",{id:a.issueId});JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[a.issueId])});this.listenTo(this.issueLoader,"issueLoaded",this._onIssueLoaded)},_buildErrorController:function(a){a=a||{};this.errorController=new JIRA.Components.IssueViewer.Controllers.Error({contextPath:AJS.contextPath(),showReturnToSearchOnError:a.showReturnToSearchOnError});this.listenTo(this.errorController,"before:render",function(){this.issueController.close()});this.listenTo(this.errorController,"returnToSearch",function(){this.trigger("close")});this.listenAndRethrow(this.errorController,"render")},_buildIssueController:function(){this.issueController=new JIRA.Components.IssueViewer.Controllers.Issue({model:this.model});this.listenTo(this.issueController,"render",function(b,a){JIRA.Components.IssueViewer.Utils.hideDropdown();this.errorController.close();this.trigger("render",b,a);JIRA.trace("jira.psycho.issue.refreshed",{id:this.model.getId()})});this.listenAndRethrow(this.issueController,"replacedFocusedPanel");this.listenTo(this.issueController,"panelRendered",function(a,b){this.eventBus.triggerPanelRendered(a,b)});this.listenTo(this.issueController,"close",function(){JIRA.Components.IssueViewer.Utils.hideDropdown()})},_updateModel:function(b,a){this.model.update(b,a)},_onIssueLoaded:function(a,h,i){var g=!JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled();var e=i.issueEntity;var b=!h.mergeIntoCurrent&&i.initialize!==false;var f=!this.model.isCurrentIssue(e.id);var c=!!e.detailView;if(!h.isUpdate||b){this.model.resetToDefault();this.errorController.close()}this._updateModel(a,{initialize:b,changed:h.changed,mergeIntoCurrent:h.mergeIntoCurrent});if(!h.isUpdate||b){this.issueController.close()}this.issueController.show();if(g&&h.fromCache){this.refreshIssue(e,{fromCache:true,mergeIntoCurrent:!h.error,detailView:c})}JIRA.Components.IssueViewer.Services.Metadata.addIssueMetadata(this.model);if(e.bringToFocus){e.bringToFocus()}this.trigger("loadComplete",this.model,{isNewIssue:f,issueId:e.id,duration:h.loadDuration,loadReason:h.fromCache?"issues-cache-refresh":undefined,fromCache:h.fromCache});var d={id:e.id};if(h.fromCache){JIRA.trace("jira.issue.loadFromCache",d)}else{JIRA.trace("jira.issue.loadFromServer",d)}JIRA.trace("jira.issue.refreshed",d);JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[e.id])},abortPending:function(){this.issueLoader.cancel()},canDismissComment:function(){return this.issueController.canDismissComment()},beforeHide:function(){JIRA.Components.IssueViewer.Utils.hideLightbox();JIRA.Components.IssueViewer.Utils.hideDropdown();this.abortPending();this.removeIssueMetadata()},beforeShow:function(){JIRA.Components.IssueViewer.Services.Metadata.addIssueMetadata(this.model)},getIssueId:function(){return this.model.getEntity().id||null},getIssueKey:function(){return this.model.getEntity().key||null},_loadIssueFromDom:function(a){if(!a.id||a.id==-1){this.errorController.applyToDom("notfound",a.key);this.trigger("loadError")}else{this.issueController.applyToDom({id:a.id||-1,key:a.key,viewIssueQuery:a.viewIssueQuery})}AJS.Meta.set("serverRenderedViewIssue",null);var b={id:this.getIssueId()};JIRA.trace("jira.issue.refreshed",b)},loadIssue:function(b){var a=AJS.$("#key-val"),c=AJS.Meta.get("serverRenderedViewIssue");if(c){b.id=a.attr("rel")||-1;this._loadIssueFromDom(b);return jQuery.Deferred().resolve().promise()}else{if(!this.canDismissComment()||!b.key){return jQuery.Deferred().reject()}this.issueController.showLoading();return this.issueLoader.load({issueEntity:b,viewIssueData:this.viewIssueData})}},refreshIssue:function(a){var b;a=_.defaults({},a,{mergeIntoCurrent:true});if(this.model.hasIssue()){b=this.issueLoader.update({viewIssueData:this.viewIssueData,issueEntity:this.model.getEntity(),mergeIntoCurrent:a.mergeIntoCurrent,detailView:a.detailView});if(a.complete){b=b.done(a.complete).fail(a.complete)}this.issueController.showLoading()}else{b=jQuery.Deferred().resolve().promise()}return b},removeIssueMetadata:function(){JIRA.Components.IssueViewer.Services.Metadata.removeIssueMetadata(this.model)},setContainer:function(a){this.errorController.setElement(a);this.issueController.setElement(a)},isCurrentlyLoading:function(){return this.issueLoader.isLoading()},updateIssueWithQuery:function(a){this.model.updateIssueQuery(a);this.issueLoader.update({viewIssueData:this.viewIssueData,issueEntity:this.model.getEntity(),mergeIntoCurrent:true})},dismiss:function(){this.model.resetToDefault();this.errorController.close();this.issueController.close()},close:function(){if(this.canDismissComment()){this.dismiss();this.trigger("close")}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/IssueViewerAppModule.js' */
AJS.namespace("JIRA.Components.IssueViewer.AppModule");JIRA.Components.IssueViewer.AppModule=JIRA.Marionette.AppModule.extend({name:"issueViewer",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{showReturnToSearchOnError:function(){return false}});return new JIRA.Components.IssueViewer({showReturnToSearchOnError:a.showReturnToSearchOnError})},commands:function(){return{abortPending:true,beforeHide:true,beforeShow:true,removeIssueMetadata:true,updateIssueWithQuery:true,close:true,setContainer:true,dismiss:true}},requests:function(){return{loadIssue:true,canDismissComment:true,getIssueId:true,getIssueKey:true,refreshIssue:true,isCurrentlyLoading:true}},events:function(){return["loadComplete","loadError","close","render","replacedFocusedPanel"]}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/Issue.soy' */
// This file was automatically generated from Issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }


JIRA.Components.IssueViewer.Templates.layout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="issue-edit-form"><div class="issue-header-container"></div><div class="issue-body-container"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueHeader.soy' */
// This file was automatically generated from IssueHeader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Header == 'undefined') { JIRA.Components.IssueViewer.Templates.Header = {}; }


JIRA.Components.IssueViewer.Templates.Header.opsbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ops-cont"><div class="ops-menus aui-toolbar">');
  if (opt_data.issue.operations) {
    var linkGroupList6 = opt_data.issue.operations.linkGroups;
    var linkGroupListLen6 = linkGroupList6.length;
    for (var linkGroupIndex6 = 0; linkGroupIndex6 < linkGroupListLen6; linkGroupIndex6++) {
      var linkGroupData6 = linkGroupList6[linkGroupIndex6];
      if (linkGroupData6.id && linkGroupData6.id == 'view.issue.opsbar') {
        output.append('<div class="toolbar-split toolbar-split-left">');
        var subGroupList10 = linkGroupData6.groups;
        var subGroupListLen10 = subGroupList10.length;
        for (var subGroupIndex10 = 0; subGroupIndex10 < subGroupListLen10; subGroupIndex10++) {
          var subGroupData10 = subGroupList10[subGroupIndex10];
          JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: subGroupData10, parentGroup: linkGroupData6}, output);
        }
        output.append('</div>');
      } else if (linkGroupData6.id && linkGroupData6.id == 'jira.issue.tools') {
        output.append('<div class="toolbar-split toolbar-split-right">');
        JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: linkGroupData6}, output);
        output.append('</div>');
      }
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.legacyIssueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content"><div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Components.IssueViewer.Templates.Header.pager(opt_data.pager, output);
  }
  output.append('</div><div id="heading-avatar"><img id="project-avatar" alt="" class="project-avatar-48" height="48" src="', soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), '" width="48"></div><ul class="breadcrumbs"><li><a id="project-name-val" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issue.project.key), '">', soy.$$escapeHtml(opt_data.issue.project.name), '</a> </li>', (opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a> </li>' : '', '<li><a class="issue-link" data-issue-key="', soy.$$escapeHtml(opt_data.issue.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" id="key-val" rel="', soy.$$escapeHtml(opt_data.issue.id), '">', soy.$$escapeHtml(opt_data.issue.key), '</a></li></ul><h1 id="summary-val">', soy.$$escapeHtml(opt_data.issue.summary), '</h1><div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Components.IssueViewer.Templates.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.issueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content">');
  var param72 = new soy.StringBuilder();
  if (opt_data.issue.project) {
    var param75 = new soy.StringBuilder();
    JIRA.Templates.Headers.projectAvatar({id: soy.$$escapeHtml(opt_data.issue.project.id), projectKey: soy.$$escapeHtml(opt_data.issue.project.key), projectName: soy.$$escapeHtml(opt_data.issue.project.name), avatarUrl: soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), avatarAlt: soy.$$escapeHtml(opt_data.issue.project.name), isSystemAvatar: opt_data.issue.project.systemAvatar, hasProjectShortcut: opt_data.hasProjectShortcut}, param75);
    aui.page.pageHeaderImage({content: param75.toString()}, param72);
    aui.page.pageHeaderMain({content: '<ol class="aui-nav aui-nav-breadcrumbs"><li><a id="project-name-val" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.project.key) + '">' + soy.$$escapeHtml(opt_data.issue.project.name) + '</a></li>' + ((opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a></li>' : '') + '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.key) + '" id="key-val" rel="' + soy.$$escapeHtml(opt_data.issue.id) + '">' + soy.$$escapeHtml(opt_data.issue.key) + '</a></li></ol><h1 id="summary-val">' + soy.$$escapeHtml(opt_data.issue.summary) + '</h1>'}, param72);
  }
  var param127 = new soy.StringBuilder('<div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Components.IssueViewer.Templates.Header.pager(opt_data.pager, param127);
  }
  param127.append('</div>');
  aui.page.pageHeaderActions({content: param127.toString()}, param72);
  aui.page.pageHeader({content: param72.toString()}, output);
  output.append('<div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Components.IssueViewer.Templates.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.linkGroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.group.header && opt_data.group.header.label) {
    if (opt_data.group.links.length > 0 || opt_data.group.groups.length > 0) {
      JIRA.Components.IssueViewer.Templates.Header.dropdownLink(opt_data.group, output);
    }
  } else {
    output.append('<ul ', (opt_data.group.id) ? 'id="opsbar-' + soy.$$escapeHtml(opt_data.group.id) + '" ' : '', 'class="toolbar-group pluggable-ops">');
    var linkList155 = opt_data.group.links;
    var linkListLen155 = linkList155.length;
    for (var linkIndex155 = 0; linkIndex155 < linkListLen155; linkIndex155++) {
      var linkData155 = linkList155[linkIndex155];
      JIRA.Components.IssueViewer.Templates.Header.toolbarItem({link: linkData155}, output);
    }
    if (opt_data.group.groups.length == 1 && opt_data.group.groups[0].links.length == 0 && opt_data.group.groups[0].groups.length == 1 && opt_data.group.groups[0].groups[0].links.length == 1) {
      JIRA.Components.IssueViewer.Templates.Header.toolbarItem({link: opt_data.group.groups[0].groups[0].links[0]}, output);
    } else {
      var subGroupList164 = opt_data.group.groups;
      var subGroupListLen164 = subGroupList164.length;
      for (var subGroupIndex164 = 0; subGroupIndex164 < subGroupListLen164; subGroupIndex164++) {
        var subGroupData164 = subGroupList164[subGroupIndex164];
        JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: subGroupData164}, output);
      }
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.dropdownLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item toolbar-dropdown"><div><a href="#" ', (opt_data.header.id) ? ' id="' + soy.$$escapeHtml(opt_data.header.id) + '"' : '');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr({title: opt_data.header.title, label: opt_data.header.label}, output);
  output.append(' data-hide-on-scroll=".split-view .issue-container" data-contain-to-window="true" class="toolbar-trigger ', (opt_data.links.length > 0 || opt_data.groups.length > 0) ? ' js-default-dropdown' : '', (opt_data.header.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.header.styleClass) : '', '" >', (opt_data.header.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.header.iconClass) + '"></span> ' : '', '<span class="dropdown-text">', soy.$$truncate(soy.$$escapeHtml(opt_data.header.label), 25, true), '</span><span class="icon drop-menu"></span></a><div class="aui-list hidden">');
  if (opt_data.links.length > 0) {
    output.append('<ul class="aui-list-section aui-first', (opt_data.groups.length == 0) ? ' aui-last' : '', '">');
    var linkList204 = opt_data.links;
    var linkListLen204 = linkList204.length;
    for (var linkIndex204 = 0; linkIndex204 < linkListLen204; linkIndex204++) {
      var linkData204 = linkList204[linkIndex204];
      JIRA.Components.IssueViewer.Templates.Header.dropdownItem(linkData204, output);
    }
    output.append('</ul>');
  }
  var groupList208 = opt_data.groups;
  var groupListLen208 = groupList208.length;
  for (var groupIndex208 = 0; groupIndex208 < groupListLen208; groupIndex208++) {
    var groupData208 = groupList208[groupIndex208];
    output.append('<ul class="aui-list-section', (opt_data.links.length == 0 && groupIndex208 == 0) ? ' aui-first' : '', (groupIndex208 == groupListLen208 - 1) ? ' aui-last' : '', '">');
    var linkList217 = groupData208.links;
    var linkListLen217 = linkList217.length;
    for (var linkIndex217 = 0; linkIndex217 < linkListLen217; linkIndex217++) {
      var linkData217 = linkList217[linkIndex217];
      JIRA.Components.IssueViewer.Templates.Header.dropdownItem(linkData217, output);
    }
    output.append('</ul>');
  }
  output.append('</div></div></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.dropdownItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="aui-list-item"><a  href="', (opt_data.href) ? soy.$$escapeHtml(opt_data.href) : '#', '" class="aui-list-item-link', (opt_data.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.styleClass) : '', '"');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr(opt_data, output);
  output.append((opt_data.id) ? 'id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', '><span class="trigger-label">', soy.$$truncate(soy.$$escapeHtml(opt_data.label), 25, true), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.toolbarItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item"><a id="', soy.$$escapeHtml(opt_data.link.id), '"');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr({title: opt_data.link.title, label: opt_data.link.label}, output);
  output.append('class="toolbar-trigger', (opt_data.link.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.link.styleClass) : '', '" href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '">', (opt_data.link.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.link.iconClass) + '"></span> <span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>' : '<span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>', '</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.titleAttr = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? 'title="' + soy.$$escapeHtml(opt_data.title) + '"' : (opt_data.label && opt_data.label.length && opt_data.label.length > 25) ? 'title="' + soy.$$escapeHtml(opt_data.label) + '"' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueBody.soy' */
// This file was automatically generated from IssueBody.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Body == 'undefined') { JIRA.Components.IssueViewer.Templates.Body = {}; }


JIRA.Components.IssueViewer.Templates.Body.issueBody = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column"></div><div id="viewissuesidebar" class="aui-item issue-side-column"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.issueBodyWithPanels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList10 = opt_data.panels.leftPanels;
    var panelListLen10 = panelList10.length;
    for (var panelIndex10 = 0; panelIndex10 < panelListLen10; panelIndex10++) {
      var panelData10 = panelList10[panelIndex10];
      JIRA.Components.IssueViewer.Templates.Body.issuePanel(panelData10, output);
    }
  }
  output.append('</div><div id="viewissuesidebar" class="aui-item issue-side-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList16 = opt_data.panels.rightPanels;
    var panelListLen16 = panelList16.length;
    for (var panelIndex16 = 0; panelIndex16 < panelListLen16; panelIndex16++) {
      var panelData16 = panelList16[panelIndex16];
      JIRA.Components.IssueViewer.Templates.Body.issuePanel(panelData16, output);
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.issuePanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.renderHeader) {
    output.append('<div id=', soy.$$escapeHtml(opt_data.id), ' class="module toggle-wrap"><div id="', soy.$$escapeHtml(opt_data.id), '_heading" class="mod-header"><ul class="ops">');
    var linkList28 = opt_data.headerLinks.links;
    var linkListLen28 = linkList28.length;
    for (var linkIndex28 = 0; linkIndex28 < linkListLen28; linkIndex28++) {
      var linkData28 = linkList28[linkIndex28];
      output.append('<li>');
      JIRA.Components.IssueViewer.Templates.Body.simpleLink({link: linkData28}, output);
      output.append('</li>');
    }
    if (opt_data.headerLinks.groups.length > 0) {
      output.append('<li class="drop"><div class="aui-dd-parent"><a href="#" class="icon drop-menu js-default-dropdown" title="', soy.$$escapeHtml("Options"), '"><span>', soy.$$escapeHtml("Options"), '</span></a><div class="aui-dropdown-content aui-list">');
      var groupList41 = opt_data.headerLinks.groups;
      var groupListLen41 = groupList41.length;
      for (var groupIndex41 = 0; groupIndex41 < groupListLen41; groupIndex41++) {
        var groupData41 = groupList41[groupIndex41];
        output.append((groupData41.header && groupData41.header.label) ? '<h5>' + soy.$$escapeHtml(groupData41.header.label) + '</h5>' : '', '<ul ', (groupData41.header && groupData41.header.id) ? 'id="' + soy.$$escapeHtml(groupData41.header.id) + '"' : '', 'class="aui-list-section', (groupData41.header && groupData41.header.styleClass) ? ' ' + soy.$$escapeHtml(groupData41.header.styleClass) : '', (groupIndex41 == 0) ? ' aui-first' : '', (groupIndex41 == groupListLen41 - 1) ? ' aui-last' : '', '">');
        var linkList65 = groupData41.links;
        var linkListLen65 = linkList65.length;
        for (var linkIndex65 = 0; linkIndex65 < linkListLen65; linkIndex65++) {
          var linkData65 = linkList65[linkIndex65];
          output.append('<li class="aui-list-item">');
          JIRA.Components.IssueViewer.Templates.Body.simpleLink({link: linkData65, additionalStyleClass: 'aui-list-item-link'}, output);
          output.append('</li>');
        }
        output.append('</ul>');
      }
      output.append('</div></div></li>');
    }
    output.append('</ul>');
    if (opt_data.subpanelHtmls.length > 0) {
      output.append('<div class="mod-header-panels">');
      var subPanelList79 = opt_data.subpanelHtmls;
      var subPanelListLen79 = subPanelList79.length;
      for (var subPanelIndex79 = 0; subPanelIndex79 < subPanelListLen79; subPanelIndex79++) {
        var subPanelData79 = subPanelList79[subPanelIndex79];
        output.append('<div class="mod-header-panel">', subPanelData79, '</div>');
      }
      output.append('</div>');
    }
    output.append('<h2 class="toggle-title">', soy.$$escapeHtml(opt_data.label), '</h2></div><div class="mod-content">', opt_data.html, '</div></div>');
  } else {
    output.append(opt_data.html);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data != null && opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data != null && opt_data.errorMessages) {
    output.append('<ul>');
    var msgList104 = opt_data.errorMessages;
    var msgListLen104 = msgList104.length;
    for (var msgIndex104 = 0; msgIndex104 < msgListLen104; msgIndex104++) {
      var msgData104 = msgList104[msgIndex104];
      output.append('<li>', soy.$$escapeHtml(msgData104), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.focusShifter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message closeable" id="focus-shifter"><label><span>', soy.$$escapeHtml("viewissue.focusshifter"), '</span><div id="focus-shifter-content"></div></label><span class="aui-icon icon-close"></span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueError.soy' */
// This file was automatically generated from IssueError.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Error == 'undefined') { JIRA.Components.IssueViewer.Templates.Error = {}; }


JIRA.Components.IssueViewer.Templates.Error.NoPermission = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Permission violation", body: "It seems that you have tried to perform an operation which you are not permitted to perform.", error: 'warning', returnToSearch: false}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.DoesNotExist = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Issue does not exist", body: "The issue you are trying to view does not exist.", error: 'error', returnToSearch: ! opt_data.hideReturnToSearch}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.Generic = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Unexpected error", body: "There was an unexpected error while loading the issue.", error: 'error', returnToSearch: false}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.viewIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="form-body"><header class="issue-header"><div class="issue-header-content"><header class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-main"><h1>', soy.$$escapeHtml(opt_data.title), '</h1></div><div class="aui-page-header-actions"><div id="issue-header-pager"></div></div></div></header></div></header><div class="issue-body-content"><div class="aui-message ', soy.$$escapeHtml(opt_data.error), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.error), '"></span><p>', soy.$$escapeHtml(opt_data.body), '</p><p>', soy.$$escapeHtml("If you think this message is wrong, please contact your"), ' <a href="', soy.$$escapeHtml(""), '/secure/ContactAdministrators!default.jspa">', soy.$$escapeHtml("JIRA administrators"), '</a>.</p>', (opt_data.returnToSearch) ? '<p><a id="return-to-search" class="push-state" href="' + soy.$$escapeHtml("") + '/issues/" title="' + soy.$$escapeHtml("Return to search") + '">' + soy.$$escapeHtml("Return to search") + '</a></p>' : '', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.Panel");JIRA.Components.IssueViewer.Models.Panel=JIRA.Issues.Brace.Model.extend({namedAttributes:["entity","updateLocked"],initialize:function(){JIRA.bind(JIRA.Events.LOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.set("updateLocked",true)}},this));JIRA.bind(JIRA.Events.UNLOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.set("updateLocked",false)}},this))},update:function(c,a,b){if(!this.getUpdateLocked()){this.set("entity",c);this.trigger("updated",a,b)}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelsCollection.js' */
AJS.namespace("JIRA.Components.IssueViewer.Collections.Panels");JIRA.Components.IssueViewer.Collections.Panels=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.IssueViewer.Models.Panel,update:function(c,b){var a=this;this.each(function(d){var e=d.id;var f=_.any(c,function(g){return g.id===e});if(!f){this.remove(d)}},this);_.each(c,function(e,f){var d=this.get(e.id);if(d){d.update(e,b.fieldsInProgress,b.fieldsSaved)}else{this.add({id:e.id,entity:e},{at:f})}},this)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelsGroupModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.PanelsGroup");JIRA.Components.IssueViewer.Models.PanelsGroup=JIRA.Issues.Brace.Model.extend({namedAttributes:["leftPanels","rightPanels","infoPanels"],defaults:function(){return{leftPanels:new JIRA.Components.IssueViewer.Collections.Panels([]),rightPanels:new JIRA.Components.IssueViewer.Collections.Panels([]),infoPanels:new JIRA.Components.IssueViewer.Collections.Panels([])}},update:function(b,a){this.get("leftPanels").update(b.leftPanels,a);this.get("rightPanels").update(b.rightPanels,a);this.get("infoPanels").update(b.infoPanels,a)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/IssueModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.Issue");JIRA.Components.IssueViewer.Models.Issue=JIRA.Issues.Brace.Model.extend({namedEvents:["updated"],namedAttributes:["entity","id","key","panels"],defaults:function(){return{entity:{},panels:new JIRA.Components.IssueViewer.Models.PanelsGroup()}},update:function(c,b){var a=false;if(c.issue){this.updateFromEntity(c.issue);a=true}if(c.panels){this.getPanels().update(c.panels,b);a=true}if(a){this.trigger("updated",b)}},resetToDefault:function(){this.clear();this.set(this.defaults())},updateFromEntity:function(a){this.set({id:a.id,key:a.key,entity:a})},isCurrentIssue:function(a){return this.get("id")==a},hasIssue:function(){return this.has("id")},updateIssueQuery:function(a){if(!this.hasIssue()){return}this.getEntity().viewIssueQuery=a}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssuePanelView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssuePanel");JIRA.Components.IssueViewer.Views.IssuePanel=JIRA.Marionette.ItemView.extend({template:JIRA.Components.IssueViewer.Templates.Body.issuePanel,modelEvents:{updated:"update"},update:function(a,i){var b=this.renderTemplate();var d=this.$el;var h=this;if(b.text()===d.text()){return}function f(){return _.any(a,function(j){return d.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(j)).length===1})}function c(){var j=d.find(document.activeElement).length>0;var m=!!jQuery.browser.msie&&jQuery.browser.version<=8;if(!m){d.replaceWith(b)}else{var l=d[0].nextSibling;var k=d[0].parentNode;d.remove();if(l){jQuery(l).before(b)}else{jQuery(k).append(b)}}if(j){h.trigger("replacedFocusedPanel")}h.setElement(b)}function e(k){var l=h.model.id;var j=h.$el;h.trigger("panelRendered",l,j);JIRA.trigger(JIRA.Events.PANEL_REFRESHED,[l,j,d]);_.each(k,function(m){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[m,JIRA.CONTENT_ADDED_REASON.panelRefreshed])})}if(!f()){c();e([h.$el])}else{var g=[];_.each(i,function(l){var k=d.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(l));if(k.length===1){var j=b.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(l));if(j.length===1){k.replaceWith(j);g.push(j)}else{k.closest("li, dl").remove()}}});e(g)}this.bindUIElements()},onRender:function(){this.setElement(this.$el.children());var a=this.model.getEntity().styleClass;if(a){this.$el.addClass(a)}JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},serializeData:function(){return this.model.getEntity()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssuePanelsView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssuePanels");JIRA.Components.IssueViewer.Views.IssuePanels=JIRA.Marionette.CollectionView.extend({itemView:JIRA.Components.IssueViewer.Views.IssuePanel,_updatingFromDom:false,appendHtml:function(a,d,b){var c=a.$el.children();var e=c.length;if(b<=0){a.$el.prepend(d.$el)}else{if(!e||b>=e){a.$el.append(d.$el)}else{d.$el.insertBefore(c.eq(b))}}},applyToDom:function(){var a=this;this._updatingFromDom=true;this.$el.children().filter(".module").each(function(){var b=this.id;if(b==="addcomment"){b="addcommentmodule"}a.collection.add(new JIRA.Components.IssueViewer.Models.Panel({id:b,entity:{id:b}}))});this._updatingFromDom=false},renderItemView:function(){if(!this._updatingFromDom){JIRA.Marionette.CollectionView.prototype.renderItemView.apply(this,arguments)}},buildItemView:function(b){var a=JIRA.Marionette.CollectionView.prototype.buildItemView.apply(this,arguments);if(this._updatingFromDom){a.setElement(this.$el.find("#"+b.id))}return a}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueBodyView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueBody");JIRA.Components.IssueViewer.Views.IssueBody=JIRA.Marionette.Layout.extend({tagName:"div",className:"issue-body-content",regions:{leftPanels:{selector:".issue-main-column",regionType:JIRA.Marionette.LinkRegion},rightPanels:{selector:".issue-side-column",regionType:JIRA.Marionette.LinkRegion},infoPanels:{selector:".issue-body",regionType:JIRA.Marionette.LinkRegion}},template:JIRA.Components.IssueViewer.Templates.Body.issueBody});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueOpsbarView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueOpsbar");JIRA.Components.IssueViewer.Views.IssueOpsbar=JIRA.Marionette.ItemView.extend({template:JIRA.Components.IssueViewer.Templates.Header.opsbar,ui:{shareButton:".viewissue-share",exportButton:"#viewissue-export",loginButton:"#ops-login-lnk",commentButton:"#comment-issue"},serializeData:function(){return{issue:this.model.getEntity()}},onApplyToDom:function(){this.onRender()},onRender:function(){this.ui.loginButton.hide();this.ui.commentButton.addClass("inline-comment");new JIRA.Issues.Tipsy({el:this.ui.shareButton,showCondition:":not(.active)"});new JIRA.Issues.Tipsy({el:this.ui.exportButton,showCondition:":not(.active)",tipsy:{gravity:"ne"}})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueHeaderView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueHeader");JIRA.Components.IssueViewer.Views.IssueHeader=JIRA.Marionette.Layout.extend({className:"issue-header js-stalker",id:"stalker",tagName:"header",template:JIRA.Components.IssueViewer.Templates.Header.issueHeader,modelEvents:{updated:"update"},regions:{opsbar:".command-bar",pager:"#issue-header-pager"},serializeData:function(){return{issue:this.model.getEntity(),hasProjectShortcut:JIRA.Components.IssueViewer.Services.DarkFeatures.PROJECT_SHORTCUTS.enabled()}},update:function(a){if(a.initialize){this._updateWindowTitle()}else{var b=_.include(a.fieldsInProgress,"summary");if(b){this.renderOpsBar()}else{this.render()}}this.trigger("updated")},onApplyToDom:function(){var a=new JIRA.Components.IssueViewer.Views.IssueOpsbar({model:this.model});a.setElement(this.opsbar.el);this.opsbar.attachView(a);this.opsbar.currentView.applyToDom()},onRender:function(){this.renderOpsBar();this._updateWindowTitle();this.trigger("panelRendered","header",this.$el)},renderOpsBar:function(){this.opsbar.show(new JIRA.Components.IssueViewer.Views.IssueOpsbar({model:this.model}));JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},_updateWindowTitle:function(){var a=this.model.getEntity();var c=a.key;var b=a.summary;var d=AJS.Meta.get("app-title");if(d&&b&&c){document.title="["+c+"] "+b+" - "+d}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.Issue");JIRA.Components.IssueViewer.Views.Issue=JIRA.Marionette.Layout.extend({template:JIRA.Components.IssueViewer.Templates.layout,className:"issue-container",regions:{header:{selector:".issue-header-container",regionType:JIRA.Marionette.ReplaceRegion},body:{selector:".issue-body-container",regionType:JIRA.Marionette.ReplaceRegion}},modelEvents:{updated:"update"},showLoading:function(){this.$el.addClass("loading")},hideLoading:function(){this.$el.removeClass("loading")},focusComment:function(a){this.$("#activitymodule .focused").removeClass("focused");this.$("#comment-"+a).addClass("focused");this.$(".js-stalker").trigger("refresh")},update:function(a){if(a.initialize){this.render()}if(a.reason&&a.reason.action===JIRA.Issues.Actions.EDIT_COMMENT){this.focusComment(a.reason.meta.commentId)}this._bringViewIssueElementIntoView()},remove:function(){this.stopListening();this.$el.empty();return this},onRender:function(){this.$el.addClass(this.className);this.$el.attr("tabindex","-1");this._bringViewIssueElementIntoView();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.pageLoad]);if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS,[this.model.getId()])}},onApplyToDom:function(){this._bringViewIssueElementIntoView()},_bringViewIssueElementIntoView:function(){var a=this.model.get("entity").viewIssueQuery;if(a){var b;if(a.focusedCommentId){b="#comment-"+a.focusedCommentId}else{if(a.attachmentSortBy||a.attachmentOrder){b="#attachmentmodule"}}if(b){AJS.$(b).scrollIntoView({marginBottom:200,marginTop:200})}}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.Error");JIRA.Components.IssueViewer.Views.Error=JIRA.Marionette.Layout.extend({className:"issue-container",regions:{pager:"#issue-header-pager"},remove:function(){this.stopListening();this.$el.empty();return this},onRender:function(){this.$el.addClass(this.className);this.$el.attr("tabindex","-1")}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorGenericView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorGeneric");JIRA.Components.IssueViewer.Views.ErrorGeneric=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.Generic});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorNotFoundView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorNoPermission");JIRA.Components.IssueViewer.Views.ErrorNotFound=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.DoesNotExist,initialize:function(a){a=a||{};this.showReturnToSearchOnError=a.showReturnToSearchOnError},triggers:{"click #return-to-search":"returnToSearch"},serializeData:function(){var a=this.showReturnToSearchOnError;if(_.isFunction(a)){a=a()}return{hideReturnToSearch:!a}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorNoPermissionView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorNoPermission");JIRA.Components.IssueViewer.Views.ErrorNoPermission=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.NoPermission});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/controllers/IssueController.js' */
AJS.namespace("JIRA.Components.IssueViewer.Controllers.Issue");JIRA.Components.IssueViewer.Controllers.Issue=JIRA.Marionette.Controller.extend({initialize:function(a){this.model=a.model},_createViews:function(){this.view=this._createMainView();this.bodyView=this._createBodyView();this.headerView=this._createHeaderView();this.leftPanelsView=this._createPanelsView(this.model.getPanels().getLeftPanels());this.rightPanelsView=this._createPanelsView(this.model.getPanels().getRightPanels());this.infoPanelsView=this._createPanelsView(this.model.getPanels().getInfoPanels())},_createMainView:function(){return new JIRA.Components.IssueViewer.Views.Issue({model:this.model,el:this.$el})},_createBodyView:function(){return new JIRA.Components.IssueViewer.Views.IssueBody({model:this.model})},_createHeaderView:function(){var a=new JIRA.Components.IssueViewer.Views.IssueHeader({model:this.model});this.listenAndRethrow(a,"panelRendered");this.listenTo(a,"updated",function(){this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{issueId:this.model.getId()})});return a},_createPanelsView:function(b){var a=new JIRA.Components.IssueViewer.Views.IssuePanels({collection:b});this.listenTo(a,"itemview:replacedFocusedPanel",function(){this.trigger("replacedFocusedPanel")});this.listenTo(a,"itemview:panelRendered",function(c,e,d){this.trigger("panelRendered",e,d)});return a},createView:function(){this._createViews();this.listenTo(this.view,"render",function(){this.view.header.show(this.headerView);this.view.body.show(this.bodyView);this.bodyView.leftPanels.show(this.leftPanelsView);this.bodyView.rightPanels.show(this.rightPanelsView);this.bodyView.infoPanels.show(this.infoPanelsView);this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{loadedFromDom:false,issueId:this.model.getId()})})},createViewFromDom:function(){this._createViews();this.listenTo(this.view,"applyToDom",function(){function a(d,b,c){b.setElement(c);b.applyToDom();d.attachView(b)}a(this.view.body,this.bodyView,this.view.$el.find(".issue-body-content"));a(this.view.body,this.headerView,this.view.$el.find("#stalker"));a(this.bodyView.leftPanels,this.leftPanelsView,this.bodyView.$el.find(this.bodyView.leftPanels.el));a(this.bodyView.rightPanels,this.rightPanelsView,this.bodyView.$el.find(this.bodyView.rightPanels.el));a(this.bodyView.infoPanels,this.infoPanelsView,this.bodyView.$el.find(this.bodyView.infoPanels.el));this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{loadedFromDom:true,issueId:this.model.getId()})})},setElement:function(a){this.$el=a;if(this.view){this.view.setElement(a)}},applyToDom:function(a){a.id=+a.id;this.model.updateFromEntity(a);this.createViewFromDom();this.view.applyToDom()},show:function(){if(!this.view){this.createView();this.view.render()}else{this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{loadedFromDom:false,issueId:this.model.getId()})}this.view.hideLoading()},close:function(){if(this.view){this.view.close()}this.hideLoading();delete this.view},hideLoading:function(){this.view&&this.view.hideLoading()},showLoading:function(){this.view&&this.view.showLoading()},canDismissComment:function(){var b;var a=JIRA.Issue.CommentForm;if(!a.getForm().data("dismissed")){b=a.handleBrowseAway();if(b){if(!confirm(b)){a.focus();return false}else{a.getForm().data("dismissed",true)}}}return true}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/controllers/ErrorController.js' */
AJS.namespace("JIRA.Components.IssueViewer.Controllers.Error");JIRA.Components.IssueViewer.Controllers.Error=JIRA.Marionette.Controller.extend({initialize:function(a){this.contextPath=a.contextPath;this.showReturnToSearchOnError=a.showReturnToSearchOnError},render:function(b,a){switch(b){case"auth":this._renderErrorAuth(a);break;case"forbidden":this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorNoPermission());break;case"notfound":this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorNotFound({showReturnToSearchOnError:this.showReturnToSearchOnError}));break;case"generic":default:this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorGeneric());break}},applyToDom:function(b,a){switch(b){case"auth":this._renderErrorAuth(a);break;case"forbidden":this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorNoPermission());break;case"notfound":this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorNotFound({showReturnToSearchOnError:this.showReturnToSearchOnError}));break;case"generic":default:this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorGeneric());break}},close:function(){if(this.view){this.view.close();delete this.view}},setElement:function(a){this._$el=a;if(this.view){this.view.setElement(a)}},_renderErrorAuth:function(b){var a=this.contextPath+"/login.jsp?os_destination="+encodeURIComponent("/browse/"+b);window.location.replace(a)},_renderErrorView:function(a){this.trigger("before:render");JIRA.Components.IssueViewer.Utils.hideDropdown();this.view=a;this.view.setElement(this._$el);this.view.render();this.listenAndRethrow(this.view,"returnToSearch");this.trigger("render",{pager:this.view.$(this.view.pager.el)},{loadedFromDom:false,issueId:null})},_renderErrorViewFromDom:function(a){this.trigger("before:render");JIRA.Components.IssueViewer.Utils.hideDropdown();this.view=a;this.view.setElement(this._$el);this.view.applyToDom();this.listenAndRethrow(this.view,"returnToSearch");this.trigger("render",{pager:this.view.$(this.view.pager.el)},{loadedFromDom:true,issueId:null})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/IssueLoaderService.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.IssueLoader");JIRA.Components.IssueViewer.Services.IssueLoader=JIRA.Marionette.Controller.extend({initialize:function(){this._promiseManager=jQuery.RecurringPromise();this._updatingPromise=this._promiseManager.sub();this._updatingPromise.done(_.bind(this._onUpdatingDone,this)).fail(_.bind(this._onUpdatingError,this));this._loadingPromise=this._promiseManager.sub();this._loadingPromise.done(_.bind(this._onLoadingDone,this)).fail(_.bind(this._onLoadingError,this))},cancel:function(){this._promiseManager.reset()},update:function(f){var d=f.issueEntity,c=f.mergeIntoCurrent,h=f.viewIssueData,g=!!f.detailView;var e=jQuery.Deferred(),b;function a(i){return function(){return{taskKey:i,data:arguments,startIssueLoad:new Date()}}}b=this._updatingPromise.add(h.get(d.key,true,{issueEntity:d,loadingDeferred:e,mergeIntoCurrent:c,startIssueLoad:new Date(),detailView:g}).pipe(a("issue"),a("issue")));b.fail(function(){e.reject.apply(e,arguments)});return e.promise()},load:function(c){var a=c.issueEntity;var e=c.viewIssueData;var d=!!a.detailView;this._currentlyLoading=true;var b=jQuery.Deferred();this._loadingPromise.add(e.get(a.key,false,{issueEntity:a,loadFields:false,loadingDeferred:b,startIssueLoad:new Date(),detailView:d}));return b.promise()},isLoading:function(){return this._currentlyLoading},_onLoadingDone:function(c,d,b){var a=b.issueEntity;var e=a.id=c.issue.id;a.key=c.issue.key;if(!c.pager){c.pager=a.pager}JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c);this._currentlyLoading=false;d.loadDuration=new Date()-b.startIssueLoad;this.trigger("issueLoaded",c,d,b);b.loadingDeferred.resolve(c,d,b)},_onUpdatingDone:function(a){var b=a.data[1];if(b){b.isUpdate=true}this._onLoadingDone.apply(this,a.data)},_onLoadingError:function(d,f,b){var a=b.issueEntity;var g=a.id;var c={issueId:a.id,issueKey:a.key,response:d};this._currentlyLoading=false;var e;switch(d.status){case 401:e="auth";break;case 403:e="forbidden";break;case 404:e="notfound";break;default:e="generic";break}this.trigger("error",e,c);b.loadingDeferred.reject()},_onUpdatingError:function(a){this._onLoadingError.apply(this,a.data)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/MetadataService.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.Metadata");JIRA.Components.IssueViewer.Services.Metadata={removeIssueMetadata:function(b){var a=b.getEntity();if(a.metadata){_.each(a.metadata,function(d,c){AJS.Meta.set(c,null)})}else{if(AJS.Meta.get("issue-key")){AJS.Meta.set("issue-key",null)}}},addIssueMetadata:function(b){var a=b.getEntity();_.each(a.metadata,function(d,c){AJS.Meta.set(c,d)})}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/DarkFeatures.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.DarkFeatures");JIRA.Components.IssueViewer.Services.DarkFeatures=(function(){var a=Class.extend({init:function(b){this.featureKey=b},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});return{NO_PREFETCH:new a("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new a("rotp.project.shortcuts")}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/Utils.js' */
JIRA.Components.IssueViewer.Utils={hideLightbox:function(){AJS.$.fancybox.close()},hideDropdown:function(){if(AJS.InlineDialog.current&&(!JIRA.Issues.IntroDialog||_.contains(JIRA.Issues.IntroDialog.dialogs,AJS.InlineDialog.current))&&AJS.InlineDialog.current.id!=="column-picker-dialog"){AJS.InlineDialog.current.hide()}if(AJS.InlineLayer.current){var a=AJS.InlineLayer.current.options.offsetTarget();if(a instanceof jQuery){if(!a.is(":visible")){AJS.InlineLayer.current.hide()}}}}};JIRA.Events.ISSUE_REFRESHED="issueRefreshed";JIRA.Events.PANEL_REFRESHED="panelRefreshed";JIRA.Issues.Actions=JIRA.Issues.Actions||{};JIRA.Issues.Actions.EDIT_COMMENT="editComment";;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/IssueEventBus.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.IssueEventBus");JIRA.Components.IssueViewer.Legacy.IssueEventBus=JIRA.Issues.Brace.Model.extend({namedAttributes:["issueId"],namedEvents:["save","saveSuccess","savingStarted","saveError","panelRendered","replacedFocusedPanel","fieldSubmitted","dismiss","refreshIssue","issueRefreshed","updateFromDom","updateStatusColor","quickEditKeyPressed","openFocusShifter"]});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/AsyncData.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.AsyncData");JIRA.Components.IssueViewer.Legacy.AsyncData=JIRA.Issues.Brace.Evented.extend({namedEvents:["change"],initialize:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.disableCache=a.disableCache;this.maxCacheSize=a.maxCacheSize}},get:function(b,a,i){var g=jQuery.Deferred();var d=this.disableCache?{}:this.data;var f=_.bind(function(m,l){var k=this._set(d,b,_.defaults(m,{accessIndex:this.accessIndex++}),true,i);var j=_.defaults({changed:k},l,d[b]);if(i&&i.mergeIntoCurrent){j.mergeIntoCurrent=true}if(d[b]&&!d[b].error){g.resolve(d[b].value,j,i)}else{g.reject(d[b]&&d[b].value,j,i)}},this);var c=_.bind(function(j){var k=this.fetch(b,i);this.setPending(b,k,function(l){f({value:l,error:false,updated:new Date()},{initialLoad:j})},function(l){var m={error:true,updated:new Date()};if(l!==undefined){m.value=l}f(m,{initialLoad:j,error:true})})},this);var e=function(){f({},{fromCache:true})};var h=_.bind(function(){this.pendings[b].always(_.bind(f,this,{},{initialLoad:true}))},this);if(a||this.disableCache){c(false)}else{if(this.hasCached(b)){e()}else{if(this.hasPending(b)){h()}else{c(true)}}}return g.promise()},setPending:function(d,b,a,c){if(this.hasPending(d)){this.pendings[d].update(b)}else{this.pendings[d]=jQuery.ConcurrentDeferred(b)}return this.pendings[d].done(function(e){a(e)}).fail(function(e){c(e)})},getIdByValue:function(a){var b;for(b in this.data){if(this.data[b].value===a){return b}}return null},getMeta:function(a){return this.data[a]||{}},getAllCached:function(){var a={};_.each(this.data,function(b,c){a[c]=b.value});return a},hasCached:function(b){var a=this.getMeta(b);return a.value!==undefined||a.error===true},hasError:function(b){var a=this.getMeta(b);return a.error===true},hasPending:function(b){var a=this.pendings[b];return a?a.isPending():false},set:function(b,a){return this._set(this.data,b,{value:a,updated:new Date()},true)},remove:function(a){if(this.data[a]){delete this.data[a];this.triggerChange();return true}return false},setError:function(c,a){var b={error:true,updated:new Date()};if(a!==undefined){b.value=a}return this._set(this.data,c,b,true)},setMultiple:function(b){var a=new Date();var c=false;_.each(b,_.bind(function(d,e){d=_.pick(d,"value","error");d.updated=a;if(this._set(this.data,e,d,false)){c=true}},this));if(c){this.triggerChange()}return c},reset:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.setMultiple(a)}else{this.triggerChange()}},_set:function(e,g,f,c,b){if(this.disableCache&&e===this.data){e={}}var d=e[g]?_.clone(e[g]):{};var a=this.mergeFetchedAndCached(d,f,b?b:{},e[g]);if(c&&(!e[g]||a||e[g].error!==d.error)&&e===this.data){this.triggerChange()}if(!e[g]&&this.maxCacheSize&&_.keys(e).length===this.maxCacheSize){if(f.accessIndex){this._dropItem(e);e[g]=d}}else{e[g]=d}return a},_dropItem:function(c){var a=null;for(var b in c){if(!c[b].accessIndex){a=b;break}else{if(a===null||c[b].accessIndex<c[a].accessIndex){a=b}}}if(a!==null){delete c[a]}},fetch:function(d,b){var c=this.getMeta(d);var a=jQuery.Deferred();if(!this.hasCached(d)||c.error){a.reject(c.value)}else{a.resolve(c.value)}return a.promise()},mergeFetchedAndCached:function(b,d,a,c){_.extend(b,d);return !c||c.value!==b.value||c.error!==b.error}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/ViewIssueData.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.ViewIssueData");JIRA.Components.IssueViewer.Legacy.ViewIssueData=JIRA.Components.IssueViewer.Legacy.AsyncData.extend({initialize:function(a){JIRA.Components.IssueViewer.Legacy.AsyncData.prototype.initialize.call(this,_.defaults(a||{},{disableCache:JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled(),maxCacheSize:+AJS.Meta.get("viewissue-max-cache-size")}))},fetch:function(e,d){var h={issueKey:e,decorator:"none",prefetch:!!d.prefetch};h.shouldUpdateCurrentProject=!d.detailView;if(d.mergeIntoCurrent){if(this.data&&this.data[e]&&this.data[e].value&&this.data[e].value.issue){h.lastReadTime=this.data[e].value.readTime;h.fields=[];_.each(this.data[e].value.fields,function(i){h.fields.push(i.id+":"+i.contentId)});h.issue=["summary:"+this.data[e].value.issue.summaryContentId];h.links=[];var g=function(i){_.each(i.links,function(j){h.links.push(j.id+":"+j.contentId)});_.each(i.groups,function(j){g(j)})};_.each(this.data[e].value.issue.operations.linkGroups,function(i){g(i)});h.panels=[];var a=this;var b=function(i){_.each(a.data[e].value.panels[i],function(j){h.panels.push(j.completeKey+":"+j.contentId)})};b("leftPanels");b("rightPanels");b("infoPanels")}}if("loadFields" in d){h.loadFields=d.loadFields}if(d.issueEntity){_.defaults(h,d.issueEntity.viewIssueQuery)}var f=jQuery.ajax({url:contextPath+"/secure/AjaxIssueAction!default.jspa",headers:{"X-SITEMESH-OFF":true},data:h,type:d.mergeIntoCurrent?"POST":"GET"});var c=f.pipe(function(i){return i},function(i){return _.pick(i,"status","responseText","statusText")});c.abort=function(){f.abort.apply(f,arguments)};return c},mergeFetchedAndCached:function(l,m,d){if(this._skipMerging(l,m,d)){_.extend(l,m);return null}_.each(_.pairs(m),function(s){if(s[0]!=="value"){l[s[0]]=s[1]}});var q=m.value;var k=[];var b=[];var h=[];_.each(q.removedContentIds,function(u,t){var s;if(t==="fields"){s=k}else{if(t==="panels"){s=b}else{if(t==="links"){s=h}}}if(s){_.each(u,function(v){s.push(v)})}});var g=q.fields;var e=q.issue.operations.linkGroups;var o=q.panels;var j=q.issue.summary;if(this._nothingChanged(k,b,h,g,o,e,j)){return null}var p={updated:{},added:{},deleted:{}};var i=l.value;var f=this._comparator;var c=false;var n=false;var a=false;var r=false;if(k.length>0||g.length>0){this._mergeFields(g,i,p,k);c=true}if(b.length>0||o.leftPanels.length>0||o.rightPanels.length>0||o.infoPanels.length>0){this._mergePanels(o,i,p,b,f);n=true}if(h.length>0||e.length>0){this._mergeLinks(e,i,p,h,f);a=true}if(j){this._mergeSummary(q,i,p);r=true}return p},_skipMerging:function(c,b,a){return _.isEmpty(c)||!a.mergeIntoCurrent||!c.value||!c.value.issue||b.error===true},_nothingChanged:function(e,a,g,b,d,c,f){return e.length==0&&a.length==0&&g.length==0&&b.length==0&&c.length==0&&d.leftPanels.length==0&&d.rightPanels.length==0&&d.infoPanels.length==0&&!f},_mergeFields:function(c,e,d,a){d.added.fields=[];d.updated.fields=[];d.deleted.fields=[];_.each(c,function(f){var g=_.find(e.fields,function(h){return h.id==f.id});if(g){d.updated.fields.push(f.id)}else{d.added.fields.push(f.id)}});var b=c;_.each(e.fields,function(f){if(_.contains(a,f.id)){d.deleted.fields.push(f.id)}else{if(!_.contains(d.updated.fields,f.id)){b.push(f)}}});e.fields=b},_mergeSummary:function(c,b,a){a.updated.issue=["summary"];b.issue.summary=c.issue.summary;b.issue.summaryContentId=c.issue.summaryContentId},_mergePanels:function(e,d,c,a,b){c.added.panels={};c.updated.panels={};c.deleted.panels={};var f=function(g){c.added.panels[g]=[];c.updated.panels[g]=[];c.deleted.panels[g]=[];_.each(e[g],function(i){var j=_.find(d.panels[g],function(k){return k.id==i.id});if(j){c.updated.panels[g].push(i.id)}else{c.added.panels[g].push(i.id)}});var h=e[g];_.each(d.panels[g],function(i){if(_.contains(a,i.completeKey)){c.deleted.panels[g].push(i.id)}else{if(!_.contains(c.updated.panels[g],i.id)){h.push(i)}}});h.sort(b);d.panels[g]=h};f("leftPanels");f("rightPanels");f("infoPanels")},_mergeLinks:function(e,d,c,a,b){c.added.groups={};c.updated.groups={};c.deleted.groups={};var f=[];this._mergeOperationsLinks(e,d,f,c,a,b);this._mergeToolsLinks(e,d,f,c,a,b);d.issue.operations.linkGroups=f},_mergeOperationsLinks:function(j,d,c,a,k,b){a.added.groups["view.issue.opsbar"]=[];a.updated.groups["view.issue.opsbar"]=[];a.deleted.groups["view.issue.opsbar"]=[];var i=_.find(d.issue.operations.linkGroups,function(l){return"view.issue.opsbar"===l.id});var h=_.find(j,function(l){return"view.issue.opsbar"===l.id});var g={};var e={};if(h){_.each(h.groups,function(l){var m=_.find(i.groups,function(o){return l.id===o.id});if(m){a.updated.groups["view.issue.opsbar"].push(l.id)}else{a.added.groups["view.issue.opsbar"].push(l.id)}_.each(l.links,function(o){g[o.id]=o;e[o.id]=l.id});if(l.groups&&l.groups.length>0){var n=l.groups[0];_.each(n.groups,function(o){_.each(o.links,function(p){g[p.id]=p;e[p.id]=o.id})})}})}if(i){var f=[];if(h){_.each(h.groups,function(l){if(_.contains(a.added.groups["view.issue.opsbar"],l.id)){f.push(l)}})}_.each(i.groups,function(q){var p=[];var m=null;if(h){m=_.find(h.groups,function(t){return q.id===t.id});if(m){_.each(m.links,function(t){var u=_.find(q.links,function(v){return t.id===v.id});if(!u){p.push(t)}})}}var n=false;var l=function(u,t){_.each(u.links,function(v){var w=e[v.id];if(w&&w!==u.id){n=true}else{if(g[v.id]){t.push(g[v.id])}else{if(!_.contains(k,v.id)){t.push(v)}else{n=true}}}})};l(q,p);p.sort(b);q.links=p;var o=null;if(m&&m.groups&&m.groups.length>0){o=m.groups[0]}var s=null;if(q.groups&&q.groups.length>0){s=q.groups[0];var r=[];if(o){_.each(o.groups,function(t){var u=_.find(s.groups,function(v){return t.id===v.id});if(!u){r.push(t)}})}_.each(s.groups,function(v){var u=[];if(o){var t=_.find(o.groups,function(w){return w.id===v.id});if(t){_.each(t.links,function(w){var x=_.find(v.links,function(y){return w.id===y.id});if(!x){u.push(w)}})}}l(v,u);if(u.length>0){u.sort(b);v.links=u;r.push(v)}});if(r.length>0){r.sort(b);s.groups=r}else{s=null;n=true}}else{if(o){s=m.groups[0]}}q.groups=[];if(s){q.groups[0]=s}if(p.length>0||s){f.push(q);if(n&&!_.contains(a.updated.groups["view.issue.opsbar"],q.id)){a.updated.groups["view.issue.opsbar"].push(q.id)}}else{a.deleted.groups["view.issue.opsbar"].push(q.id)}});if(f.length>0){f.sort(b);i.groups=f;c.push(i)}}else{if(h){c.push(h)}}a.added.groups["view.issue.opsbar"].sort();a.deleted.groups["view.issue.opsbar"].sort();a.updated.groups["view.issue.opsbar"].sort()},_mergeToolsLinks:function(j,g,f,a,k,b){a.updated.groups["jira.issue.tools"]=false;var m=_.find(g.issue.operations.linkGroups,function(n){return"jira.issue.tools"===n.id});var l=_.find(j,function(n){return"jira.issue.tools"===n.id});var h={};if(l){a.updated.groups["jira.issue.tools"]=true;_.each(l.links,function(n){h[n.id]=n});if(l.groups&&l.groups.length>0){_.each(l.groups[0].links,function(n){h[n.id]=n})}}if(m){var c=[];if(l){_.each(l.links,function(n){var o=_.find(m.links,function(p){return n.id===p.id});if(!o){c.push(n)}})}_.each(m.links,function(n){if(h[n.id]){c.push(h[n.id])}else{if(!_.contains(k,n.id)){c.push(n)}}});c.sort(b);m.links=c;var i=null;if(l&&l.groups&&l.groups.length>0){i=l.groups[0]}if(m.groups&&m.groups.length>0){var e=m.groups[0];var d=[];if(i){_.each(i.links,function(n){var o=_.find(e.links,function(p){return n.id===p.id});if(!o){d.push(n)}})}_.each(e.links,function(n){if(h[n.id]){d.push(h[n.id])}else{if(!_.contains(k,n.id)){d.push(n)}}});m.groups=[];if(d.length>0){d.sort(b);e.links=d;m.groups[0]=e}}else{if(i){m.groups=[i]}}f.push(m)}else{if(l){f.push(l)}}},_comparator:function(b,a){if(b.weight&&a.weight){if(b.weight>a.weight){return 1}if(b.weight<a.weight){return -1}return 0}if(b.weight&&!a.weight){return 1}if(!b.weight&&a.weight){return -1}return 0},updateIssue:function(a,c){var b=this.getMeta(a);if(b&&b.value){b.value.fields=c.fields||{}}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/IssueFieldUtil.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.IssueFieldUtil");JIRA.Components.IssueViewer.Legacy.IssueFieldUtil={getFieldSelector:function(a){if(a==="issuetype"){return"#type-val"}else{if(a==="fixVersions"){return"#fixfor-val"}else{if(a==="summary"){return"#summary-val"}else{if(a==="labels"){return"#wrap-labels .value"}else{if(a==="duedate"){return"#due-date"}else{return"#"+a+"-val"}}}}}},matchesFieldSelector:function(a){return jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(a)).length===1},transformFieldHtml:function(a){a.fields=_.map(a.fields,function(c){var b=AJS.$("<div />").htmlCatchExceptions(c.editHtml);if(b.find("input.radio,input.checkbox").length!==0){b.find("legend").eq(0).remove()}else{b.find("label").eq(0).remove()}return{id:c.id,label:c.label,editHtml:b.html(),required:c.required,contentId:c.contentId}});return a},getAccessKeyModifier:function(){var b=AJS.$("#home_link_drop").attr("title"),a=/\(([\w\+]+)\+\w\)/i;if(a.test(b)){return a.exec(b)[1]}else{return"Alt"}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/IssueEditor.js' */
AJS.namespace("JIRA.Components.IssueEditor");JIRA.Components.IssueEditor=JIRA.Components.IssueViewer.extend({namedEvents:["loadComplete","loadError","returnToSearch","saveSuccess","saveError","editField","fieldSubmitted","replacedFocusedPanel"],initialize:function(a){JIRA.Components.IssueViewer.prototype.initialize.call(this,a);this._buildFieldsLoader();this._buildIssueSaver();this._buildEditIssueController();this._buildFieldsController();this._handleUnload();this.listenAndRethrow(this.eventBus,"fieldSubmitted")},_buildFieldsLoader:function(){this.fieldsLoader=new JIRA.Components.IssueEditor.Services.FieldsLoader({contextPath:contextPath});this.listenTo(this.fieldsLoader,"fieldsLoaded",function(a){this.viewIssueData.updateIssue(a.issueKey,a);a.issueId=Number(a.issueId);var b=a.fields&&a.fields.length;if(b){this.editIssueController.update(a)}else{this.editIssueController.reset()}JIRA.trace("jira.issue.fields.loaded",{id:a.issueId})});this.listenTo(this.fieldsLoader,"fieldsError",function(a){this.fieldsController.showError(a.errorCollection,a.isTimeout);JIRA.trace("jira.issue.fields.loaded",{id:a.issueId})})},_buildIssueSaver:function(){this.saveInProgressManager=new JIRA.Components.IssueEditor.Services.SaveInProgressManager();this.issueSaver=new JIRA.Components.IssueEditor.Services.IssueSaver({saveInProgressManager:this.saveInProgressManager,model:this.model});this.listenTo(this.issueSaver,"error",function(d){var f=d.issueId;var c=d.attemptedSavedIds;var b=d.response;var e=d.duration;if(!this.model.isCurrentIssue(f)){this._showSaveError({issueId:f,issueKey:d.issueKey,response:b});return}this.eventBus.triggerSaveError(f,c,b);var a=b&&b.fields&&b.fields.length;if(!a&&b){this.editIssueController.reset();this.model.update(b,{fieldsSaved:[],fieldsInProgress:[]})}this.trigger("saveError",{issueId:f,duration:e,deferred:false});JIRA.trace("jira.issue.refreshed",{id:f})});this.listenTo(this.issueSaver,"saveStarted",function(a,b){this.eventBus.triggerSavingStarted(b)});this.listenTo(this.issueSaver,"save",function(i){var g=i.issueId;var c=i.issueKey;var f=i.savedFieldIds;var e=i.response;var h=i.shouldSkipSaveIssueSuccessHandler;var d=i.duration;if(this.model.isCurrentIssue(g)&&!h){this.eventBus.triggerSaveSuccess(g,c,f,e);this.viewIssueData.set(c,e);var a=this.editIssueController.getEditsInProgress();this.model.update(e,{fieldsSaved:f,fieldsInProgress:this.editIssueController.getEditsInProgress()});JIRA.trace("jira.psycho.issue.refreshed",{id:g});var b=e.fields&&e.fields.length;if(b){this.editIssueController.update({fields:e.fields,issueId:g,issueKey:c},{editable:true,editIssueController:this.editIssueController,issueModel:this.model,issueId:g,fieldsSaved:f,initialize:false,fieldsInProgress:this.editIssueController.getEditsInProgress()})}JIRA.trace("jira.issue.refreshed",{id:g})}this.trigger("saveSuccess",{issueId:g,issueKey:c,savedFieldIds:f,duration:d})})},_buildEditIssueController:function(){this.editIssueController=new JIRA.Components.IssueEditor.Controllers.EditIssue({issueEventBus:this.eventBus});this.listenTo(this.editIssueController,"save",function(e,a,c,d,b){this.issueSaver.setSkipSaveIssueSuccessHandler(false);this.issueSaver.save(e,a,c,d,b)});this.listenAndRethrow(this.editIssueController,"editField")},_buildFieldsController:function(){this.fieldsController=new JIRA.Components.IssueEditor.Controllers.Fields()},_onIssueLoaded:function(d,e,b){if(d.issue.isEditable){var c=!JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled();if(c&&!e.error&&!e.fromCache){this.fieldsLoader.load({viewIssueData:this.viewIssueData,issueEntity:b.issueEntity})}}var a=!e.mergeIntoCurrent&&b.initialize!==false;if(!e.isUpdate||a){this.editIssueController.reset()}JIRA.Components.IssueViewer.prototype._onIssueLoaded.call(this,d,e,b);if(d.fields){this.editIssueController.update({fields:d.fields,issueId:d.issue.id,issueKey:d.issue.key});JIRA.trace("jira.issue.fields.loaded",{id:d.issue.id})}},_handleUnload:function(){var a=_.bind(function(){var b;if(this.editIssueController.getDirtyEditsInProgress().length>0){b="You are still editing this page. Are you sure you want to leave?"}return b},this);this.unloadInterceptor=new JIRA.Components.IssueEditor.Services.UnloadInterceptor();this.unloadInterceptor.addAfterEvent(a);this.on("destroy",function(){this.unloadInterceptor.removeAfterEvent(a)})},_updateModel:function(c,a){var b=c.fields&&c.fields.length;if(b){this.editIssueController.update(c.fields,{fieldsInProgress:this.editIssueController.getEditsInProgress(),changed:a.changed})}a=_.extend({},a,{fieldsInProgress:this.editIssueController.getEditsInProgress()});JIRA.Components.IssueViewer.prototype._updateModel.call(this,c,a)},_loadIssueFromDom:function(a){if(AJS.Meta.get("server-view-issue-is-editable")){this.editIssueController.setIssueId(a.id);this.editIssueController.setIssueKey(a.key);this.fieldsLoader.load({viewIssueData:this.viewIssueData,issueEntity:a});AJS.Meta.set("server-view-issue-is-editable",null)}JIRA.Components.IssueViewer.prototype._loadIssueFromDom.call(this,a)},editField:function(c){if(!c.isEditable()){return}var a=this.model.getEntity();var b=_.bind(function(){if(c.matchesFieldSelector()){c.edit()}else{new JIRA.Components.IssueEditor.Views.ModalFieldView({issueEventBus:this.eventBus,model:c,issue:a}).show()}},this);if(!c.getSaving()){b()}else{JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){b()})}},abortPending:function(){this.fieldsLoader.cancel();JIRA.Components.IssueViewer.prototype.abortPending.call(this)},beforeHide:function(){this.issueSaver.setSkipSaveIssueSuccessHandler(true);JIRA.Components.IssueViewer.prototype.beforeHide.call(this)},setContainer:function(a){this.editIssueController.setIssueViewContext(a);JIRA.Components.IssueViewer.prototype.setContainer.call(this,a)},dismiss:function(){this.editIssueController.reset();JIRA.Components.IssueViewer.prototype.dismiss.call(this)},getFields:function(){return this.editIssueController.getFields()},hasSavesInProgress:function(){return this.saveInProgressManager.hasSavesInProgress()},_showSaveError:function(b){var c,a;c=new JIRA.Components.IssueEditor.Views.SaveError(b).render();a=_.partial(this.stopListening,c);this.listenTo(c,{close:a,issueLinkClick:this.loadIssue})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/IssueEditorAppModule.js' */
AJS.namespace("JIRA.Components.IssueEditor.AppModule");JIRA.Components.IssueEditor.AppModule=JIRA.Components.IssueViewer.AppModule.extend({name:"issueEditor",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{showReturnToSearchOnError:function(){return false}});return new JIRA.Components.IssueEditor({showReturnToSearchOnError:a.showReturnToSearchOnError})},commands:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.commands.call(this,a);return _.extend(b,{editField:true})},requests:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.requests.call(this,a);return _.extend(b,{fields:function(){return a.getFields()},hasSavesInProgress:true})},events:function(b){var a=JIRA.Components.IssueViewer.AppModule.prototype.events.call(this,b);return a.concat(["saveSuccess","saveError","editField","fieldSubmitted"])}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/NoInlineAppModule.js' */
AJS.namespace("JIRA.Components.IssueEditor.NoInlineAppModule");JIRA.Components.IssueEditor.NoInlineAppModule=JIRA.Components.IssueViewer.AppModule.extend({name:"issueEditor",requests:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.requests.call(this,a);return _.extend(b,{fields:function(){return[]},hasSavesInProgress:function(){return false}})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/templates/Fields.soy' */
// This file was automatically generated from Fields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueEditor == 'undefined') { JIRA.Templates.IssueEditor = {}; }
if (typeof JIRA.Templates.IssueEditor.Fields == 'undefined') { JIRA.Templates.IssueEditor.Fields = {}; }


JIRA.Templates.IssueEditor.Fields.saveErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var issueLink__soy3 = new soy.StringBuilder('<a class="issue" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '">', soy.$$escapeHtml(opt_data.issueKey), '</a>');
  issueLink__soy3 = issueLink__soy3.toString();
  output.append(AJS.format("Saving of \x3cstrong\x3e{0}\x3c/strong\x3e failed!",issueLink__soy3));
  if (opt_data.errors.length > 0) {
    output.append('<ul>');
    var messageList16 = opt_data.errors;
    var messageListLen16 = messageList16.length;
    for (var messageIndex16 = 0; messageIndex16 < messageListLen16; messageIndex16++) {
      var messageData16 = messageList16[messageIndex16];
      output.append('<li>', soy.$$escapeHtml(messageData16), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="', soy.$$escapeHtml(opt_data.issue.id), '-form" class="ajs-dirty-warning-exempt aui" action= "#"><div class="inline-edit-fields">', opt_data.issue.editHtml, '</div><span class="overlay-icon throbber" /><div class="save-options"><button type="submit" class="aui-button submit" accessKey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.accessKey)), '"><span class="aui-icon aui-icon-small aui-iconfont-success">', soy.$$escapeHtml("Save"), '</span></button><button type="cancel" class="aui-button cancel" accessKey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.accessKey)), '"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Cancel"), '</span></button></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.modalField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("Edit {0} for {1}",opt_data.field.label,opt_data.issue.key)), '</h2><form action="" class="aui" method="post"><div class="form-body">', opt_data.field.editHtml, '</div><div class="buttons-container form-footer"><div class="buttons"><input class="button" type="submit" value="', soy.$$escapeHtml("Submit"), '"/><a class="cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.modalFieldGeneralErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error">');
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else if (opt_data.messages.length > 0) {
    output.append('<ul>');
    var messageList59 = opt_data.messages;
    var messageListLen59 = messageList59.length;
    for (var messageIndex59 = 0; messageIndex59 < messageListLen59; messageIndex59++) {
      var messageData59 = messageList59[messageIndex59];
      output.append('<li>', soy.$$escapeHtml(messageData59), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data.errorMessages) {
    output.append('<ul>');
    var msgList75 = opt_data.errorMessages;
    var msgListLen75 = msgList75.length;
    for (var msgIndex75 = 0; msgIndex75 < msgListLen75; msgIndex75++) {
      var msgData75 = msgList75[msgIndex75];
      output.append('<li>', soy.$$escapeHtml(msgData75), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/entities/FieldModel.js' */
AJS.namespace("JIRA.Components.IssueEditor.Models.Field");JIRA.Components.IssueEditor.Models.Field=JIRA.Issues.Brace.Model.extend({namedEvents:["editingStarted","focusRequested","editingCancelled","save","saveError","savingStarted","saveComplete","saveSuccess","updateRequired","validationError","modelDestroyed"],namedAttributes:["id","initParams","params","editHtml","viewHtml","required","fieldType","editing","saving","error","label","contentId"],initialize:function(){if(this.collection){var a=this;this.collection.on("reset",function(){a.triggerModelDestroyed()})}this.on("change:viewHtml",function(){var b=this.previous("viewHtml");if(b){jQuery.cleanData(b)}});this.onModelDestroyed(function(){var b=this.getViewHtml();if(b){jQuery.cleanData(b)}})},blurEdit:function(){if(this.getEditing()){if(this.isDirty()||this.hasValidationError()){this.save()}else{this.cancelEdit()}}},setValidationError:function(c,b,a){this.setSaving(false);this.setError(b);this.edit({ignoreBlur:true});this.triggerSaveError();this.triggerValidationError(c,a)},handleSaveError:function(){this.setSaving(false);this.triggerSaveError()},cancelEdit:function(b){if(!this.cancelLocked){var a=new AJS.$.Event(JIRA.Events.BEFORE_INLINE_EDIT_CANCEL);JIRA.trigger(a,[this.getId(),this.getFieldType(),b]);if(!a.isDefaultPrevented()){this.cancelLocked=true;if(this.getEditing()||this.getSaving()){this.setEditing(false);this.setSaving(false);this.unset("params");this.unset("initParams");this.triggerEditingCancelled();this.unset("viewHtml")}delete this.cancelLocked}}},edit:function(a){if(!this.getEditing()){this.setEditing(true);this.triggerEditingStarted(this,a)}else{if(!a||!a.ignoreBlur){this.triggerFocusRequested(this,a)}}},getCurrentParams:function(){this.triggerUpdateRequired();var c={};if(this.getParams()){c=this.getParams()}else{if(this.getInitParams()){c=this.getInitParams()}else{var b=AJS.$("<div />").html(this.getEditHtml());this.setInitParams(this._serializeObject(b));c=this.getInitParams()}}var a={};_.each(c,function(e,d){a[d]=e});return a},isEditable:function(){if(this.getEditHtml()){return AJS.$(this.getEditHtml()).find("textarea, :text,:radio,:checkbox, select").length!==0}return false},hasValidationError:function(){return !!this.getError()},switchElToEdit:function(a){if(!this.getViewHtml()){this.setViewHtml(a.contents())}a.contents().detach();a.html(JIRA.Templates.IssueEditor.Fields.field({issue:this.toJSON(),accessKey:JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getAccessKeyModifier()}));if(!this.getInitParams()){this.setInitParams(this._serializeObject(a))}this.setEditing(true)},update:function(a){if(this.getEditing()){this.setParams(this._serializeObject(a))}},handleSaveSuccess:function(){this.setSaving(false);this.setEditing(false);this.unset("viewHtml");this.unset("initParams");this.setError(null);this.triggerSaveSuccess()},handleSaveStarted:function(){this.setSaving(true);this.triggerSavingStarted()},save:function(){if(!this.getSaving()){this.triggerUpdateRequired();this.triggerSave(this)}},isDirty:function(){this.triggerUpdateRequired();return this._isDirty(this.getCurrentParams())},_isDirty:function(a){return JSON.stringify(a)!==JSON.stringify(this.getInitParams())},matchesFieldSelector:function(){return JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.matchesFieldSelector(this.id)},_serializeObject:function(b){var c={};var a=AJS.$(b).find(":input").serializeArray();jQuery.each(a,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(this.value||"")}else{c[this.name]=this.value||""}});return c}},{IS_EDITABLE:function(a){return a.isEditable()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/entities/FieldCollection.js' */
AJS.namespace("JIRA.Components.IssueEditor.Collections.Fields");JIRA.Components.IssueEditor.Collections.Fields=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.IssueEditor.Models.Field,initialize:function(){this.on("editingStarted",this._handleEditingStarted,this)},_handleEditingStarted:function(b,a){a=a||{};if(a.ignoreBlur){return}this.each(function(c){if(b!==c&&c.getEditing()){c.blurEdit()}})},update:function(e,c){var a=this;if(c&&c.changed){var b=c.changed;var f=b.updated?b.updated.fields:[];var d=b.added?b.added.fields:[];_.each(e,function(h){if(_.contains(f,h.id)){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}}else{if(_.contains(d,h.id)){a.add(h)}}})}else{_.each(e,function(h){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}})}},cancelEdit:function(){this.each(function(a){a.cancelEdit()})},isDirty:function(){return this.any(function(a){return a.isDirty()})},getDirtyFields:function(){return this.filter(function(a){return a.isDirty()})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/FieldView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.FieldView");JIRA.Components.IssueEditor.Views.FieldView=JIRA.Marionette.ItemView.extend({events:{"click .cancel":"onClickCancel",keyup:"onKeyCancel","click .submit":"onSubmit",click:"onEdit",mousedown:"saveSelectedText","submit form":"onSubmit",'keydown select[multiple="multiple"]':"_enterToSubmitMultiSelect","keypress select":"_enterToSubmitSelect","beforeBlurInput *":"_preventBlurByEsc"},initialize:function(b){this.model.on("validationError",this.handleValidationError,this);this.model.on("editingStarted",this.switchToEdit,this);this.model.on("focusRequested",this.focus,this);this.model.on("editingCancelled",this.switchToRead,this);this.model.on("saveError",this.handleSaveError,this);this.model.on("updateRequired",this.updateModel,this);this.model.on("savingStarted",this.handleSavingStarted,this);this.model.on("modelDestroyed",this.destroy,this);this.decorate();this.issueEventBus=b.issueEventBus;this.issueEventBus.on("panelRendered",this.handlePanelRendered,this);this.model.setFieldType(this.$el.data("fieldtypecompletekey"));this._editDelay=0;var a=this;JIRA.bind(JIRA.Events.INLINE_EDIT_BLURRED,function(d,c){if(c===a.model.getId()){a._onPossibleBlur()}});JIRA.bind(JIRA.Events.INLINE_EDIT_REQUESTED,function(d,c){if(c!==a.model.getId()&&a._editDelay!==0){clearTimeout(a._editDelay);a._editDelay=0}})},destroy:function(){this.issueEventBus.off("panelRendered",this.handlePanelRendered)},decorate:function(){if(this.model.isEditable()&&!this.model.getEditing()){this.$el.addClass("editable-field inactive");this.$el.append('<span class="overlay-icon aui-icon aui-icon-small aui-iconfont-edit" />');this._addToolTip()}},getEditElements:function(){return this.$el.find(".inline-edit-fields")},_addToolTip:function(){this.$el.attr("title","Click to edit");jQuery("a:not([title])",this.$el).attr("title","Follow link")},_removeToolTip:function(){this.$el.removeAttr("title")},_stealAccessKeys:function(){jQuery("[accessKey='"+"s"+"']").attr("accessKey","_s");jQuery("[accessKey='"+"`"+"']").attr("accessKey","_x")},_returnAccessKeys:function(){jQuery("[accessKey=_s]").attr("accessKey","s");jQuery("[accessKey=_x]").attr("accessKey","`")},_handleEditingStarted:function(a){var b=this.$el.find(".field-tools");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.inlineEditStarted]);JIRA.trigger(JIRA.Events.INLINE_EDIT_STARTED,[this.model.getId(),this.model.getFieldType(),this.getEditElements(),this.$el]);this.$el.find(".textarea").css("height",Math.max(this._originalHeight,60)).expandOnInput(window.innerHeight-jQuery("#stalker").height()-100);if(a){this.$el.find(":input:visible:first").focus()}if(!this.$el.find(".error").size()){this.$el.find("select.aui-ss-select").each(function(){var c=jQuery(this);if(c.data("static-suggestions")){c.trigger("showSuggestions")}})}this.$el.find(".save-options").attr("tabindex",1).prepend(b)},handleValidationError:function(b,a){this.$el.html(JIRA.Templates.IssueEditor.Fields.field({issue:{id:this.model.id,editHtml:b},accessKey:JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getAccessKeyModifier()}));this.$el.find(".error").addClass("inline-edit-error").attr("data-field",this.model.id);this._handleEditingStarted(a)},handlePanelRendered:function(a,b){var c=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(this.model.id),b);if(c.length===1){this.$el=c;this.el=this.$el[0];this.decorate();this.delegateEvents()}},handleSaveError:function(){this.$el.find(":input").removeAttr("disabled").trigger("enable");this.$el.removeClass("saving saving-"+this.model.id)},handleSavingStarted:function(){this.$el.find(":input").attr("disabled","disabled").trigger("disable");this.$el.addClass("saving saving-"+this.model.id)},updateModel:function(){this.model.update(this.$el)},reveal:function(){var a=40;this.$el.scrollIntoView({direction:"y",marginBottom:a,marginTop:AJS.$("#stalker").outerHeight(true)+a});this.$el.trigger("reveal")},focus:function(){this.reveal();this.$el.find(":input").removeAttr("disabled");if(jQuery(".aui-blanket").length===0){var a=this.$el.find(":input:visible:first");a.focus();if(!this.$el.hasClass("field-ignore-highlight")){a.select()}}},switchToEdit:function(){this.trigger("editField",{fieldId:this.model.getId()});this._stealAccessKeys();this._removeToolTip();this.$el.removeClass("inactive saving").addClass("active");this._originalHeight=this.$el.height();this.model.switchElToEdit(this.$el);this._handleEditingStarted();this.focus()},switchToRead:function(){this._addToolTip();this.$el.addClass("inactive").removeClass("active");this.$el.html(this.model.getViewHtml());this.$el.closest("form").unbind("submit",this.onSubmit);this._returnAccessKeys()},onKeyCancel:function(a){if(a.keyCode===27){this.model.cancelEdit(JIRA.Issues.CANCEL_REASON.escPressed);a.preventDefault()}},onClickCancel:function(a){this.model.cancelEdit();a.preventDefault()},onSubmit:function(b){var a=new jQuery.Event("before-submit");this.$el.find("form").trigger(a);if(!a.isDefaultPrevented()){this.$el.find(":focus").blur();this.issueEventBus.triggerFieldSubmitted();this.model.save();this._returnAccessKeys()}b.preventDefault()},onEdit:function(f){var e=AJS.$(f.target).is(".overlay-icon.aui-iconfont-edit");var c=AJS.$(f.target).closest("a, .uneditable").length===0&&this.$el.hasClass("inactive");var d=this._getCurrentlySelectedText()===""&&!this._previouslySelectedText;var b=c&&(e||d);if(this._editDelay!==0){clearTimeout(this._editDelay);this._editDelay=0}else{if(b){JIRA.trigger(JIRA.Events.INLINE_EDIT_REQUESTED,[this.model.getId()]);var a=this;if(e){jQuery(document).one("click",function(g){if(!g.isDefaultPrevented()){a.model.edit()}})}else{this._editDelay=setTimeout(function(){if(!f.isDefaultPrevented()&&a.$el.hasClass("inactive")&&a._getCurrentlySelectedText()===""){a.model.edit()}a._editDelay=0},250)}}}},_onPossibleBlur:function(){if(this.model.getSaving()){return}if(jQuery(".aui-blanket").length>0){return}this.model.blurEdit()},_preventBlurByEsc:function(a){a.preventDefault()},_getCurrentlySelectedText:function(){if(jQuery(document.activeElement).is(":input")){return""}if(document.selection&&document.selection.createRange){return document.selection.createRange().text||""}if(window.getSelection){return window.getSelection().toString()}return""},_enterToSubmitSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){a.preventDefault();jQuery(a.target).closest("form").submit()}}},_enterToSubmitMultiSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){jQuery(a.target).blur()}}},saveSelectedText:function(){this._previouslySelectedText=this._getCurrentlySelectedText()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/ModalFieldView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.ModalFieldView");JIRA.Components.IssueEditor.Views.ModalFieldView=JIRA.Marionette.ItemView.extend({errorsTemplate:JIRA.Templates.IssueEditor.Fields.modalFieldGeneralErrors,template:JIRA.Templates.IssueEditor.Fields.modalField,initialize:function(a){_.bindAll(this,"_onHide","_onSubmit","_remove","_showGeneralError","_showValidationError","_updateModel");JIRA.bind("Dialog.hide",this._onHide);this.issueEventBus=a.issueEventBus;this.issueEventBus.on("saveError",this._showGeneralError);this.model.onSaveSuccess(this._remove);this.model.onUpdateRequired(this._updateModel);this.model.onValidationError(this._showValidationError)},_enable:function(){var b=this._getDialog();b.hideFooterLoadingIndicator();var a=b.$popup;a.find(":input").removeAttr("disabled").trigger("enable");a.find(":input:first").focus().select();a.find(":submit").removeAttr("disabled")},_getDialog:function(){if(!this._dialog){this._dialog=new JIRA.FormDialog({id:"modal-field-view",submitHandler:this._onSubmit,content:_.bind(function(a){a(this.template({field:this.model.toJSON(),issue:this.options.issue}))},this)});this._dialog.get$popup().data("field-id",this.model.getId())}return this._dialog},_onHide:function(a,b){if(b===this._getDialog().get$popup()){this._remove()}},_onSubmit:function(c,b){c.preventDefault();this.model.save();b();var a=this._getDialog();a.showFooterLoadingIndicator();a.$popup.find(":input").attr("disabled","disabled").trigger("disable")},close:function(){this._remove()},_remove:function(b){var a=this._getDialog();if(a.get$popup().is(":visible")){a.hide()}a.destroy();this.model.cancelEdit();JIRA.unbind("Dialog.hide",this._onHide);this.issueEventBus.off("saveError",this._showGeneralError);this.model.off("saveSuccess",this._remove);this.model.off("updateRequired",this._updateModel);this.model.off("validationError",this._showValidationError)},show:function(){this.model.edit();this._getDialog().show()},_showGeneralError:function(f,b,a){this._enable();var d=this._getDialog().$popup;var g=a&&a.errorCollection;if(g){var c=!_.isEmpty(g.errors),e=!_.isEmpty(g.errorMessages);if(!c&&e){d.find(".form-body").append(this.errorsTemplate({messages:g.errorMessages}))}}},_showValidationError:function(a){this._enable();this._getDialog().$popup.find(".form-body").html(a)},_updateModel:function(){this.model.update(this._getDialog().$popup)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/LoadingError.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.LoadingError");JIRA.Components.IssueEditor.Views.LoadingError=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueEditor.Fields.errorsLoading,initialize:function(b,a){this.errorMessages=b;this.isTimeout=a},serializeData:function(){return{errorMessages:this.errorMessages,isTimeout:this.isTimeout}},onRender:function(){this.setElement(JIRA.Messages.showErrorMsg(this.$el.html(),{closeable:true,timeout:0}))}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/SaveError.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.SaveError");JIRA.Components.IssueEditor.Views.SaveError=JIRA.Marionette.ItemView.extend({events:{"simpleClick .issue":"onIssueLinkClick"},template:JIRA.Templates.IssueEditor.Fields.saveErrorMessage,getErrorMessages:function(){var a,b=[];a=this.options.response.errorCollection;a&&(b=a.errorMessages.concat(_.values(a.errors)));return b},onIssueLinkClick:function(b){var a;a={id:this.options.issueId,key:this.options.issueKey};b.preventDefault();this.trigger("issueLinkClick",a);this.close()},onRender:function(){this.setElement(JIRA.Messages.showErrorMsg(this.$el.html(),{closeable:true,timeout:0}))},serializeData:function(){return{errors:this.getErrorMessages(),issueKey:this.options.issueKey}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/EditIssueController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.EditIssue");JIRA.Components.IssueEditor.Controllers.EditIssue=JIRA.Issues.Brace.Model.extend({namedAttributes:["issueId","issueKey","issueViewContext","fields","issueEventBus"],namedEvents:["save","editField"],initialize:function(){_.bindAll(this,"_handleSaveError","_handleSaveSuccess","_handleSavingStarted","cancelUneditedFields","createFieldView","handleFieldUpdate","save");this.set({fields:new JIRA.Components.IssueEditor.Collections.Fields()},{silent:true});this.getFields().bind("add",this.createFieldView).bind("updated",this.handleFieldUpdate).bind("save",this.save);this.getIssueEventBus().onSavingStarted(this._handleSavingStarted);this.getIssueEventBus().onSaveSuccess(this._handleSaveSuccess);this.getIssueEventBus().onSaveError(this._handleSaveError);this.getIssueEventBus().onSave(this.save);this.getIssueEventBus().onSave(this.cancelUneditedFields)},_saveById:function(b){var a=this.getFields().get(b);if(a){a.blurEdit()}},_handleSaveError:function(d,c,b){var a=this;if(b){this.applyErrors(b)}else{_.each(c,function(f){var e=a.getFields().get(f);if(e){e.handleSaveError()}})}},_handleSavingStarted:function(a){this.getFields().each(function(b){if(_.include(a,b.id)){b.handleSaveStarted()}})},handleFieldUpdate:function(b){var a=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(b.id));if(!a.hasClass("editable-field")){this.createFieldView(b)}},applyErrors:function(d,c){var a=d.errorCollection;if(a&&a.errors){this.getFields().each(function(e){if(a.errors[e.id]){var f=_.find(d.fields,function(g){return g.id==e.id});if(f){e.setValidationError(f.editHtml,a.errors[e.id],c);c=false}}})}if(a.errorMessages&&a.errorMessages.length){var b=JIRA.Templates.IssueEditor.Fields.saveErrorMessage({errors:a.errorMessages,issueKey:this.getIssueKey()});JIRA.Messages.showErrorMsg(b,{closeable:true})}},reset:function(){this.getFields().reset()},cancelEdit:function(){this.getFields().each(function(a){a.cancelEdit()})},_handleSaveSuccess:function(c,a,d){var b=this.getFields().filter(function(e){return _.indexOf(d,e.id)>=0});_.each(b,function(e){e.handleSaveSuccess()})},getDirtyEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()&&a.isDirty()}),"id")},getEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()}),"id")},save:function(b,a){var e={},d=[];var c=[b];if(!b){c=this.getFields().filter(function(f){return !f.getSaving()&&f.getEditing()&&f.isDirty()})}else{if(!b.getEditing()||b.getSaving()){return}}_.each(c,function(f){d.push(f.getId());_.extend(e,f.getCurrentParams())});if(d.length>0){this.triggerSave(this.getIssueId(),this.getIssueKey(),d,e,a)}},cancelUneditedFields:function(){this.getFields().each(function(a){if(a.getEditing()&&!a.isDirty()&&!a.hasValidationError()){a.cancelEdit()}})},update:function(b,a){if(b.fields){if(a&&a.fieldsInProgress){_.each(b.fields,function(c){if(_.contains(a.fieldsInProgress,c.id)){c.editing=true}})}this.getFields().update(b.fields,a)}if(b.issueId){this.setIssueId(b.issueId)}if(b.issueKey){this.setIssueKey(b.issueKey)}},createFieldView:function(b){var a=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(b.id),this.getIssueViewContext());if(a.length===1){var c=new JIRA.Components.IssueEditor.Views.FieldView({model:b,el:a,issueEventBus:this.getIssueEventBus()});c.on("editField",_.bind(function(d){this.trigger("editField",d)},this))}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/FieldsController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.Fields");JIRA.Components.IssueEditor.Controllers.Fields=JIRA.Marionette.Controller.extend({showError:function(b,a){if(b||a){var c=b.errorMessages||[];this.close();this.triggerMethod("before:render");this.view=new JIRA.Components.IssueEditor.Views.LoadingError(b,a);this.view.render();this.listenTo(this.view,"close",this.close);this.triggerMethod("render")}},close:function(){if(this.view){this.view.close();this.stopListening(this.view);delete this.view}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/FieldsLoaderService.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.FieldsLoader");JIRA.Components.IssueEditor.Services.FieldsLoader=JIRA.Marionette.Controller.extend({initialize:function(a){this.recurringPromise=jQuery.RecurringPromise().sub();this.recurringPromise.done(_.bind(function(b){this.trigger("fieldsLoaded",b)},this)).fail(_.bind(function(b){this.trigger("fieldsError",b)},this));this.contextPath=a.contextPath},load:function(b){var a=this._buildUpdateTask(b);this.recurringPromise.add(a)},cancel:function(){this.recurringPromise.reset()},_getFieldsData:function(d,a){var c=jQuery.ajax({url:this.contextPath+"/secure/AjaxIssueEditAction!default.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},data:{issueId:d}});var b=c.pipe(function(e){var f=JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(e);return{issueId:d,issueKey:a,fields:f.fields}},function(j){var g={};var h;switch(j.status){case 400:h=false;try{var f=JSON.parse(j.responseText)||{};g=f.errorCollection}catch(i){}break;case 401:h=false;g=null;break;default:h=true;g={};break}return{issueId:d,fields:null,errorCollection:g,isTimeout:"timeout"===j.statusText,fatalError:h}});b.abort=function(){c.abort.apply(c,arguments)};return b},_buildUpdateTask:function(c){var e=c.viewIssueData;var a=c.issueEntity;var d=c.lastEditData;var b=jQuery.Deferred();e.setPending(a.id,this._getFieldsData(a.id,a.key),function(f){b.resolve(f)},function(f){if(f.fatalError){b.reject(f)}else{b.resolve(f)}});return b.promise()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/IssueSaverService.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.IssueSaver");JIRA.Components.IssueEditor.Services.IssueSaver=JIRA.Marionette.Controller.extend({initialize:function(a){this.saveInProgressManager=a.saveInProgressManager;this.model=a.model;this._saveStarted=[];this.saveInProgressManager.onSavingStarted(_.bind(function(b,c){this._saveStarted.push((new Date()).getTime());this.trigger("saveStarted",b,c)},this));this.saveInProgressManager.onSaveSuccess(_.bind(function(d,b,e,c){if(c&&c.fields){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c)}this.trigger("save",{issueId:d,issueKey:b,savedFieldIds:e,response:c,shouldSkipSaveIssueSuccessHandler:this._shouldSkipSaveIssueSuccessHandler,duration:(new Date()).getTime()-this._saveStarted.shift()})},this));this.saveInProgressManager.onSaveError(_.bind(function(e,b,d,c){if(c&&c.fields){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c)}this.trigger("error",{issueId:e,issueKey:b,attemptedSavedIds:d,response:c,duration:(new Date()).getTime()-this._saveStarted.shift()})},this))},setSkipSaveIssueSuccessHandler:function(a){this._shouldSkipSaveIssueSuccessHandler=a},save:function(e,a,c,d,b){this.saveInProgressManager.saveIssue(e,a,c,d,b)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/SaveInProgressManager.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.SaveInProgressManager");JIRA.Components.IssueEditor.Services.SaveInProgressManager=JIRA.Issues.Brace.Model.extend({namedAttributes:["savesInProgress"],namedEvents:["beforeSaving","savingStarted","saveSuccess","saveError"],initialize:function(){this.setSavesInProgress([])},saveIssue:function(g,b,d,c,h){this.triggerBeforeSaving();var i=this,a,e;e=_.extend(c,{issueId:g,atl_token:atl_token(),singleFieldEdit:true,fieldsToForcePresent:d});var f=_.extend({type:"POST",url:contextPath+"/secure/AjaxIssueAction.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},error:function(j){i._handleSaveError(g,b,d,j)},success:function(n,l,m,j){var k=j.data;if(typeof k=="string"){i._handleHtmlResponse(g,b,d,k)}else{JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(k);i.triggerSaveSuccess(g,b,d,k)}},complete:function(){i.removeSaveInProgress(a);JIRA.trigger(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE)},data:e},h);a=JIRA.SmartAjax.makeRequest(f);this.addSaveInProgress(a);this.triggerSavingStarted(g,d,c)},hasSavesInProgress:function(){return this.getSavesInProgress().length>0},removeSaveInProgress:function(a){this.setSavesInProgress(_.without(this.getSavesInProgress(),a))},addSaveInProgress:function(a){var b=this.getSavesInProgress();b.push(a);this.setSavesInProgress(b)},_handleHtmlResponse:function(h,b,c,e){var a=this;var g=AJS.$(AJS.extractBodyFromResponse(e));var f=g.find("#atl_token").val();if(f){AJS.$("#atlassian-token").attr("content",f)}var d=new JIRA.FormDialog({offsetTarget:"body",content:g});this.triggerSaveError(h,b,c);d._handleServerSuccess=function(i){d.hide();var j=a._parseResponse(i);if(j){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(e);a.triggerSaveSuccess(h,b,c,j)}};d._handleServerError=function(j){d.hide();var i=a._parseResponse(j.responseText);if(i){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(i);a.triggerSaveError(h,b,c,i)}};d.show()},_handleSaveError:function(e,a,b,d){var c=this._parseResponse(d.responseText);if(c){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c);this.triggerSaveError(e,a,b,c)}},_parseResponse:function(a){try{return JSON.parse(a)}catch(b){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var a="<p>"+"Communications Breakdown"+"</p><p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(a,{closeable:true})}});JIRA.Events.INLINE_EDIT_SAVE_COMPLETE="inlineEditSaveComplete";;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/UnloadInterceptor.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.UnloadInterceptor");JIRA.Components.IssueEditor.Services.UnloadInterceptor=JIRA.Marionette.Controller.extend({initialize:function(){this._afterEventHandlers=[];this.originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=_.bind(this.onBeforeUnload,this)},addAfterEvent:function(a){this._afterEventHandlers.push(a)},removeAfterEvent:function(a){this._afterEventHandlers=_.without(this._afterEventHandlers,a)},onBeforeUnload:function(){var a,b=arguments;if(_.isFunction(this.originalBeforeUnload)){a=this.originalBeforeUnload.apply(window,b)}if(!a){a=_.reduce(this._afterEventHandlers,function(c,f,d,e){if(c){return c}return f.apply(window,b)},a)}return a}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/InlineEditUtils.js' */
JIRA.Events.INLINE_EDIT_STARTED="inlineEditStarted";JIRA.Events.BEFORE_INLINE_EDIT_CANCEL="inlineEditCancelled";JIRA.Events.INLINE_EDIT_BLURRED="inlineEditBlurred";JIRA.Events.INLINE_EDIT_FOCUSED="inlineEditFocused";JIRA.Events.INLINE_EDIT_REQUESTED="inlineEditRequested";JIRA.Events.LOCK_PANEL_REFRESHING="lockPanelRefreshing";JIRA.Events.UNLOCK_PANEL_REFRESHING="unlockPanelRefreshing";JIRA.Events.REFRESH_ISSUE_PAGE="refreshIssuePage";JIRA.Issues.CANCEL_REASON={escPressed:"escPressed"};AJS.$(function(){AJS.namespace("JIRA.Components.IssueEditor.InlineEditUtils");JIRA.Components.IssueEditor.InlineEditUtils.BLUR_FOCUS_TIMEOUT=50;var a=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggers={Default:function(e,i){i=i.nextAll(".save-options").andSelf();var h=":input, a[href], [tabindex]";var g;var f=b(i);var d={focus:function(){if(!f){f=true;JIRA.trigger(JIRA.Events.INLINE_EDIT_FOCUSED,[e])}},blur:function(){if(g){clearTimeout(g)}g=setTimeout(c,JIRA.Components.IssueEditor.InlineEditUtils.BLUR_FOCUS_TIMEOUT)}};i.attr("tabindex",1).bind(d).delegate(h,d);function c(){if(!b(i)){f=false;JIRA.trigger(JIRA.Events.INLINE_EDIT_BLURRED,[e])}}}};function b(d){var c=document.activeElement;return d.find(c).length>0||d.filter(c).length>0}JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping={system:{summary:a.Default,priority:a.Default,issuetype:a.Default,components:a.Default,versions:a.Default,fixVersions:a.Default,assignee:a.Default,reporter:a.Default,environment:a.Default,description:a.Default,labels:a.Default,duedate:a.Default},custom:{"com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datetime":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:float":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:grouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:labels":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multigrouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:project":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:select":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:url":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:version":a.Default}};JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(h,d,c,i){var g;if(c){g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.custom[c];if(!g){var f=c.replace(/.+:(.+)/,"$1");g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.custom[f]}}else{g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.system[d]}if(g){g(d,i)}});AJS.namespace("JIRA.Issues.InlineEdit.BlurTriggers",window,JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggers);AJS.namespace("JIRA.Issues.InlineEdit.BlurTriggerMapping",window,JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping)});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerTemplate.soy' */
// This file was automatically generated from PagerTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Header == 'undefined') { JIRA.Templates.ViewIssue.Header = {}; }


JIRA.Templates.ViewIssue.Header.pager = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="ajax ops page-navigation"><li class="previous">', (opt_data.previousIssue && opt_data.position != 1) ? '<a data-id="' + soy.$$escapeHtml(opt_data.previousIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" id="previous-issue" rel="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" title="' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'"><span class="icon icon-page-prev"><span>' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'</span></span></a>' : (opt_data.position && opt_data.resultCount) ? '<span class="icon icon-page-prev-deactivated" title="' + soy.$$escapeHtml("Not available - this is the first issue") + '"></span>' : '', '</li><li class="showing">', (opt_data.position && opt_data.resultCount) ? soy.$$escapeHtml(AJS.format("{0} of {1}",opt_data.position,opt_data.resultCount)) : '', '</li><li class="next">', (opt_data.nextIssue && opt_data.position != opt_data.resultCount) ? '<a data-id="' + soy.$$escapeHtml(opt_data.nextIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" id="next-issue" rel="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" title="' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'"><span class="icon icon-page-next"><span>' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'</span></span></a>' : (opt_data.position && opt_data.resultCount) ? '<span class="icon icon-page-next-deactivated" title="' + soy.$$escapeHtml("Not available - this is the last issue") + '"></span>' : '', '</li>', (opt_data.hasSearchLink) ? '<li class="return"><a id="return-to-search" href="' + soy.$$escapeHtml("") + '/issues/" title="' + soy.$$escapeHtml("Return to search") + '">' + soy.$$escapeHtml("Return to search") + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/Pager.js' */
(function(b,a){b.namespace("JIRA.Components.Pager");a.Components.Pager=function(e){var d,c;this.initialize=function(){d=new a.Components.Pager.Model()};this.update=function(f){if(f){d.update(f)}else{d.clear()}};this.show=function(f,g){if(!c){c=new a.Components.Pager.Controller({model:d});c.on("goBack",e.goBack);c.on("nextItem",e.nextItem);c.on("previousItem",e.previousItem)}c.show(f,g)};this.close=function(){if(c){c.close()}c=null;d.clear()}}})(AJS,JIRA);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerModel.js' */
(function(a,b){b.define("JIRA.Components.Pager.Model",a.Issues.BaseModel.extend({properties:["nextIssue","previousIssue","position","resultCount","hasSearchLink"],update:function(c){c.hasSearchLink=!c.isSplitView;delete c.isSplitView;this.set(c)}}))})(JIRA,Backbone);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerView.js' */
(function(a,b,c){AJS.namespace("JIRA.Components.Pager.View");a.Components.Pager.View=a.Marionette.ItemView.extend({template:function(d){return _.isEmpty(d)?"":a.Templates.ViewIssue.Header.pager(d)},events:{"simpleClick #return-to-search":"_onReturnToSearchClick"},triggers:{"simpleClick #next-issue":"nextItem","simpleClick #previous-issue":"previousItem"},ui:{nextIssue:"#next-issue",previousIssue:"#previous-issue",returnToSearch:"#return-to-search"},modelEvents:{change:"render"},onRender:function(){if(AJS.activeShortcuts){AJS.activeShortcuts.j&&AJS.activeShortcuts.j._addShortcutTitle(this.$el.find(this.ui.nextIssue));AJS.activeShortcuts.k&&AJS.activeShortcuts.k._addShortcutTitle(this.$el.find(this.ui.previousIssue));AJS.activeShortcuts.u&&AJS.activeShortcuts.u._addShortcutTitle(this.$el.find(this.ui.returnToSearch))}},_onReturnToSearchClick:function(d){d.preventDefault();this.trigger("goBack");b("body").focus()}})})(JIRA,AJS.$,Backbone);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerController.js' */
(function(a,c,b){c.define("JIRA.Components.Pager.Controller",a.Marionette.Controller.extend({initialize:function(d){this.model=d.model},getView:function(d){if(!this.pagerView){this.pagerView=new a.Components.Pager.View({model:this.model,el:d});this.listenTo(this.pagerView,"close",this.destroyView);this.listenAndRethrow(this.pagerView,["goBack","nextItem","previousItem"])}else{if(d){this.pagerView.setElement(d)}}return this.pagerView},show:function(d){this.getView(d).render()},onClose:function(){this.pagerView.close()},destroyView:function(){delete this.pagerView}}))})(JIRA,Backbone,JIRA.Libs.Marionette);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerAppModule.js' */
(function(b,a){b.namespace("JIRA.Components.Pager.AppModule");a.Components.Pager.AppModule=function(c,e){var d=new a.Components.Pager({nextItem:function(){a.Issues.Api.nextIssue()},previousItem:function(){a.Issues.Api.prevIssue()},goBack:function(){e.execute("returnToSearch")}});e.addInitializer(function(){d.initialize();e.commands.setHandlers({"pager:update":d.update,"pager:render":d.show,"pager:close":d.close})})}})(AJS,JIRA);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/Application.js' */
AJS.namespace("JIRA.Issues.Application");JIRA.Issues.Application=new JIRA.Marionette.Application();JIRA.Issues.Application.addInitializer(function(){this.module("JIRA.Components.Pager",JIRA.Components.Pager.AppModule);if(AJS.Meta.get("is-inline-edit-enabled")!==false){this.module("JIRA.Components.IssueEditor",new JIRA.Components.IssueEditor.AppModule().definition)}else{this.module("JIRA.Components.IssueEditor",new JIRA.Components.IssueEditor.NoInlineAppModule().definition)}this.module("JIRA.Components.Analytics",new JIRA.Components.Analytics.AppModule().definition)});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/FocusShifterService.js' */
AJS.namespace("JIRA.Issues.FocusShifter");JIRA.Issues.FocusShifter.init=function(){return JIRA.Shifter.register(function(){var b;if(JIRA.Issues.Api.issueIsVisible&&!JIRA.Issues.Api.issueIsVisible()){b=[]}else{var a=JIRA.Issues.Api.getFieldsOnSelectedIssue();b=a?JIRA.Issues.FocusShifter.getSuggestions(a):[]}return{id:"edit-fields",name:"Edit Fields",context:JIRA.Issue.getIssueKey(),weight:100,getSuggestions:function(){return jQuery.Deferred().resolve(b)},onSelection:function(c){JIRA.Issues.Api.editFieldOnSelectedIssue(c)}}})};JIRA.Issues.FocusShifter.show=function(){JIRA.Shifter.show()};JIRA.Issues.FocusShifter.getSuggestions=function(a){return _.chain(a.models).filter(JIRA.Components.IssueEditor.Models.Field.IS_EDITABLE).filter(function(b){return b.id!=="comment"}).map(function(b){return{label:b.getLabel(),value:b.id}}).value()};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/Overrides.js' */
JIRA.Messages.showMsgOnReload=function(b,a){JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){a.type=JIRA.Messages.Types[a.type];JIRA.Messages.showMsg(b,a)})};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.Util == 'undefined') { JIRA.Templates.Issues.Util = {}; }


JIRA.Templates.Issues.Util.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml(""), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/IssueTable.js' */
AJS.namespace("JIRA.Components.IssueTable");JIRA.Components.IssueTable=JIRA.Marionette.Controller.extend({initialize:function(a){this.issueTableView=new JIRA.Issues.IssueTableView({columnConfig:a.columnConfig});this._createSearchService(a);this._createTableController(a);JIRA.Issues.Application.on("issueEditor:loadError",this._handleIssueLoadError,this)},_createSearchService:function(a){this.searchService=a.searchService;this.listenTo(this.searchService,{"before:search":function(){this.issueTableController.showPending()},search:function(c,b){this.latestResults={table:c,sortOptions:b.getSortBy(),totalDisplayableIssues:b.getDisplayableTotal(),startIndex:b.getStartIndex(),pageSize:b.getPageSize(),pageNumber:b.getPageNumber(),numberOfPages:b.getNumberOfPages(),totalIssues:b.getTotal(),currentSearch:JIRA.Issues.Application.request("issueNav:currentSearchRequest"),jiraHasIssues:b.getJiraHasIssues(),hasIssues:b.hasIssues()};this.show();this.highlightIssue(b.getHighlightedIssue().id,false)},"error:search":function(){this.issueTableController.showErrorMessage()},issueUpdated:function(c,b){this.issueTableController.updateIssue(c,b.table)},issueHighlighted:function(b){this.issueTableController.highlightIssue(b)},selectedIssueChanged:function(c,b){if(!c.hasIssue()){this.issueTableController.highlightIssue(b.id)}}})},_createTableController:function(b){var a=b.columnConfig;var c=b.el;this.issueTableController=new JIRA.Components.IssueTable.Controllers.IssueTable({el:c});this.listenTo(this.issueTableController,{goToPage:function(d){this.searchService.goToPage(d)},columnsChanged:function(d){a.saveColumns(d)},highlightIssue:function(d){this.trigger("highlightIssue",d)},sort:function(d){this.searchService.sort(d)},refresh:function(){this.searchService.runCurrentSearch()},renderTable:function(d){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[d,JIRA.CONTENT_ADDED_REASON.issueTableRefreshed]);JIRA.trace("jira.search.stable.update")},renderEmpty:function(d){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[d,JIRA.CONTENT_ADDED_REASON.issueTableRefreshed]);JIRA.trace("jira.search.stable.update")},issueRowUpdated:function(d){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[d,JIRA.CONTENT_ADDED_REASON.issueTableRowRefreshed]);JIRA.trace("jira.search.finished")}})},show:function(){if(!this.latestResults){this.searchService.updateExitingResults()}else{this.issueTableController.show(this.latestResults);this.trigger("render");this.issueTableView._onSearchDone(this.issueTableController.view.$el)}},close:function(){this.issueTableController.close();this.stopListening(this.searchService);JIRA.Issues.Application.off("issueEditor:loadError",this._handleIssueLoadError,this);delete this.issueTableController;delete this.searchService},handleIssueInaccessible:function(a){this.issueTableController.markIssueAsInaccessible(a)},highlightIssue:function(b,a){this.issueTableController.highlightIssue(b,a)},_handleIssueLoadError:function(a){if(a.response.status===404){this.issueTableController.markIssueAsInaccessible(a.issueId)}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/templates/issuenav-results.soy' */
// This file was automatically generated from issuenav-results.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNav == 'undefined') { JIRA.Templates.IssueNav = {}; }


JIRA.Templates.IssueNav.resultsCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNav.resultsCountHelper({start: '<span class="results-count-start">' + soy.$$escapeHtml(opt_data.start) + '</span>', end: '<span class="results-count-end">' + soy.$$escapeHtml(opt_data.end) + '</span>', total: '<span class="results-count-total results-count-link">' + soy.$$escapeHtml(opt_data.total) + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.resultsCountHelper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="results-count-text">', AJS.format("{0}\x26ndash;{1} of {2}",opt_data.start,opt_data.end,opt_data.total), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.endOfStableMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml("Too many search results to display. Refine your search criteria and try again."), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.refreshResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" class="refresh-table" title="', soy.$$escapeHtml("Refresh results"), '"><span class="aui-icon aui-icon-small aui-iconfont-refresh-small">', soy.$$escapeHtml("Refresh results"), '</span></a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/templates/issuenav-pagination.soy' */
// This file was automatically generated from issuenav-pagination.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.pagination = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="pagination" data-displayable-total="', soy.$$escapeHtml(opt_data.displayableTotal), '">');
  var MAX_PAGES_DISPLAYED__soy6 = 5;
  var lastPage__soy7 = Math.floor((opt_data.displayableTotal - 1) / opt_data.pageSize);
  var pageNumber__soy8 = Math.floor(opt_data.startIndex / opt_data.pageSize);
  var urlFragment__soy9 = new soy.StringBuilder(soy.$$escapeHtml(""), '/', opt_data.searchQuery, '&startIndex=');
  urlFragment__soy9 = urlFragment__soy9.toString();
  var prevStartIndex__soy15 = opt_data.startIndex - opt_data.pageSize;
  output.append((prevStartIndex__soy15 >= 0) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(prevStartIndex__soy15) + '" data-start-index="' + soy.$$escapeHtml(prevStartIndex__soy15) + '" class="icon icon-previous" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8,lastPage__soy7 + 1)) + '"><span>&lt;&lt; ' + soy.$$escapeHtml("Previous") + '</span></a>' : '');
  JIRA.Templates.IssueNavTable.numberLinksLogicBranch({startPage: pageNumber__soy8 - Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), endPage: pageNumber__soy8 + Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), lastPage: lastPage__soy7, urlFragment: urlFragment__soy9, currentPage: pageNumber__soy8 + 1, maxPagesDisplayed: MAX_PAGES_DISPLAYED__soy6, pageSize: opt_data.pageSize, displayableTotal: opt_data.displayableTotal}, output);
  var nextStartIndex__soy37 = Math.min(opt_data.startIndex + opt_data.pageSize, opt_data.displayableTotal);
  output.append((nextStartIndex__soy37 < opt_data.displayableTotal) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(nextStartIndex__soy37) + '" data-start-index="' + soy.$$escapeHtml(nextStartIndex__soy37) + '" class="icon icon-next" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8 + 2,lastPage__soy7 + 1)) + '"><span>' + soy.$$escapeHtml("Next") + ' &gt;&gt;</span></a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinksLogicBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastPage < opt_data.maxPagesDisplayed) {
    JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.lastPage}), output);
  } else {
    if (opt_data.startPage < 0) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.endPage - opt_data.startPage}), output);
    } else if (opt_data.endPage > opt_data.lastPage) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: opt_data.startPage - (opt_data.endPage - opt_data.lastPage), endPage: opt_data.lastPage}), output);
    } else {
      JIRA.Templates.IssueNavTable.numberLinks(opt_data, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinks = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var size__soy72 = opt_data.endPage - opt_data.startPage + 1;
  if (size__soy72 > 1) {
    var iLimit75 = Math.round(size__soy72);
    for (var i75 = 0; i75 < iLimit75; i75++) {
      var pageIndex__soy76 = i75 + opt_data.startPage;
      var pageNumber__soy77 = pageIndex__soy76 + 1;
      var pageStartIndex__soy78 = pageIndex__soy76 * opt_data.pageSize;
      var pageEndIndex__soy79 = Math.min(pageStartIndex__soy78 + opt_data.pageSize, opt_data.displayableTotal);
      var pageBoundaries__soy80 = new soy.StringBuilder(soy.$$escapeHtml(AJS.format("Issues {0} - {1}",pageStartIndex__soy78 + 1,pageEndIndex__soy79)));
      pageBoundaries__soy80 = pageBoundaries__soy80.toString();
      output.append(' ', (pageNumber__soy77 == opt_data.currentPage) ? '<strong title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</strong>' : '<a href="' + soy.$$escapeHtml(opt_data.urlFragment) + soy.$$escapeHtml(pageStartIndex__soy78) + '" data-page="' + soy.$$escapeHtml(pageNumber__soy77) + '" data-start-index="' + soy.$$escapeHtml(pageStartIndex__soy78) + '" title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</a>');
    }
  }
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/templates/issuenav-table.soy' */
// This file was automatically generated from issuenav-table.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.structure = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="list-view"><div class="aui-group aui-group-split issue-table-info-bar"><div class="aui-item"><div class="results-count-top"></div><div class="refresh-table-top"></div></div><div class="aui-item"><div class="column-picker-trigger-container"></div></div></div><div class="issue-table-container"></div><div class="end-of-stable-message"></div><div class="aui-group aui-group-split count-pagination"><div class="aui-item"><div class="results-count-bottom"></div><div class="refresh-table-bottom"></div></div><div class="aui-item"><div class="pagination"></div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-adbox jira-adbox-medium no-results ', soy.$$escapeHtml(opt_data.cssClass), '"><h3>', opt_data.message, '</h3>', (opt_data.hint) ? '<p class="no-results-hint">' + opt_data.hint + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.listOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list">');
  var groupList20 = opt_data.groups;
  var groupListLen20 = groupList20.length;
  for (var groupIndex20 = 0; groupIndex20 < groupListLen20; groupIndex20++) {
    var groupData20 = groupList20[groupIndex20];
    output.append((groupData20.label) ? '<h5>' + soy.$$escapeHtml(groupData20.label) + '</h5>' : '', '<ul ', (groupData20.id) ? 'id="' + soy.$$escapeHtml(groupData20.id) + '"' : '', ' class="aui-list-section', (groupIndex20 == 0) ? ' aui-first' : '', (groupIndex20 == groupListLen20 - 1) ? ' aui-last' : '', '">');
    var itemList40 = groupData20.items;
    var itemListLen40 = itemList40.length;
    for (var itemIndex40 = 0; itemIndex40 < itemListLen40; itemIndex40++) {
      var itemData40 = itemList40[itemIndex40];
      output.append('<li class="aui-list-item"><a class="aui-list-item-link" ', (itemData40.id) ? 'id="' + soy.$$escapeHtml(itemData40.id) + '"' : '', ' ', (itemData40.rel) ? 'rel="' + soy.$$escapeHtml(itemData40.rel) + '"' : '', ' href="', (! itemData40.relativeLink) ? soy.$$escapeHtml("") : '', soy.$$escapeHtml(itemData40.link), '" ', (itemData40.title) ? 'title="' + soy.$$escapeHtml(itemData40.title) + '"' : '', '>', soy.$$escapeHtml(itemData40.label), '</a></li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.views = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.sections.issue && opt_data.sections.issue.length > 0) {
    output.append('<div class="issue-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.issue}, output);
    output.append('</div>');
  }
  if (opt_data.sections.filter && opt_data.sections.filter.length > 0) {
    output.append('<div class="filter-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.filter}, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.tools = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavTable.listOptions(opt_data, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="issuerow inaccessible-issue" rel="', soy.$$escapeHtml(opt_data.issueID), '"><td class="nav" colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</td></tr>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.headerSortIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-', (opt_data.order == 'ASC') ? 'up' : 'down', ' issuetable-header-sort-icon"></span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/EmptyResults.js' */
AJS.namespace("JIRA.Components.IssueTable.Views.EmptyResults");JIRA.Components.IssueTable.Views.EmptyResults=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNavTable.noResults,serializeData:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca\u003elogging in\u003c/a\u003e to see more results";b="not-logged-in-message";a="login"}else{if(this.options.jiraHasIssues===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca\u003ecreate an issue\u003c/a\u003e":null;b="empty-results-message";this.linkType="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca\u003ecreating a new issue\u003c/a\u003e":"Try modifying your search criteria";b="no-results-message";this.linkType="create"}}return{message:d,hint:e,cssClass:b}},onRender:function(){this.$el.addClass("empty-results");var a=this.$(".no-results-hint a");if(!JIRA.Issues.LoginUtils.isLoggedIn()){a.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link")}else{a.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa")}this.hidePending()},showPending:function(){this.$el.addClass("pending")},hidePending:function(){this.$el.removeClass("pending")}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/EndOfStableMessage.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.EndOfStableMessage");JIRA.Components.IssueNavigator.Views.EndOfStableMessage=JIRA.Marionette.ItemView.extend({className:"end-of-stable-message",serializeData:function(){return this.options},getTemplate:function(){return(this.shouldRender)?JIRA.Templates.IssueNav.endOfStableMessage:jQuery.noop},onBeforeRender:function(){this.shouldRender=this._hasMoreIssues()&&this._onLastPage()},onRender:function(){if(this.shouldRender){this.$el.addClass("visible")}else{this.$el.removeClass("visible")}},_hasMoreIssues:function(){return !!(this.options.total-this.options.displayableTotal)},_onLastPage:function(){return this.options.pageNumber===this.options.numberOfPages}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/IssueTable.js' */
AJS.namespace("JIRA.Components.IssueTable.Views.IssueTable");JIRA.Components.IssueTable.Views.IssueTable=JIRA.Marionette.ItemView.extend({events:{"blur .hidden-link":function(a){jQuery(a.target).attr("tabIndex",-1)},"click tr.issuerow":function(a){var c=jQuery(a.target).closest(".issuerow");var b=Number(c.attr("rel"));this.trigger("highlightIssue",b)},"click .sortable":function(a){a.preventDefault();this.trigger("sort",jQuery(a.currentTarget).data("id"))}},inaccessibleIssueRowTemplate:JIRA.Templates.IssueNavTable.inaccessibleIssueRow,initialize:function(a){this.resultsTable=a.resultsTable;this.sortOptions=a.sortOptions||{}},render:function(){this.triggerMethod("before:render",this);var a=jQuery(this.resultsTable)[0];this.$el.empty().append(a);this.triggerMethod("render",this);return this},onRender:function(){this._decorateTableHeaderWithSortOptions();this._addDraggable();this._removeEmptyTextNodes()},onClose:function(){this._removeDraggable()},_decorateTableHeaderWithSortOptions:function(){var a=this.$el.find(".rowHeader .sortable");a.each(function(){this.onclick=null});var d=this.sortOptions;if(d.fieldId){var c=a.filter(function(){return this.getAttribute("data-id")===d.fieldId});if(c.size()&&!c.hasClass("descending")&&!c.hasClass("ascending")){a.removeClass("descending ascending active").addClass("colHeaderLink");a.find(".issuetable-header-sort-icon").remove();var b=d.order==="DESC"?"descending":"ascending";c.removeClass("colHeaderLink").addClass("active "+b);c.append(JIRA.Templates.IssueNavTable.headerSortIcon({order:d.order}))}}},_addDraggable:function(){this.$("#issuetable").dragtable({maxMovingRows:1,containment:"body",axis:false,revert:false,clickDelay:250,tolerance:"intersect",dragaccept:":not(.headerrow-actions)",persistState:_.bind(this._saveColumns,this)})},_removeDraggable:function(){this.$("#issuetable").dragtable("destroy")},_removeEmptyTextNodes:function(){this.$el.find("table, tbody, thead, tr").contents().filter(function(){return this.nodeType===3}).remove()},_saveColumns:function(){var a=[];this.$("#issuetable").find("th").each(function(){var b=jQuery(this).data("id");if(_.isNotBlank(b)){a.push(b)}});this.trigger("columnsChanged",a)},highlightIssue:function(d,a){var c=this._getIssueRow(d);var b=this.$(".focused");b.removeClass("focused");c.addClass("focused");if(c.length&&c.closest(document.body).length){if(a!==false){c.find(".hidden-link").removeAttr("tabIndex").focus()}c.scrollIntoView({marginBottom:50})}},_getIssueRow:function(b,a){a=a||this.$el;return a.find(".issuerow").filter(function(){return this.getAttribute("rel")==b})},markIssueAsInaccessible:function(a){this._getIssueRow(a).replaceWith(this.inaccessibleIssueRowTemplate({columnCount:this.$el.find("thead > tr > th").length,issueID:a}))},updateIssue:function(c,b){var a=this._getIssueRow(c,jQuery(b));this._getIssueRow(c).replaceWith(a);this.highlightIssue(c);this.trigger("issueRowUpdated",a)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/IssueTableLayout.js' */
AJS.namespace("JIRA.Components.IssueTable.Views.IssueTableLayout");JIRA.Components.IssueTable.Views.IssueTableLayout=JIRA.Marionette.Layout.extend({template:JIRA.Templates.IssueNavTable.structure,regions:{pagination:{selector:".pagination",regionType:JIRA.Marionette.ReplaceRegion},table:".issue-table-container",resultsCountTop:{selector:".results-count-top",regionType:JIRA.Marionette.ReplaceRegion},refreshResultsTop:{selector:".refresh-table-top",regionType:JIRA.Marionette.ReplaceRegion},resultsCountBottom:{selector:".results-count-bottom",regionType:JIRA.Marionette.ReplaceRegion},refreshResultsBottom:{selector:".refresh-table-bottom",regionType:JIRA.Marionette.ReplaceRegion},endOfStableMessage:{selector:".end-of-stable-message",regionType:JIRA.Marionette.ReplaceRegion}},onRender:function(){this.hidePending()},showPending:function(){this.$el.addClass("pending")},hidePending:function(){this.$el.removeClass("pending")}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/Pagination.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.Pagination");JIRA.Components.IssueNavigator.Views.Pagination=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNavTable.pagination,events:{"simpleClick a[data-start-index]":function(a){a.preventDefault();var b=a.target.getAttribute("data-start-index");this.trigger("goToPage",parseInt(b,10))}},serializeData:function(){return{startIndex:this.options.startIndex,pageSize:this.options.pageSize,searchQuery:this._getPagingUri(),displayableTotal:this.options.total}},onRender:function(){this.unwrapTemplate()},_getPagingUri:function(){return JIRA.Issues.URLSerializer.getURLFromState({selectedIssueKey:null,jql:this.options.currentSearch.jql,filter:this.options.currentSearch.filterId})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/RefreshResults.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.RefreshResults");JIRA.Components.IssueNavigator.Views.RefreshResults=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNav.refreshResults,triggers:{click:"refresh"},onRender:function(){this.unwrapTemplate()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/ResultsCount.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.ResultsCount");JIRA.Components.IssueNavigator.Views.ResultsCount=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNav.resultsCount,serializeData:function(){var b=this.options.total;var c=this.options.startIndex+1;var a=this.options.startIndex+this.options.pageSize;return{start:c,end:Math.min(a,b),total:b}},onRender:function(){this.unwrapTemplate()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/controllers/IssueTable.js' */
AJS.namespace("JIRA.Components.IssueTable.Controllers.IssueTable");JIRA.Components.IssueTable.Controllers.IssueTable=JIRA.Marionette.Controller.extend({initialize:function(a){this.$el=jQuery(a.el)},_createMainView:function(){return new JIRA.Components.IssueTable.Views.IssueTableLayout()},_createTableView:function(a,c){var b=new JIRA.Components.IssueTable.Views.IssueTable({resultsTable:a,sortOptions:c});this.listenAndRethrow(b,"columnsChanged");this.listenAndRethrow(b,"highlightIssue");this.listenAndRethrow(b,"issueRowUpdated");this.listenAndRethrow(b,"sort");return b},_createResultsCount:function(a){return new JIRA.Components.IssueNavigator.Views.ResultsCount(a)},_createPagination:function(b){var a=new JIRA.Components.IssueNavigator.Views.Pagination(b);this.listenAndRethrow(a,"goToPage");return a},_createRefreshResults:function(){var a=new JIRA.Components.IssueNavigator.Views.RefreshResults();this.listenAndRethrow(a,"refresh");return a},_createEndOfStableMessage:function(a){return new JIRA.Components.IssueNavigator.Views.EndOfStableMessage(a)},_createEmptyResultsView:function(a){return new JIRA.Components.IssueTable.Views.EmptyResults(a)},_layoutIsRendered:function(){return this.view&&this.view instanceof JIRA.Components.IssueTable.Views.IssueTableLayout},close:function(){if(this.view){this.view.close();delete this.view}},show:function(a){if(a.hasIssues){this._showTable(a)}else{this._showEmptyResults(a)}},showErrorMessage:function(a){this._showEmptyResults(a)},showPending:function(){if(this.view){this.view.showPending();if(this._layoutIsRendered()){this.view.table.currentView._removeDraggable()}}},_showTable:function(d){d=d||{};this.close();this.view=this._createMainView();var e=this._createTableView(d.table,d.sortOptions);var c=this._createResultsCount({total:d.totalIssues,startIndex:d.startIndex,pageSize:d.pageSize});var b=this._createResultsCount({total:d.totalIssues,startIndex:d.startIndex,pageSize:d.pageSize});var a=this._createPagination({startIndex:d.startIndex,pageSize:d.pageSize,total:d.totalIssues,currentSearch:d.currentSearch});var f=this._createEndOfStableMessage({total:d.totalIssues,displayableTotal:d.totalDisplayableIssues,pageNumber:d.pageNumber,numberOfPages:d.numberOfPages});this.listenTo(this.view,{render:function(){this.view.table.show(e);this.view.resultsCountTop.show(c);this.view.resultsCountBottom.show(b);this.view.pagination.show(a);this.view.refreshResultsTop.show(this._createRefreshResults());this.view.refreshResultsBottom.show(this._createRefreshResults());this.view.endOfStableMessage.show(f)}});this.view.render();this.$el.empty().append(this.view.$el);this.trigger("renderTable",this.$el)},_showEmptyResults:function(a){this.close();this.view=this._createEmptyResultsView(a);this.view.render();this.$el.empty().append(this.view.$el);this.trigger("renderEmpty",this.$el)},highlightIssue:function(b,a){if(this._layoutIsRendered()){this.view.table.currentView.highlightIssue(b,a)}},markIssueAsInaccessible:function(a){if(this._layoutIsRendered()){this.view.table.currentView.markIssueAsInaccessible(a)}},updateIssue:function(b,a){if(this._layoutIsRendered()){this.view.table.currentView.updateIssue(b,a)}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/search/Search.js' */
AJS.namespace("JIRA.Components.SearchService");JIRA.Components.SearchService=JIRA.Marionette.Controller.extend({initialize:function(a){this.searchModule=a.searchModule;this.searchResults=a.searchResults;this.columnConfig=a.columnConfig;_.bindAll(this,"_onIssueUpdated","_onHighlightedIssueChange","_onSelectedIssueChange","_onBeforeSearch");this.listenTo(this.searchResults,"change:resultsId change:startIndex stableUpdate issueDeleted",function(){this._doSearch()});this.searchResults.onIssueUpdated(this._onIssueUpdated);this.searchResults.onHighlightedIssueChange(this._onHighlightedIssueChange);this.searchResults.onSelectedIssueChange(this._onSelectedIssueChange);this.searchModule.onBeforeSearch(this._onBeforeSearch)},_onSelectedIssueChange:function(a){this.trigger("selectedIssueChanged",a,this.searchResults.getHighlightedIssue())},_onIssueUpdated:function(c,a,b){this.trigger("issueUpdated",c,a,b)},_onHighlightedIssueChange:function(a){this.trigger("issueHighlighted",a.getId())},_onBeforeSearch:function(){this.trigger("before:search")},close:function(){this.stopListening();this.searchResults.offIssueUpdated(this._onIssueUpdated);this.searchResults.offHighlightedIssueChange(this._onHighlightedIssueChange)},_doSearch:function(){this.searchInProgress=true;var a=this.searchModule.getFilterId();var b=a<0;a=(b||_.isNull(a))?undefined:a;this.searchResults.getResultsForPage({jql:this.searchModule.getEffectiveJql(),filterId:a}).always(_.bind(function(){this.searchInProgress=false},this)).done(_.bind(function(c){if(!this.searchResults.hasHighlightedIssue()){this.searchResults.highlightFirstInPage()}this.trigger("search",c,this.searchResults)},this)).fail(_.bind(function(){this.trigger("error:search")},this))},goToPage:function(a){if(this.searchInProgress){return}this.searchResults.goToPage(a)},sort:function(b){if(this.searchInProgress){return}var c=this.searchModule.getResults().getColumnSortJql();var a=c[b];if(a){this.searchModule.doSort(a)}},runCurrentSearch:function(){if(this.searchInProgress){return}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");this.searchModule.refresh()}},updateExitingResults:function(){if(this.searchInProgress){return}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");this._doSearch()}},highlightIssue:function(a){this.searchResults.highlightIssueById(a)},getPager:function(){return this.searchResults.getPager()},selectNextIssue:function(){this.searchResults.highlightNextIssue();if(this.searchResults.hasSelectedIssue()){require("jira/issues/navigator/metrics").notifyIssueView();this.searchResults.selectNextIssue()}},selectPreviousIssue:function(){this.searchResults.highlightPrevIssue();if(this.searchResults.hasSelectedIssue()){require("jira/issues/navigator/metrics").notifyIssueView();this.searchResults.selectPrevIssue()}},unselectIssue:function(){this.searchResults.unselectIssue()},hasSelectedIssue:function(){return this.searchResults.hasSelectedIssue()},getHighlightedIssue:function(){return this.searchResults.getHighlightedIssue().id}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/templates/issuenav-searchheader.soy' */
// This file was automatically generated from issuenav-searchheader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavSearchHeader == 'undefined') { JIRA.Templates.IssueNavSearchHeader = {}; }


JIRA.Templates.IssueNavSearchHeader.layoutSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-buttons"><button id="layout-switcher-button" class="aui-button aui-button-light drop-arrow js-default-dropdown" type="button"><span class="aui-icon aui-icon-small ', soy.$$escapeHtmlAttribute(opt_data.activeLayout.iconClass), '"></span></button><div class="aui-list hidden"><h5>', soy.$$escapeHtml("Views"), '</h5><ul class="aui-list-section aui-first aui-last">');
  var layoutList8 = opt_data.layouts;
  var layoutListLen8 = layoutList8.length;
  for (var layoutIndex8 = 0; layoutIndex8 < layoutListLen8; layoutIndex8++) {
    var layoutData8 = layoutList8[layoutIndex8];
    output.append('<li class="aui-list-item layout-switcher-item"><a href="#" class="aui-list-item-link" data-layout-key="', soy.$$escapeHtmlAttribute(layoutData8.id), '"><span class="aui-icon aui-icon-small ', (opt_data.activeLayout.id == layoutData8.id) ? 'aui-iconfont-success' : '', '"></span>', soy.$$escapeHtml(layoutData8.label), '</a>');
  }
  output.append('</ul></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/LayoutSwitcherView.js' */
Backbone.define("JIRA.Issues.LayoutSwitcherView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavSearchHeader.layoutSwitcher,initialize:function(a){_.bindAll(this,"_onLayoutSwitchClick");this.searchPageModule=a.searchPageModule;this.searchPageModule.on("change:currentLayout",this.render,this)},render:function(){this.$el.html(this.template({layouts:this.searchPageModule.getSortedLayouts(),activeLayout:this.searchPageModule.getActiveLayout()}));this._addLayoutSwitcherTooltip();this.$el.find(".aui-list-item-link").click(this._onLayoutSwitchClick);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.layoutSwitcherReady]);return this},enableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").removeClass("disabled").removeAttr("disabled");return this},disableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").addClass("disabled").attr("disabled","");return this},createHelptipForSwitchingToDetailView:function(b){var a;if(this._shouldShowIntro()&&this.$el.is(":visible")){a=new AJS.HelpTip({id:"split-view-intro",title:"Choose how you view issues",url:AJS.Meta.get("issue-search-help-url"),bodyHtml:"Switch between the details and list views to suit your preference.",anchor:".view-selector button",isSequence:true,weight:b})}return a},_shouldShowIntro:function(){return this.searchPageModule.search.getResults().hasIssues()},_addLayoutSwitcherTooltip:function(){function a(){var b=AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts");if(b){return AJS.format("Change view (Type \'\'{0}\'\')",AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts"))}else{return "Change view"}}new JIRA.Issues.Tipsy({el:this.$el.find("#layout-switcher-button"),showCondition:":not(.active)",tipsy:{title:a,gravity:"ne"}})},_onLayoutSwitchClick:function(c,a){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){var b=AJS.$(c.target).closest("[data-layout-key]").data("layout-key");c.preventDefault();if(b==="split-view"){require("jira/issues/navigator/metrics").notifyIssueNavDetail()}else{if(b==="list-view"){require("jira/issues/navigator/metrics").notifyIssueNavList()}}this.searchPageModule.changeLayout(b,a)}}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/SearchHeaderModule.js' */
Backbone.define("JIRA.Issues.SearchHeaderModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule},registerSearch:function(a){this._search=a},createToolsView:function(a){new JIRA.Issues.IssueTableHeaderOperationsView({el:a,search:this._search,searchPageModule:this._searchPageModule})}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/Filters.js' */
AJS.namespace("JIRA.Components.Filters");JIRA.Components.Filters=JIRA.Marionette.Controller.extend({initialize:function(a){this._initializeDialogController();this.searchPageModule=a.searchPageModule;this._initializeCollections(a);this._initializeSystemFiltersController();this._initializeFavouriteFiltersController();this._initializeFilterHeaderController()},_initializeCollections:function(a){this.systemFiltersCollection=new JIRA.Components.Filters.Collections.SystemFilters(a.systemFilters);this.favouriteFiltersCollection=new JIRA.Components.Filters.Collections.FavouriteFilters([]);this.listenTo(this.favouriteFiltersCollection,{"change:favourite":function(c,b){if(!b){this.favouriteFiltersCollection.remove(c)}},remove:function(b){this.trigger("filterUnfavourited",{filterId:b.getId()})}})},_initializeDialogController:function(){this.dialogController=new JIRA.Components.Filters.Controllers.Dialog();this.listenTo(this.dialogController,"delete:success",function(a){this.favouriteFiltersCollection.remove(a);this.trigger("filterRemoved",{filterId:a.getId()});JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e has been deleted.",AJS.escapeHtml(a.getName())),JIRA.Issues.getDefaultMessageOptions());JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"delete:error",function(){JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"rename:success",function(a){JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e has been renamed.",AJS.escapeHtml(a.getName())),JIRA.Issues.getDefaultMessageOptions());JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"rename:error",function(){JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"copy:success",function(a){this.trigger("newFilter",a);this._addFavouriteFilter(a);JIRA.trace("jira.filter.saved")},this);this.listenTo(this.dialogController,"copy:error",function(){JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"saveas:success",function(a){this.trigger("newFilter",a);this._addFavouriteFilter(a);JIRA.trace("jira.filter.saved")},this);this.listenTo(this.dialogController,"saveas:error",function(){JIRA.trace("jira.filter.saved")})},_initializeSystemFiltersController:function(){this.systemFiltersController=new JIRA.Components.Filters.Controllers.List({collection:this.systemFiltersCollection,className:"system-filters",errorMessage:"Failed to retrieve system filters from server.",loadingMessage:"Loading system filters...",emptyMessage:"There are no system filters.",loginMessage:AJS.format("You must be {0}logged in{1} to view system filters.",'<a class="login-link" href="'+JIRA.Issues.LoginUtils.redirectUrlToCurrent()+'">',"</a>")});this.systemFiltersController.on("selectFilter",function(a){this.headerController.closeDetails();this.trigger("filterSelected",a.id)},this)},_initializeFavouriteFiltersController:function(){this.favouriteFiltersController=new JIRA.Components.Filters.Controllers.ListWithActions({collection:this.favouriteFiltersCollection,className:"favourite-filters",title:"Favorite Filters",errorMessage:"Failed to retrieve favorite filters from server.",loadingMessage:"Loading favorite filters...",emptyMessage:"You don\'t have any favorite filters.",loginMessage:AJS.format("You must be {0}logged in{1} to view favorite filters.",'<a class="login-link" href="'+JIRA.Issues.LoginUtils.redirectUrlToCurrent()+'">',"</a>")});this.favouriteFiltersController.on("selectFilter",function(a){this.headerController.closeDetails();this.trigger("filterSelected",a.id)},this);this.favouriteFiltersController.on("deleteFilter",function(a){this.showDeleteDialog(a.id)},this);this.favouriteFiltersController.on("renameFilter",function(a){this.showRenameDialog(a.id)},this);this.favouriteFiltersController.on("copyFilter",function(a){this.showCopyDialog(a.id)},this);this.favouriteFiltersController.on("unfavouriteFilter",function(a){a.saveFavourite(false)},this);this.favouriteFiltersController.on("list:render",function(){this.trigger("list:render")},this)},_initializeFilterHeaderController:function(){this.headerController=new JIRA.Components.Filters.Controllers.Header();this.listenTo(this.headerController,"saveAs",function(a){this.showSaveAsDialog(a)});this.listenTo(this.headerController,"save",function(b){var a=AJS.escapeHtml(b.getName());b.saveFilter(this.searchPageModule.getEffectiveJql()).done(_.bind(function(){JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e has been successfully saved.",a),JIRA.Issues.getDefaultMessageOptions());this.trigger("savedFilter",b)},this)).fail(function(){JIRA.Messages.showErrorMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e could not be saved.",a),JIRA.Issues.getDefaultMessageOptions())})});this.listenTo(this.headerController,"discard",function(){this.trigger("filterDiscarded")});this.listenTo(this.headerController,"favourite",function(a){a=this._addFavouriteFilter(a);this.highlightFilter(a);this.trigger("fitlerFavourited",a)})},_addFavouriteFilter:function(b){var a=!!b.getFavourite();var c=!!this.favouriteFiltersCollection.get(b.getId());if(a&&!c){this.favouriteFiltersCollection.add(b)}return this.favouriteFiltersCollection.get(b.getId())},getFilterByIdFromExistingCollections:function(a){return this.systemFiltersCollection.get(a)||this.favouriteFiltersCollection.get(a)},getFilterById:function(b){var d=this.getFilterByIdFromExistingCollections(b);var a=jQuery.Deferred();if(d){a.resolve(d)}else{var c=new JIRA.Components.Filters.Models.Filter({id:b});c.fetch({success:_.bind(function(){if(c.getFavourite()){this.favouriteFiltersCollection.add(c,{merge:true});a.resolve(this.favouriteFiltersCollection.get(c.id))}else{if(c.getIsSystem()){this.systemFiltersCollection.add(c,{merge:true});a.resolve(this.systemFiltersCollection.get(c.id))}else{a.resolve(c)}}},this),error:function(){c.setIsValid(false);a.reject.apply(this,arguments)}})}return a.promise()},showDeleteDialog:function(a){this.getFilterById(a).done(_.bind(function(b){this.dialogController.showDeleteDialog(b)},this))},showRenameDialog:function(a){this.getFilterById(a).done(_.bind(function(b){this.dialogController.showRenameDialog(b)},this))},showCopyDialog:function(a){this.getFilterById(a).done(_.bind(function(b){this.dialogController.showCopyDialog(b)},this))},showSaveAsDialog:function(a){this.searchPageModule.getJqlDeferred().done(_.bind(function(b){this.dialogController.showSaveAsDialog(a,b)},this))},showSystemFilters:function(a){this.systemFiltersController.show(a)},showFavouriteFilters:function(a){this.favouriteFiltersController.show(a)},showFilterHeader:function(a){this.headerController.show({el:a.el,model:a.model,isEdited:a.isEdited,isDirty:a.isDirty})},updateFilterHeader:function(a){this.headerController.update({model:a.model,isEdited:a.isEdited||false,isDirty:a.isDirty||false})},highlightFilter:function(a){this.systemFiltersController.highlightFilter(a);this.favouriteFiltersController.highlightFilter(a)},markFilterHeaderAsInvalid:function(){this.headerController.markAsInvalid()},fetchSystemFilters:function(){return this.systemFiltersCollection.fetch()},fetchFavouriteFilters:function(){return this.favouriteFiltersCollection.fetch({reset:true})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/Filter.js' */
AJS.namespace("JIRA.Components.Filters.Models.Filter");JIRA.Components.Filters.Models.Filter=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","description","jql","favourite","isSystem","sharePermissions","subscriptions","ownerUserName","ownerDisplayName","avatarUrl","requiresLogin","isValid"],defaults:{isSystem:false,isValid:true},urlRoot:AJS.contextPath()+"/rest/api/2/filter/",getOwner:function(){return this.getOwnerDisplayName()||this.getOwnerUserName()},isFavouriteFilter:function(){return !this.getIsSystem()&&!!this.getFavourite()},url:function(){return this.urlRoot+encodeURIComponent(this.id)+"?expand=subscriptions[-5:]"},isMyFilter:function(){return !this.getIsSystem()&&this.getOwnerUserName()===JIRA.Issues.LoginUtils.loggedInUserName()},parse:function(a){if(a.subscriptions&&a.subscriptions.items){a.subscriptions.items.reverse()}return{id:a.id,name:a.name,description:a.description,jql:a.jql,isSystem:a.isSystem,favourite:a.favourite,sharePermissions:a.sharePermissions||[],subscriptions:a.subscriptions,ownerUserName:a.owner&&a.owner.name,ownerDisplayName:a.owner&&a.owner.displayName,avatarUrl:a.owner&&a.owner.avatarUrls["48x48"],requiresLogin:a.requiresLogin}},getNumberOfAdditionalSubscriptions:function(){var a=this.getSubscriptions();return a.size>a.items.length?a.size-a.items.length:0},saveFavourite:function(b){var a=this;var c=this.getFavourite();this.setFavourite(b);if(this.pendingRequest){this.pendingRequest.abort()}this.pendingRequest=JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/1.0/filters/"+encodeURIComponent(this.getId())+"/favourite",type:b?"PUT":"DELETE"}).done(function(d){var e=AJS.$(d).text().match(/favourite state: (\w+)/)[1]==="true";delete a.pendingRequest;a.setFavourite(e)}).fail(function(){a.setFavourite(c)});return this.pendingRequest},saveFilter:function(c){if(this.pendingRequest){this.pendingRequest.abort()}var b=this.toJSON();var d={id:b.id,name:b.name,jql:c,favourite:b.favourite};var a=this;this.pendingRequest=JIRA.SmartAjax.makeRequest({url:this.url(),type:"PUT",contentType:"application/json",data:JSON.stringify(d)}).done(function(e){a.set(a.parse(e))}).then(function(){delete a.pendingRequest;JIRA.trace("jira.filter.saved")});return this.pendingRequest},toJSON:function(){var a=JIRA.Issues.BaseModel.prototype.toJSON.apply(this);_.extend(a,{requiresLoginForUser:this._requiresLoginForUser(this.getRequiresLogin()),navUrl:this._constructNavUrl(this.getId(),this.getRequiresLogin())});return a},_requiresLoginForUser:function(a){return !JIRA.Issues.LoginUtils.isLoggedIn()&&a},_constructNavUrl:function(a,b){var c="/issues/?filter="+a;if(this._requiresLoginForUser(b)){return JIRA.Issues.LoginUtils.redirectUrl(c)}else{return AJS.contextPath()+c}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/Filters.js' */
AJS.namespace("JIRA.Components.Filters.Collections.Filters");JIRA.Components.Filters.Collections.Filters=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.Filters.Models.Filter,fetch:function(){var a=JIRA.Issues.Brace.Collection.prototype.fetch.apply(this,arguments);a.done(_.bind(function(){this.fetchState="fetched";this.trigger("change:fetchState",this.fetchState)},this));a.fail(_.bind(function(){this.fetchState="error";this.trigger("change:fetchState",this.fetchState)},this));return a},initialize:function(b,a){a=a||{};this.fetchState=a.fetchState}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/SystemFilters.js' */
AJS.namespace("JIRA.Components.Filters.Collections.SystemFilters");JIRA.Components.Filters.Collections.SystemFilters=JIRA.Components.Filters.Collections.Filters.extend({_setFetchState:function(b){var a=b!==this.fetchState;this.fetchState=b;if(a){this.trigger("change:fetchState",this.fetchState)}},url:AJS.contextPath()+"/rest/issueNav/latest/systemFilters",fetch:function(){if(this.length>0){this._setFetchState("fetched");return jQuery.Deferred().resolve()}return JIRA.Components.Filters.Collections.Filters.prototype.fetch.apply(this,_.toArray(arguments))}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/FavouriteFilters.js' */
AJS.namespace("JIRA.Components.Filters.Collections.FavouriteFilters");JIRA.Components.Filters.Collections.FavouriteFilters=JIRA.Components.Filters.Collections.Filters.extend({url:AJS.contextPath()+"/rest/api/2/filter/favourite?expand=subscriptions[-5:]",comparator:function(b,a){return b.getName().toLowerCase().localeCompare(a.getName().toLowerCase())}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/actions.soy' */
// This file was automatically generated from actions.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Actions == 'undefined') { JIRA.Components.Filters.Templates.Actions = {}; }


JIRA.Components.Filters.Templates.Actions.DropDown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list"><ul class="aui-list-section">', (opt_data.canEdit) ? '<li class="aui-list-item"><a href="" class="aui-list-item-link rename-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Rename") + '</a></li>' : '', '<li class="aui-list-item"><a href="" class="aui-list-item-link copy-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Copy"), '</a></li></ul><ul class="aui-list-section', (! opt_data.canEdit) ? ' aui-last' : '', '"><li class="aui-list-item"><a href="" class="aui-list-item-link unfavourite-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Remove from favorites"), '</a></li></ul>', (opt_data.canEdit) ? '<ul class="aui-list-section aui-last"><li class="aui-list-item"><a href="" class="aui-list-item-link delete-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Delete") + '</a></li></ul>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/dialogs.soy' */
// This file was automatically generated from dialogs.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Dialogs == 'undefined') { JIRA.Components.Filters.Templates.Dialogs = {}; }


JIRA.Components.Filters.Templates.Dialogs.Rename = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="rename-filter-form" method="put"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Rename Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2><div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name" value="', soy.$$escapeHtmlAttribute(opt_data.filter.name), '" class="text long-field"></div></div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Dialogs.Delete = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="delete-filter-form" method="delete"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Delete Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2>');
  if (opt_data.filter.subscriptions.items.length) {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("The filter {0} has the following subscriptions. Are you sure you want to delete it?",opt_data.filter.name)), '</p>');
    JIRA.Components.Filters.Templates.Details.SubscriptionList(opt_data, output);
    output.append('<p class="form-description"><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/ViewSubscriptions.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '">', soy.$$escapeHtml("Manage subscriptions"), '</a></p>');
  } else {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the filter {0}?",opt_data.filter.name)), '</p>');
  }
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Delete"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Dialogs.Save = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/rest/api/2/filter/" class="aui" id="save-filter-form" method="post"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.headerText), '</h2>', (opt_data.copyFromAnotherUser) ? '<p class="form-description">' + ((opt_data.filterOwnerName) ? soy.$$escapeHtml(AJS.format("This filter was created by {0}. You can save a copy of this filter but you cannot modify the original.",opt_data.filterOwnerName)) : soy.$$escapeHtml("You can save a copy of this filter but you cannot modify the original.")) + '</p>' : '', '<div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name"', (opt_data.prefilledFilterName) ? ' value="' + soy.$$escapeHtmlAttribute(opt_data.prefilledFilterName) + '"' : '', 'class="text long-field"><div class="description">', soy.$$escapeHtml("Enter a name for this Filter"), '</div>');
  var fieldList95 = opt_data.hiddenFields;
  var fieldListLen95 = fieldList95.length;
  for (var fieldIndex95 = 0; fieldIndex95 < fieldListLen95; fieldIndex95++) {
    var fieldData95 = fieldList95[fieldIndex95];
    output.append('<input type="hidden" name="', soy.$$escapeHtmlAttribute(fieldData95.name), '" value="', (fieldData95.value) ? soy.$$escapeHtmlAttribute(fieldData95.value) : '', '" />');
  }
  output.append('</div>', (opt_data.isDefaultShareScopeGlobal) ? '<div class="aui-message info shadowed"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml("By default your filters are shared with everyone.") + '</strong></p><input type="checkbox" id="setSharingPrivate" class="checkbox"><label for="setSharingPrivate">' + soy.$$escapeHtml("My filters should be private by default.") + '</label></div>' : '', '</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/list.soy' */
// This file was automatically generated from list.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.List == 'undefined') { JIRA.Components.Filters.Templates.List = {}; }


JIRA.Components.Filters.Templates.List.Module = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-panel-section">', (opt_data.title) ? '<h4 class="filter-title">' + soy.$$escapeHtml(opt_data.title) + '</h4>' : '', '<div class="filter-content" /></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.List.Message = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="filter-info ', soy.$$escapeHtmlAttribute(opt_data.className), '">', opt_data.text, '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.List.List = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="saved-filter filter-list ', soy.$$escapeHtmlAttribute(opt_data.className), '"></ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.List.Filter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="filter-link', (opt_data.requiresLoginForUser) ? ' requires-login' : '', '" href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.navUrl)), '" data-id="', soy.$$escapeHtmlAttribute(opt_data.id), '" title="', soy.$$escapeHtmlAttribute(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</a>', (opt_data.useActions) ? '<a href="#" class="filter-actions" data-id="' + soy.$$escapeHtmlAttribute(opt_data.id) + '"><span>' + soy.$$escapeHtml("Filter Actions") + '</span></a>' : '', '</li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/header.soy' */
// This file was automatically generated from header.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Header == 'undefined') { JIRA.Components.Filters.Templates.Header = {}; }


JIRA.Components.Filters.Templates.Header.Main = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="header-section-primary"><h1 class="search-title" title="', soy.$$escapeHtmlAttribute(opt_data.title), '">', soy.$$escapeHtml(opt_data.title), '</h1><ul class="filter-operations">', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<li class="filter-edited-item"><span>' + soy.$$escapeHtml("Edited") + '</span></li>' : '');
  if (opt_data.primaryButton) {
    output.append('<li>', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<div class="aui-buttons">' : '', '<button class="aui-button aui-button-light ', soy.$$escapeHtmlAttribute(opt_data.primaryButton.styleClass), '">', soy.$$escapeHtml(opt_data.primaryButton.label), '</button>');
    if (opt_data.primaryOps && opt_data.primaryOps.length) {
      output.append('<button class="aui-button aui-button-light aui-dropdown2-trigger js-edited-trigger" aria-owns="js-edited-content" aria-haspopup="true" data-container=".aui-buttons"></button></div><div id="js-edited-content" class="aui-dropdown2 aui-style-default"><ul>');
      var opList27 = opt_data.primaryOps;
      var opListLen27 = opList27.length;
      for (var opIndex27 = 0; opIndex27 < opListLen27; opIndex27++) {
        var opData27 = opList27[opIndex27];
        output.append('<li><a href="', (opData27.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData27.href)) : '#', '" ', (opData27.styleClass) ? 'class="' + soy.$$escapeHtmlAttribute(opData27.styleClass) + '"' : '', '>', soy.$$escapeHtml(opData27.label), '</a></li>');
      }
      output.append('</ul></div>');
    }
    output.append('</li>');
  }
  if (opt_data.owner) {
    var opList48 = opt_data.secondaryOps;
    var opListLen48 = opList48.length;
    for (var opIndex48 = 0; opIndex48 < opListLen48; opIndex48++) {
      var opData48 = opList48[opIndex48];
      output.append('<li><a href="', (opData48.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData48.href)) : '#', '" ', (opData48.title) ? 'title="' + soy.$$escapeHtmlAttribute(opData48.title) + '"' : '', ' class="', soy.$$escapeHtmlAttribute(opData48.styleClass), '">', (opData48.label) ? soy.$$escapeHtml(opData48.label) : '', '</a></li>');
    }
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/details.soy' */
// This file was automatically generated from details.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Details == 'undefined') { JIRA.Components.Filters.Templates.Details = {}; }


JIRA.Components.Filters.Templates.Details.Main = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.Filters.Templates.Details.Description(opt_data, output);
  JIRA.Components.Filters.Templates.Details.Permissions(opt_data, output);
  if (opt_data.userIsLoggedIn) {
    JIRA.Components.Filters.Templates.Details.Subscriptions(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Description = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section">');
  if (opt_data.owner) {
    JIRA.Components.Filters.Templates.Details.Owner(opt_data, output);
  }
  output.append((opt_data.filter.description) ? '<p class="filter-name">' + soy.$$escapeHtml(opt_data.filter.description) + ((opt_data.permissions.userHasEditPermission) ? ' <a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">(' + soy.$$escapeHtml("Edit") + ')</a>' : '') + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Permissions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section"><h4 class="section-header">', soy.$$escapeHtml("Permissions"), '</h4>');
  if (opt_data.sharePermissions && opt_data.sharePermissions.length > 0) {
    output.append('<p>', soy.$$escapeHtml("This filter is visible to:"), '</p><ul class="shared-filters">');
    var shareList49 = opt_data.sharePermissions;
    var shareListLen49 = shareList49.length;
    for (var shareIndex49 = 0; shareIndex49 < shareListLen49; shareIndex49++) {
      var shareData49 = shareList49[shareIndex49];
      JIRA.Components.Filters.Templates.Details.SharePermissionItem({type: shareData49.type, project: (shareData49.project) ? '<a href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(shareData49.project.key) + '">' + soy.$$escapeHtml(shareData49.project.name) + '</a>' : '', projectRole: (shareData49.role) ? soy.$$escapeHtml(shareData49.role.name) : '', group: (shareData49.group) ? soy.$$escapeHtml(shareData49.group.name) : ''}, output);
    }
    output.append('</ul>');
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter is only visible to you."), '</p>');
  }
  output.append((opt_data.permissions.userHasEditSharingPermission) ? '<p><a class="edit-permissions" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Edit permissions") + '</a></p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Subscriptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section full-section"><h4>', soy.$$escapeHtml("Subscriptions"), '</h4>');
  if (opt_data.subscriptions.items.length) {
    output.append('<p>', soy.$$escapeHtml("This filter has the following subscriptions:"), '</p>');
    JIRA.Components.Filters.Templates.Details.SubscriptionList(opt_data, output);
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter has no subscriptions."), '</p>');
  }
  output.append('<ul class="manage-links"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/FilterSubscription!default.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '&returnUrl=', soy.$$escapeUri(opt_data.returnUrl), '">', soy.$$escapeHtml("New subscription"), '</a></li>', (opt_data.subscriptions.items.length) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Manage subscriptions") + '</a></li>' : '', '</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.SharePermissionItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type == 'global') ? '<li>' + soy.$$escapeHtml("Everyone") + '</li>' : (opt_data.type == 'group') ? '<li>' + AJS.format("{0}Group{1}: {2}",'<strong>','</strong>',opt_data.group) + '</li>' : (opt_data.projectRole) ? '<li>' + AJS.format("{0}Project{1}: {2} {3}Role{4}: {5}",'<strong>','</strong>',opt_data.project,'<strong>','</strong>',opt_data.projectRole) + '</li>' : '<li>' + AJS.format("{0}Project{1}: {2}",'<strong>','</strong>',opt_data.project) + '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.SubscriptionList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul>');
  var subList150 = opt_data.filter.subscriptions.items;
  var subListLen150 = subList150.length;
  for (var subIndex150 = 0; subIndex150 < subListLen150; subIndex150++) {
    var subData150 = subList150[subIndex150];
    output.append((subData150.group) ? '<li>' + soy.$$escapeHtml(subData150.group.name) + '</li>' : '<li>' + soy.$$escapeHtml(subData150.user.displayName) + '</li>');
  }
  output.append((opt_data.filter.subscriptions.additionalLength) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml(AJS.format("{0} more",opt_data.filter.subscriptions.additionalLength)) + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Owner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-owner">', (opt_data.avatarUrl) ? '<span class="aui-avatar aui-avatar-large search-owner-avatar"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.avatarUrl)) + '" /></span></span>' : '', '<span class="search-owner-name">');
  var ownerLink__soy181 = new soy.StringBuilder();
  JIRA.Components.Filters.Templates.Details.OwnerLink(opt_data, ownerLink__soy181);
  ownerLink__soy181 = ownerLink__soy181.toString();
  output.append(AJS.format("Owned by {0}",ownerLink__soy181), '</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.OwnerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.ownerUrl)), '" class="user-hover" rel="', soy.$$escapeHtmlAttribute(opt_data.ownerUserName), '">', soy.$$escapeHtml(opt_data.owner), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/Actions.js' */
AJS.namespace("JIRA.Components.Filters.Views.Actions");JIRA.Components.Filters.Views.Actions=JIRA.Marionette.ItemView.extend({template:JIRA.Components.Filters.Templates.Actions.DropDown,triggers:{"click .rename-filter":"renameFilter","click .copy-filter":"copyFilter","click .unfavourite-filter":"unfavouriteFilter","click .delete-filter":"deleteFilter"},triggerView:null,dropDown:null,initialize:function(a){this.triggerView=a.triggerView},serializeData:function(){return{filter:this.model,canEdit:JIRA.Issues.LoginUtils.loggedInUserName()===this.model.getOwnerUserName()}},onBeforeRender:function(){this.dropDown=new AJS.Dropdown({alignment:AJS.LEFT,styleClass:"filter-actions-dropdown",content:_.bind(function(){return this.$el},this),positioningController:new JIRA.Issues.WindowPositioning(),trigger:this.triggerView.getActionsTrigger()});this.dropDown.bind("hideLayer",_.bind(this.close,this))},onRender:function(){this.dropDown.show();this._markFilterAsSelected()},onClose:function(){this.dropDown.hide();this.dropDown.layerController.placeholder().remove();this.dropDown=null;this._markFilterAsUnselected()},_markFilterAsSelected:function(){var a=this.triggerView.getActionsTrigger();a.find("span").addClass("active");a.closest("li").addClass("hover")},_markFilterAsUnselected:function(){var a=this.triggerView.getActionsTrigger();a.find("span").removeClass("active");a.closest("li").removeClass("hover")}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/Copy.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.Copy");JIRA.Components.Filters.Views.Dialogs.Copy=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Save,id:"copy-filter-dialog",dialogOptions:function(){var a=this;return{content:function(b){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",contentType:"application/json"}).done(function(c){b(a.template(_.extend({isDefaultShareScopeGlobal:c&&c.scope==="GLOBAL"},a.serializeData())))})}}},formToRequestData:function(a){return{name:a.find("[name=name]").val(),id:this.model.getId(),favourite:true}},serializeData:function(){var a=this.model;return{headerText:"Copy Filter"+" : "+a.getName(),prefilledFilterName:AJS.format("Copy of {0}",a.getName()),modifierKey:AJS.Navigator.modifierKey(),contextPath:AJS.contextPath(),filter:a.toJSON(),copyFromAnotherUser:a.getOwnerUserName()!==AJS.Meta.get("remote-user"),filterOwnerName:a.getOwnerDisplayName(),hiddenFields:[]}},onSubmitSuccess:function(){if(this.$el.find("#setSharingPrivate").prop("checked")){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",type:"PUT",contentType:"application/json",processData:false,data:JSON.stringify({scope:"PRIVATE"})})}},onSubmitError:function(){this.dialog.$form.find("#filterName").focus()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/Delete.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.Delete");JIRA.Components.Filters.Views.Dialogs.Delete=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Delete,id:"delete-filter-dialog",serializeData:function(){var a={modifierKey:AJS.Navigator.modifierKey()};if(this.model){a.filter=this.model.toJSON()}else{a.filter={subscriptions:{items:[]}}}return a}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/Rename.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.Rename");JIRA.Components.Filters.Views.Dialogs.Rename=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Rename,id:"rename-filter-dialog",serializeData:function(){return{modifierKey:AJS.Navigator.modifierKey(),filter:this.model.toJSON()}},formToRequestData:function(a){return{name:a.find("[name=name]").val(),id:this.model.getId(),favourite:true}},onSubmitError:function(){this.dialog.$form.find("#filterName").focus()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/SaveAs.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.SaveAs");JIRA.Components.Filters.Views.Dialogs.SaveAs=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Save,id:"save-filter-dialog",initialize:function(a){this.jql=a.jql},dialogOptions:function(){var a=this;return{content:function(b){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",contentType:"application/json"}).done(function(c){b(a.template(_.extend({isDefaultShareScopeGlobal:c&&c.scope==="GLOBAL"},a.serializeData())))})}}},formToRequestData:function(b){var a={name:b.find("[name=name]").val(),jql:this.jql,favourite:true};if(this.model&&!this.model.getIsSystem()){a.id=this.model.getId()}return a},serializeData:function(){var b={headerText:"Save Filter",modifierKey:AJS.Navigator.modifierKey(),contextPath:AJS.contextPath(),hiddenFields:[]};var a=this.model;if(a){_.extend(b,{filter:a?a.toJSON():{},copyFromAnotherUser:a.getOwnerUserName()!==AJS.Meta.get("remote-user"),filterOwnerName:a.getOwnerDisplayName()})}return b},onSubmitSuccess:function(){if(this.$el.find("#setSharingPrivate").prop("checked")){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",type:"PUT",contentType:"application/json",processData:false,data:JSON.stringify({scope:"PRIVATE"})})}},onSubmitError:function(){this.dialog.$form.find("#filterName").focus()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/Filter.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.Filter");JIRA.Components.Filters.Views.List.Filter=JIRA.Marionette.ItemView.extend({template:JIRA.Components.Filters.Templates.List.Filter,ui:{filterLink:".filter-link"},triggers:{"simpleClick .filter-link:not(.requires-login)":"selectFilter"},modelEvents:{change:"render"},onRender:function(){this.unwrapTemplate()},highlight:function(){this.ui.filterLink.addClass("active");this.ui.filterLink.scrollIntoView()},unhighlight:function(){this.ui.filterLink.removeClass("active")}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/FilterWithActions.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.FilterWithActions");JIRA.Components.Filters.Views.List.FilterWithActions=JIRA.Components.Filters.Views.List.Filter.extend({ui:_.extend({actionsTrigger:".filter-actions"},JIRA.Components.Filters.Views.List.Filter.prototype.ui),triggers:_.extend({"click .filter-actions":"openActions"},JIRA.Components.Filters.Views.List.Filter.prototype.triggers),templateHelpers:{useActions:true},getActionsTrigger:function(){return this.ui.actionsTrigger}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/List.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.List");JIRA.Components.Filters.Views.List.List=JIRA.Marionette.CompositeView.extend({template:JIRA.Components.Filters.Templates.List.List,itemView:JIRA.Components.Filters.Views.List.Filter,itemViewContainer:".filter-list",onRender:function(){this.unwrapTemplate()},templateHelpers:function(){return{className:this.className}},unhighlightAllFilters:function(){this.children.apply("unhighlight")},highlightFilter:function(b){var a=this.children.findByModel(b);if(a){a.highlight()}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/ListWithActions.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.ListWithActions");JIRA.Components.Filters.Views.List.ListWithActions=JIRA.Components.Filters.Views.List.List.extend({itemView:JIRA.Components.Filters.Views.List.FilterWithActions,useActions:false,initialize:function(a){a=_.defaults({},a,{useActions:false});this.useActions=a.useActions}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/Message.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.Message");JIRA.Components.Filters.Views.List.Message=JIRA.Marionette.ItemView.extend({template:JIRA.Components.Filters.Templates.List.Message,text:"",initialize:function(a){this.text=a.text},onRender:function(){this.unwrapTemplate()},templateHelpers:function(){return{text:this.text,className:this.className}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/Module.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.Module");JIRA.Components.Filters.Views.List.Module=JIRA.Marionette.Layout.extend({template:JIRA.Components.Filters.Templates.List.Module,title:"",regions:{content:".filter-content"},initialize:function(a){a=_.defaults({},a,{title:""});this.title=a.title},templateHelpers:function(){return{title:this.title}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/Header.js' */
AJS.namespace("JIRA.Components.Filters.Views.Header");JIRA.Components.Filters.Views.Header=JIRA.Marionette.ItemView.extend({operations:{save:{styleClass:"save-changes",label:"Save"},saveAs:{styleClass:"save-as-new-filter",label:"Save as",},discardChanges:{styleClass:"discard-filter-changes",label:"Discard changes"},details:{styleClass:"show-filter-details",title:"View information about this filter",label:"Details"},favouriteOn:{title:"Remove this filter from your Favorite Filters",label:"Remove this filter from your Favorite Filters",styleClass:"fav-link aui-icon aui-icon-small aui-iconfont-star"},favouriteOff:{title:"Add this filter to your Favorite Filters",label:"Add this filter to your Favorite Filters",styleClass:"fav-link aui-icon aui-icon-small aui-iconfont-unstar"}},template:JIRA.Components.Filters.Templates.Header.Main,ui:{filterFavouriteButton:".fav-link",filterEditedLabel:".filter-edited-item",saveButton:".save-changes",saveAsButton:".save-as-new-filter",detailsTrigger:".show-filter-details",dropdownContent:"#js-edited-content"},triggers:{"click .fav-link":"toogleFavourite","click .save-as-new-filter:not([aria-disabled=true])":{event:"saveAs",preventDefault:true,stopPropagation:false},"click .save-changes:not([aria-disabled=true])":{event:"save",preventDefault:true,stopPropagation:false},"click .discard-filter-changes":{event:"discard",preventDefault:true,stopPropagation:false}},events:{"click .show-filter-details":function(){this.trigger("details",this.ui.detailsTrigger)}},_generatePrimaryOperations:function(){var a=[];if(this.isEdited&&this.model.isMyFilter()){a.push(this.operations.save)}if(!this.isDirty&&!!JIRA.Issues.LoginUtils.loggedInUserName()){a.push(this.operations.saveAs)}if(this.isEdited){a.push(this.operations.discardChanges)}return a},_generateSecondaryOperations:function(){var b=[];if(!this.model.getIsSystem()){b.push(this.operations.details)}if(!!JIRA.Issues.LoginUtils.loggedInUserName()&&!this.model.getIsSystem()){var a=this.model.isFavouriteFilter()?this.operations.favouriteOn:this.operations.favouriteOff;b.href=AJS.contextPath()+"/secure/EditFilter!default.jspa?filterId="+this.model.id;b.push(a)}return b},serializeData:function(){if(!this.model){return{title:"Search",primaryButton:this.operations.saveAs}}if(!this.model.getIsValid()){return{title:"Search"}}var a=this._generatePrimaryOperations();var c=this._generateSecondaryOperations();var b={title:this.model.getName(),primaryButton:a.shift(),primaryOps:a,secondaryOps:c};if(this.model.getOwner()){_.extend(b,{owner:this.model.getOwner()||"",ownerUserName:this.model.getOwnerUserName()||"",avatarUrl:this.model.getAvatarUrl(),ownerUrl:AJS.contextPath()+"/secure/ViewProfile.jspa?name="+encodeURIComponent(this.model.getOwnerUserName())})}return b},render:function(a){this.model=a.model;this.isEdited=a.isEdited;this.isDirty=a.isDirty;return JIRA.Marionette.ItemView.prototype.render.call(this)},onRender:function(){this.ui.dropdownContent.on("aui-dropdown2-show",_.bind(function(b){var a=this.$el;this.$el=jQuery(b.target);this.delegateEvents();this.$el=a},this));if(this.dirtyTipsy){this.dirtyTipsy.remove();delete this.dirtyTipsy}if(this.isDirty){this.markAsInvalid()}new JIRA.Issues.Tipsy({el:this.ui.filterFavouriteButton})},markAsInvalid:function(){this.ui.saveButton.addClass("disabled");this.ui.saveButton.attr("aria-disabled","true");this.dirtyTipsy=new JIRA.Issues.Tipsy({el:this.ui.saveButton,tipsy:{delayIn:0,title:function(){return "You need to run the search first before you can save your changes"}}})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/Details.js' */
AJS.namespace("JIRA.Components.Filters.Views.Details");JIRA.Components.Filters.Views.Details=JIRA.Marionette.InlineDialogView.extend({template:JIRA.Components.Filters.Templates.Details.Main,id:"filter-details-overlay",dialogOptions:{addActiveClass:true,hideDelay:3600000,offsetX:-36,width:400},initialize:function(a){this.trigger=a.triggerEl},serializeData:function(){var b=this.model;var c=_.sortBy(b.getSharePermissions(),function(f){var g=[f.type];f.group&&g.push(f.group.name);f.project&&g.push(f.project.name);f.role&&g.push(f.role.name);return g});var e=_.clone(b.getSubscriptions());var a=JIRA.Issues.LoginUtils.loggedInUserName()===b.getOwnerUserName();e.additionalLength=b.getNumberOfAdditionalSubscriptions();var d={filter:b.toJSON(),sharePermissions:c,subscriptions:e,permissions:{userHasEditSharingPermission:a&&(!!JIRA.Issues.UserParms.createSharedObjects()||c.length>0),userHasEditPermission:a},userIsLoggedIn:JIRA.Issues.LoginUtils.isLoggedIn(),returnUrl:window.location};if(b.getOwner()){_.extend(d,{owner:b.getOwner()||"",ownerUserName:b.getOwnerUserName()||"",avatarUrl:b.getAvatarUrl(),ownerUrl:AJS.contextPath()+"/secure/ViewProfile.jspa?name="+encodeURIComponent(b.getOwnerUserName())})}return d},onRender:function(){this.dialog.bind("click",function(a){a.stopPropagation()})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/Dialog.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.Dialog");JIRA.Components.Filters.Controllers.Dialog=JIRA.Marionette.Controller.extend({initialize:function(){this.activeView=null},_closeActiveDialog:function(){if(this.activeView){this.activeView.close();this.stopListening(this.activeView);this.activeView=null}},_showDialog:function(c,b,a){_.defaults(a,{viewOptions:{},onSuccess:jQuery.noop,onError:jQuery.noop});this._closeActiveDialog();this.activeView=new c(_.extend({model:b},a.viewOptions));this.listenTo(this.activeView,"submit:success",function(d){a.onSuccess.call(this,d,b)});this.listenTo(this.activeView,"submit:error",function(){a.onError.call(this,b)});this.activeView.render()},showDeleteDialog:function(a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.Delete,a,{onSuccess:function(c,b){this.trigger("delete:success",b)},onError:function(b){this.trigger("delete:error",b)}})},showRenameDialog:function(a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.Rename,a,{onSuccess:function(c,b){b.set("name",c.name);this.trigger("rename:success",b)},onError:function(b){this.trigger("rename:error",b)}})},showCopyDialog:function(a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.Copy,a,{onSuccess:function(c){var b=new JIRA.Components.Filters.Models.Filter(c,{parse:true});this.trigger("copy:success",b)},onError:function(b){this.trigger("copy:error",b)}})},showSaveAsDialog:function(b,a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.SaveAs,b,{viewOptions:{jql:a},onSuccess:function(d){var c=new JIRA.Components.Filters.Models.Filter(d,{parse:true});this.trigger("saveas:success",c)},onError:function(c){this.trigger("saveas:error",c)}})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/List.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.List");JIRA.Components.Filters.Controllers.List=JIRA.Marionette.Controller.extend({view:null,initialize:function(a){this.collection=a.collection;this.title=a.title;this.className=a.className;this.errorMessage=a.errorMessage;this.loadingMessage=a.loadingMessage;this.emptyMessage=a.emptyMessage;this.loginMessage=a.loginMessage},show:function(a){if(this.view){this.close()}this.view=new JIRA.Components.Filters.Views.List.Module({el:a,title:this.title});this.view.render();this._showInternalView(this.collection.fetchState);this.listenTo(this.collection,"change:fetchState",this._showInternalView)},close:function(){if(this.view){this.stopListening(this.collection,"change:fetchState",this._showRegion);this.stopListening(this.view);this.view.close();this.view=null}},highlightFilter:function(a){if(this._listView){this._listView.unhighlightAllFilters();if(a){this._listView.highlightFilter(a)}}},_showInternalView:function(a){switch(a){case"error":this._showError();break;case"fetched":this._showList();break;default:this._showLoading();break}},_showLoading:function(){this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.loadingMessage}))},_showError:function(){this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.errorMessage}))},_showList:function(){var a=this.collection;if(a.length){this._showListWithItems()}else{this._showEmptyList()}},_getListViewConstructor:function(){return JIRA.Components.Filters.Views.List.List},_showListWithItems:function(){var a=this._getListViewConstructor();this._listView=new a({collection:this.collection,className:this.className});this.view.content.show(this._listView);this.trigger("render");this.listenTo(this.collection,"remove",function b(){if(!this.collection.length){this.stopListening(this.collection,"remove",b);this._showEmptyList()}});this.listenTo(this._listView,"itemview:selectFilter",function(d,c){this.trigger("selectFilter",c.model)});this.listenTo(this._listView,"itemview:render",function(){this.trigger("render")});this.triggerMethod("list:render",this._listView)},_showEmptyList:function(){if(JIRA.Issues.LoginUtils.isLoggedIn()){this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.emptyMessage}))}else{this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.loginMessage}))}this.listenToOnce(this.collection,"add",function(){this._showListWithItems()})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/ListWithActions.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.ListWithActions");JIRA.Components.Filters.Controllers.ListWithActions=JIRA.Components.Filters.Controllers.List.extend({actionsView:null,_getListViewConstructor:function(){return JIRA.Components.Filters.Views.List.ListWithActions},close:function(){this._closeActions();JIRA.Components.Filters.Controllers.List.prototype.close.call(this)},highlightFilter:function(a){this._closeActions();JIRA.Components.Filters.Controllers.List.prototype.highlightFilter.call(this,a)},_showActions:function(c,b){var a=(this.actionsView&&this.actionsView.model===b);this._closeActions();if(!a){this.actionsView=new JIRA.Components.Filters.Views.Actions({triggerView:c,model:b});this.actionsView.render();this.listenTo(this.actionsView,"deleteFilter",function(d){this._closeActions();this.trigger("deleteFilter",d.model)});this.listenTo(this.actionsView,"renameFilter",function(d){this._closeActions();this.trigger("renameFilter",d.model)});this.listenTo(this.actionsView,"copyFilter",function(d){this._closeActions();this.trigger("copyFilter",d.model)});this.listenTo(this.actionsView,"unfavouriteFilter",function(d){this._closeActions();this.trigger("unfavouriteFilter",d.model)})}},_closeActions:function(){if(this.actionsView){this.actionsView.close();this.stopListening(this.actionsView);this.actionsView=null}},onListRender:function(){this.listenTo(this._listView,"itemview:selectFilter",function(){this._closeActions()});this.listenTo(this._listView,"itemview:openActions",function(b,a){this._showActions(a.view,a.model)})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/Header.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.Header");JIRA.Components.Filters.Controllers.Header=JIRA.Marionette.Controller.extend({initialize:function(){this.view=null},close:function(){if(this.view){this.view.close();this.stopListening(this.view);this.view=null;this.trigger("close")}},closeDetails:function(){if(this.detailsView){this.detailsView.close();this.stopListening(this.detailsView);this.detailsView=null}},showDetails:function(a){if(this.detailsView){this.closeDetails()}this.detailsView=new JIRA.Components.Filters.Views.Details({model:this.model,triggerEl:a});this.listenTo(this.detailsView,"close",this.closeDetails);this.detailsView.render()},show:function(a){if(this.view){this.close()}this.view=new JIRA.Components.Filters.Views.Header({el:a.el});this.isInvalid=false;this.listenTo(this.view,{saveAs:function(b){if(!JIRA.Issues.LoginUtils.isLoggedIn()||this.isInvalid){return}this.trigger("saveAs",b.model)},save:function(b){if(!JIRA.Issues.LoginUtils.isLoggedIn()||this.isInvalid){return}this.trigger("save",b.model)},discard:function(){this.update({isEdited:false,isDirty:false});this.trigger("discard")},details:function(b){this.showDetails(b)},toogleFavourite:function(d){var c=d.model;if(!c){return}var b=!!c.getFavourite();c.saveFavourite(!b);if(!b){this.trigger("favourite",c)}},close:this.close});this.update(a)},update:function(a){if(!this.view){return}this.isInvalid=false;if(typeof a.model!=="undefined"){this.model=a.model}this.view.render({model:this.model,isDirty:a.isDirty,isEdited:a.isEdited})},markAsInvalid:function(){if(this.view){this.view.markAsInvalid()}this.isInvalid=true}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/templates/issuenav-filter.soy' */
// This file was automatically generated from issuenav-filter.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavFilter == 'undefined') { JIRA.Templates.IssueNavFilter = {}; }


JIRA.Templates.IssueNavFilter.collapsedFiltersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="toggle-filter-panel" href="#" title="', soy.$$escapeHtmlAttribute(AJS.format("Dock the filters panel ({0})",'[')), '"></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filtersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filters-content"><h4 class="filter-title">', soy.$$escapeHtml("Filters"), '</h4><ul class="filter-options"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/issues/?jql=" class="new-search aui-button aui-button-light" title="', soy.$$escapeHtmlAttribute("Create a new search filter"), '">', soy.$$escapeHtml("New filter"), '</a></li><li><a class="find-filters" href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/ManageFilters.jspa?filterView=search">', soy.$$escapeHtml("Find filters"), '</a></li></ul><div class="filter-panel-system-container"></div><div class="filter-panel-favourites-container"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelView.js' */
Backbone.define("JIRA.Issues.FilterPanelView",JIRA.Issues.BaseView.extend({events:{"simpleClick .system-filters a.filter-link:not(.requires-login)":"_onClickFilter","simpleClick .new-search":"_onClickNewSearch","click .ui-dock":"_onDockFilterPanelClick","click .ui-undock":"_onUndockFilterPanelClick"},collapsedTemplate:JIRA.Templates.IssueNavFilter.collapsedFiltersPanel,template:JIRA.Templates.IssueNavFilter.filtersPanel,initialize:function(a){_.bindAll(this,"adjustFavouriteFiltersHeight");if(a.easeOff){this._adjustFavouriteFiltersHeight=_.debounce(this._adjustFavouriteFiltersHeight,a.easeOff)}JIRA.Issues.onVerticalResize(this.adjustFavouriteFiltersHeight);this.panelReady=jQuery.Deferred();JIRA.bind(JIRA.Events.LAYOUT_RENDERED,_.bind(function(c,b){if(b){delete this._splitViewSidebarElement}else{this._splitViewSidebarElement=AJS.$(".list-results-panel:first")}},this))},adjustFavouriteFiltersHeight:function(){var e=AJS.$(".jira-feedback-link-container.subtle-style").outerHeight(true),c=e?e+10:0,b=this.$(".favourite-filters"),a=b.length&&b.offset().top,d=window.innerHeight;b.css("height",d-a-c)},_onDockFilterPanelClick:function(){AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed")},_onUndockFilterPanelClick:function(){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed")},toggleDockState:function(){this.$el.popoutSidebar("toggle")},_onClickFilter:function(b){b.preventDefault();var a=jQuery(b.target).data("id");this.trigger("filterSelected",a)},_onClickNewSearch:function(a){a.preventDefault();this.trigger("filterSelected",null)},render:function(){if(!this.model.isDocked()){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed");this._renderCollapsed()}else{AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed");this._renderOpen()}var a=AJS.KeyboardShortcut.getKeyboardShortcutKeys("toggle.filter.panel");this.$el.popoutSidebar({isDocked:this.model.isDocked(),expandedWidth:this.model.getWidth(),renderExpanded:_.bind(this._renderOpen,this),renderCollapsed:_.bind(this._renderCollapsed,this),undockText:"Undock",undockTitle:AJS.format("Undock the filter panel so it is hidden when not being focused (Type \'\'{0}\'\')",a),dockText:"Dock",dockTitle:AJS.format("Dock the filter panel so you can always see the list of filters (Type \'\'{0}\'\')",a),toggleTarget:".filter-title:first",persist:_.bind(function(c,b){this.model.setDocked(c);this.model.setWidth(b)},this),resize:_.bind(function(){this._splitViewSidebarElement&&this._splitViewSidebarElement.sidebar("updatePosition")},this)});if(this.model.shouldShowDockIntro()){this.$el.popoutSidebar("collapse",false)}if(this.model.isDocked()){this.$el.popoutSidebar("renderDockState")}this._fireDockAnalytics();this.panelReady.resolve();return this.$el},_fireDockAnalytics:function(){if(localStorage.getItem("dockStatesAnalyticsEnabled")){var a=this.model.isDocked();if(localStorage.getItem("dockStateAnalytic")!==""+a){localStorage.setItem("dockStateAnalytic",a);JIRA.Issues.Application.execute("analytics:trigger","kickass.filters.docked",{isDocked:this.model.isDocked()})}}},_renderCollapsed:function(){var a=jQuery(".jira-feedback-link-container.subtle-style").detach().addClass("left noborder");this.$el.addClass("collapsed").html(this.collapsedTemplate({isDocked:this.model.isDocked()}));this.trigger("renderCollapsed");JIRA.Issues.triggerHorizontalResize();a.appendTo("body");return this},_renderOpen:function(){var a=jQuery(".jira-feedback-link-container.subtle-style").detach().removeClass("left noborder");this.$el.removeClass("collapsed");this.$el.width(this.model.getWidth());this.$el.html(this.template({}));this.trigger("renderOpen");a.appendTo(this.$el);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.filterPanelOpened]);JIRA.Issues.triggerHorizontalResize();return this},_renderSelectedFilter:function(){}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/Browser.js' */
(function(a){AJS.namespace("JIRA.Issues.Browser");JIRA.Issues.Browser={getWindowWidth:function(){return window.innerWidth}}}(AJS.$));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelModel.js' */
(function(){var b="issues.sidebar.docked";var a="issues.sidebar.width";Backbone.define("JIRA.Issues.FilterPanelModel",JIRA.Issues.BaseModel.extend({properties:["activeFilter"],defaults:{activeFilter:null},initialize:function(c,d){_.extend(this,_.defaults(d,{storage:window.localStorage}))},setDocked:function(c){this._getStorage().setItem("dockStatesAnalyticsEnabled",true);return this._getStorage().setItem(b,c)},setWidth:function(c){return this._getStorage().setItem(a,c)},getWidth:function(){var c=parseInt(this._getStorage().getItem(a),10);return((c>0)?c:200)},_getStorage:function(){return this.storage||window.localStorage},isDockedPrefGiven:function(){return this._getStorage().getItem(b)!==null},shouldShowDockIntro:function(){return !this.isDocked()&&!this.isDockedPrefGiven()},isExpanded:function(){return this.shouldShowDockIntro()?false:this.isDocked()},isDocked:function(){var c=this._getStorage();return c.getItem(b)==null||c.getItem(b)==="true"}}))}());;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterModule.js' */
Backbone.define("JIRA.Issues.FilterModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule;this.filterPanelModel=a.filterPanelModel||new JIRA.Issues.FilterPanelModel({},{searchPageModule:a.searchPageModule});this.filtersComponent=new JIRA.Components.Filters({systemFilters:a.systemFilters,searchPageModule:this._searchPageModule});this.filtersComponent.on("newFilter",function(b){this._searchPageModule.filterModuleSaved(b);if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){this._searchPageModule.setSessionSearch(b)}},this);this.filtersComponent.on("filterRemoved",function(b){this.trigger("filterRemoved",b)},this);this.filtersComponent.on("filterUnfavourited",function(b){this.trigger("filterUnfavourited",b)},this);this.filtersComponent.on("filterSelected",this._onFilterSelected,this);this.filtersComponent.on("filterDiscarded",function(){this._searchPageModule.discardFilterChanges()},this);this.filtersComponent.on("savedFilter",function(b){this._searchPageModule.setSessionSearch(b);this.filtersComponent.highlightFilter(b)},this);this.filtersComponent.on("list:render",function(){var c=this._searchPageModule.getFilter();if(c){var b=c.id;var d=this.filtersComponent.getFilterByIdFromExistingCollections(b);this.filterPanelModel.set("activeFilter",d)}},this);this._searchPageModule.on("change changeFilterProps",function(){this.filtersComponent.updateFilterHeader({model:this._searchPageModule.getFilter(),isPendingSearch:false,isEdited:this._searchPageModule.isDirty()})},this);this.filtersComponent.fetchFavouriteFilters();this.filterPanelModel.bind("change:activeFilter",this._markFilterAsActive,this);this.filterPanelModel.set("activeFilter",this._searchPageModule.getFilter());this._searchPageModule.bind("change:filter",function(b,c){this.filterPanelModel.set("activeFilter",c)},this)},canEditColumns:function(){var a=this._searchPageModule.getFilter();return a&&a.isMyFilter()},initSystemFilters:function(){return this.filtersComponent.fetchSystemFilters()},getFilterById:function(a){return this.filtersComponent.getFilterById(a)},createView:function(a){this.filterPanelView=new JIRA.Issues.FilterPanelView({el:a.$filterPanelEl,model:this.filterPanelModel,searchPageModule:this._searchPageModule,easeOff:(!!jQuery.browser.msie&&jQuery.browser.version<=8)?500:0});this.filterPanelView.on("renderOpen",function(){this.filtersComponent.showSystemFilters(this.filterPanelView.$el.find(".filter-panel-system-container"));this.filtersComponent.showFavouriteFilters(this.filterPanelView.$el.find(".filter-panel-favourites-container"));this._markFilterAsActive();this.filterPanelView.adjustFavouriteFiltersHeight()},this);this.filterPanelView.on("filterSelected",this._onFilterSelected,this);this.filterPanelView.render();return this.filterPanelView},_markFilterAsActive:function(){var a=this.filterPanelModel.get("activeFilter");this.filtersComponent.highlightFilter(a)},toggleFilterPanel:function(){this.filterPanelView.toggleDockState()},createHelptipForFilterPanelDocking:function(c){var b;var d=this.filterPanelModel;var a=this.filterPanelView;if(d.shouldShowDockIntro()&&a.$el.is(":visible")){b=new AJS.HelpTip({id:"filters-dock-intro",title:"Did you notice?",bodyHtml:"You can dock the filter bar to always show your list of filters.",anchor:".ui-dock",isSequence:true,weight:c,callbacks:{beforeShow:function(){a.$el.popoutSidebar("expand",false)},init:function(){if(a.$el.popoutSidebar("isUndocked")){a.$el.popoutSidebar("unbindHoverIntent")}},hide:function(){if(a.$el.popoutSidebar("isUndocked")){a.$el.popoutSidebar("bindHoverIntent");a.$el.popoutSidebar("collapse")}}}})}return b},_onFilterSelected:function(a){if(a===null){this._searchPageModule.resetToBlank({isNewSearch:true})}else{this._searchPageModule.resetToFilter(a)}},updateFilterHeader:function(a){a=a||{};var c=a.isEdited||false;var b=a.isPendingSearch||false;this.filtersComponent.updateFilterHeader({isEdited:c,isDirty:b})}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/util/WindowPositioning.js' */
JIRA.Issues.WindowPositioning=AJS.InlineLayer.StandardPositioning.extend({_calculateOverflow:function(c){var b=this.layer().css("position")==="fixed",a=c.top+this.layer().outerHeight(true),e=window.innerHeight,d=jQuery(window).scrollTop();if(b){return Math.max(0,a-e)}else{return Math.max(0,a-d-e)}},left:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left+=this.offsetTarget().outerWidth();a.top-=b}return a},right:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left-=this.offsetTarget().outerWidth();a.top-=b}return a}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-templates', location = 'content/templates/issuenav.soy' */
// This file was automatically generated from issuenav.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNav == 'undefined') { JIRA.Templates.IssueNav = {}; }


JIRA.Templates.IssueNav.issueTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<thead><tr></tr></thead><tbody></tbody>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-type issue-icon-result persist-result"><div>', soy.$$escapeHtml("T"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-type issue-icon-result persist-result"><img src="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.name), '" title="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.description), '" align="absmiddle" border="0" height="16" width="16"></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-key persist-result"><div>', soy.$$escapeHtml("Key"), '</div></th><th class="issue-summary issue-text-result persist-result"><div>', soy.$$escapeHtml("Summary"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-key-summary issue-text-result persist-result" colspan="2"><div><a href="', soy.$$escapeHtml(opt_data.contextPath), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" class="issue"><span class="secondary-text">', soy.$$escapeHtml(opt_data.issue.key), '</span>', soy.$$escapeHtml(opt_data.issue.fields.summary), '</a></div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-status"><div>', soy.$$escapeHtml("Status"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-status"><div class="status-lozenge">', soy.$$escapeHtml(opt_data.issue.fields.status.name), '</div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-user"><div>', soy.$$escapeHtml("Assignee"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-user">', (opt_data.issue.fields.assignee) ? '<img src="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.avatarUrls['16x16']) + '" alt="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" height="16" width="16" /><a class="user-hover" rel="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" href="#">' + soy.$$escapeHtml(opt_data.issue.fields.assignee.displayName) + '</a>' : soy.$$escapeHtml("Unassigned"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-datetime"><div>', soy.$$escapeHtml("Updated"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-datetime"><time datetime="', soy.$$escapeHtml(opt_data.issue.fields.updated), '">', soy.$$escapeHtml(opt_data.TMP_FORMATTED_DATE), '</time></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-resolution"><div>', soy.$$escapeHtml("Resolution"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-resolution">', (opt_data.issue.fields.resolution) ? soy.$$escapeHtml(opt_data.issue.fields.resolution.name) : soy.$$escapeHtml("Unresolved"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.issueResultsError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="error"><td colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml(opt_data.errorText), '</td></tr>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/ColumnPicker.js' */
JIRA.Issues.ColumnPicker=JIRA.Components.ColumnPicker.extend({initialize:function(a,b){var c=[this._getUserColumnProvider(),this._getFilterColumnProvider()];if(JIRA.isAdmin()){c.push(this._getSystemColumnProvider())}JIRA.Components.ColumnPicker.prototype.initialize.call(this,null,{providers:c});this.search=b.search;this.search.on("change:filter",function(){var d=this.filterColumn;var f=d.isEditDisabled();var e=d.isDisabled();d.trigger("change:isDisabled",d,e);d.trigger("change:editDisabled",d,e||f)},this)},isSystemMode:function(){return this.columnPickerModel.getColumnConfig()==="system"},sanitizeColumnConfig:function(a){a=a.toLowerCase();var b=a=="system"&&!this.isSystemMode();return b?"user":a},syncColumns:function(a,b){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.syncColumns.call(this,a,b)},clearFilterConfiguration:function(){this.filterColumn.unset("columns");this.filterColumn.unset("savedColumns")},setCurrentColumnConfig:function(a){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.setCurrentColumnConfig.call(this,a)},_getFilterColumnProvider:function(){var a=this;return this.filterColumn=JIRA.Issues.ColumnConfigModel.create("filter","Filter",{url:function(){return AJS.contextPath()+"/rest/api/2/filter/"+a.search.getState().filter+"/columns"},isDisabled:function(){return !a.search.getFilter()||a.search.getFilter().getIsSystem()},isEditDisabled:function(){return !a.search.filterModule.canEditColumns()},shouldRefreshSearchOnActivation:function(){return this.has("savedColumns")},shouldCloseOnActivation:function(){return this.has("savedColumns")},shouldLoadDefaultsOnActivation:function(){return !this.has("savedColumns")},defaultColumns:_.bind(function(){if(this.userColumns.has("columns")){var b=jQuery.Deferred();b.resolve(_.map(this.userColumns.getColumns(),function(c){return{value:c}}));return b.promise()}else{return jQuery.ajax(this.userColumns.url()).promise()}},this)})},_getSystemColumnProvider:function(){return JIRA.Issues.ColumnConfigModel.create("system","System",{url:_.lambda(AJS.contextPath()+"/rest/api/2/settings/columns"),defaultColumns:function(){return jQuery.ajax(this.url()).promise()},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return false},shouldLoadDefaultsOnActivation:function(){return true},shouldRevertOnHide:function(){return false}})},_getUserColumnProvider:function(){this.userColumns=JIRA.Issues.ColumnConfigModel.create("user","My Defaults",{url:_.lambda(AJS.contextPath()+"/rest/api/2/user/columns")});return this.userColumns}});JIRA.Issues.ColumnPicker.create=function(a){return new JIRA.Issues.ColumnPicker(null,a)};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueTableView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueTableView",JIRA.Issues.BaseView.extend({_closeSystemModeMessage:function(){if(this.currentMessage){this.currentMessage.close();this.currentMessage=null}},_showSystemModeMessage:function(){if(this.currentMessage){return}var c=require("jira/flag");var b=c.showMsg("","You are on System Mode. The column changes might affect all users. \u003ca href=# class=exit\u003eExit System Mode\u003c/a\u003e.",{type:"warning",close:"never"});AJS.$(b).find(".exit").click(_.bind(function(d){d.preventDefault();this.columnConfig.setCurrentColumnConfig("user");this._closeSystemModeMessage()},this));this.currentMessage=b},syncSystemModeMessage:function(){var b=this.columnConfig.isSystemMode();if(b){this._showSystemModeMessage()}else{this._closeSystemModeMessage()}},initialize:function(b){this.columnConfig=b.columnConfig;this.columnConfig.on("change:columnConfig",this.syncSystemModeMessage,this);JIRA.Issues.onVerticalResize(_.bind(this.adjustColumnConfigHeight,this))},deactivate:function(){JIRA.Issues.offVerticalResize(this.adjustColumnConfigHeight)},_onSearchDone:function(b){this.columnConfig.setElement(b.find(".column-picker-trigger-container")).render()},adjustColumnConfigHeight:function(){this.columnConfig.adjustHeight()}}))})(jQuery);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/HeaderOperationsView.js' */
JIRA.Issues.IssueTableHeaderOperationsView=JIRA.Issues.BaseView.extend({initialize:function(a){_.bindAll(this,"_onSearchSuccess","_updateFilterPageResources");_.extend(this,a);this.initTools();this.initViews();this.initShare();this._results=this.search.getResults();this._results.onNewPayload(this._onSearchSuccess)},initViews:function(){var a=this.searchPageModule;a.on("change",this._updateFilterPageResources);this._updateFilterPageResources();new JIRA.Issues.Tipsy({el:this.$el.find(".header-views"),showCondition:":not(.active)"});var b=this._spinnerTimeoutKeeper(".header-views");AJS.Dropdown.create({styleClass:"header-views-menu aui-style-default",trigger:AJS.$(".header-views",this.$el),ajaxOptions:function(){var d={jql:a.getEffectiveJql()},c=a.getFilter();if(c&&!c.getIsSystem()){d.filterId=c.getId();if(a.isDirty()){d.jql=a.getJql();d.modified=true}}b.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/views",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:d,dataType:"json",cache:false,formatSuccess:function(e){b.end();return AJS.$(JIRA.Templates.IssueNavTable.views({sections:e,contextPath:contextPath}))}}}})},initTools:function(){var a=this,b=this.searchPageModule;AJS.$("body").delegate("#use-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("user");a.searchPageModule.columnConfig.refreshSearchWithColumns()});AJS.$("body").delegate("#use-filter-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("filter");a.searchPageModule.columnConfig.refreshSearchWithColumns()});new JIRA.Issues.Tipsy({el:this.$el.find(".header-tools"),showCondition:":not(.active)",tipsy:{gravity:"ne"}});var c=this._spinnerTimeoutKeeper(".header-tools");AJS.Dropdown.create({styleClass:"header-tools-menu",trigger:AJS.$(".header-tools",a.$el),ajaxOptions:function(){var e,d=b.getFilter();e={jql:b.getEffectiveJql(),searchResultsTotal:a._results.getTotal(),searchResultsPages:a._results.getNumberOfPages(),useColumns:a.searchPageModule.columnConfig.getCurrentColumnConfig().getName()!="user",skipColumns:b.getActiveLayout().id==="split-view"};if(d&&!d.getIsSystem()){e.filterId=d.getId();if(b.isDirty()){e.jql=b.getJql()}}c.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/tools",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:e,dataType:"json",cache:false,formatSuccess:function(f){c.end();if(f&&f.length==0){return AJS.$('<div class="menu-empty-content"></span>'+"No Available Option(s)"+"<div>")}else{return AJS.$(JIRA.Templates.IssueNavTable.tools({groups:f,contextPath:contextPath}))}}}}})},initShare:function(){new JIRA.Issues.Tipsy({el:this.$el.find(".issuenav-share"),showCondition:":not(.active)"})},_onSearchSuccess:function(){AJS.$(".header-tools").toggle(this.search.getResults().getDisplayableTotal()>0)},_updateFilterPageResources:function(){var d=this.$el.find(".operations-view-data > fieldset"),b=this.searchPageModule;d.empty();if(b.getFilter()&&!b.isDirty()){AJS.$('<input type="hidden" id="filterId" />').val(b.getFilter().getId()).appendTo(d);AJS.$('<input type="hidden" id="jql" />').val("").appendTo(d)}else{AJS.$('<input type="hidden" id="filterId" />').val("");AJS.$('<input type="hidden" id="jql" />').val(b.getJql()).appendTo(d)}var c=b.getFilter(),a=c&&c.getId();if(a&&!c.getIsSystem()&&!b.isDirty()){AJS.Meta.set("filter-id",a);AJS.Meta.set("filter-jql",undefined)}else{AJS.Meta.set("filter-id",undefined);AJS.Meta.set("filter-jql",b.getEffectiveJql())}},_spinnerTimeoutKeeper:function(a){var b=undefined;return{start:function(){if(b){b=clearTimeout(b)}b=setTimeout(function(){b=undefined;AJS.$(a).addClass("spinner")},1000)},end:function(){b=clearTimeout(b);AJS.$(a).removeClass("spinner")}}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'util/utils.js' */
_.mixin({lambda:function(a){return function(){return a}},isNotBlank:function(a){return !!a}});if(!JIRA.Issues){JIRA.Issues={}}JIRA.bind(JIRA.Events.CHECKBOXMULITSELECT_READY,function(b,a){a.closest(".form-body").addClass("checkboxmultiselect-container")});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.ComponentUtil == 'undefined') { JIRA.Templates.Issues.ComponentUtil = {}; }


JIRA.Templates.Issues.ComponentUtil.throbber = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="icon throbber" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueNotFound = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("issues.components.query.search.selected.issue.nonexistent.html",opt_data.issueAnchor));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.buildMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else {
    output.append('<ul>');
    var messageList52 = opt_data.messages;
    var messageListLen52 = messageList52.length;
    for (var messageIndex52 = 0; messageIndex52 < messageListLen52; messageIndex52++) {
      var messageData52 = messageList52[messageIndex52];
      output.append('<li>', soy.$$escapeHtml(messageData52), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.auiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length > 0) {
    output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.typeClass), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.typeClass), '"></span>');
    JIRA.Templates.Issues.ComponentUtil.buildMessage(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'error', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.warningMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml(""), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SingleSelectMixin.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={namedAttributes:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-basic.soy' */
// This file was automatically generated from query-basic.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryBasic == 'undefined') { JIRA.Templates.IssueNavQueryBasic = {}; }


JIRA.Templates.IssueNavQueryBasic.basicQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-field-container">', (opt_data.hasOrderBy) ? '<div class="list-ordering-container"><div class="list-ordering"></div></div>' : '', '<div class="search-criteria-container"><div class="search-criteria"><ul class="criteria-list"><li class="text-query hidden"><div class="text-query-container"><input class="search-entry text ajs-dirty-warning-exempt" id="searcher-query" type="text" name="text" placeholder="', soy.$$escapeHtmlAttribute("Contains text"), '" /></div></li><li class="criteria-actions"></li>', (opt_data.hasSearchButton) ? '<li><button class="aui-button aui-button-subtle search-button" type="button" title="' + soy.$$escapeHtmlAttribute("Search for issues") + '"><span class="aui-icon aui-icon-small aui-iconfont-search">' + soy.$$escapeHtml("Search") + '</span></button></li>' : '', '</ul></div><div class="search-criteria-extended"><ul class="criteria-list"></ul></div></div></div><div class="search-options-container"><div class="mode-switcher"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" data-id="', soy.$$escapeHtmlAttribute(opt_data.id), '" class="criteria-selector aui-button aui-button-subtle drop-arrow" /><a href="#" class="remove-filter" title="', soy.$$escapeHtmlAttribute("Remove criterion"), '" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-remove"></span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="criteria-wrap">', (opt_data.extended || ! opt_data.viewHtml) ? '<span class="fieldLabel">' + soy.$$escapeHtml(opt_data.name) + ':</span> ' : '', (opt_data.viewHtml) ? opt_data.viewHtml : soy.$$escapeHtml("All"), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="issue-filter" action="#" class="searchfilter aui top-label aui-popup-content"><div class="form-body"></div>', (opt_data.displayBackButton) ? '<a href="#" class="back">' + soy.$$escapeHtml("Back") + '</a>' : '', (opt_data.displayUpdateCancel) ? '<div class="buttons-container form-footer"><div class="buttons"><input type="submit" name="filter" class="aui-button filter" value="' + soy.$$escapeHtmlAttribute("Update") + '" /><a href="#" class="aui-button aui-button-link cancel-update">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '', '</form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-no-edit-content">');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'info', messages: [AJS.format("To search by {0} please switch to advanced.",opt_data.fieldName)]}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.clauseButtonView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" class="add-criteria aui-button ', (opt_data.isSubtle) ? 'aui-button-subtle' : '', ' drop-arrow" title="', soy.$$escapeHtmlAttribute("Add more fields to search with"), '">', soy.$$escapeHtml("More"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-groups available"><ul>');
  var groupList71 = opt_data.searcherGroups;
  var groupListLen71 = groupList71.length;
  for (var groupIndex71 = 0; groupIndex71 < groupListLen71; groupIndex71++) {
    var groupData71 = groupList71[groupIndex71];
    output.append('<li class="twixi-block ', (groupIndex71 == 0) ? 'expanded' : 'collapsed', '" data-id="', soy.$$escapeHtmlAttribute(groupData71.id), '"><div class="twixi-trigger">', soy.$$escapeHtml(groupData71.name), '</div><ul class="twixi-content">');
    var searcherList83 = groupData71.searchers;
    var searcherListLen83 = searcherList83.length;
    for (var searcherIndex83 = 0; searcherIndex83 < searcherListLen83; searcherIndex83++) {
      var searcherData83 = searcherList83[searcherIndex83];
      output.append('<li><a href="#" data-id="', soy.$$escapeHtmlAttribute(searcherData83.id), '" class="searcher-option" >', soy.$$escapeHtml(searcherData83.name), '</a></li>');
    }
    output.append('</ul></li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><a href="#" class="aui-button aui-button-link">', soy.$$escapeHtml("Close"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextQueryBuilder.js' */
AJS.namespace("JIRA.Issues.TextQueryBuilder");JIRA.Issues.TextQueryBuilder={BACKSLASH_PATTERN:/\\/g,MULTIPLE_WHITESPACE_PATTERN:/\s+/g,QUOTE_PATTERN:/\"/g,DOUBLE_BACKSLASH:"\\\\",buildJql:function(a){if(!a){return""}a=""+a;a=AJS.$.trim(a);a=a.replace(this.BACKSLASH_PATTERN,this.DOUBLE_BACKSLASH);a=a.replace(this.MULTIPLE_WHITESPACE_PATTERN," ");a=a.replace(this.QUOTE_PATTERN,'\\"');return this.createQueryClause(a)},createQueryClause:function(a){return'text ~ "'+a+'"'}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryModule.js' */
JIRA.Issues.BasicQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlTooComplex","searchRequested","basicModeCriteriaCountWhenSearching","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.searcherCollection=new JIRA.Issues.SearcherCollection([],{fixedLozenges:a.primaryClauses,queryStateModel:a.queryStateModel,initData:a.initialSearcherCollectionState});this.view=new JIRA.Issues.BasicQueryView({queryStateModel:a.queryStateModel,searcherCollection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this);this.searcherCollection.onSearchRequested(_.bind(function(b){this.triggerBasicModeCriteriaCountWhenSearching({count:this.searcherCollection.getAllSelectedCriteriaCount()});var c=this._attachOrderByClause(b);this.triggerSearchRequested(c)},this));this.searcherCollection.onJqlTooComplex(_.bind(function(b){this.triggerJqlTooComplex(b)},this))},hasErrors:function(){var a=this.searcherCollection.any(function(b){return b.hasErrorInEditHtml()});return a},clear:function(){this.searcherCollection.clear()},queryChanged:function(){this.searcherCollection.restoreFromQuery(this._queryStateModel.getJql())},queryReset:function(a){this.searcherCollection.setInteractive(false);return this.searcherCollection.restoreFromQuery(a,true).always(_.bind(function(){this.searcherCollection.setInteractive(true)},this))},searchersReady:function(){return this.searcherCollection.searchersReady()},createView:function(){return this.view},getSelectedCriteria:function(){return this.searcherCollection.getAllSelectedCriteria()},_attachOrderByClause:function(a){var b=/\bORDER\s+BY\b.*$/i;var c=b.exec(this._queryStateModel.getJql());if(c&&b.exec(a)===null){a=a?a+" "+c[0]:c[0]}return a}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaView.js' */
JIRA.Issues.CriteriaView=JIRA.Issues.Brace.View.extend({tagName:"li",template:JIRA.Templates.IssueNavQueryBasic.criteriaButton,contentTemplate:JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent,events:{click:"hideTipsy","click .criteria-selector":"_onClickCriteriaSelector","click .remove-filter":"_onClickRemoveCriteria","mousedown .remove-filter":"_preventFocusWhileDisabled",keydown:"_onKeydown"},initialize:function(a){this.extended=a.extended;this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this.update,this);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.bind("change:isSelected",this._onCriteriaSelectionChanged,this);JIRA.Issues.SearcherDialog.instance.onHide(_.bind(this._addTooltip,this));JIRA.Issues.SearcherDialog.instance.onShow(_.bind(this._onCriteriaDialogShow,this))},render:function(){this.$el.html(this.template({id:this.model.getId()}));this.$el.attr("data-id",this.model.getId());if(this.extended){this.$el.addClass("extended-searcher")}this.update();this.prepareForDisplay()},prepareForDisplay:function(){this._addTooltip();this.delegateEvents()},hideTipsy:function(){if(this.tipsy){this.tipsy.hide()}},update:function(){var g=this.searcherCollection.length===0;var f=this._getSearcher();var b=this._isValidSearcher();var e=!g&&!f;var a=g||!b;var d=this.$("button");var c=this.$(".remove-filter");this.$el.toggleClass("hidden",e);d.attr("aria-disabled",a?"true":null).html(this.contentTemplate({name:f&&f.getName()||this.model.getName(),viewHtml:f&&f.getViewHtml(),extended:this.extended}));this.$el.toggleClass("invalid-searcher",!b).toggleClass("partial-invalid-searcher",(b&&d.find(".invalid_sel").length!==0));c.toggle(!b||!!this.extended);return this},destroy:function(){this.hideTipsy();this.$el.remove()},_getSearcher:function(){return this.searcherCollection.get(this.model.getId())},_isValidSearcher:function(){var a=this._getSearcher();return !a||!(a.getValidSearcher()===false)},_containsInvalidValue:function(a){return(AJS.$(a.getViewHtml()).find(".invalid_sel").length>0)},_showDialog:function(){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.show(this._getSearcher())}},_removeCriteria:function(b){var a=this.extended||!this._isValidSearcher();if(this.searcherCollection.isInteractive()&&a){this.searcherCollection.triggerBeforeCriteriaRemoved(this.model.getId(),b);_.defer(_.bind(function(){this.searcherCollection.clearClause(this.model.getId())},this))}},_getTooltipText:function(){var b=this.searcherCollection.get(this.model.getId());var a;if(!this._isValidSearcher()){a="This criteria is not valid for the project and/or issue type"}else{if(this._containsInvalidValue(b)){a="This criteria contains invalid value(s)"}else{a=b.getTooltipText()}}return b&&a||""},_addTooltip:function(){this.tipsy=new JIRA.Issues.Tipsy({el:this.$el,showCondition:this.searcherCollection.isInteractive,tipsy:{title:_.bind(this._getTooltipText,this)}})},_handleInteractiveChanged:function(a){this.$("button, .remove-filter").attr("aria-disabled",(a)?null:"true")},_onClickCriteriaSelector:function(a){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.toggle(this._getSearcher())}a.preventDefault()},_onClickRemoveCriteria:function(a){this._removeCriteria();a.preventDefault()},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog();break;case AJS.$.ui.keyCode.ESCAPE:this.$("button:focus").blur();break;case AJS.$.ui.keyCode.BACKSPACE:this._removeCriteria(-1);break;case AJS.$.ui.keyCode.DELETE:this._removeCriteria(1);break;default:return}a.preventDefault()},_onCriteriaDialogShow:function(){var a=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher();if(a==this._getSearcher()){this.tipsy&&this.tipsy.remove()}},_preventFocusWhileDisabled:function(a){if(jQuery(a.target).closest("[aria-disabled=true]").length>0){a.preventDefault()}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherModel.js' */
JIRA.Issues.SearcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","isShown","viewHtml","editHtml","groupId","groupName","initParams","isSelected","jql","position","serializedParams","validSearcher","key","lastViewed"],namedEvents:["readyForDisplay"],initialize:function(){this._onEditHtmlUpdated();this.bind("change:editHtml",this._onEditHtmlUpdated,this)},parse:function(a){if(a.viewHtml){a.viewHtml=this._cleanViewHtml(a.viewHtml)}return a},_cleanViewHtml:function(b){var a=AJS.$("<div/>").appendCatchExceptions(b);a.find(".fieldLabel").remove();a.find("a").replaceWith(function(){return AJS.$(this).html()});a.find(".searcherValue").slice(0,-1).each(function(){AJS.$(this).after("-")});a.find("*").removeAttr("title");return a.html()},createOrUpdateClauseWithQueryString:function(a){return this.collection.createOrUpdateClauseWithQueryString(this.id,a)},getQueryString:function(){var a={};if(this.collection.QUERY_ID===this.getId()){if(this.getViewHtml()){a[this.collection.QUERY_PARAM]=this.getDisplayText();return AJS.$.param(a)}return null}if((!this.getValidSearcher()||/^\s*$/.test(this.getEditHtml()))&&this.getJql()){a={};a[this.collection.JQL_INVALID_QUERY_PREFIX+this.getId()]=this.getJql();return AJS.$.param(a)}return this.getSerializedParams()},getDisplayText:function(){var a=this.getViewHtml();var c="";if(a){var b=AJS.$("<div>").appendCatchExceptions(a);c=AJS.$.trim(b.text()).replace(/[\n\r\s]+/g," ")}return c},hasClause:function(){if(this.collection.QUERY_ID===this.getId()){return !!this.getViewHtml()}else{if(!this.getValidSearcher()){return !!this.getJql()}else{return !!this.getQueryString()}}},clearSearchState:function(){this.set({viewHtml:null,editHtml:null,jql:null,validSearcher:null,isSelected:false})},_now:Date.now||function(){return new Date().getTime()},select:function(){this.set({isSelected:true,position:this.collection.getNextPosition(),validSearcher:true,lastViewed:this._now()})},retrieveEditHtml:function(){var a=this.collection.createJql();if(this.getEditHtml()){return jQuery.Deferred().resolve(this.getEditHtml())}return JIRA.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/QueryComponentRendererEdit!Default.jspa",success:_.bind(this.setEditHtml,this),dataType:"html",error:JIRA.Issues.displayFailSearchMessage,data:{fieldId:this.getId(),decorator:"none",jqlContext:a}})},hasErrorInEditHtml:function(){var a=jQuery("<div>").htmlCatchExceptions(this.getEditHtml());if(!a){return false}else{return a.find(".error, .has-errors").length>0}},clearEditHtml:function(){this.setEditHtml(null)},_onEditHtmlUpdated:function(){this.setSerializedParams(jQuery("<form/>").appendCatchExceptions(this.getEditHtml()).serialize())},getTooltipText:function(){if(this.getValidSearcher!==false){var a=this.getDisplayText()||"All";return this.getName()+": "+a}else{return "This criteria is not valid for the project and/or issue type"}},searchersReady:function(){return this.collection.searchersReady()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherCollection.js' */
JIRA.Issues.SearcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SearcherModel,namedEvents:["searchRequested","collectionChanged","jqlTooComplex","textFieldChanged","requestUpdateFromView","interactiveChanged","beforeCriteriaRemoved"],QUERY_PARAM:"text",QUERY_ID:"text",JQL_INVALID_QUERY_PREFIX:"__jql_",initialize:function(b,a){if(b&&b.length){this._searcherCache=b}this.fixedLozenges=a&&a.fixedLozenges?a.fixedLozenges:[];this.queryStateModel=a&&a.queryStateModel;this.initData=a&&a.initData;this._interactive=true},_createItemDescriptors:function(a){return _.map(a,function(b){return new AJS.ItemDescriptor({meta:{isShown:b.isShown},label:b.name,title:b.isShown?b.name:b.name+" "+"is not applicable for the current project and/or issue type.",selected:b.isSelected||b.jql,value:b.id})})},getAddMenuGroupDescriptors:function(){this._updateSearcherCache();var d=this.fixedLozengeIds().concat(this.QUERY_ID);var a=_.filter(this._searcherCache,function(e){var g=_.contains(d,e.id);var f=!!e.groupName;return !g&&f});if(a.length){var b=new AJS.GroupDescriptor({label:"All Criteria",items:this._createItemDescriptors(_.sortBy(a,function(e){return e.name.toLowerCase()}))});var c=new AJS.GroupDescriptor({label:"Recent Criteria",items:this._createItemDescriptors(_.first(_.sortBy(_.filter(a,function(e){return e.lastViewed}),function(e){return -e.lastViewed}),AJS.Meta.getNumber("max-recent-searchers")))});return[c,b]}else{return[]}},getSearcher:function(b){var a=this.get(b);if(!a){this.add(this._searcherCache[b]);a=this.get(b)}return a},setJql:function(b,a){this._addOrSet(b,{jql:a})},createJql:function(){var a=this.pluck("jql");return _.filter(a,_.isNotBlank).join(" AND ")||""},isDirty:function(){return this.any(function(a){return a.getJql()!==undefined&&a.getJql()!==""})},clearSearchState:function(){this.each(function(a){a.clearSearchState()});this._querySearchersAndValues("")},clearClause:function(c){var b=this.get(c);var a=b&&b.hasClause();if(b){b.clearSearchState()}this.triggerCollectionChanged();this.triggerRequestUpdateFromView();if(a){this.triggerSearchRequested(this.createJql())}},getTextQuery:function(){var a=this.get(this.QUERY_ID);return a?a.getViewHtml():""},setInteractive:function(a){if(a!==this._interactive){this._interactive=a;this.triggerInteractiveChanged(a)}},isInteractive:function(){return this._interactive},handleBasicViewSubmit:function(){this.triggerRequestUpdateFromView();this.triggerSearchRequested(this.createJql())},updateTextQuery:function(a){if(a){var b=AJS.escapeHtml(a);this._addOrSet(this.QUERY_ID,{viewHtml:b,editHtml:b,jql:JIRA.Issues.TextQueryBuilder.buildJql(a)})}else{this.remove(this.QUERY_ID)}this.triggerTextFieldChanged()},getQueryString:function(){var a=[];this.each(function(c){var b=c.getQueryString();if(b){a.push(b)}});return a.join("&")},_addOrSet:function(e,d,b){var a=this.get(e);if(a){if(b&&b.parse&&a.parse){d=a.parse(d);delete b.parse}if(d.jql){d.isSelected=true}a.set(d,b)}else{var c=_.clone(d);c.id=e;c.isSelected=!!d.jql;this.add(c,b);a=this.get(e)}return a},restoreFromQuery:function(a,d){this.queryStateModel.setJql(a);var c={jql:this.queryStateModel.getJql()||"",decorator:"none"};if(this.initData){if(!this.initData.errorMessages){this._onQuerySearchersAndValues(this.initData);this.initData=null;return jQuery.Deferred().resolve()}else{this._handleSearcherError(c.jql,this.initData);this.initData=null;return jQuery.Deferred().reject()}}else{var b=AJS.$.ajax({url:AJS.contextPath()+"/secure/QueryComponent!Jql.jspa",headers:{"X-SITEMESH-OFF":true},data:c,type:"POST"});b.success(_.bind(function(e){if(d){this.clearExpectingUpdate(d)}this._onQuerySearchersAndValues(e)},this));b.error(_.bind(function(h){if(d){this.clearExpectingUpdate()}try{var f=JSON.parse(h.responseText);if(f){this._handleSearcherError(c.jql,f)}}catch(g){console.log("search response error - not JSON?")}},this));b.always(function(){JIRA.trace("jira.search.searchers.updated")});return b}},clearExpectingUpdate:function(){this.reset();this.updateTextQuery("")},_handleSearcherError:function(a,b){if(_.include(b.errorMessages,"jqlTooComplex")||_.include(b.errorMessages,"jqlInvalid")){window.setTimeout(_.bind(function(){this.triggerJqlTooComplex(a)},this),0)}},searcherAffectsContext:function(a){return"project"===a||"issuetype"===a},createOrUpdateClauseWithQueryString:function(c,b){this.triggerRequestUpdateFromView();var a;if(this.searcherAffectsContext(c)){a=this._querySearchersAndValues(this.getQueryString())}else{a=this._querySearchersByValue(c)}a.done(_.bind(function(){if((this.queryStateModel.getBasicAutoUpdate()||b)&&!this.containsInvalidSearchers()){this.triggerSearchRequested(this.createJql())}},this));return a},containsInvalidSearchers:function(){return this.any(function(a){return a.hasErrorInEditHtml()})},_querySearchersByValue:function(d){var a=this.get(d);var c=AJS.$.param({decorator:"none",jqlContext:this.queryStateModel.getJql()});if(a){var b=a.getQueryString();if(b){c=c+"&"+b}}if(this._activeSearcherReq){this._activeSearcherReq.abort()}return this._activeSearcherReq=JIRA.SmartAjax.makeRequest({type:"POST",data:c,processData:false,url:contextPath+"/secure/QueryComponentRendererValue!Default.jspa",success:_.bind(function(f){var e=this.get(d);if(e){if(f[d]){f[d].groupName=e.getGroupName();f[d].groupId=e.getGroupId()}else{f[d]=_.extend(e.toJSON(),{editHtml:null,jql:null,viewHtml:null})}}this._setSearchersFromData(f,true)},this),dataType:"json",error:function(e){JIRA.Issues.displayFailSearchMessage(e)}}).always(_.bind(function(){this._activeSearcherReq=null},this))},_parseSearcherGroups:function(c){var a={};var b=this.queryStateModel.getWithout();_.each(c.groups,function(d){_.each(d.searchers,function(e){if(!_.contains(b,e.id)){e.groupId=d.type;e.groupName=d.title;a[e.id]=e}})});return a},_querySearchersAndValues:function(b){var a="decorator=none";if(this._activeSearcherReq){if(this._activeSearcherQuery===b){return jQuery.Deferred().reject()}this._activeSearcherReq.abort()}this._activeSearcherQuery=b;if(b){a+="&"+b}this._activeSearcherReq=AJS.$.ajax({url:contextPath+"/secure/QueryComponent!Default.jspa",headers:{"X-SITEMESH-OFF":true},type:"POST",data:a,processData:false});this._activeSearcherReq.done(_.bind(function(c){this._onQuerySearchersAndValues(c)},this));this._activeSearcherReq.fail(_.bind(function(c){JIRA.Issues.displayFailSearchMessage(c)},this));this._activeSearcherReq.always(_.bind(function(){this._activeSearcherReq=null},this));return this._activeSearcherReq},clear:function(){this.reset([],{silent:true});this.updateTextQuery("");this.triggerCollectionChanged()},searchersReady:function(){if(this._activeSearcherReq){return this._activeSearcherReq}else{return jQuery.Deferred().resolve()}},_onQuerySearchersAndValues:function(c){var d=this,a=this._parseSearcherGroups(c.searchers);_.each(c.values,_.bind(function(f,g){var e=a[g];if(!e){a[g]=f}else{_.extend(e,f)}},this));var b=[];this.each(function(f){var e=f.id;if(!_.any(a,function(g){return g.id===e})){if(f.getIsSelected()){f.setValidSearcher(false)}else{b.push(f)}}});if(b.length){this.remove(b)}this._setSearchersFromData(a)},_updateSearcherCache:function(){if(this._searcherCache){this.each(_.bind(function(a){this._searcherCache[a.id]=a.toJSON();this._searcherCache[a.id].id=a.id},this))}},_setSearchersFromData:function(a,b){_.each(a,_.bind(function(c,d){this._addOrSet(d,{groupId:c.groupId,groupName:c.groupName,isShown:c.isShown,name:c.name,viewHtml:c.viewHtml,jql:c.jql,editHtml:c.editHtml,validSearcher:c.validSearcher,key:c.key,lastViewed:c.lastViewed},{parse:true})},this));if(b){this._updateSearcherCache()}else{this._searcherCache=a}this.triggerCollectionChanged();JIRA.trace("jira.search.searchers.updated")},getVariableClauses:function(){var a=[];this.each(_.bind(function(b){if(!this.isFixed(b)&&b.hasClause()){a.push(b)}},this));return a},getSelectedCriteria:function(){var a=this;var b=function(c){return !a.isFixed(c)&&(c.hasClause()||c.getIsSelected())};return this.chain().filter(b).sortBy(function(c){return c.getPosition()}).value()},getAllSelectedCriteriaCount:function(){return this.getAllSelectedCriteria().length},getAllSelectedCriteria:function(){var a=[];this.each(_.bind(function(b){if(b.hasClause()||b.getIsSelected()){a.push(b)}},this));return a},isFixed:function(a){return _.contains(this.fixedLozengeIds(),a.getId())||a.getId()===this.QUERY_ID},fixedLozengeIds:function(){return _.pluck(this.fixedLozenges,"id")},getNextPosition:function(){return this.reduce(function(b,c){var a=Math.max(b,c.getPosition());return isNaN(a)?b:a},-1)+1}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaModel.js' */
JIRA.Issues.CriteriaModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name"]});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CardView.js' */
AJS.namespace("JIRA.Issues.CardView");JIRA.Issues.CardView=JIRA.Issues.Brace.View.extend({namedEvents:["viewChanged"],initialize:function(a){this.views=a.views;if(a.activeView){this.activeView=a.activeView}else{var b=_.keys(this.views);if(b.length>0){this.activeView=b[0]}}},render:function(){this._renderActiveView()},changeToView:function(a){if(a===this.activeView){return}this.activeView=a;if(this.$el){this._renderActiveView(a)}this.triggerViewChanged(a)},_renderActiveView:function(){var a=this.views[this.activeView];a.setElement(this.$el);a.render()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryView.js' */
JIRA.Issues.BasicQueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize","searchRequested"],template:JIRA.Templates.IssueNavQueryBasic.basicQueryView,initialize:function(a){this.searcherCollection=a.searcherCollection;this.queryStateModel=a.queryStateModel;this.textFieldView=new JIRA.Issues.TextFieldView({collection:this.searcherCollection});this.primaryCriteriaContainerView=new JIRA.Issues.PrimaryCriteriaContainerView({collection:this.searcherCollection});this.extendedCriteriaContainerView=new JIRA.Issues.ExtendedCriteriaContainerView({collection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this);if(this.queryStateModel.getBasicOrderBy()){this.basicOrderByView=JIRA.Components.OrderBy.create();this.queryStateModel.on("change:jql",function(){this.basicOrderByView.setJql(this.queryStateModel.getJql())},this);this.basicOrderByView.onSort(this.triggerSearchRequested,this)}this.clauseButtonView=new JIRA.Issues.ClauseButtonView({searcherCollection:this.searcherCollection,queryStateModel:this.queryStateModel});this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.onBeforeCriteriaRemoved(this._handleBeforeCriteriaRemoved,this)},_handleInteractiveChanged:function(a){this.$el.toggleClass("loading",!a)},_handleBeforeCriteriaRemoved:function(b,a){if(a){this._shiftFocus(b,a)}},hasPdl:function(){var a=AJS.Meta.get("version-number");if(a){return parseInt(a.charAt(0),10)>=6}},render:function(){this.$el.html(this.template({hasPdl:this.hasPdl(),hasOrderBy:this.queryStateModel.getBasicOrderBy(),hasSearchButton:this.queryStateModel.hasSearchButton()}));this.primaryCriteriaContainerView.setElement(this.$el.find(".search-criteria .criteria-list"));this.textFieldView.setElement(this.$el.find("input.search-entry"));this.clauseButtonView.setElement(this.$el.find(".criteria-actions"));this.extendedCriteriaContainerView.setElement(this.$el.find(".search-criteria-extended .criteria-list"));if(this.basicOrderByView){this.basicOrderByView.setElement(this.$el.find(".list-ordering")).render();this.basicOrderByView.setJql(this.queryStateModel.getJql())}this.primaryCriteriaContainerView.render();this.$el.find(".text-query").removeClass("hidden");this.textFieldView.render();this.clauseButtonView.render();this.extendedCriteriaContainerView.render();this._handleInteractiveChanged(this.searcherCollection.isInteractive());this.triggerVerticalResize();new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});return this},search:function(){this.searcherCollection.handleBasicViewSubmit()},_shiftFocus:function(b,f){var e=this.primaryCriteriaContainerView.getFocusableForCriteria(b);if(!e.length){e=this.extendedCriteriaContainerView.getFocusableForCriteria(b)}var d=this.primaryCriteriaContainerView.getFocusables().add(this.extendedCriteriaContainerView.getFocusables());var c=d.index(e);var a;if(c===0){a=1}else{if(c===d.length-1){a=d.length-2}else{a=c+f}}d.eq(a).focus()},focus:function(){this.primaryCriteriaContainerView.getFocusables().first().focus()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextFieldView.js' */
AJS.namespace("JIRA.Issues.TextFieldView");JIRA.Issues.TextFieldView=JIRA.Issues.Brace.View.extend({namedEvents:["searchRequested"],events:{keypress:"handleKeypress"},initialize:function(){_.bindAll(this,"_updateSearcherCollectionTextField","_handleInteractiveChanged","render");this.collection.on("remove change add",_.bind(function(a){if(a.getId()===this.collection.QUERY_ID){this.render()}},this));this.collection.onTextFieldChanged(this.render);this.collection.onRequestUpdateFromView(this._updateSearcherCollectionTextField);this.collection.onInteractiveChanged(this._handleInteractiveChanged)},handleKeypress:function(a){if(a.keyCode===13){this.collection.handleBasicViewSubmit();a.preventDefault()}},render:function(){var a=this.collection.get(this.collection.QUERY_ID);if(a){var c=a.getEditHtml();var b=AJS.$("<div></div>").html(c||"").text();this.setQuery(b)}else{this.setQuery("")}},setQuery:function(a){this.$el.val(a)},_updateSearcherCollectionTextField:function(){if(this.$el.is("input")){var a=AJS.$.trim(this.$el.val());this.collection.updateTextQuery(a)}},_handleInteractiveChanged:function(a){this.$el.prop("disabled",!a)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/PrimaryCriteriaContainerView.js' */
JIRA.Issues.PrimaryCriteriaContainerView=JIRA.Issues.Brace.View.extend({initialize:function(){this._criteriaViews=_.map(this.collection.fixedLozenges,function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel(a),searcherCollection:this.collection})},this)},render:function(){_.each(this._criteriaViews,function(a){a.render()});this.$el.prepend(_.pluck(this._criteriaViews,"el"))},getCriteriaViews:function(){return this._criteriaViews},getFocusables:function(){return this.$(".criteria-selector, #searcher-query, .add-criteria, .search-button")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ExtendedCriteriaContainerView.js' */
JIRA.Issues.ExtendedCriteriaContainerView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],initialize:function(a){this.collection.on("change:isSelected",this._onCriteriaSelectionChanged,this);this.collection.on("add",this._onCriteriaSelectionChanged,this);this.collection.on("remove",this._removeViewForSearcher,this);this.collection.on("reset",this._onReset,this);this._criteriaViews=_.map(this.collection.getSelectedCriteria(),_.bind(function(b){if(b.getPosition()==null){b.setPosition(this.collection.getNextPosition())}return this._buildCriteriaViewForSearcher(b)},this))},render:function(){_.each(this._criteriaViews,_.bind(function(a){a.render();this.$el.append(a.$el)},this))},getFocusables:function(){return this.$(".criteria-selector")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')},_buildCriteriaViewForSearcher:function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel({id:a.get("id"),name:a.get("name")}),searcherCollection:this.collection,extended:true})},_onCriteriaSelectionChanged:function(a){if(a.getIsSelected()&&!this.collection.isFixed(a)){this._addViewForSearcher(a)}else{this._removeViewForSearcher(a)}},_addViewForSearcher:function(b){var a=this._buildCriteriaViewForSearcher(b);a.render();this.$el.append(a.$el);this._criteriaViews.push(a);this.triggerVerticalResize()},_removeViewForSearcher:function(a){this._criteriaViews=_.reject(this._criteriaViews,function(b){if(b.model.getId()===a.getId()){b.destroy();return true}return false});this.triggerVerticalResize()},_onReset:function(){_.each(this._criteriaViews,function(a){a.destroy()});this._criteriaViews=[]}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherGroupListDialogView.js' */
(function(){var a;JIRA.Issues.SearcherGroupListDialogView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent,namedEvents:["searcherSelected","hideRequested"],events:{keydown:"_keyPressed"},initialize:function(b){this.searcherCollection=b.searcherCollection;this.$el.scrollLock(".aui-list-scroll")},render:function(){var f=this.searcherCollection.getAddMenuGroupDescriptors(),e=f.length&&f[0].properties.items.length>JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;var c=jQuery(AJS.Templates.queryableSelect({descriptors:f,id:"criteria"}));this.$el.empty().append(c);var d={element:c,suggestionsHandler:JIRA.Issues.SearcherGroupListDialogView.SuggestHandler,hideFooterButtons:true};var h="...excluding \u003cspan class=hidden-no\u003e\u003c/span\u003e hidden",g="These criteria are hidden because they are not applicable to the current project and/or issue type";if(e){d.maxInlineResultsDisplayed=JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;h="...excluding \u003cspan class=hidden-no\u003e\u003c/span\u003e hidden. Please enter a keyword to refine.";g="These criteria are hidden because there are either too many to display or they are not applicable to the current project and/or issue type"}var b=new AJS.CheckboxMultiSelect(d);a=jQuery("<div class='more-criteria-footer' />").html(h);this.$el.append(a);new JIRA.Issues.Tipsy({el:a,tipsy:{title:function(){return g},className:"tipsy-front"}});this.$el.unbind("selected").bind("selected",_.bind(this._searcherSelected,this));this.$el.unbind("unselect").bind("unselect",_.bind(this._searcherUnselected,this));return this.$el},_searcherUnselected:function(c,b){this.searcherCollection.clearClause(b.properties.value)},_searcherSelected:function(d,c){var b=this.searcherCollection.getSearcher(c.properties.value);b.select();JIRA.Issues.SearcherDialog.instance.hide();JIRA.Issues.SearcherDialog.instance.show(b)},_keyPressed:function(f){if(f.keyCode===AJS.$.ui.keyCode.TAB){var b=AJS.$(":tabbable",this.$el);var c=(b.length===0);var e=(f.shiftKey&&(document.activeElement===b.first()[0]));var d=(!f.shiftKey&&(document.activeElement===b.last()[0]));if(c||e||d){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);f.preventDefault()}}}},{CRITERIA_DISPLAY_LIMIT:100});JIRA.Issues.SearcherGroupListDialogView.SuggestHandler=AJS.CheckboxMultiSelectSuggestHandler.extend({formatSuggestions:function(b,c){var e=0,d=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());b.splice(0,0,new AJS.GroupDescriptor({actionBarHtml:d.length>1?this.createClearAll():null,items:d,styleClass:"selected-group"}));_.each(b,function(g){if(c.length===0){var f=_.filter(g.items(),function(i,h){var j=i.meta();return j&&j.isShown&&h<JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT});e+=g.items().length-f.length;g.items(f)}else{_.each(g.items(),function(h){var i=h.meta();h.disabled(!(i&&i.isShown))})}});_.defer(function(){if(a){if(e){a.show().find(".hidden-no").text(e)}else{a.hide()}}});return b}})})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherEditDialogView.js' */
JIRA.Issues.SearcherEditDialogView=JIRA.Issues.Brace.View.extend({namedEvents:["backRequested","hideRequested"],autoUpdate:[".js-default-checkboxmultiselect",".js-default-checkboxmultiselectstatuslozenge",".js-user-checkboxmultiselect",".js-usergroup-checkboxmultiselect",".js-group-checkboxmultiselect",".js-label-checkboxmultiselect"],events:function(){var a={"click .cancel-update":"_onCancelClicked",click:"_stopPropagation",submit:"_onSubmit",keydown:"_keyPressed"};if(this.queryStateModel.getBasicAutoUpdate()){a["selected "+this.autoUpdate.join(",")]="applyChanges";a["unselect "+this.autoUpdate.join(",")]="applyChanges"}return a},template:JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent,initialize:function(a){this._formData="";this.queryStateModel=a.queryStateModel;this.$el.scrollLock(".aui-list-scroll")},renderDeferred:function(){var a=jQuery.Deferred();this.model.retrieveEditHtml().done(_.bind(function(b){a.resolve(this.render(b))},this));return a.promise()},hasAutoUpdate:function(a){return this.queryStateModel.getBasicAutoUpdate()&&jQuery(a).find(this.autoUpdate.join(",")).length!==0},render:function(b){var a=!(/^\s*$/.test(b));var c;if(a){c=AJS.$(this.template({displayBackButton:this.displayBackButton,displayUpdateCancel:!this.hasAutoUpdate(b)&&!jQuery(b).hasClass("searchfilter-not-found")}))}else{c=AJS.$(JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit({fieldName:this.model.getName()}))}this.$el.html(c);this.$el.find(".form-body").appendCatchExceptions(b);this.$el.find("form").addClass(this.model.id+"-criteria");this.$el.find("label:first").remove();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed]);this._formData=this.$el.find("form").serialize();this.model.setInitParams(this._formData);return this.$el},_stopPropagation:function(a){a.stopPropagation()},_preventDefault:function(a){a.preventDefault()},applyFilter:function(){var b=this.$el.find("form").serialize();var a=(b!==this._formData);this._formData=b;this.model.setSerializedParams(this._formData);return a},applyChanges:function(){if(this.applyFilter()){this.model.createOrUpdateClauseWithQueryString()}},_onCancelClicked:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.cancelClicked)},_onSubmit:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.submit)},_keyPressed:function(e){if(e.keyCode===AJS.$.ui.keyCode.TAB){var a=AJS.$(":tabbable",this.$el);var b=(a.length===0);var d=(e.shiftKey&&(document.activeElement===a.first()[0]));var c=(!e.shiftKey&&(document.activeElement===a.last()[0]));if(b||d||c){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);e.preventDefault()}}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseListDialogView.js' */
AJS.namespace("JIRA.Issues.ClauseListDialogView");JIRA.Issues.ClauseListDialogView=JIRA.Issues.Brace.View.extend({events:{"click .clauses .searcherValue":"_clauseSelected","click .remove-filter":"_removeFilterRequested"},template:JIRA.Templates.IssueNavQueryBasic.enabledClauses,namedEvents:["clauseSelected","hideRequested"],initialize:function(a){this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this._renderAndCheckForClose,this)},render:function(){this.$el.html(this.template({clauses:this._getClauses()}))},_renderAndCheckForClose:function(){this.render();if(!this._getClauses().length){this.triggerHideRequested()}},_clauseSelected:function(b){b.preventDefault();var a=AJS.$(b.target),c=a.parents("li").first().data("id");this.triggerClauseSelected(c)},_removeFilterRequested:function(b){b.preventDefault();var a=this;_.defer(function(){var c=AJS.$(b.target),e=c.parents("li").first();var d=e.data("id");a.searcherCollection.clearClause(d);e.remove();a.triggerHideRequested()})},_getClauses:function(){var b=this.searcherCollection.getVariableClauses();var a=_.invoke(b,"toJSON");_.each(a,this._formatForTemplate);return a},_formatForTemplate:function(a){if(a.validSearcher){a.invalidMessage=""}else{a.invalidMessage="This criteria is not valid for the project and/or issue type"}}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseButtonView.js' */
JIRA.Issues.ClauseButtonView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.clauseButtonView,addCriteriaButton:".add-criteria",events:{"click .add-criteria":"_showDialog","keydown .add-criteria":"_onKeydown"},initialize:function(c){_.bindAll(this,"_handleInteractiveChanged","_showOrHideClauseButtons");var a=this;this.queryStateModel=c.queryStateModel;this.searcherCollection=c.searcherCollection;this.searcherCollection.onCollectionChanged(this._showOrHideClauseButtons);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged);var d=this.dialog=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return a.$el.find(a.addCriteriaButton)},content:function(){return b.render()}});d.bind(AJS.InlineLayer.EVENTS.hide,function(h,f,g){if(g===AJS.HIDE_REASON.escPressed||g===AJS.HIDE_REASON.toggle||g==AJS.HIDE_REASON.tabbedOut){a.$(a.addCriteriaButton).focus()}});var b=new JIRA.Issues.SearcherGroupListDialogView({searcherCollection:this.searcherCollection,dialog:d});b.onHideRequested(function(e){d.hide(e)});d.bind(AJS.InlineLayer.EVENTS.show,function(f,e){jQuery("#criteria-input").focus();e.find(".aui-list-scroll").scrollTop(0)})},render:function(){this.$el.html(this.template({isSubtle:this.queryStateModel.hasSubtleMoreCriteria()}));this._showOrHideClauseButtons();this._addToolTip();return this.$el},_addToolTip:function(){new JIRA.Issues.Tipsy({el:this.$el.find(this.addCriteriaButton),showCondition:":not(.active)"})},_showOrHideClauseButtons:function(){var a=this.$(this.addCriteriaButton);if(this.searcherCollection.getAddMenuGroupDescriptors().length>0){a.show()}else{a.hide()}},_showDialog:function(a){if(this.searcherCollection.isInteractive()){this.dialog.toggle()}a.preventDefault()},_handleInteractiveChanged:function(a){this.$(this.addCriteriaButton).attr("aria-disabled",(a)?null:"true")},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog(a);break;case AJS.$.ui.keyCode.ESCAPE:jQuery(a.target).blur();break;case AJS.$.ui.keyCode.BACKSPACE:break;default:return}a.preventDefault()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherDialog.js' */
JIRA.Issues.SearcherDialog=function(){return{initialize:function(b){if(!this.instance){this.instance=a(b)}}};function a(b){AJS.HIDE_REASON.switchLozenge="switchLozenge";var f=[AJS.HIDE_REASON.escPressed,AJS.HIDE_REASON.toggle,AJS.HIDE_REASON.cancelClicked,AJS.HIDE_REASON.submit,AJS.HIDE_REASON.tabbedOut];function e(i){return i?jQuery(".criteria-selector[data-id='"+i.getId()+"']"):jQuery()}var h;var d;var c;var g=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return e(d)},content:function(){c=new JIRA.Issues.SearcherEditDialogView({model:d,queryStateModel:b.queryStateModel});c.onHideRequested(function(i){g.hide(i)});return c.renderDeferred()}});g.bind(AJS.InlineLayer.EVENTS.show,function(k,i){var j=i.find(":input:not(submit):visible:first");j.focus();i.find(".aui-list-scroll").scrollTop(0)});g.bind(AJS.InlineLayer.EVENTS.beforeHide,function(l,j,k,m,i){if(k===AJS.HIDE_REASON.clickOutside&&i&&jQuery(i).closest(".calendar").length){l.preventDefault()}});g.bind(AJS.InlineLayer.EVENTS.hide,function(m,j,l){var k=d;if(_.contains(f,l)){e(k).focus()}function i(){h=d.createOrUpdateClauseWithQueryString(l===AJS.HIDE_REASON.submit);h.done(function(){if(k.hasErrorInEditHtml()){if(b.queryStateModel.getSearchMode()==="basic"){JIRA.Issues.SearcherDialog.instance.show(k)}}if(AJS.InlineLayer.current){AJS.InlineLayer.current.setPosition()}});h.always(function(){h=null});k.clearEditHtml()}if(l===AJS.HIDE_REASON.submit){c.applyFilter();i()}else{if(l!==AJS.HIDE_REASON.cancelClicked&&l!==AJS.HIDE_REASON.escPressed&&l!==AJS.HIDE_REASON.tabbedOut){if(c.applyFilter()){i()}}else{JIRA.trace("jira.search.searchers.hiddenWithoutUpdate")}}c.$el.remove();c=null;d=null});b.queryStateModel.on("change:searchMode",function(){g.hide()});return{getCurrentSearcher:function(){return d},toggle:function(i){if(d!=null){if(d!==i){g.hide(AJS.HIDE_REASON.switchLozenge);this.show(i)}else{g.hide(AJS.HIDE_REASON.toggle)}}else{this.show(i)}},_show:function(i){_.defer(function(){d=i;g.show();g.setPosition()})},show:function(k){var j;if(JIRA.Issues.SearcherDialog.waitingToShow){j=true}var i=this;JIRA.Issues.SearcherDialog.waitingToShow=function(){i._show(k);JIRA.Issues.SearcherDialog.waitingToShow=null};if(!j){k.searchersReady().done(function(){if(h){h.done(function(){JIRA.Issues.SearcherDialog.waitingToShow()})}else{JIRA.Issues.SearcherDialog.waitingToShow()}})}},onShow:function(i){g.bind(AJS.InlineLayer.EVENTS.show,i)},hide:function(){g.hide()},onHide:function(i){g.bind(AJS.InlineLayer.EVENTS.hide,i)}}}}();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-jql.soy' */
// This file was automatically generated from query-jql.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryJql == 'undefined') { JIRA.Templates.IssueNavQueryJql = {}; }


JIRA.Templates.IssueNavQueryJql.jqlQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-field-container"><div class="atlassian-autocomplete"><label for="advanced-search"><span id="jqlerrormsg" class="icon jqlgood"><span>', soy.$$escapeHtml("parse"), '</span></span> <span class="jql-label">', soy.$$escapeHtml("Query"), ' <span id="jqlcolrowcount">', soy.$$escapeHtml("line"), ':<span id="jqlrownum">0</span>', soy.$$escapeHtml("character"), ':<span id="jqlcolumnnum">0</span></span></span></label><textarea id="advanced-search" class="search-entry advanced-search ajs-dirty-warning-exempt" name="jql"></textarea><a class="syntax-help" href="', soy.$$escapeHtml(opt_data.helpUrl), '" title="', soy.$$escapeHtml("Syntax Help"), '" target="_jirahelp" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-help">', soy.$$escapeHtml("Syntax Help"), '</span></a></div></div><div class="search-options-container">', (opt_data.hasSearchButton) ? '<button class="aui-item aui-button aui-button-subtle search-button" type="button" title="' + soy.$$escapeHtml("Search for issues") + '"><span class="aui-icon aui-icon-small aui-iconfont-search">' + soy.$$escapeHtml("Search") + '</span></button>' : '', '<span class="mode-switcher"></span></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlAutoCompleteView.js' */
JIRA.Issues.JQLAutoCompleteView=JIRA.Issues.Brace.View.extend({namedEvents:["jqlValid","jqlInvalid","searchRequested"],events:{focus:"_onFocus"},getJqlAutoCompleteData:function(){var b=jQuery.Deferred();if(this.jqlFieldNames==null||this.jqlFunctionNames==null||this.jqlReservedWords==null){var c=jQuery("#jqlFieldz");var d=jQuery("#jqlFunctionNamez");var a=jQuery("#jqlReservedWordz");if(c.length>0&&d.length>0&&a.length>0){this.jqlFieldNames=JSON.parse(c.text());this.jqlFunctionNames=JSON.parse(d.text());this.jqlReservedWords=JSON.parse(a.text())}else{AJS.$.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/jqlAutoComplete"}).done(_.bind(function(f){var e=JSON.parse(f);this.jqlFieldNames=_.reject(JSON.parse(e.jqlFieldz),_.bind(function(g){return _.contains(this.model.getWithout(),g.value)},this));this.jqlFunctionNames=JSON.parse(e.jqlFunctionNamez);this.jqlReservedWords=JSON.parse(e.jqlReservedWordz);b.resolve()},this));return b.promise()}}return b.resolve().promise()},_initJQLAutoComplete:function(){var d=this.$el;var b=JIRA.JQLAutoComplete({fieldID:d.attr("id"),parser:JIRA.JQLAutoComplete.MyParser(this.jqlReservedWords),queryDelay:0.65,jqlFieldNames:this.jqlFieldNames,jqlFunctionNames:this.jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var a=this;d.keypress(function(e){if(b.dropdownController===null||!b.dropdownController.displayed||b.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){e.preventDefault();b.dropdownController.hideDropdown();a.triggerSearchRequested(d.val())}}});var a=this;var c=b.updateParseIndicator;b.updateParseIndicator=function(e){c.apply(this,arguments);if(!e.getParseError()){a.triggerJqlValid(d.val())}else{a.triggerJqlInvalid(d.val())}};b.buildResponseContainer();b.parse(d.val());b.updateColumnLineCount();d.bind("expandedOnInput",function(){b.positionResponseContainer()}).bind("updateParseIndicator",function(){b.parse(d.val())}).click(function(){b.dropdownController.hideDropdown()})},_onFocus:function(){if(!this.model.getAutocompleteEnabled()||this.$el.data("JQLAutoComplete_init")){return}this.$el.data("JQLAutoComplete_init",true);this.getJqlAutoCompleteData().done(_.bind(this._initJQLAutoComplete,this))}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryModule.js' */
JIRA.Issues.JqlQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["searchRequested","verticalResize","searchChanged"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.view=new JIRA.Issues.JqlQueryView({queryStateModel:a.queryStateModel}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this).onSearchChanged(this.triggerSearchChanged,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,_.bind(function(d,b,c){if(c===JIRA.CONTENT_ADDED_REASON.returnToSearch){this.setQuery()}},this))},search:function(){var a=this.view.readJql();this.triggerSearchRequested(a)},setQuery:function(){this.view.setQuery()},createView:function(){return this.view}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryView.js' */
JIRA.Issues.JqlQueryView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryJql.jqlQueryView,namedEvents:["verticalResize","searchRequested","searchChanged"],events:{expandedOnInput:"_handleExpandOnInput",input:function(){this.trigger("searchChanged",{newJql:this.readRawJql()})}},initialize:function(a){this.queryStateModel=a.queryStateModel;this.queryStateModel.on("change:jql",this.setQuery,this);AJS.$(document).bind("issueNavWidthChanged",_.bind(this._resizeHeight,this));if(JIRA.Issues.JQLAutoCompleteView){this.JQLAutoCompleteView=new JIRA.Issues.JQLAutoCompleteView({model:this.queryStateModel});this.JQLAutoCompleteView.onJqlValid(function(b){if(this.queryStateModel.getAdvancedAutoUpdate()){this.triggerSearchRequested(b)}},this);this.JQLAutoCompleteView.onSearchRequested(this.triggerSearchRequested,this)}},render:function(){this.$el.html(this.template({helpUrl:AJS.Meta.get("advanced-search-help-url"),helpTitle:AJS.Meta.get("advanced-search-help-title"),hasSearchButton:this.queryStateModel.hasSearchButton()}));this.$el.addClass("loading");if(this.JQLAutoCompleteView){this.JQLAutoCompleteView.setElement(this.$el.find(".advanced-search"));this.JQLAutoCompleteView.getJqlAutoCompleteData()}new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});this.setQuery();return this},readRawJql:function(){var a=this._getInputField();var b=a.val()||"";return b},readJql:function(){var b=this.readRawJql();var a=this._getInputField();var c=AJS.$.trim(b);if(b!==c){a.val(c)}this._resizeHeight();return c},_handleExpandOnInput:function(){this.triggerVerticalResize()},_resizeHeight:function(){var a=this._getInputField();if(a.val()){a.height(0).expandOnInput()}else{a.expandOnInput().height(0).trigger("refreshInputHeight")}},setQuery:function(){this.$el.removeClass("loading");this._getInputField().val(this.queryStateModel.getJql());this._getInputField().trigger("updateParseIndicator");this._resizeHeight()},focus:function(){this._getInputField().focus()},_getInputField:function(){return this.$el?this.$el.find("textarea"):AJS.$()}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query.soy' */
// This file was automatically generated from query.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQuery == 'undefined') { JIRA.Templates.IssueNavQuery = {}; }


JIRA.Templates.IssueNavQuery.searchSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var itemList3 = opt_data.items;
  var itemListLen3 = itemList3.length;
  for (var itemIndex3 = 0; itemIndex3 < itemListLen3; itemIndex3++) {
    var itemData3 = itemList3[itemIndex3];
    JIRA.Templates.IssueNavQuery.searchSwitcherItem({id: itemData3.id, isActive: itemData3.id == opt_data.selectedId}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.searchSwitcherItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" class="switcher-item', soy.$$escapeHtml(opt_data.isActive ? ' active' : ''), ' " data-id=\'', soy.$$escapeHtml(opt_data.id), '\' title="', (opt_data.id == 'basic') ? soy.$$escapeHtml("Switch to advanced search using JQL") : soy.$$escapeHtml("Switch to basic search"), '">', (opt_data.id == 'basic') ? soy.$$escapeHtml("Advanced") : soy.$$escapeHtml("Basic"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.queryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="aui-item search-wrap"><div class="search-container"></div><div class="save-filter-controls"></div></div>', (opt_data.layoutSwitcher) ? '<div class="aui-item view-selector" id="layout-switcher-toggle"></div>' : '', '</div><div class="notifications"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryModule.js' */
JIRA.Issues.QueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlChanged","jqlTooComplex","jqlError","jqlSuccess","searchRequested","searchChanged","queryTooComplexSwitchToAdvanced","changedPreferredSearchMode","basicModeCriteriaCountWhenSearching","verticalResize","initialized"],initialize:function(a){this._queryStateModel=a.queryStateModel;this._queryStateModel.on("change:preferredSearchMode",_.bind(function(){this.triggerChangedPreferredSearchMode(this._queryStateModel.getPreferredSearchMode())},this));JIRA.Issues.SearcherDialog.initialize({queryStateModel:this._queryStateModel});this._jqlQueryModule=new JIRA.Issues.JqlQueryModule({queryStateModel:this._queryStateModel}).onSearchRequested(this.handleAdvancedSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this).onSearchChanged(this.triggerSearchChanged,this);this._errors={};this._errors[this._queryStateModel.BASIC_SEARCH]=[];this._errors[this._queryStateModel.ADVANCED_SEARCH]=[];this._queryStateModel.on("change:searchMode",this.showSearchErrors,this);this._basicQueryModule=new JIRA.Issues.BasicQueryModule({queryStateModel:this._queryStateModel,primaryClauses:a.primaryClauses,initialSearcherCollectionState:a.searchers}).onSearchRequested(this.clearSearchErrors,this).onJqlTooComplex(this.handleJqlTooComplex,this).onSearchRequested(this.handleSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this).onBasicModeCriteriaCountWhenSearching(this.triggerBasicModeCriteriaCountWhenSearching,this)},refreshLayout:function(){this._jqlQueryModule.setQuery()},handleAdvancedSearchRequested:function(a){this.handleSearchRequested(a);this._basicQueryModule.queryChanged()},handleSearchRequested:function(a){this._queryStateModel.setJql(a);this.clearSearchErrors()},handleJqlTooComplex:function(a){if(this.getSearchMode()!==this._queryStateModel.ADVANCED_SEARCH){this.triggerQueryTooComplexSwitchToAdvanced()}this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH);this.triggerJqlTooComplex(a);if(this._queryView){this._queryView.switcherViewModel.disableSwitching()}},getJql:function(){return this._queryStateModel.getJql()},getSearcherCollection:function(){return this._basicQueryModule.searcherCollection},isBasicMode:function(){return this._queryStateModel.getSearchMode()===this._queryStateModel.BASIC_SEARCH},resetToQuery:function(a,b){this.clearSearchErrors();return this._basicQueryModule.queryReset(a).always(_.bind(function(){this._queryStateModel.switchToPreferredSearchMode();this._jqlQueryModule.setQuery();if(b&&b.focusQuery===true){this._queryView.getView().focus()}this._basicQueryModule.off("searchRequested",this.publishJqlChanges);this._jqlQueryModule.off("searchRequested",this.publishJqlChanges);this._basicQueryModule.onSearchRequested(this.publishJqlChanges,this);this._jqlQueryModule.onSearchRequested(this.publishJqlChanges,this)},this))},publishJqlChanges:function(a){this.triggerJqlChanged(a)},setVisible:function(a){this._queryView.setVisible(a)},queryChanged:function(){this.clearSearchErrors();this._basicQueryModule.queryChanged()},onSearchSuccess:function(a){if(this._queryView){this._queryView.showWarnings(a)}this.triggerJqlSuccess()},searchersReady:function(){return this._basicQueryModule.searchersReady()},onSearchError:function(b){this._errors.renderFunction="showErrors";var c=(b.errorMessages)?b.errorMessages.concat():[];var a=[];_.each(b.errors,function(e,d){if(d==="jql"){a.push(e)}else{c.push(e)}});if(this.getSearchMode()===this._queryStateModel.BASIC_SEARCH&&!this._basicQueryModule.hasErrors()&&a.length>0){this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH)}this._errors[this._queryStateModel.BASIC_SEARCH]=c;this._errors[this._queryStateModel.ADVANCED_SEARCH]=a.concat(c);this.showSearchErrors();this.triggerJqlError()},showSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();var a=this._errors.renderFunction||"showErrors";this._queryView[a](this._errors[this.getSearchMode()])}},clearSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();this._queryView.switcherViewModel.enableSwitching()}this._errors[this._queryStateModel.BASIC_SEARCH].length=0;this._errors[this._queryStateModel.ADVANCED_SEARCH].length=0},getSearchMode:function(){return this._queryStateModel.getSearchMode()},getActiveBasicModeSearchers:function(){return this._basicQueryModule.getSelectedCriteria()},setSearchMode:function(a){if(this.getSearchMode()!==a){this._queryStateModel.switchToSearchMode(a);return true}return false},createAndRenderView:function(a){this._queryView=new JIRA.Issues.QueryView({el:a,queryStateModel:this._queryStateModel,basicQueryModule:this._basicQueryModule,jqlQueryModule:this._jqlQueryModule}).onVerticalResize(this.triggerVerticalResize,this);this._queryView.render()},isQueryValid:function(){return(this._errors&&this._errors[this._queryStateModel.BASIC_SEARCH].length===0&&this._errors[this._queryStateModel.ADVANCED_SEARCH].length===0)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryStateModel.js' */
JIRA.Issues.QueryStateModel=JIRA.Issues.Brace.Model.extend({BASIC_SEARCH:"basic",ADVANCED_SEARCH:"advanced",namedAttributes:["style","searchMode","preferredSearchMode","jql","without","layoutSwitcher","autocompleteEnabled","advancedAutoUpdate","basicAutoUpdate","basicOrderBy"],defaults:{searchMode:"basic",preferredSearchMode:"basic"},switchToSearchMode:function(a){this.setSearchMode(a)},switchPreferredSearchMode:function(a){this.switchToSearchMode(a);this.setPreferredSearchMode(a);this._savePreferredSearchMode()},switchToPreferredSearchMode:function(){this.switchToSearchMode(this.getPreferredSearchMode())},hasSearchButton:function(){return this.getStyle()!=="field"},hasSubtleMoreCriteria:function(){return this.getStyle()!=="field"},_savePreferredSearchMode:function(){jQuery.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/userSearchMode",type:"POST",headers:{"X-Atlassian-Token":"nocheck"},data:{searchMode:this.getPreferredSearchMode()},error:_.bind(function(a){if(JIRA.Issues.displayFailSearchMessage){JIRA.Issues.displayFailSearchMessage(a)}},this),success:function(){JIRA.trace("jira.search.mode.changed")}})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherModel.js' */
JIRA.Issues.SwitcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","view","text"]});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherCollection.js' */
JIRA.Issues.SwitcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SwitcherModel});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QuerySwitcherViewModel.js' */
JIRA.Issues.QuerySwitcherViewModel=JIRA.Issues.Brace.Model.extend({mixins:[JIRA.Issues.Mixin.SingleSelect],namedAttributes:["disabled"],namedEvents:["selectionChanged"],initialize:function(a,b){this.queryStateModel=b.queryStateModel;this.queryStateModel.on("change:searchMode",_.bind(function(){this.triggerSelectionChanged.apply(this,arguments)},this))},getSelected:function(){var a=this.queryStateModel.getSearchMode();return a?this.getCollection().get(a):null},setSelected:function(a){this.queryStateModel.switchPreferredSearchMode(a?a.id:null)},enableSwitching:function(){this.setDisabled(false)},disableSwitching:function(){this.setDisabled(true)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryView.js' */
JIRA.Issues.QueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],template:JIRA.Templates.IssueNavQuery.queryView,events:{"click .search-button":"search",submit:"preventDefault"},initialize:function(a){this.queryStateModel=a.queryStateModel;var b=new JIRA.Issues.SwitcherCollection([{id:this.queryStateModel.BASIC_SEARCH,name:"Basic",view:a.basicQueryModule.createView()},{id:this.queryStateModel.ADVANCED_SEARCH,name:"Advanced",view:a.jqlQueryModule.createView()}]);this.jqlQueryModule=a.jqlQueryModule;this.switcherViewModel=new JIRA.Issues.QuerySwitcherViewModel({collection:b},{queryStateModel:this.queryStateModel});this.switcherView=new JIRA.Issues.SwitcherView({template:JIRA.Templates.IssueNavQuery.searchSwitcher,model:this.switcherViewModel,containerClass:".search-container"}).onVerticalResize(this.triggerVerticalResize,this)},render:function(){this.$el.html(this.template(this.queryStateModel.toJSON()));this.switcherView.setElement(this.$el).render();return this},preventDefault:function(a){a.preventDefault()},clearNotifications:function(){this.$(".notifications").empty()},search:function(){if(this.queryStateModel.ADVANCED_SEARCH===this.switcherViewModel.getSelected().getId()){this.jqlQueryModule.search()}else{this.getView().search()}},getView:function(){return this.switcherViewModel.getSelected().getView()},showErrors:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.errorMessage({messages:a}))},showWarnings:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.warningMessage({messages:a}))},setVisible:function(a){this.$(".search-container").toggle(a);this.switcherView.setVisible(a)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherView.js' */
JIRA.Issues.SwitcherView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],tagName:"div",events:{"click .switcher-item":"_onSwitcherClick"},initialize:function(a){this.containerClass=a.containerClass;this.model=a.model;this.template=a.template;this.model.onSelectionChanged(this._onSelect,this);this.switchEl=AJS.$();this.model.on("change:disabled",_.bind(this._setSwitching,this))},render:function(){this._onSelect();this._render()},_render:function(){var a=this.model.getSelected();this.switchEl=this.$el.find(".mode-switcher");this.switchEl.html(this.template({items:this.model.getCollection().toJSON(),selectedId:a&&a.id}));new JIRA.Issues.Tipsy({el:this.$el.find(".switcher-item.active")})},getSwitcherTrigger:function(){return this.switchEl.find(".switcher-item.active")},_onSelect:function(){var a=this.$el.find(this.containerClass).empty(),b=this.model.getSelected();if(b){a.attr("data-mode",b.id);b.getView().setElement(a).render()}this._render();this.triggerVerticalResize()},_onSwitcherClick:function(b){b.preventDefault();if(!this.model.getDisabled()){this.model.next();var a=this.model.getSelected().getView();a.focus&&a.focus()}},_setSwitching:function(){if(this.model.getDisabled()){this.disableSwitching()}else{this.enableSwitching()}},disableSwitching:function(){this.switchEl.addClass("disabled");this.getSwitcherTrigger().attr("original-title","This query is too complex to display in Simple mode.")},enableSwitching:function(){this.switchEl.removeClass("disabled");var a=this.model.getSelected();if(a&&a.id==="advanced"){this.getSwitcherTrigger().attr("original-title","Switch to basic search")}},setVisible:function(a){this.switchEl.toggleClass("hidden",!a)}});;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/Query.js' */
JIRA.Components.Query=function(){var a={project:"Project",issuetype:"Type",status:"Status",assignee:"Assignee",reporter:"Reporter",labels:"Labels",resolution:"Resolution",created:"Created Date",updated:"Updated Date",resolutiondate:"Resolution Date",description:"Description",duedate:"Due Date",comment:"Comment",fixfor:"Fix Version",version:"Affects Version",component:"Component"};return{DEFAULT_CLAUSES:["project","issuetype","status","assignee"],create:function(c){c=_.defaults(c,{primaryClauses:this.DEFAULT_CLAUSES,without:[],style:"generic",layoutSwitcher:true,autocompleteEnabled:true,advancedAutoUpdate:false,basicOrderBy:false,basicAutoUpdate:true,preferredSearchMode:"basic"});c.primaryClauses=_.reject(c.primaryClauses,function(d){return _.contains(c.without,d.id)});_.each(c.primaryClauses,function(e,d){if(typeof e==="string"){if(a[e]){c.primaryClauses[d]={id:e,name:a[e]}}else{console.error("JIRA.Components.Query: You have specified clause ["+e+"]. But we do not have the i18n string for it, probably a custom field. Instead use {id:"+e+", name: '[NAME_HERE]'}")}}});var b=new JIRA.Issues.QueryModule({queryStateModel:new JIRA.Issues.QueryStateModel({jql:c.jql,without:c.without,style:c.style,layoutSwitcher:c.layoutSwitcher,autocompleteEnabled:c.autocompleteEnabled,advancedAutoUpdate:c.advancedAutoUpdate,basicAutoUpdate:c.basicAutoUpdate,preferredSearchMode:c.preferredSearchMode,basicOrderBy:c.basicOrderBy}),primaryClauses:c.primaryClauses,searchers:c.searchers});jQuery(c.el).addClass("query-component "+c.style+"-styled");b.createAndRenderView(c.el);if(c.jql||c.jql===""){b.resetToQuery(c.jql).always(function(){jQuery(c.el).addClass("ready");b.triggerInitialized(c.jql)})}return b}}}();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-query', location = 'content/js/search/query/SearchShifter.js' */
JIRA.Issues.SearchShifter=function(d){var b,c,a,e;b=function(){var f=d.searcherCollection.chain().filter(a).map(e).value();return function(){return jQuery.Deferred().resolve(f).promise()}};c=function(h){var f=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher(),g=d.searcherCollection.get(h);if(!g.getIsSelected()){g.select()}if(!f||f.getId()!==g.getId()){JIRA.Issues.SearcherDialog.instance.toggle(g)}};a=function(f){return f.getIsShown()};e=function(f){return{label:f.getName(),value:f.getId()}};return function(){if(!d.isBasicMode()||d.isFullScreenIssue()){return null}return{getSuggestions:b(),name:"Search Criteria",onSelection:c,weight:150}}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/LayoutPreferenceManager.js' */
JIRA.Issues.LayoutPreferenceManager={PREFERRED_LAYOUT_KEY:"jira.issues.preferred.layout.key",getPreferredLayoutKey:function(){return AJS.Meta.get(this.PREFERRED_LAYOUT_KEY)},setPreferredLayoutKey:function(b,a){a=_.defaults({},a,{ajax:true});AJS.Meta.set(this.PREFERRED_LAYOUT_KEY,b);a.ajax&&AJS.$.ajax({data:{layoutKey:b},type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/latest/preferredSearchLayout"})}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/templates/splitview.soy' */
// This file was automatically generated from splitview.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.SplitView == 'undefined') { JIRA.Templates.SplitView = {}; }


JIRA.Templates.SplitView.fullSplitView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group split-view"><div class="aui-item list-results-panel"><div class="list-panel"><div class="list-ordering"></div><div class="list-content">');
  if (opt_data.issuePanelData) {
    JIRA.Templates.SplitView.issueList(opt_data.issuePanelData, output);
  }
  output.append('</div></div><div class="end-of-stable-message-container"></div><div class="aui-group pagination-view count-pagination"><div class="refresh-container aui-item">');
  JIRA.Templates.IssueNav.refreshResults(null, output);
  output.append('</div><div class="pagination-container aui-item">');
  if (opt_data.pagination) {
    JIRA.Templates.IssueNavTable.pagination(opt_data.pagination, output);
  }
  output.append('</div></div></div><div class="aui-item detail-panel navigator-issue-only"><div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.structure = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.SplitView.fullSplitView({issuePanelData: null, pagination: null}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="issue-list">');
  var iLimit20 = opt_data.issues.length;
  for (var i20 = 0; i20 < iLimit20; i20++) {
    var issue__soy21 = opt_data.issues[i20];
    var issueID__soy22 = opt_data.issueIDs[i20];
    var isHighlighted__soy23 = issueID__soy22 == opt_data.highlightedID;
    if (issue__soy21) {
      output.append('<li ', (isHighlighted__soy23) ? 'class="focused"' : '', ' data-id="', soy.$$escapeHtml(issueID__soy22), '" data-key="', soy.$$escapeHtml(issue__soy21.key), '" title="', soy.$$escapeHtml(issue__soy21.summary), '">');
      JIRA.Templates.SplitView.issueRow(issue__soy21, output);
      output.append('</li>');
    } else {
      JIRA.Templates.SplitView.inaccessibleIssueRow({isHighlighted: isHighlighted__soy23, issueID: issueID__soy22}, output);
    }
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="splitview-issue-link" data-issue-key="', soy.$$escapeHtml(opt_data.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.key), '">');
  if (opt_data.type) {
    JIRA.Templates.SplitView.issueIcon(opt_data.type, output);
    output.append('&nbsp;');
  }
  output.append('<span class="issue-link-key">', soy.$$escapeHtml(opt_data.key), '</span><br/><span class="issue-link-summary">', soy.$$escapeHtml(opt_data.summary), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img height="16" width="16" alt="', soy.$$escapeHtml(opt_data.name), '" title="', soy.$$escapeHtml(opt_data.name), ' - ', soy.$$escapeHtml(opt_data.description), '" src="', soy.$$escapeHtml(opt_data.iconUrl), '" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="inaccessible-issue ', (opt_data.isHighlighted) ? 'focused' : '', '" data-id="', soy.$$escapeHtml(opt_data.issueID), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueDetailsNoSelection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenDetailView.js' */
Backbone.define("JIRA.Issues.SplitScreenDetailView",JIRA.Issues.BaseView.extend({events:{"focus #addcomment textarea":"scrollToBottom"},issueDetailsNoSelectionTemplate:JIRA.Templates.SplitView.issueDetailsNoSelection,initialize:function(a){_.bindAll(this,"adjustHeight","_renderIssue");this.issueCacheManager=a.issueCacheManager;this.search=a.search;this.searchResults=a.search.getResults();JIRA.Issues.Application.on("issueEditor:fieldSubmitted",this.focus,this);JIRA.Issues.Application.on("issueEditor:replacedFocusedPanel",this.focus,this);this.adjustHeight=_.debounce(this.adjustHeight,a.easeOff)},adjustHeight:function(){_.defer(_.bind(function(){var b=this.getIssueContainer(),a;if(b.length){a=b.length&&b.offset().top;b.css("height",window.innerHeight-a)}},this))},getIssueContainer:function(){return this.$el.find(".issue-container")},scrollToTop:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(0)}},scrollToBottom:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(a.prop("scrollHeight"))}},activate:function(){if(this.isActive){return this}var a=this;this.$el.focusin(function(){a.focused=true});this.$el.focusout(function(){a.focused=false});this.addListener(this.searchResults,"selectedIssueChange",this.render,this);this.addListener(this.searchResults,"issueUpdated",this.onIssueUpdated,this);this.addListener(this.searchResults,"issueDoesNotExist",this._onIssueDoesNotExist,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.onVerticalResize(this.adjustHeight);JIRA.Issues.Application.on("issueEditor:loadComplete",this.adjustHeight,this);this.isActive=true;return this},deactivate:function(){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.offVerticalResize(this.adjustHeight);JIRA.Issues.Application.off("issueEditor:loadComplete",this.adjustHeight);JIRA.unbind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);this.isActive=false},fixMentionsDropdownInMentionableFields:function(b,a,c){if(c===JIRA.CONTENT_ADDED_REASON.panelRefreshed||c===JIRA.CONTENT_ADDED_REASON.inlineEditStarted){a.find(".mentionable:not([data-follow-scroll])").attr("follow-scroll",".split-view .issue-container");a.find(".mentionable:not([data-push-scroll])").attr("push-scroll",".issue-body-content")}},onIssueUpdated:function(c,a,b){if(b.action!==JIRA.Issues.Actions.INLINE_EDIT&&b.action!==JIRA.Issues.Actions.ROW_UPDATE){return JIRA.Issues.Application.request("issueEditor:refreshIssue",b)}else{return jQuery.Deferred().resolve()}},render:function(b,a){a=a||{};if(this.searchResults.hasIssues()&&!this.search.isStandAloneIssue()&&a.reason!=="issueLoaded"){if(this.searchResults.hasSelectedIssue()){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.Utils.debounce(this,"_renderIssue",this.searchResults.getSelectedIssue())}else{this._renderNoIssue()}}this.adjustHeight();return this},_renderIssue:function(a){JIRA.Issues.Application.request("issueEditor:loadIssue",{id:a.get("id"),key:a.get("key"),detailView:true}).always(_.bind(function(){JIRA.Issues.Application.execute("pager:update",_.extend({},this.searchResults.getPager(),{isSplitView:true}));if(this.searchResults.isFirstIssueSelected()&&this.searchResults.getDisplayableTotal()>1){this.issueCacheManager.scheduleIssueToBePrefetched(this.searchResults.getNextIssueForSelectedIssue())}this.issueCacheManager.prefetchIssues();this.$el.addClass("active");this.scrollToTop()},this))},focus:function(){if(!this.hasFocus()){this.getIssueContainer().focus()}},blur:function(){this.getIssueContainer().blur()},_onIssueDoesNotExist:function(){this._renderNoIssue();JIRA.Issues.Application.execute("issueEditor:setContainer",this.$el);this.render()},_renderNoIssue:function(){this.$el.html(this.issueDetailsNoSelectionTemplate())},hasFocus:function(){return this.focused===true}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenListView.js' */
Backbone.define("JIRA.Issues.SplitScreenListView",JIRA.Issues.BaseView.extend({inaccessibleIssueRowTemplate:JIRA.Templates.SplitView.inaccessibleIssueRow,template:JIRA.Templates.SplitView.issueList,events:{"simpleClick .issue-list li":"_onClickIssue"},initialize:function(a){_.bindAll(this,"_onSearchDone","_onSearchFail");this.search=a.search;this.searchContainer=a.searchContainer;this.searchPromise=this._createSearchPromise({done:this._onSearchDone,fail:this._onSearchFail});this.searchResults=a.search.getResults();this.serverRendered=!!a.serverRendered&&this._issuesRendered(a);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"issueUpdated",this._onIssueUpdated,this);this.addListener(this.searchResults,"startIndexChange",this.render,this)},_issuesRendered:function(a){return !!a.searchContainer.find(".issue-list").length},scrollToFocused:function(){var b=this.searchContainer.find(".list-panel");var a=this.$el.find(".focused");if(b.size()&&a.size()){b.scrollTop(a.position().top)}},deactivate:function(){this.searchPromise.reset();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},_onClickIssue:function(c){var b=AJS.$(c.target).closest("[data-id]").data("id"),a=this.searchResults.getSelectedIssue().getId()==b;c.preventDefault();if(!a){require("jira/issues/navigator/metrics").notifyIssueNavDetail();this.searchResults.selectIssueById(b,{replace:true});JIRA.Issues.Application.execute("analytics:trigger","kickass.openIssueFromTable",{issueId:b,absolutePosition:this.searchResults.getPositionOfIssueInSearchResults(b)+1,relativePosition:this.searchResults.getPositionOfIssueInPage(b)+1})}},_createSearchPromise:function(a){var b=jQuery.RecurringPromise();a=a||{};a.done&&b.done(_.bind(a.done,this));a.fail&&b.fail(_.bind(a.fail,this));return b},getIssueById:function(a){return this.$el.find("[data-id="+a+"]")},_highlightIssue:function(a){this.$el.find(".focused").removeClass("focused");a&&this.getIssueById(a.getId()).addClass("focused").scrollIntoView()},markIssueInaccessible:function(a){this.getIssueById(a).replaceWith(this.inaccessibleIssueRowTemplate({isHighlighted:this.searchResults.getHighlightedIssue().getId()===a,issueID:a}))},_onHighlightedIssueChange:function(){this._highlightIssue(this.searchResults.getHighlightedIssue())},_onIssueUpdated:function(b,a){if(a.table[0]===null){this.markIssueInaccessible(b)}else{this.getIssueById(b).html(JIRA.Templates.SplitView.issueRow(a.table[0]))}},_onSearchDone:function(a){if(a instanceof Array){if(this.searchResults.hasIssues()){this.$el.html(this.template({highlightedID:this.searchResults.getHighlightedIssue().getId(),issueIDs:this.searchResults.getPageIssueIds(),issues:a}))}_.defer(_.bind(this.scrollToFocused,this))}},_onSearchFail:function(){var a=this.searchContainer.find(".navigator-content");a.html(JIRA.Templates.Issues.ComponentUtil.errorMessage({msg:"Error occurred communicating with the server. Please reload the page and try again."}))},render:function(){var a=this.serverRendered;this.serverRendered=false;if(this.searchResults.hasIssues()){if(!this.searchResults.hasHighlightedIssue()&&!this.searchResults.hasSelectedIssue()){this.searchResults.highlightFirstInPage();return}return this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql()}).then(function(b){return _.extend(b,{serverRendered:a})}))}else{return jQuery.Deferred().resolve()}}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenLayout.js' */
(function(a){Backbone.define("JIRA.Issues.SplitScreenLayout",JIRA.Issues.BaseView.extend({initialize:function(b){_.bindAll(this,"_adjustHeight","_adjustNoResultsMessageHeight","_updateSidebarPosition","applyResponsiveDesign");if(b.easeOff){this.applyResponsiveDesign=a.noop;_.debounce(this._adjustHeight,b.easeOff)}b=_.extend(b,{serverRendered:this._consumeServerRenderedSplitView(b)});this.search=b.search;this.fullScreenIssue=b.fullScreenIssue;this.navigatorContent=b.searchContainer.find(".navigator-content");this.searchResults=b.search.getResults();this.emptyResultsView=new JIRA.Issues.EmptyResultsView({searchResults:this.searchResults,el:this.navigatorContent});this.detailsView=new JIRA.Issues.SplitScreenDetailView(b);this.listView=new JIRA.Issues.SplitScreenListView(b);this.orderBy=JIRA.Components.OrderBy.create();this.orderBy.onSort(this._handleSort,this);JIRA.Issues.onVerticalResize(this._adjustHeight);JIRA.Issues.onVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.onHorizontalResize(this._updateSidebarPosition);JIRA.Issues.onVerticalResize(this._updateSidebarPosition);this.addListener(b.search,"beforeSearch",this._showPending,this);this.addListener(this.searchResults,"issueDeleted",this._onIssueDeleted,this);this.addListener(this.searchResults,"newPayload",this._hidePending,this);this.addListener(this.searchResults,"newPayload",this._updateSortBy,this);this.addListener(this.searchResults,"newPayload",this.render,this);this.addListener(this.searchResults,"startIndexChange",this._onStartIndexChange,this);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"selectedIssueChange",this._onSelectedIssueChange,this);this.addListener(this.searchResults,"startIndexChange",this._renderEverythingExceptListView,this);this.search.onSearchError(this._onSearchFail,this);JIRA.Issues.Application.on("issueEditor:loadError",this._onIssueLoadError,this);this.listView.searchPromise.done(_.bind(function(){this._makeVisible()},this));this.fullScreenIssue.hide();JIRA.Issues.overrideScrollIntoViewForSplit();this.setElement(this.navigatorContent);if(b.serverRendered){this._activateSubviews()}this._scrollLayoutOnZoom=this._initScrollLayoutOnZoom();if(this._scrollLayoutOnZoom){a(window).on("resize",this._scrollLayoutOnZoom)}this._updateSortBy()},_updateSortBy:function(){this.orderBy.setJql(this.search.getEffectiveJql())},_handleSort:function(b){this.search.doSort(b)},_adjustHeight:function(){var b=this.$el.find(".list-panel");var d=0,c=this.listView.$el.offset().top+b.scrollTop(),f=this.$el.find(".pagination-container").outerHeight(),e=window.innerHeight;if(this.endOfStableSearchView&&this.endOfStableSearchView.$el){d=this.endOfStableSearchView.$el.outerHeight()}b.css("height",e-c-d-f)},_adjustNoResultsMessageHeight:function(){var b;if(this.searchResults.hasIssues()){this.navigatorContent.css("height","")}else{b=this.navigatorContent.offset().top;this.navigatorContent.css("height",window.innerHeight-b)}},_initScrollLayoutOnZoom:function(){if(a.browser.msie){this.cachedDPI=screen.deviceXDPI;return _.bind(function(){if(this.cachedDPI!==screen.deviceXDPI){a("body, html").scrollTop(0)}this.cachedDPI=screen.deviceXDPI},this)}return null},_consumeServerRenderedSplitView:function(c){var d=!!AJS.Meta.get("consumed-server-rendered-split-view"),b=!!c.searchContainer.find(".split-view").length;AJS.Meta.set("consumed-server-rendered-split-view",true);return !d&&b},close:function(){JIRA.Issues.offVerticalResize(this._adjustHeight);JIRA.Issues.offVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.offHorizontalResize(this._updateSidebarPosition);JIRA.Issues.restoreScrollIntoViewForNormal();a("body").removeClass("page-type-split");JIRA.Issues.Application.off("issueEditor:loadError",this._onIssueLoadError,this);this.navigatorContent.addClass("pending").css("height","");this.orderBy.offSort(this._handleSort,this);this.search.offSearchError(this._onSearchFail,this);if(this._isIOS()){this._deactivateIOSSpecificBehaviour()}this.detailsView.deactivate();this.listView.deactivate();a(window).off("resize",this.applyResponsiveDesign);if(this._scrollLayoutOnZoom){a(window).off("resize",this._scrollLayoutOnZoom);delete this._scrollLayoutOnZoom}JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);if(!this.searchResults.hasIssue(this.searchResults.getSelectedIssue().getId())){this.searchResults.selectFirstInPage()}},_handleInitialIssueSelection:function(){if(!this.searchResults.hasSelectedIssue()){if(this.searchResults.hasHighlightedIssue()){this.searchResults.selectIssueById(this.searchResults.getHighlightedIssue().getId(),{replace:true})}else{this.searchResults.selectFirstInPage({replace:true})}}},_hidePending:function(){this.navigatorContent.removeClass("pending")},_isInitialRender:function(){return !this.navigatorContent.find(".split-view").length},_applyWidthClass:function(){var b=this.detailsView.$el.width();this.$el.toggleClass("skinny",b<900);this.$el.toggleClass("very-skinny",b<600)},_makeVisible:function(){this.navigatorContent.removeClass("pending");if(this._isInitialRender()){this.navigatorContent.html(this.$el)}this.$el.find(".list-results-panel").sidebar({id:"splitview",minWidth:function(b){return 250},maxWidth:_.bind(function(){return this.$el[0].clientWidth-500},this),resize:this.applyResponsiveDesign});a(window).on("resize",this.applyResponsiveDesign);this._applyWidthClass();JIRA.trigger(JIRA.Events.LAYOUT_RENDERED);this.applyResponsiveDesign()},_updateSidebarPosition:function(){var b=this.$el.find(".list-results-panel");b.sidebar("updatePosition")},applyResponsiveDesign:function(){if(this.reapplyResponsive){clearTimeout(this.reapplyResponsive)}this.reapplyResponsive=setTimeout(_.bind(function(){this._applyWidthClass();clearTimeout(this.reapplyResponsive);delete this.reapplyResponsive},this),0)},_onHighlightedIssueChange:function(c,b){b=_.defaults({},b,{replace:true});var d=this.searchResults.getHighlightedIssue().getId();this.searchResults.selectIssueById(d,b)},_onIssueDeleted:function(b){this.listView.getIssueById(b.id).hide();this._showPending();if(this.searchResults.hasIssues()){this.listView.render();this._renderPagination();this._renderEndOfStableSearch();this._renderRefreshResults()}else{this._renderEmptyResults()}},_onIssueLoadError:function(b){if(b.response.status===404){this.listView.markIssueInaccessible(b.issueId)}},_onSearchFail:function(){this._renderEmptyResults();this._hidePending()},_onSelectedIssueChange:function(){this._setIssueModuleContainer()},_onStartIndexChange:function(){if(this.searchResults.hasIssues()){this._showPending()}},nextIssue:function(){require("jira/issues/navigator/metrics").notifyIssueNavDetail();this.searchResults.selectNextIssue({replace:true})},prevIssue:function(){require("jira/issues/navigator/metrics").notifyIssueNavDetail();this.searchResults.selectPrevIssue({replace:true})},goToPage:function(b){this.searchResults.goToPage(b)},refreshSearch:function(){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");JIRA.Issues.Application.execute("issueNav:refreshSearch")}},render:function(){var c=this.searchResults.hasIssues(),b=this._isInitialRender();a("body").addClass("page-type-split");if(this._isIOS()){this._activateIOSSpecificBehaviour()}if(c){this._handleInitialIssueSelection();this.navigatorContent.removeClass("empty-results");if(b){this.$el.children().detach();this.$el.html(JIRA.Templates.SplitView.structure())}this._renderPagination();this._renderEndOfStableSearch();this._renderRefreshResults();this._activateSubviews();this.detailsView.render();this.listView.render()}else{this._hidePending();this._renderEmptyResults()}this._adjustHeight();this._adjustNoResultsMessageHeight();this.orderBy.render();return this},_renderPagination:function(){if(this.paginationView){this.paginationView.close()}this.paginationView=new JIRA.Components.IssueNavigator.Views.Pagination({startIndex:this.searchResults.getStartIndex(),pageSize:this.searchResults.getPageSize(),total:this.searchResults.getTotal(),currentSearch:JIRA.Issues.Application.request("issueNav:currentSearchRequest")});this.listenTo(this.paginationView,"goToPage",this.goToPage);this.paginationView.render();this.$(".pagination-container").empty().append(this.paginationView.$el)},_renderEndOfStableSearch:function(){if(this.endOfStableSearchView){this.endOfStableSearchView.close()}this.endOfStableSearchView=new JIRA.Components.IssueNavigator.Views.EndOfStableMessage({total:this.searchResults.getTotal(),displayableTotal:this.searchResults.getDisplayableTotal(),pageNumber:this.searchResults.getPageNumber(),numberOfPages:this.searchResults.getNumberOfPages()});this.endOfStableSearchView.render();this.$(".end-of-stable-message-container").empty().append(this.endOfStableSearchView.$el)},_renderRefreshResults:function(){if(this.refreshResultsView){this.refreshResultsView.close()}this.refreshResultsView=new JIRA.Components.IssueNavigator.Views.RefreshResults();this.listenTo(this.refreshResultsView,"refresh",this.refreshSearch);this.refreshResultsView.render();this.$(".refresh-container").empty().append(this.refreshResultsView.$el)},_renderEverythingExceptListView:function(){var b=this.searchResults.hasIssues();if(b){this._renderPagination();this._renderEndOfStableSearch();this._renderRefreshResults();this._adjustHeight();this._adjustNoResultsMessageHeight()}},_renderEmptyResults:function(){this.emptyResultsView.render()},_setIssueModuleContainer:function(){JIRA.Issues.Application.execute("issueEditor:setContainer",this.$(".split-view .detail-panel > div"))},_showPending:function(){this.navigatorContent.addClass("pending")},_activateSubviews:function(){this.detailsView.setElement(this.$(".detail-panel")).activate();this.orderBy.setElement(this.$(".list-ordering"));this.listView.setElement(this.$(".list-content"));this._setIssueModuleContainer()},handleLeft:function(){this.detailsView.blur()},handleRight:function(){this.detailsView.focus()},isIssueViewActive:function(){return this.detailsView.hasFocus()},_isIOS:function(){var b=navigator.platform;return b==="iPod"||b==="iPhone"||b==="iPad"},_activateIOSSpecificBehaviour:function(){a(document).on("touchmove.iOSSpecific",function(b){b.preventDefault()});a("body").on("touchstart.iOSSpecific",".issue-container, .list-panel",function(b){if(b.currentTarget.scrollTop===0){b.currentTarget.scrollTop=1}else{if(b.currentTarget.scrollHeight===b.currentTarget.scrollTop+b.currentTarget.offsetHeight){b.currentTarget.scrollTop-=1}}});a("body").on("touchmove.iOSSpecific",".issue-container, .list-panel",function(b){b.stopPropagation()})},_deactivateIOSSpecificBehaviour:function(){a(document).off("touchmove.iOSSpecific");a("body").off("touchstart.iOSSpecific");a("body").off("touchmove.iOSSpecific")}}))})(jQuery);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/FullScreenLayout.js' */
(function(e,b,a,d,c){AJS.namespace("JIRA.Issues.FullScreenLayout");JIRA.Issues.FullScreenLayout=e.Controller.extend({initialize:function(f){this.searchService=new b({searchModule:f.search,searchResults:f.search.getResults(),columnConfig:f.columnConfig});this.$navigatorContent=f.searchContainer.find(".navigator-content");this.issueTable=new a({searchService:this.searchService,el:this.$navigatorContent,columnConfig:f.columnConfig});this.listenTo(this.issueTable,{highlightIssue:function(g){this.searchService.highlightIssue(g)},render:function(){if(!this.searchService.hasSelectedIssue()){this.fullScreenIssue.hide()}this.fullScreenIssue.bindSearchService(this.searchService);this.trigger("render")}});this.fullScreenIssue=f.fullScreenIssue;this.listenTo(this.fullScreenIssue,{issueHidden:function(){this.issueTable.highlightIssue(this.searchService.getHighlightedIssue())}});d.on("issueEditor:loadError",this.onLoadError,this)},onLoadError:function(f){if(!this.fullScreenIssue.isVisible()){this.searchService.unselectIssue();c.showErrorMsg(AJS.format("{0} can not be opened. The issue may have been deleted or you might not have permission to see the issue.",f.issueKey),{closeable:true})}},render:function(){this.issueTable.show()},onClose:function(){this.fullScreenIssue.deactivate();this.issueTable.close();this.searchService.close();d.off("issueEditor:loadError",this.onLoadError,this);delete this.fullScreenIssue;delete this.issueTable;delete this.searchService},nextIssue:function(){this.searchService.selectNextIssue()},prevIssue:function(){this.searchService.selectPreviousIssue()},returnToSearch:function(){this.searchService.unselectIssue()},handleLeft:function(){},handleRight:function(){},isIssueViewActive:function(){return this.fullScreenIssue.isVisible()}})})(JIRA.Marionette,JIRA.Components.SearchService,JIRA.Components.IssueTable,JIRA.Issues.Application,JIRA.Messages);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/EmptyResultsView.js' */
Backbone.define("JIRA.Issues.EmptyResultsView",JIRA.Issues.BaseView.extend({initialize:function(a){this.searchResults=a.searchResults},render:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca\u003elogging in\u003c/a\u003e to see more results";b="not-logged-in-message";a="login"}else{if(this.searchResults.getJiraHasIssues()===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca\u003ecreate an issue\u003c/a\u003e":null;b="empty-results-message";a="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca\u003ecreating a new issue\u003c/a\u003e":"Try modifying your search criteria";b="no-results-message";a="create"}}this.$el.addClass("empty-results");this.$el.html(JIRA.Templates.IssueNavTable.noResults({message:d,hint:e,cssClass:b}));var f=this.$(".no-results-hint a");switch(a){case"create":f.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa");break;case"login":f.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link");break}_.defer(jQuery.event.trigger,"updateOffsets.popout");_.defer(JIRA.trace,"jira.search.finished")}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/util/DialogCleanup.js' */
JIRA.Issues.dialogCleaner=function(a){a.on("navigate",function(){if(JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(AJS.HelpTip&&AJS.HelpTip.Manager){AJS.HelpTip.Manager.hideSequences();AJS.HelpTip.Manager.clearSequences()}})};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/util/OverrideIssueDialogUtil.js' */
JIRA.Dialogs.getDefaultAjaxOptions=function(){var a=this.options.url||this.getRequestUrlFromTrigger();this.issueId=JIRA.Issues.Api.getSelectedIssueId();this.issueKey=JIRA.Issues.Api.getSelectedIssueKey();if(/id=\{0\}/.test(a)){if(!this.issueId){return false}else{a=a.replace(/(id=\{0\})/,"id="+this.issueId)}}return{data:{decorator:"dialog",inline:"true"},url:a}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/util/OverrideIssueDialogs.js' */
(function(){var e,f,b;JIRA.Issues.overrideIssueDialogs=function(g){g=_.defaults({},g,{isNavigator:false});e=g.getIssueId;f=!!g.isNavigator;b=g.updateIssue;if(f){JIRA.LabelsDialog.prototype._handleSubmitResponse=JIRA.FormDialog.prototype._handleSubmitResponse}AJS.$(function(){var h=JIRA.IssueNavigator.Shortcuts;JIRA.unbind("QuickEdit.sessionComplete",h._quickEditSessionCompleteHandler);JIRA.bind("QuickEdit.sessionComplete",function(){b(JIRA.Dialog.current)});JIRA.unbind("QuickCreateSubtask.sessionComplete",h._quickCreateSubtaskSessionCompleteHandler);JIRA.bind("QuickCreateSubtask.sessionComplete",function(){b(JIRA.Dialog.current)})});JIRA.bind("Dialog.show",function(j,i,h){if(h){h.issueId=e(JIRA.Dialog.current)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,h){h.find(".issueaction-workflow-transition").each(function(){var k=AJS.$(this);var j=k.attr("href");j=j.replace(/atl_token=[^&]*/,"atl_token="+atl_token());k.attr("href",j)})});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(l,j){var k=AJS.$("#ops-login-lnk");if(k.length==0){return}var h=window.location;var i=parseUri(k.attr("href"));i.queryKey.os_destination=h.pathname.slice(contextPath.length)+h.search;k.attr("href",i.path+"?"+AJS.$.param(i.queryKey))})};var d=JIRA.FormDialog.prototype._getDefaultOptions;JIRA.FormDialog.prototype._getDefaultOptions=function(){var g=d.call(this),h=g.onDialogFinished;g.onDialogFinished=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{h.apply(this,arguments)}};return g};var a=JIRA.FormDialog.prototype._performRedirect;JIRA.FormDialog.prototype._performRedirect=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{a.apply(this,arguments)}};function c(){if(this.options.id==="clone-issue-dialog"){a.apply(this,arguments)}else{if(this.options.id==="delete-issue-dialog"){if(f){this.hide();b(this)}else{var h=this._getTargetUrlValue();if(h&&h!==""){AJS.reloadViaWindowLocation(h)}else{if(AJS.$(".page-navigation #next-issue").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #next-issue").attr("href"))}else{if(AJS.$(".page-navigation #return-to-search").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #return-to-search").attr("href"))}else{AJS.reloadViaWindowLocation(AJS.$("#find_link").attr("href"))}}}}}else{var g=this;this.showFooterLoadingIndicator();b(this).always(function(){JIRA.trace("jira.issue.update");g.hideFooterLoadingIndicator();g.hide()})}}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/enhanceIssueLinks.js' */
JIRA.Issues.enhanceLinks={withPushState:function(a){a=_.defaults(a,{selector:".push-state"});AJS.$(document).delegate(a.selector,"simpleClick",function(d){if(this.href){d.preventDefault();var b=parseUri(this.href);var c=b.path;if(b.query){c+="?"+b.query}c=c.replace(Backbone.history.options.root,"");if(Backbone.history.fragment==c||Backbone.history.fragment==decodeURIComponent(c)){Backbone.history.loadUrl(c)}else{a.router.navigate(c,{trigger:true})}}})},toIssueNav:function(a){var c="a.filter-link[data-filter-id], a.filter-link[data-jql]",b="#issues_new_search_link_lnk";AJS.$(document).on("simpleClick",c,function(h){h.preventDefault();var g=AJS.$(h.target).closest("a"),f=g.data("filter-id"),d=g.data("jql");a.searchPageModule.reset({filter:f,jql:d})});AJS.$(document).on("simpleClick",b,function(d){d.preventDefault();a.searchPageModule.resetToBlank()})},isIssueTableDropdown:function(a){if(AJS.InlineLayer.current){var b=jQuery(AJS.InlineLayer.current.offsetTarget());if(b.closest(".list-view table#issuetable").size()){return true}}},toIssue:function(b){AJS.$(document).on("simpleClick",["#attachment-sorting-options a","#attachment-sorting-order-options a","#subtasks-show-all","#subtasks-show-open"].join(","),function(g){if(this.href){g.preventDefault();g.stopPropagation();var f=parseUri(this.href);if(f.queryKey){JIRA.Issues.Application.execute("issueEditor:updateIssueWithQuery",f.queryKey);AJS.$(this).parents("ul").find("a.aui-checked").removeClass("aui-checked");AJS.$(this).addClass("aui-checked")}}});var d="a.issue-link[data-issue-key]",c=".parentIssue",a=".list-view table#issuetable a.issue-link[data-issue-key]";AJS.$(document).on("simpleClick",d,function(k){k.preventDefault();k.stopPropagation();var i=b.searchPageModule.searchResults;var f=AJS.$(k.target).closest("a").data("issue-key");var g=i._getIssueIdForKey(f);var l=parseInt(g,10);var j=AJS.$(k.target).is(a);var m=AJS.$(k.target).is(c);var h=JIRA.Issues.enhanceLinks.isIssueTableDropdown(a);if((j&&!m)||h){JIRA.Issues.Application.execute("analytics:trigger","kickass.openIssueFromTable",{issueId:g,absolutePosition:i.getPositionOfIssueInSearchResults(l)+1,relativePosition:i.getPositionOfIssueInPage(l)+1});b.searchPageModule.update({selectedIssueKey:f})}else{require("jira/issues/navigator/metrics").notifyIssueView();b.searchPageModule.reset({selectedIssueKey:f})}})},transformToAjax:function(){AJS.$(document).on("simpleClick",".subtask-reorder a",function(a){if(this.href){a.preventDefault();a.stopPropagation();AJS.$.ajax({type:"GET",data:{disableRedirect:true},url:this.href}).done(function(){JIRA.Issues.Api.refreshSelectedIssue({reason:JIRA.Issues.Actions.UPDATE})}).fail(function(b){JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(b),{closeable:true})})}})}};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/Notifications.js' */
JIRA.Issues.showNotification=function(){var a={thanks_issue_updated:"{0} has been updated.",thanks_issue_transitioned:"{0} has been updated.",thanks_issue_assigned:"{0} has been assigned.",thanks_issue_commented:"{0} has been updated with your comment.",thanks_issue_worklogged:"Work has been logged on {0}.",thanks_issue_voted:"Your vote on {0} has been updated.",thanks_issue_watched:"Your watcher status on {0} has been updated.",thanks_issue_moved:"{0} has been moved.",thanks_issue_linked:"The links on {0} have been updated.",thanks_issue_cloned:"{0} has been cloned.",thanks_issue_labelled:"The labels on {0} have been updated.",thanks_issue_deleted:"{0} has been deleted.",thanks_issue_attached:"The file(s) have been attached to {0}."};return function(c,b){var d;if(!c){c="thanks_issue_updated"}d=a[c];if(d&&b){d=AJS.format(d,b)}JIRA.Messages.showSuccessMsg(d||c,{closeable:true})}}();;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavRouter.js' */
Backbone.define("JIRA.Issues.IssueNavRouter",JIRA.Issues.BaseRouter.extend({initialize:function(a){_.extend(this,a);_.bindAll(this,"_restoreSessionSearch","_route");this.route(/^(.*?)([\?]{1}.*)?$/,this._route);this.route(/^(issues\/)?$/,this._restoreSessionSearch);delete Backbone.Router.arrayValueSplit},navigate:function(){this.searchPageModule.removeOpenTipsies();this.trigger("navigate");JIRA.Issues.BaseRouter.prototype.navigate.apply(this,arguments)},pushState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false})},replaceState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false,replace:true})},_restoreSessionSearch:function(){var b=this.initialSessionSearchState,a=JIRA.Issues.URLSerializer.getURLFromState(b||this.searchPageModule.getState());this.navigate(a,{replace:true,trigger:true})},_route:function(e,d){var a=this.toFragment(e,d);if(JIRA.Issues.ignorePopState){return}var c=JIRA.Issues.URLSerializer.getStateFromURL(a);var b=AJS.Meta.get("jql");if(b!=null){AJS.Meta.set("jql",null);c.jql=b}if(!this._navigateToLoginIfNeeded(c)){this._navigateUsingState(c)}},_navigateToLoginIfNeeded:function(c,d){if(!JIRA.Issues.IssueNavRouter.usePushState(d)&&c.selectedIssueKey&&!JIRA.Issues.LoginUtils.isLoggedIn()){var a=this;var b={};if(c.filter!=null){b.filterId=c.filter}jQuery.ajax({url:AJS.contextPath()+"/rest/issueNav/1/issueNav/anonymousAccess/"+c.selectedIssueKey,headers:{"X-SITEMESH-OFF":true},data:b,success:function(){a._navigateUsingState(c)},error:function(e){if(e.status===401){a._redirectToLogin(c)}else{a._navigateUsingState(c)}}});return true}return false},_navigateUsingState:function(a){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{replace:true,trigger:false});this.searchPageModule.updateFromRouter(a)}},_redirectToLogin:function(b){var a=AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(JIRA.Issues.URLSerializer.getURLFromState(b));window.location.replace(a)},_setStatePermalink:function(d){var b=_.pick(d,"selectedIssueKey");var c=AJS.Meta.get("jira-base-url");if(!_.isEmpty(b)){AJS.Meta.set("viewissue-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(b))}var a=_.omit(d,"selectedIssueKey");if(!_.isEmpty(a)){AJS.Meta.set("issuenav-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(a))}}},{getBackboneRoot:function(a){return AJS.contextPath()+(this.usePushState(a)?"/":"/i")},usePushState:function(c){var a=(c=c||window.history)&&c.pushState,b=AJS.DarkFeatures.isEnabled("ka.I_ROOT");return a&&!b}}));;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/util/HandlePushStateInIE.js' */
JIRA.Issues.hashTheUrl=function(b){var d=parseUri(b);var a={changed:false,uri:d};if(d.anchor===""&&d.query!==""){var c=d.protocol+"://"+d.authority+d.path;a.uri=c+"#?"+d.query;a.changed=true}return a};;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavCreator.js' */
(function(c,b){JIRA.Events.LAYOUT_RENDERED="layoutRendered";AJS.namespace("JIRA.Issues.IssueNavCreator");JIRA.Issues.IssueNavCreator.create=function(p,q){var f=this.searchPageModule=new JIRA.Issues.SearchPageModule({},{initialIssueTableState:q.initialIssueTableState});f.registerViewContainers({issueContainer:c(".issue-container"),searchContainer:c(".navigator-container")});var j=this.searchHeaderModule=new JIRA.Issues.SearchHeaderModule({searchPageModule:f});var g=new JIRA.Issues.FilterModule({searchPageModule:f,systemFilters:f.addOwnerToSystemFilters(q.systemFilters)});var l=JIRA.Components.Query.create({el:p.find("form.navigator-search"),searchers:q.initialSearcherCollectionState,preferredSearchMode:AJS.Meta.get("user.search.mode"),layoutSwitcher:true,autocompleteEnabled:AJS.Meta.getBoolean("autocomplete-enabled"),basicAutoUpdate:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.bind(JIRA.Events.ISSUE_TABLE_REORDER,function(r){if(!JIRA.Issues.Application.request("issueEditor:canDismissComment")){r.preventDefault()}});this.layoutSwitcherView=new JIRA.Issues.LayoutSwitcherView({searchPageModule:f});this.layoutSwitcherView.setElement(p.find("#layout-switcher-toggle")).render();var k=JIRA.Issues.Application.request("issueEditor");JIRA.Issues.Application.on("issueEditor:render",function(r){JIRA.Issues.Application.execute("pager:render",r.pager)});JIRA.Issues.Application.commands.setHandler("returnToSearch",function(){JIRA.Issues.Application.execute("issueEditor:close")});JIRA.Issues.Application.on("issueEditor:saveSuccess",function(r){JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[r.issueId])});JIRA.Issues.Application.on("issueEditor:saveError",function(r){if(!r.deferred){JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[r.issueId])}});JIRA.Issues.FocusShifter.init();var o=k.viewIssueData;var n=new JIRA.Issues.IssueSearchManager({initialIssueTableState:q.initialIssueTableState,initialIssueIds:q.initialIssueIds});var h=new JIRA.Issues.SearchModule({searchPageModule:f,queryModule:l,issueSearchManager:n,initialSelectedIssue:q.initialSelectedIssue});var d=new JIRA.Issues.Cache.IssueCacheManager({searchResults:h.getResults(),viewIssueData:o});var e=p.find(".saved-search-selector");var i=new JIRA.Issues.FullScreenIssue({issueContainer:f.issueContainer,searchContainer:f.searchContainer,issueCacheManager:d});f.registerSearch(h);f.registerSearchHeaderModule(j);f.registerFilterModule(g);f.registerQueryModule(l);f.registerFullScreenIssue(i);f.registerIssueSearchManager(n);f.registerIssueCacheManager(d);f.registerLayoutSwitcher(this.layoutSwitcherView);j.registerSearch(h);j.createToolsView(e);var m=this.issueNavRouter=new JIRA.Issues.IssueNavRouter({searchPageModule:f,initialSessionSearchState:q.initialSessionSearchState});f.registerIssueNavRouter(m);JIRA.Issues.enhanceLinks.toIssueNav({searchPageModule:f});JIRA.Issues.enhanceLinks.withPushState({router:m});JIRA.Issues.enhanceLinks.toIssue({searchPageModule:f});JIRA.Issues.enhanceLinks.transformToAjax();JIRA.Issues.dialogCleaner(m);JIRA.Issues.Api.initialize({searchPageModule:f});JIRA.Issues.IssueAPI.override({searchPageModule:f});JIRA.Issues.IssueNavigatorAPI.override({searchPageModule:f});JIRA.Dialogs.BeforeShowIssueDialogHandler.add(JIRA.Issues.Api.waitForSavesToComplete);JIRA.Issues.overrideIssueDialogs({getIssueId:b.bind(f.getEffectiveIssueId,f),isNavigator:true,updateIssue:function(r){var s=JIRA.Issues.Utils.getUpdateCommandForDialog(r);return f.updateIssue(s)}});c(document).keydown(function(t){var v=c("div.aui-blanket").length>0,r=(t.which===c.ui.keyCode.ENTER||t.which===c.ui.keyCode.LEFT||t.which===c.ui.keyCode.UP||t.which===c.ui.keyCode.RIGHT||t.which===c.ui.keyCode.DOWN);if(!v&&r){var s=c(t.target),u=s.is(":not(:input)");if(s==undefined||u){if(t.which===c.ui.keyCode.ENTER){if(s==undefined||s.is(":not(a)")){JIRA.Issues.Api.viewSelectedIssue()}}else{if(t.which===c.ui.keyCode.LEFT){f.handleLeft()}else{if(t.which===c.ui.keyCode.RIGHT){f.handleRight()}else{if(t.which===c.ui.keyCode.UP){if(f.handleUp()){t.preventDefault()}}else{if(t.which===c.ui.keyCode.DOWN){if(f.handleDown()){t.preventDefault()}}}}}}}}});this.searchResults=h.getResults();this.searchPageModule.on("change",a);this.searchResults.on("change",a);this.searchResults.getSelectedIssue().on("change",a);return this};function a(){var d=JIRA.Issues.LoginUtils.redirectUrlToCurrent();c(".login-link").attr("href",d)}AJS.namespace("JIRA.Issues.GlobalIssueNavCreator");JIRA.Issues.GlobalIssueNavCreator.create=function(g,f){var k=g.find(".navigator-sidebar");var d=g.find("#search-header-view");var j=JIRA.Issues.IssueNavCreator.create(g,f);var h=j.searchPageModule.filterModule;h.createView({$filterPanelEl:k});h.filtersComponent.showFilterHeader({el:d,model:j.searchPageModule.getFilter(),isEdited:j.searchPageModule.isDirty()});var e=c("#quicksearch-message");if(e.length){var i=JIRA.Messages.showWarningMsg(e.find("p").html(),{closeable:true});c("a",i).click(function(){i.remove()})}return j}})(AJS.$,_);;
;/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/popupuserprefstore.js' */
AJS.namespace("jira.plugin.chartingstore");jira.plugin.chartingstore=function(){var userPrefMap={};return{get:function(gadgetId){var userPrefs=userPrefMap[gadgetId];if(!userPrefs){return{}}return userPrefs},set:function(gadgetId,name,value){var prefs=this.get(gadgetId);prefs[name]=value;userPrefMap[gadgetId]=prefs},clear:function(){userPrefMap={}}}}();gadgets.IfrGadgetService.prototype.setUserPref=function(editToken,name,value){var gadgetId=this.f;if(gadgetId){gadgetId=gadgetId.substr("gadget-".length)}jira.plugin.chartingstore.set(gadgetId,name,value)};;
;/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/chartdialog.js' */
AJS.namespace("jira.plugin.charting");jira.plugin.charting=function(){var dialog,DIALOG_ID="charts-dialog",CHARTS_CATEGORY="Charts",CHART_HEIGHT=522,saveFormLoaded=false,idToUriMap={},dialogThrobber=AJS.$('<span class="icon throbber"></span>'),getPostData=function(formData){var postData={};jQuery.each(formData,function(i,field){postData[field.name]=field.value});var filterId=getFilterId();if(filterId){postData.filterId=filterId}else{postData.jql=getFilterJql()||""}var chartPanelId=dialog.getPage(0).curtab;postData.gadgetUri=idToUriMap[chartPanelId];var userPrefs=jira.plugin.chartingstore.get(chartPanelId);if(userPrefs){var prefsMap={};for(var key in userPrefs){prefsMap[key]=userPrefs[key]}postData.userPrefs=prefsMap}return postData},loadSaveToDashboardForm=function(){if(!saveFormLoaded){var saveFormUrl=contextPath+"/rest/gadget/1.0/chart/add";var filterId=getFilterId();if(filterId){saveFormUrl=saveFormUrl+"?filterId="+encodeURIComponent(filterId)}else{saveFormUrl=saveFormUrl+"?jql="+encodeURIComponent(getFilterJql())}var saveFormPanel=jQuery("#saveToDashboardPanel");saveFormPanel.empty();jQuery.ajax({url:saveFormUrl,success:function(data){saveFormPanel.html(data);saveFormLoaded=true;var chartForm=saveFormPanel.find("form#savetodashboardform");var saveButton=saveFormPanel.find("#save-btn1");chartForm.submit(function(e){e.preventDefault();chartForm.find(".error").remove();chartForm.find(".form-errors p").remove();chartForm.find(".form-errors").hide();saveButton.attr("disabled","true");var postData=getPostData(chartForm.serializeArray());jQuery.ajax({url:chartForm.attr("action"),contentType:"application/json",dataType:"text",data:JSON.stringify(postData),type:"POST",success:function(data){chartForm.trigger("fakesubmit");saveButton.removeAttr("disabled","false");window.location=data},error:function(XMLHttpRequest,textStatus,errorThrown){saveButton.removeAttr("disabled","false");if(XMLHttpRequest.status===400){var errorCollection=eval("("+XMLHttpRequest.responseText+")");if(errorCollection.generic.length>0){jQuery(errorCollection.generic).each(function(i,item){chartForm.find(".form-errors").append("<p>"+item+"</p>")});chartForm.find(".form-errors").show()}if(errorCollection.fields.length>0){jQuery(errorCollection.fields).each(function(i,item){chartForm.find("#"+item.field).after('<div class="error">'+item.error+"</div>")})}}}})});saveFormPanel.find("#cancel-btn1").click(function(e){dialog.prevPage();saveButton.removeAttr("disabled","false");chartForm.find(".form-errors").hide();chartForm.find(".error").remove();e.preventDefault()})}})}},addThrobber=function(){dialog.popup.element.find(".dialog-button-panel").prepend(dialogThrobber);jQuery().ajaxSend(function(a,xhr){if(dialog.popup.element.is(":visible")){jQuery(xhr).throbber({target:dialogThrobber})}})},addErrorHandler=function(){jQuery().ajaxError(function(e,XMLHttpRequest,ajaxOptions){if(XMLHttpRequest.status==500){dialog.hide();jQuery("body").html(XMLHttpRequest.responseText)}})},keypressListener=function(e){if(e.keyCode===27){dialog.hide()}},createDialog=function(width,height,data){dialog=new AJS.Dialog(width,height,DIALOG_ID);dialog.addHeader("Gadgets");resetPanels(data);dialog.addButton("Save to Dashboard",function(dialog){loadSaveToDashboardForm();dialog.nextPage()},"save-to-dashboard");dialog.addCancel("Cancel",function(dialog){dialog.hide()});dialog.addPage();dialog.page[1].addPanel("saveToDashBoard",'<div id="saveToDashboardPanel"</div>');dialog.page[1].addHeader("Save gadget to a Dashboard");addThrobber();addErrorHandler();AJS.$(document).keydown(keypressListener)},resetDialog=function(initialPanel){if(dialog){saveFormLoaded=false;jQuery("form[name=chartpopup]").show();jQuery("input[name=filterName]").val("");dialog.gotoPage(0);for(var i=0;dialog.getPanel(i);i++){var panel=dialog.getPanel(i);panel.loaded=false}dialog.gotoPanel(initialPanel)}},loadChartGadgets=function(data){var chartGadgets=[],filterResultsGadget,uri=parseUri(window.location);var baseUrl=uri.protocol+"://"+uri.authority;jQuery(data.gadgets).each(function(i,gadget){if(gadget.gadgetSpecUri.indexOf("http")!==0||gadget.gadgetSpecUri.indexOf(baseUrl)===0){jQuery([gadget.categories]).each(function(i,catKey){var g={title:gadget.title,specUri:gadget.gadgetSpecUri};if(g.specUri.indexOf("filter-results")>-1){filterResultsGadget=g}if(catKey.constructor==Array){for(var j=0;j<catKey.length;++j){if(catKey[j]===CHARTS_CATEGORY&&filterResultsGadget!=g){chartGadgets.push(g)}}}else{if(catKey===CHARTS_CATEGORY&&filterResultsGadget!=g){chartGadgets.push(g)}}})}});chartGadgets.sort(function(one,two){return(one.title>two.title?1:-1)});if(filterResultsGadget){chartGadgets.unshift(filterResultsGadget)}return chartGadgets},renderPanelContents=function(panel,data){panel.body.html(data);panel.loaded=true},resetPanels=function(data){var chartGadgets=loadChartGadgets(data);dialog.gotoPage(0);jQuery(chartGadgets).each(function(i,gadget){dialog.page[0].addPanel(gadget.title,'<div class="loadingPanel">&nbsp;</div>');var panel=dialog.getPanel(i);if(panel){panel.loaded=false;idToUriMap[i]=gadget.specUri;panel.body.show=function(panel,show){return function(){if(!panel.loaded){var rendererUrl=contextPath+"/rest/gadget/1.0/chart/render?id="+i+"&gadgetUri="+encodeURIComponent(gadget.specUri);var filterId=getFilterId();if(filterId){rendererUrl=rendererUrl+"&filterId="+encodeURIComponent(filterId)}else{rendererUrl=rendererUrl+"&jql="+encodeURIComponent(getFilterJql())}jQuery.ajax({url:rendererUrl,success:function(data){renderPanelContents(panel,data)}})}show.call(panel.body)}}(panel,panel.body.show)}})},launchDialog=function(url,width,height,initialPanel){if(dialog){resetDialog(initialPanel);dialog.show()}else{jQuery(jQuery.ajax({url:url,dataType:"json",success:function(data){if(!dialog){createDialog(width,height,data)}dialog.show();dialog.gotoPage(0);dialog.gotoPanel(initialPanel)}})).throbber({target:jQuery("#throbber-space")})}},getFilterId=function(){var filterId=AJS.Meta.get("filter-id");if(filterId&&filterId>=0){return filterId}return null},getFilterJql=function(){return AJS.Meta.get("filter-jql")};return function(){jQuery("body").delegate("#charts","click",function(e){AJS.populateParameters();launchDialog(contextPath+"/rest/config/1.0/directory.json",800,CHART_HEIGHT,1);e.preventDefault()});jQuery("body").delegate("#onDashboard","click",function(e){AJS.populateParameters();launchDialog(contextPath+"/rest/config/1.0/directory.json",800,CHART_HEIGHT,0);e.preventDefault()})}}();jQuery(document).ready(jira.plugin.charting);;
;/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/IssueNavInit.js' */
(function(){if(history&&history.pushState===undefined){var a=JIRA.Issues.hashTheUrl(window.location);if(a.changed){window.location=a.uri}}jQuery("html").addClass("hide-until-domready");jQuery(function(){jQuery("html").removeClass("hide-until-domready")});jQuery(document).on("keydown",function(b){if(b.which===27){b.preventDefault()}})})();AJS.$(function(){var f=AJS.$(".navigator-content");var i=f.data("issue-table-model-state");if(i&&!i.table){var a=AJS.$("<div></div>").append(f.children().clone());i.issueTable.table=a.html()}var e=AJS.$("#stableSearchIds").data("ids");var g=f.data("selected-issue");var c=jQuery.parseJSON(jQuery("#criteriaJson").text());var d=f.data("session-search-state");var h=jQuery.parseJSON(jQuery("#systemFiltersJson").text());JIRA.Issues.Application.start({showReturnToSearchOnError:function(){return JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()!=="split-view"},useLog:AJS.Meta.get("dev-mode")===true});JIRA.Issues.AnalyticsLoader();var b=JIRA.Issues.GlobalIssueNavCreator.create(AJS.$(document),{initialIssueTableState:i,initialSearcherCollectionState:c,initialSessionSearchState:d,initialSelectedIssue:g,initialIssueIds:e,systemFilters:h});Backbone.history.start({pushState:!AJS.DarkFeatures.isEnabled("ka.I_ROOT"),root:JIRA.Issues.IssueNavRouter.getBackboneRoot()});if(jQuery.browser.webkit){JIRA.Issues.ignorePopState=true;window.addEventListener("load",function(){setTimeout(function(){JIRA.Issues.ignorePopState=false},0)})}AJS.KeyboardShortcut.addIgnoreCondition(function(m,l,k){return k==="issueaction"&&JIRA.Issues.Api.isCurrentlyLoadingIssue()});var j=parseInt(jQuery("body").css("minWidth"),10);jQuery(document).bind("resultsWidthChanged",function(){var k=jQuery(".contained-content");var n=k.parent();if(k.length>0){var m=k.offset().left;var o=Math.max(window.innerWidth,j)-m;var l=o/n.width()*100;if(l<100){k.css("width",l+"%")}else{k.css("width","")}jQuery(document).trigger("issueNavWidthChanged")}});AJS.$(document).trigger("resultsWidthChanged");JIRA.Issues.onVerticalResize(function(){jQuery.event.trigger("updateOffsets.popout")});JIRA.bind(JIRA.Events.LAYOUT_RENDERED,function(){_.defer(function(){jQuery.event.trigger("updateOffsets.popout")})})});JIRA.Issues.displayFailSearchMessage=function(a){if(a&&a.statusText!=="abort"){return JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(a),{closeable:true})}};;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.soy' */
// This file was automatically generated from appswitcher.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher == 'undefined') { navlinks.templates.appswitcher = {}; }


navlinks.templates.appswitcher.linkSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    output.append('<div class="aui-nav-heading sidebar-section-header">', soy.$$escapeHtml(opt_data.title), '</div><ul class="aui-nav nav-links">');
    var linkList8 = opt_data.list;
    var linkListLen8 = linkList8.length;
    for (var linkIndex8 = 0; linkIndex8 < linkListLen8; linkIndex8++) {
      var linkData8 = linkList8[linkIndex8];
      navlinks.templates.appswitcher.applicationsItem(linkData8, output);
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" ', (opt_data.self) ? 'class="checked"' : '', ' title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.shortcutsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" ', (opt_data.self) ? 'class="checked"' : '', ' title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebarContents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="app-switcher-section app-switcher-applications"><div class="aui-nav-heading">', soy.$$escapeHtml("Application Links"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div><div class="app-switcher-section app-switcher-shortcuts"><div class="aui-nav-heading">', soy.$$escapeHtml("Shortcuts"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div></nav></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.projectHeaderSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-title">');
  aui.avatar.avatar({size: 'large', avatarImageUrl: opt_data.avatarUrl, isProject: true, title: opt_data.name}, output);
  output.append('<div class="sidebar-project-name">', soy.$$escapeHtml(opt_data.name), '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.cogDropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var dropdownList__soy74 = new soy.StringBuilder();
  navlinks.templates.appswitcher.dropdownList({list: opt_data.links}, dropdownList__soy74);
  dropdownList__soy74 = dropdownList__soy74.toString();
  aui.dropdown2.dropdown2({menu: {'id': opt_data.id, 'content': dropdownList__soy74, 'extraClasses': 'aui-style-default sidebar-customize-section'}, trigger: {'showIcon': false, 'content': '<span class="aui-icon aui-icon-small aui-iconfont-configure"></span>', 'container': '#app-switcher'}}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.dropdownList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="sidebar-admin-links">');
  var linkList82 = opt_data.list;
  var linkListLen82 = linkList82.length;
  for (var linkIndex82 = 0; linkIndex82 < linkListLen82; linkIndex82++) {
    var linkData82 = linkList82[linkIndex82];
    output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(linkData82.href), '" title="', soy.$$escapeHtml(linkData82.title), '"><span class="nav-link-label">', soy.$$escapeHtml(linkData82.label), '</span></a></li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    if (AJS.DarkFeatures.isEnabled('rotp.sidebar')) {
      var sidebarContents__soy97 = new soy.StringBuilder();
      navlinks.templates.appswitcher.sidebarContents(null, sidebarContents__soy97);
      sidebarContents__soy97 = sidebarContents__soy97.toString();
      var triggerContent__soy99 = new soy.StringBuilder();
      navlinks.templates.appswitcher.trigger(null, triggerContent__soy99);
      triggerContent__soy99 = triggerContent__soy99.toString();
      navlinks.templates.appswitcher.sidebar({sidebar: {'id': 'app-switcher', 'content': sidebarContents__soy97}, trigger: {'showIcon': false, 'content': triggerContent__soy99}}, output);
      output.append('<script>\n                (function (NL) {\n                    var initialise = function () {\n                        new NL.SideBar({\n                            sidebarContents: \'#app-switcher\'\n                        });\n                    };\n                    if (NL.SideBar) {\n                        initialise();\n                    } else {\n                        NL.onInit = initialise;\n                    }\n                }(window.NL = (window.NL || {})));\n                window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
    } else {
      navlinks.templates.appswitcher_old.switcher(null, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.sidebar.id), '" class="sidebar-trigger app-switcher-trigger" aria-owns="', soy.$$escapeHtml(opt_data.sidebar.id), '" aria-haspopup="true">', opt_data.trigger.content, '</a><div id=', soy.$$escapeHtml(opt_data.sidebar.id), ' class="app-switcher-sidebar aui-style-default sidebar-offscreen">', opt_data.sidebar.content, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.js' */
(function(c,a){a.SideBar=function(d){var e=this;this.$sidebar=null;d=c.extend({sidebarContents:null},d);this.getLinks=function(){return c.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateAppLinks).fail(this.showAppSwitcherError)};this.populateProjectHeader=function(g,f){e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").after(navlinks.templates.appswitcher.projectHeaderSection({avatarUrl:f,name:g}))};this.getProjectData=function(){var f=c(".project-shortcut-dialog-trigger"),g=f.data("key"),h=f.data("entity-type");if(f.size()==0||!g||!h){c(".app-switcher-shortcuts").remove();return}var j,i;i=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+g,cache:false,data:{entityType:h},dataType:"json"});j=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+g,cache:false,data:{entityType:h},dataType:"json"});c.when(i,j).then(function(l,k){e.updateProjectShortcuts(l,k,{key:g,entityType:h,name:f.data("name"),avatarUrl:f.find("img").prop("src")})},e.showProjectShortcutsError)};this.getSidebar=function(){if(!this.$sidebar){this.$sidebar=c(d.sidebarContents)}return this.$sidebar};this.addApplicationsCog=function(){c(".app-switcher-applications .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-applications-admin-dropdown",links:[{href:AJS.contextPath()+"/plugins/servlet/customize-application-navigator",label:"Customize navigator",title:"Add new entries, hide existing or restrict who sees what"},{href:AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks",label:"Manage application links",title:"Link to more Atlassian applications"}]}))};this.addProjectShortcutsCog=function(f,h){var g=[{href:AJS.contextPath()+"/plugins/servlet/custom-content-links-admin?entityKey="+f,label:"Customize shortcuts",title:""}];if(e.entityMappings[h]){g.push({href:e.generateEntityLinksUrl(f,e.entityMappings[h]),label:"Manage product links",title:""})}e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-project-shortcuts-admin-dropdown",links:g}))};this.updateAppLinks=function(f){c(function(){e.getSidebar().find(".app-switcher-applications").html(navlinks.templates.appswitcher.linkSection({title:"Application Links",list:f}));if(a.isUserAdmin){e.addApplicationsCog()}e.bindAnalyticsHandlers(e.getSidebar(),f)})};this.updateProjectShortcuts=function(i,g,h){var j=i[0].shortcuts,f=g[0].shortcuts;e.getSidebar().find(".app-switcher-shortcuts").html(navlinks.templates.appswitcher.linkSection({title:"Shortcuts",list:j.concat(f)}));if(a.isUserAdmin){e.addProjectShortcutsCog(h.key,h.entityType)}e.populateProjectHeader(h.name,h.avatarUrl);e.bindAnalyticsHandlers(e.getSidebar(),data)};this.entityMappings={"confluence.space":"com.atlassian.applinks.api.application.confluence.ConfluenceSpaceEntityType","jira.project":"com.atlassian.applinks.api.application.jira.JiraProjectEntityType","bamboo.project":"com.atlassian.applinks.api.application.bamboo.BambooProjectEntityType","stash.project":"com.atlassian.applinks.api.application.stash.StashProjectEntityType"};this.generateEntityLinksUrl=function(f,g){if(g===e.entityMappings["confluence.space"]){return AJS.contextPath()+"/spaces/listentitylinks.action?typeId="+g+"&key="+f}else{return AJS.contextPath()+"/plugins/servlet/applinks/listEntityLinks/"+g+"/"+f}};this.showAppSwitcherError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-applications .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.showProjectShortcutsError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-shortcuts .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getSidebar().html(navlinks.templates.appswitcher.sidebarContents());this.getLinks();this.getProjectData();f&&f.stopPropagation()};this.bindAnalyticsHandlers=function(f,g){};this.getLinks();c(this.getProjectData);this.toggleSidebar=function(h){var i=e.getSidebar(),g=c("body"),f=c(window.document);if(!g.hasClass("app-switcher-open")){var k=c("#header");i.css("left",-i.width());i.parent("body").length||i.appendTo("body");b({data:i});i.animate({left:0},300);function j(l){var n=l.target&&c(l.target),m=l.keyCode;if(l.originalEvent===h.originalEvent){return}if(n&&!m&&!(n.closest(i).length||n.closest(k).length)&&h.which==1&&!(l.shiftKey||l.ctrlKey||l.metaKey)){e.toggleSidebar()}else{if(m===27){e.toggleSidebar()}}}f.on("click.appSwitcher",j);f.on("keydown.appSwitcher",j);f.on("scroll.appSwitcher",i,b)}else{f.off(".appSwitcher")}g.toggleClass("app-switcher-open")};c("#header").on("click",".app-switcher-trigger",this.toggleSidebar)};function b(f){var d=c(document).scrollTop(),g=c("#header"),e=(g.height()+g.offset().top)-d;if(e>=0){f.data.css({top:e,position:"fixed"})}else{f.data.css({top:0,left:0,position:"fixed"})}}if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.js' */
(function(e,c){c.AppSwitcher=function(f){var g=AJS.contextPath()+"/plugins/servlet/customize-application-navigator";var h=this;this.$dropdown=null;f=e.extend({dropdownContents:null},f);this.getLinks=function(){return e.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateDropdown).fail(this.showError)};this.getDropdown=function(){if(!this.$dropdown){this.$dropdown=e(f.dropdownContents)}return this.$dropdown};this.updateDropdown=function(i){e(function(){h.getDropdown().html(navlinks.templates.appswitcher_old.applications({apps:i,showAdminLink:c.environment.isUserAdmin,adminLink:g}));h.bindAnalyticsHandlers(h.getDropdown(),i);if(window.NL.environment.isAppSuggestionAvailable){h.handleSuggestionApps(i)}})};this.bindAnalyticsHandlers=function(i,j){};this.handleSuggestionApps=function(k){var l=_.map(k,function(m){return m.applicationType.toLowerCase()});$suggestionApps=e("<div id='app-switcher-suggestion-apps' class='aui-dropdown2-section'/>");$suggestionApps.html(navlinks.templates.appswitcher_old.suggestionApps);var j=$suggestionApps.find(".suggestion-apps");var i=false;_.each(a,function(m){if(!_.contains(l,m.appName)){i=true;j.append(navlinks.templates.appswitcher_old.suggestionApp({appName:m.appName,appDesc:m.appDesc}))}});if(!i){return}e("#app-switcher").append($suggestionApps);e(".app-discovery-suggestion-app").click(function(){AJS.trigger("analytics",{name:"appswitcher.discovery.user.select."+e(this).find("a").attr("id").toLowerCase()});window.open(e(this).find("a").attr("title"),"_blank")});e(".app-discovery-suggestion-app").hover(function(){e(this).find("a").removeClass("active").removeClass("aui-dropdown2-active")});e(".app-discovery-cancel-button").click(function(){AJS.trigger("analytics",{name:"appswitcher.discovery.nothanks.button.click"});d(b,"true");$suggestionApps.remove()})};this.showError=function(){e(function(){h.getDropdown().html(navlinks.templates.appswitcher_old.error()).off(".appswitcher").on("click.appswitcher",".app-switcher-retry",e.proxy(h.retryLoading,h))})};this.retryLoading=function(i){this.getDropdown().html(navlinks.templates.appswitcher_old.loading());this.getLinks();i&&i.stopPropagation()};this.getLinks()};var b="key-no-thanks";var a=[{appName:"jira",appDesc:"Issue & Project Tracking Software"},{appName:"confluence",appDesc:"Collaboration and content sharing"},{appName:"bamboo",appDesc:"Continuous integration"}];var d=function(f,g){e.ajax({url:AJS.contextPath()+"/rest/menu/latest/userdata/",type:"PUT",contentType:"application/json",data:JSON.stringify({key:f,value:g})})};if(c.onInit){c.onInit()}}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.soy' */
// This file was automatically generated from appswitcher_old.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher_old == 'undefined') { navlinks.templates.appswitcher_old = {}; }


navlinks.templates.appswitcher_old.applications = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.apps, listClass: 'nav-links', showDescription: opt_data.showDescription}, output);
  if (opt_data.custom) {
    navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.custom, showDescription: opt_data.showDescription}, output);
  }
  if (opt_data.showAdminLink) {
    navlinks.templates.appswitcher_old.adminSection(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    var param19 = new soy.StringBuilder('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
    var linkList27 = opt_data.list;
    var linkListLen27 = linkList27.length;
    for (var linkIndex27 = 0; linkIndex27 < linkListLen27; linkIndex27++) {
      var linkData27 = linkList27[linkIndex27];
      navlinks.templates.appswitcher_old.applicationsItem(soy.$$augmentData(linkData27, {showDescription: opt_data.showDescription}), param19);
    }
    param19.append('</ul>');
    aui.dropdown2.section({content: param19.toString()}, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link', (opt_data.self) ? ' nav-link-local' : '', '"><a href="', soy.$$escapeHtml(opt_data.link), '" class="aui-dropdown2-radio ', (opt_data.self) ? 'aui-dropdown2-checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.adminSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dropdown2.section({content: '<ul class="nav-links"><li><a class="nav-link-edit-wrapper" href="' + soy.$$escapeHtml(opt_data.adminLink) + '"><span class="nav-link-edit">' + "Configure\x26hellip;" + '</span></a></li></ul>'}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.loading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-loading">', "Loading\x26hellip;", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    var loadingContent__soy81 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.loading(null, loadingContent__soy81);
    loadingContent__soy81 = loadingContent__soy81.toString();
    var triggerContent__soy83 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.trigger(null, triggerContent__soy83);
    triggerContent__soy83 = triggerContent__soy83.toString();
    aui.dropdown2.dropdown2({menu: {'id': 'app-switcher', 'content': loadingContent__soy81, 'extraClasses': 'aui-style-default'}, trigger: {'showIcon': false, 'content': triggerContent__soy83, 'extraClasses': 'app-switcher-trigger', 'extraAttributes': {'href': '#app-switcher'}}}, output);
    output.append('<script>\n            (function (NL) {\n                var initialise = function () {\n                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.\n                    window.atlassian = window.atlassian || window.aui;\n                    new NL.AppSwitcher({\n                        dropdownContents: \'#app-switcher\'\n                    });\n                };\n                if (NL.AppSwitcher) {\n                    initialise();\n                } else {\n                    NL.onInit = initialise;\n                }\n            }(window.NL = (window.NL || {})));\n            window.NL.environment = ', soy.$$escapeHtml({}), ';<\/script>');
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.suggestionApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="app-discovery-suggestion-app"><a id="', soy.$$escapeHtml(opt_data.appName), '" href="#" class="app-discovery-link aui-icon-container app-discovery-', soy.$$escapeHtml(opt_data.appName), '-product-icon" title="https://www.atlassian.com/software/', soy.$$escapeHtml(opt_data.appName), '"/><div class="app-discovery-small">', soy.$$escapeHtml(opt_data.appDesc), '</div></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.suggestionApps = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class=\'nav-links suggestion-apps\'><li><span class=\'app-discovery-suggest-title nav-link-label\'><h6>', soy.$$escapeHtml("Try other Atlassian apps"), '</h6></span></li></ul><div class=\'buttons-container app-discovery-suggest-apps-buttons\'><div class=\'buttons\'><button class=\'aui-button aui-button-link app-discovery-cancel-button\' name=\'cancel\' accesskey=\'c\' href=\'#\'>', soy.$$escapeHtml("Don\x27t show this again"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/inline-dialog.js' */
(function(d){AJS.CustomInlineDialog=AJS.CustomInlineDialog||function(B,n,r,p){p=p||[];if(p.hasOwnProperty("getArrowAttributes")){getArrowAttributesDeprecationLogger()}if(p.hasOwnProperty("getArrowPath")){getArrowPathDeprecationLogger();if(p.hasOwnProperty("gravity")){getArrowPathWithGravityDeprecationLogger()}}if(p.hasOwnProperty("onTop")){onTopDeprecationLogger();if(p.onTop&&p.gravity===undefined){p.gravity="s"}}if(typeof n==="undefined"){n=String(Math.random()).replace(".","");if(d("#inline-dialog-"+n+", #arrow-"+n+", #inline-dialog-shim-"+n).length){throw"GENERATED_IDENTIFIER_NOT_UNIQUE"}}var z=d.extend(false,AJS.CustomInlineDialog.opts,p);if(z.gravity==="w"){z.offsetX=p.offsetX===undefined?10:p.offsetX;z.offsetY=p.offsetY===undefined?0:p.offsetY}var v=function(){return window.Raphael&&p&&(p.getArrowPath||p.getArrowAttributes)};var j;var q;var K;var u=false;var A=false;var I=false;var J;var x;var g=d('<div id="inline-dialog-'+n+'" class="aui-inline-dialog"><div class="aui-inline-dialog-contents contents"></div><div id="arrow-'+n+'" class="aui-inline-dialog-arrow arrow"></div></div>');var m=d("#arrow-"+n,g);var G=g.find(".contents");if(!v()){g.find(".aui-inline-dialog-arrow").addClass("aui-css-arrow")}if(!z.displayShadow){G.addClass("aui-inline-dialog-no-shadow")}if(z.autoWidth){G.addClass("aui-inline-dialog-auto-width")}else{G.css("width",z.width+"px")}G.mouseover(function(O){clearTimeout(q);g.unbind("mouseover")}).mouseout(function(){E()});var D=function(){if(!j){j={popup:g,hide:function(){E(0)},id:n,show:function(){y()},persistent:z.persistent?true:false,reset:function(){function S(U,T){U.css(T.popupCss);if(v()){if(T.gravity==="s"){T.arrowCss.top-=d.browser.msie?10:9}if(!U.arrowCanvas){U.arrowCanvas=Raphael("arrow-"+n,16,16)}var V=z.getArrowPath,W=d.isFunction(V)?V(T):V;U.arrowCanvas.path(W).attr(z.getArrowAttributes())}else{m.removeClass("aui-bottom-arrow aui-left-arrow aui-right-arrow");if(T.gravity==="s"&&!m.hasClass("aui-bottom-arrow")){m.addClass("aui-bottom-arrow")}else{if(T.gravity==="n"){}else{if(T.gravity==="w"){m.addClass("aui-left-arrow")}else{if(T.gravity==="e"){m.addClass("aui-right-arrow")}}}}}m.css(T.arrowCss)}var P=AJS.$(window).height();var Q=Math.round(P*0.75);g.children(".aui-inline-dialog-contents").css("max-height",Q);var O=z.calculatePositions(g,x,J,z);if(O.hasOwnProperty("displayAbove")){displayAboveDeprecationLogger();O.gravity=O.displayAbove?"s":"n"}S(g,O);g.fadeIn(z.fadeTime,function(){});if(d.browser.msie&&~~(d.browser.version)<10){var R=d("#inline-dialog-shim-"+n);if(!R.length){d(g).prepend(d('<iframe class = "inline-dialog-shim" id="inline-dialog-shim-'+n+'" frameBorder="0" src="javascript:false;"></iframe>'))}R.css({width:G.outerWidth(),height:G.outerHeight()})}}}}return j};var y=function(){if(g.is(":visible")){return}K=setTimeout(function(){if(!I||!A){return}z.addActiveClass&&d(B).addClass("active");u=true;if(!z.persistent){H()}AJS.CustomInlineDialog.current=D();d(document).trigger("showLayer",["inlineDialog",D()]);D().reset()},z.showDelay)};var E=function(O){if(typeof O=="undefined"&&z.persistent){return}A=false;if(u&&z.preHideCallback.call(g[0].popup)){O=(O==null)?z.hideDelay:O;clearTimeout(q);clearTimeout(K);if(O!=null){q=setTimeout(function(){l();z.addActiveClass&&d(B).removeClass("active");g.fadeOut(z.fadeTime,function(){z.hideCallback.call(g[0].popup)});if(g.arrowCanvas){g.arrowCanvas.remove();g.arrowCanvas=null}u=false;A=false;d(document).trigger("hideLayer",["inlineDialog",D()]);AJS.CustomInlineDialog.current=null;if(!z.cacheContent){I=false;w=false}},O)}}};var F=function(R,P){var O=d(P);z.upfrontCallback.call({popup:g,hide:function(){E(0)},id:n,show:function(){y()}});g.each(function(){if(typeof this.popup!="undefined"){this.popup.hide()}});if(z.closeOthers){d(".aui-inline-dialog").each(function(){!this.popup.persistent&&this.popup.hide()})}x={target:O};if(!R){J={x:O.offset().left,y:O.offset().top}}else{J={x:R.pageX,y:R.pageY}}if(!u){clearTimeout(K)}A=true;var Q=function(){w=false;I=true;z.initCallback.call({popup:g,hide:function(){E(0)},id:n,show:function(){y()}});y()};if(!w){w=true;if(d.isFunction(r)){r(G,P,Q)}else{d.get(r,function(T,S,U){G.html(z.responseHandler(T,S,U));I=true;z.initCallback.call({popup:g,hide:function(){E(0)},id:n,show:function(){y()}});y()})}}clearTimeout(q);if(!u){y()}return false};g[0].popup=D();var w=false;var t=false;var s=function(){if(!t){d(z.container).append(g);t=true}};var o=d(B);if(z.onHover){if(z.useLiveEvents){if(o.selector){d(document).on("mousemove",o.selector,function(O){s();F(O,this)}).on("mouseout",o.selector,function(){E()})}else{AJS.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled.")}}else{o.mousemove(function(O){s();F(O,this)}).mouseout(function(){E()})}}else{if(!z.noBind){if(z.useLiveEvents){if(o.selector){d(document).on("click",o.selector,function(O){s();if(M()){g.hide()}else{F(O,this)}return false}).on("mouseout",o.selector,function(){E()})}else{AJS.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled.")}}else{o.click(function(O){s();if(M()){g.hide()}else{F(O,this)}return false}).mouseout(function(){E()})}}}var M=function(){return u&&z.closeOnTriggerClick};var H=function(){k();f()};var l=function(){C();N()};var i=false;var h=n+".inline-dialog-check";var k=function(){if(!i){d("body").bind("click."+h,function(P){var O=d(P.target);if(O.closest("#inline-dialog-"+n+" .contents").length===0){E(0)}});i=true}};var C=function(){if(i){d("body").unbind("click."+h)}i=false};var L=function(O){if(O.keyCode===27){E(0)}};var f=function(){d(document).on("keydown",L)};var N=function(){d(document).off("keydown",L)};g.show=function(P,O){if(P){P.stopPropagation()}s();if(z.noBind&&!(B&&B.length)){F(P,O===undefined?P.target:O)}else{F(P,B)}};g.hide=function(){E(0)};g.refresh=function(){if(u){D().reset()}};g.getOptions=function(){return z};return g};function c(g){var f=d(g);var h=d.extend({left:0,top:0},f.offset());return{left:h.left,top:h.top,width:f.outerWidth(),height:f.outerHeight()}}function b(h,j,t,f){var m=AJS.$.isFunction(f.offsetX)?f.offsetX(h,j,t,f):f.offsetX;var l=AJS.$.isFunction(f.offsetY)?f.offsetY(h,j,t,f):f.offsetY;var q=AJS.$.isFunction(f.arrowOffsetX)?f.arrowOffsetX(h,j,t,f):f.arrowOffsetX;var p=AJS.$.isFunction(f.arrowOffsetY)?f.arrowOffsetY(h,j,t,f):f.arrowOffsetY;var s=f.container.toLowerCase()!=="body";var g=AJS.$(f.container);var o=s?AJS.$(f.container).parent():AJS.$(window);var r=s?g.offset():{left:0,top:0};var k=s?o.offset():{left:0,top:0};var i=j.target;var u=i.offset();var n=i[0].getBBox&&i[0].getBBox();return{screenPadding:10,arrowMargin:5,window:{top:k.top,left:k.left,scrollTop:o.scrollTop(),scrollLeft:o.scrollLeft(),width:o.width(),height:o.height()},scrollContainer:{width:g.width(),height:g.height()},trigger:{top:u.top-r.top,left:u.left-r.left,width:n?n.width:i.outerWidth(),height:n?n.height:i.outerHeight()},dialog:{width:h.width(),height:h.height(),offset:{top:l,left:m}},arrow:{height:h.find(".arrow").outerHeight(),offset:{top:p,left:q}}}}function e(f,p,G,r){var n=b(f,p,G,r);var j=n.screenPadding;var k=n.window;var t=n.trigger;var D=n.dialog;var i=n.arrow;var z=n.scrollContainer;var E={top:t.top-k.scrollTop,left:t.left-k.scrollLeft};var A=Math.floor(t.height/2);var v=Math.floor(D.height/2);var u=Math.floor(i.height/2);var C=E.left-D.offset.left-j;var H=z.width-E.left-t.width-D.offset.left-j;var B=C>=D.width;var h=H>=D.width;var l=!h&&B?"e":"w";var o=E.top+A-u;var q=k.height-o-i.height;j=Math.min(j,o-n.arrowMargin);j=Math.min(j,q-n.arrowMargin);var g=E.top+A;var x=Math.max(g-j,0);var F=Math.max(k.height-g-j,0);var y=v-D.offset.top>x;var m=v+D.offset.top>F;var w;var s;if(y){w={top:k.scrollTop+j,left:l==="w"?t.left+t.width+D.offset.left:t.left-D.width-D.offset.left};s={top:(t.top+A)-(w.top+u)}}else{if(m){w={top:k.scrollTop+k.height-D.height-j,left:l==="w"?t.left+t.width+D.offset.left:t.left-D.width-D.offset.left};s={top:(t.top+A)-(w.top+u)}}else{w={top:t.top+A-v+D.offset.top,left:l==="w"?t.left+t.width+D.offset.left:t.left-D.width-D.offset.left};s={top:v-u+i.offset.top}}}return{gravity:l,popupCss:w,arrowCss:s}}function a(g,o,z,s){var x=AJS.$.isFunction(s.offsetX)?s.offsetX(g,o,z,s):s.offsetX;var v=AJS.$.isFunction(s.offsetY)?s.offsetY(g,o,z,s):s.offsetY;var m=AJS.$.isFunction(s.arrowOffsetX)?s.arrowOffsetX(g,o,z,s):s.arrowOffsetX;var l=AJS.$.isFunction(s.arrowOffsetY)?s.arrowOffsetY(g,o,z,s):s.arrowOffsetY;var f=c(window);var p=c(o.target);var y=c(g);var j=c(g.find(".aui-inline-dialog-arrow"));var i=p.left+p.width/2;var u=(window.pageYOffset||document.documentElement.scrollTop)+f.height;var k=10;y.top=p.top+p.height+~~v;y.left=p.left+~~x;var r=f.width-(y.left+y.width+k);j.left=i-y.left+~~m;j.top=-(j.height/2);var n=p.top>y.height;var h=(y.top+y.height)<u;var q=(!h&&n)||(n&&s.gravity==="s");if(q){y.top=p.top-y.height-(j.height/2);j.top=y.height}if(s.isRelativeToMouse){if(r<0){y.right=k;y.left="auto";j.left=z.x-(f.width-y.width)}else{y.left=z.x-20;j.left=z.x-y.left}}else{if(r<0){y.right=k;y.left="auto";var w=f.width-y.right;var t=w-y.width;j.right="auto";j.left=i-t-j.width/2}else{if(y.width<=p.width/2){j.left=y.width/2;y.left=i-y.width/2}}}return{gravity:q?"s":"n",displayAbove:q,popupCss:{left:y.left,top:y.top,right:y.right},arrowCss:{left:j.left,top:j.top,right:j.right}}}AJS.CustomInlineDialog.opts={onTop:false,responseHandler:function(g,f,h){return g},closeOthers:true,isRelativeToMouse:false,addActiveClass:true,onHover:false,useLiveEvents:false,noBind:false,fadeTime:100,persistent:false,hideDelay:10000,showDelay:0,width:300,offsetX:0,offsetY:10,arrowOffsetX:0,arrowOffsetY:0,container:"body",cacheContent:true,displayShadow:true,autoWidth:false,gravity:"n",closeOnTriggerClick:false,preHideCallback:function(){return true},hideCallback:function(){},initCallback:function(){},upfrontCallback:function(){},calculatePositions:function(f,i,j,h){h=h||{};var g=h.gravity==="w"?e:a;return g(f,i,j,h)},getArrowPath:function(f){if(f.gravity==="s"){return"M0,8L8,16,16,8"}else{return"M0,8L8,0,16,8"}},getArrowAttributes:function(){return{fill:"#fff",stroke:"#ccc"}}}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'soy/headerDropdown.soy' */
// This file was automatically generated from headerDropdown.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Menu == 'undefined') { JIRA.Templates.Menu = {}; }
if (typeof JIRA.Templates.Menu.Dropdowns == 'undefined') { JIRA.Templates.Menu.Dropdowns = {}; }


JIRA.Templates.Menu.Dropdowns.dropdown2Fragment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var sectionList3 = opt_data.sections;
  var sectionListLen3 = sectionList3.length;
  for (var sectionIndex3 = 0; sectionIndex3 < sectionListLen3; sectionIndex3++) {
    var sectionData3 = sectionList3[sectionIndex3];
    var hasItems__soy4 = sectionData3.items && sectionData3.items.length > 0;
    output.append('<div class="aui-dropdown2-section">', (hasItems__soy4 && sectionData3.label) ? '<strong>' + soy.$$escapeHtml(sectionData3.label) + '</strong>' : '', '<ul class=\'aui-list-truncate\'', (sectionData3.id) ? ' id="' + soy.$$escapeHtml(sectionData3.id) + '"' : '', (sectionData3.style) ? ' class="' + soy.$$escapeHtml(sectionData3.style) + '"' : '', '>');
    if (hasItems__soy4) {
      var itemList25 = sectionData3.items;
      var itemListLen25 = itemList25.length;
      for (var itemIndex25 = 0; itemIndex25 < itemListLen25; itemIndex25++) {
        var itemData25 = itemList25[itemIndex25];
        JIRA.Templates.Menu.Dropdowns.dropdown2Item(itemData25, output);
      }
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Menu.Dropdowns.dropdown2Item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.style) ? ' class="' + soy.$$escapeHtml(opt_data.style) + '"' : '', '><a href="', soy.$$escapeHtml(opt_data.url), '"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '_lnk"' : '', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', ' class="', (opt_data.iconUrl) ? 'aui-icon-container' : '', (opt_data.parameters && opt_data.parameters['class']) ? ' ' + soy.$$escapeHtml(opt_data.parameters['class']) : '', '"');
  if (opt_data.parameters) {
    var keyList66 = soy.$$getMapKeys(opt_data.parameters);
    var keyListLen66 = keyList66.length;
    for (var keyIndex66 = 0; keyIndex66 < keyListLen66; keyIndex66++) {
      var keyData66 = keyList66[keyIndex66];
      output.append((keyData66 != 'class') ? ' ' + soy.$$escapeHtml(keyData66) + '="' + soy.$$escapeHtml(opt_data.parameters[keyData66]) + '"' : '');
    }
  }
  output.append('>', (opt_data.iconUrl) ? '<img class="icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '" />' : '', soy.$$escapeHtml(opt_data.label), '</a></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'js/init-dropdown2.js' */
;(function() {
    var SmartAjax = require('jira/ajs/ajax/smart-ajax');
    var Events = require('jira/util/events');
    var $ = require('jquery');

    /**
     * Binds analytics events to capture opening / closing of any dropdown menus, and clicking of any menu items therein.
     * Passes the id of the link element as a parameter
     */
    function bindHeaderDropdown2Analytics() {
        $("nav.aui-header a.aui-dropdown2-trigger").each(function() {
            var $ddtrigger = $(this);
            var id = $ddtrigger.attr("id");
            if (id) {
                var $dd = $("#" + $ddtrigger.attr("aria-owns"));
                $dd.on("aui-dropdown2-show", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.opened",
                        data: {
                            id: id
                        }
                    });
                });
                $dd.on("aui-dropdown2-hide", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.closed",
                        data: {
                            id: id
                        }
                    });
                });
                $dd.on("click", "a", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.item.clicked",
                        data: {
                            id: this.id,
                            menu_id: id
                        }
                    });
                });
            }
        });
    }

    /**
     * Binds all the header implementations of Dropdown2. Including global nav and user profile.
     */
    function bindHeaderDropdown2() {
        $(".jira-ajax-menu").each(function () {
            var $ddtrigger = $(this);
            var $dd = $("#" + $ddtrigger.attr("aria-owns"));
            var $ajaxkey = $dd.data("aui-dropdown2-ajax-key");

            if ($ajaxkey) {
                $dd.bind("aui-dropdown2-show", function (event, options) {
                    Events.trigger('aui-dropdown2-show-before', event.target.id);
                    $dd.empty();
                    $dd.addClass("aui-dropdown2-loading");
                    SmartAjax.makeRequest({
                        url: contextPath + "/rest/api/1.0/menus/" + $ajaxkey,
                        data: {
                            inAdminMode: AJS.Meta.getBoolean("in-admin-mode")
                        },
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            $dd.removeClass("aui-dropdown2-loading");
                            $dd.html(JIRA.Templates.Menu.Dropdowns.dropdown2Fragment(data));

                            if (options && options.selectFirst) {
                                $dd.find("a:not(.disabled)").filter(":first").addClass("active")
                            }
                            Events.trigger('aui-dropdown2-show-after', event.target.id);
                        }
                    });
                });
            }
        });
    }

    $(function () {
        bindHeaderDropdown2();
        bindHeaderDropdown2Analytics();
    });

    AJS.namespace('JIRA.Dropdowns.bindHeaderDropdown2', null, bindHeaderDropdown2);
})();
;
